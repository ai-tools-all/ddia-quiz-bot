1
00:00:01,520 --> 00:00:07,970

all right hello everyone I'm today going

2
00:00:07,970 --> 00:00:07,980
all right hello everyone I'm today going
 

3
00:00:07,980 --> 00:00:10,910
all right hello everyone I'm today going
to talk about this paper about how

4
00:00:10,910 --> 00:00:10,920
to talk about this paper about how
 

5
00:00:10,920 --> 00:00:15,289
to talk about this paper about how
Facebook uses memcache I'm in order to

6
00:00:15,289 --> 00:00:15,299
Facebook uses memcache I'm in order to
 

7
00:00:15,299 --> 00:00:19,099
Facebook uses memcache I'm in order to
handle enormous load the reason we're

8
00:00:19,099 --> 00:00:19,109
handle enormous load the reason we're
 

9
00:00:19,109 --> 00:00:20,990
handle enormous load the reason we're
reading this paper is that it's an

10
00:00:20,990 --> 00:00:21,000
reading this paper is that it's an
 

11
00:00:21,000 --> 00:00:23,740
reading this paper is that it's an
experience paper there's not really any

12
00:00:23,740 --> 00:00:23,750
experience paper there's not really any
 

13
00:00:23,750 --> 00:00:26,660
experience paper there's not really any
new concepts or ideas or techniques here

14
00:00:26,660 --> 00:00:26,670
new concepts or ideas or techniques here
 

15
00:00:26,670 --> 00:00:32,830
new concepts or ideas or techniques here
but it's kind of what a real live

16
00:00:32,830 --> 00:00:32,840

 

17
00:00:32,840 --> 00:00:36,260

company ran into when they were trying

18
00:00:36,260 --> 00:00:36,270
company ran into when they were trying
 

19
00:00:36,270 --> 00:00:38,450
company ran into when they were trying
to build very high capacity

20
00:00:38,450 --> 00:00:38,460
to build very high capacity
 

21
00:00:38,460 --> 00:00:40,850
to build very high capacity
infrastructure there's a couple of ways

22
00:00:40,850 --> 00:00:40,860
infrastructure there's a couple of ways
 

23
00:00:40,860 --> 00:00:44,150
infrastructure there's a couple of ways
you could read it one is a sort of

24
00:00:44,150 --> 00:00:44,160
you could read it one is a sort of
 

25
00:00:44,160 --> 00:00:47,540
you could read it one is a sort of
cautionary tale about what goes wrong if

26
00:00:47,540 --> 00:00:47,550
cautionary tale about what goes wrong if
 

27
00:00:47,550 --> 00:00:49,790
cautionary tale about what goes wrong if
you don't take consistency seriously

28
00:00:49,790 --> 00:00:49,800
you don't take consistency seriously
 

29
00:00:49,800 --> 00:00:53,209
you don't take consistency seriously
from the start another way to read it is

30
00:00:53,209 --> 00:00:53,219
from the start another way to read it is
 

31
00:00:53,219 --> 00:00:55,189
from the start another way to read it is
that it's an impressive story about how

32
00:00:55,189 --> 00:00:55,199
that it's an impressive story about how
 

33
00:00:55,199 --> 00:00:58,130
that it's an impressive story about how
to get extremely high capacity from

34
00:00:58,130 --> 00:00:58,140
to get extremely high capacity from
 

35
00:00:58,140 --> 00:01:03,009
to get extremely high capacity from
using mostly off-the-shelf software

36
00:01:03,009 --> 00:01:03,019

 

37
00:01:03,019 --> 00:01:05,570

another way to read it is that it's a

38
00:01:05,570 --> 00:01:05,580
another way to read it is that it's a
 

39
00:01:05,580 --> 00:01:08,240
another way to read it is that it's a
kind of illustration or the fundamental

40
00:01:08,240 --> 00:01:08,250
kind of illustration or the fundamental
 

41
00:01:08,250 --> 00:01:11,480
kind of illustration or the fundamental
struggle that a lot of setups face

42
00:01:11,480 --> 00:01:11,490
struggle that a lot of setups face
 

43
00:01:11,490 --> 00:01:13,460
struggle that a lot of setups face
between trying to get very high

44
00:01:13,460 --> 00:01:13,470
between trying to get very high
 

45
00:01:13,470 --> 00:01:16,249
between trying to get very high
performance which you do by things like

46
00:01:16,249 --> 00:01:16,259
performance which you do by things like
 

47
00:01:16,259 --> 00:01:18,289
performance which you do by things like
replication and how to give consistency

48
00:01:18,289 --> 00:01:18,299
replication and how to give consistency
 

49
00:01:18,299 --> 00:01:20,630
replication and how to give consistency
for which techniques like replication

50
00:01:20,630 --> 00:01:20,640
for which techniques like replication
 

51
00:01:20,640 --> 00:01:24,170
for which techniques like replication
are really the enemy and so you know we

52
00:01:24,170 --> 00:01:24,180
are really the enemy and so you know we
 

53
00:01:24,180 --> 00:01:26,960
are really the enemy and so you know we
can argue about whether we like their

54
00:01:26,960 --> 00:01:26,970
can argue about whether we like their
 

55
00:01:26,970 --> 00:01:28,760
can argue about whether we like their
design or we think it's elegant or a

56
00:01:28,760 --> 00:01:28,770
design or we think it's elegant or a
 

57
00:01:28,770 --> 00:01:31,850
design or we think it's elegant or a
good solution but we can't really argue

58
00:01:31,850 --> 00:01:31,860
good solution but we can't really argue
 

59
00:01:31,860 --> 00:01:35,840
good solution but we can't really argue
with how successful they've been so we

60
00:01:35,840 --> 00:01:35,850
with how successful they've been so we
 

61
00:01:35,850 --> 00:01:37,819
with how successful they've been so we
do need to take them seriously and for

62
00:01:37,819 --> 00:01:37,829
do need to take them seriously and for
 

63
00:01:37,829 --> 00:01:40,010
do need to take them seriously and for
me actually this paper which I first

64
00:01:40,010 --> 00:01:40,020
me actually this paper which I first
 

65
00:01:40,020 --> 00:01:43,580
me actually this paper which I first
read quite a few years ago it's been I

66
00:01:43,580 --> 00:01:43,590
read quite a few years ago it's been I
 

67
00:01:43,590 --> 00:01:45,649
read quite a few years ago it's been I
thought about it a lot and it's been

68
00:01:45,649 --> 00:01:45,659
thought about it a lot and it's been
 

69
00:01:45,659 --> 00:01:51,469
thought about it a lot and it's been
sort of a source of sort of ideas and

70
00:01:51,469 --> 00:01:51,479
sort of a source of sort of ideas and
 

71
00:01:51,479 --> 00:01:55,160
sort of a source of sort of ideas and
understanding about problems at many

72
00:01:55,160 --> 00:01:55,170
understanding about problems at many
 

73
00:01:55,170 --> 00:01:57,880
understanding about problems at many
points

74
00:01:57,880 --> 00:01:57,890

 

75
00:01:57,890 --> 00:02:01,280

all right so before talking about

76
00:02:01,280 --> 00:02:01,290
all right so before talking about
 

77
00:02:01,290 --> 00:02:03,230
all right so before talking about
Facebook proper you know they're an

78
00:02:03,230 --> 00:02:03,240
Facebook proper you know they're an
 

79
00:02:03,240 --> 00:02:06,230
Facebook proper you know they're an
example of a pattern that you see fairly

80
00:02:06,230 --> 00:02:06,240
example of a pattern that you see fairly
 

81
00:02:06,240 --> 00:02:07,609
example of a pattern that you see fairly
often or that many people have

82
00:02:07,609 --> 00:02:07,619
often or that many people have
 

83
00:02:07,619 --> 00:02:09,139
often or that many people have
experienced in which they're trying to

84
00:02:09,139 --> 00:02:09,149
experienced in which they're trying to
 

85
00:02:09,149 --> 00:02:11,059
experienced in which they're trying to
build a website to do something and you

86
00:02:11,059 --> 00:02:11,069
build a website to do something and you
 

87
00:02:11,069 --> 00:02:13,010
build a website to do something and you
know typically people who build websites

88
00:02:13,010 --> 00:02:13,020
know typically people who build websites
 

89
00:02:13,020 --> 00:02:14,990
know typically people who build websites
are not interested in building high

90
00:02:14,990 --> 00:02:15,000
are not interested in building high
 

91
00:02:15,000 --> 00:02:20,180
are not interested in building high
performance you know high performance

92
00:02:20,180 --> 00:02:20,190
performance you know high performance
 

93
00:02:20,190 --> 00:02:22,190
performance you know high performance
storage infrastructure they're

94
00:02:22,190 --> 00:02:22,200
storage infrastructure they're
 

95
00:02:22,200 --> 00:02:24,740
storage infrastructure they're
interested in building features that

96
00:02:24,740 --> 00:02:24,750
interested in building features that
 

97
00:02:24,750 --> 00:02:26,930
interested in building features that
will make their users happy or selling

98
00:02:26,930 --> 00:02:26,940
will make their users happy or selling
 

99
00:02:26,940 --> 00:02:29,210
will make their users happy or selling
more advertisements or something you

100
00:02:29,210 --> 00:02:29,220
more advertisements or something you
 

101
00:02:29,220 --> 00:02:31,280
more advertisements or something you
know so they they're not gonna start by

102
00:02:31,280 --> 00:02:31,290
know so they they're not gonna start by
 

103
00:02:31,290 --> 00:02:33,440
know so they they're not gonna start by
spending a main year of effort or a

104
00:02:33,440 --> 00:02:33,450
spending a main year of effort or a
 

105
00:02:33,450 --> 00:02:35,390
spending a main year of effort or a
whole lot of time building cool

106
00:02:35,390 --> 00:02:35,400
whole lot of time building cool
 

107
00:02:35,400 --> 00:02:36,440
whole lot of time building cool
infrastructure they're gonna start by

108
00:02:36,440 --> 00:02:36,450
infrastructure they're gonna start by
 

109
00:02:36,450 --> 00:02:38,330
infrastructure they're gonna start by
building features in that they'll sort

110
00:02:38,330 --> 00:02:38,340
building features in that they'll sort
 

111
00:02:38,340 --> 00:02:41,840
building features in that they'll sort
of make infrastructure better only to

112
00:02:41,840 --> 00:02:41,850
of make infrastructure better only to
 

113
00:02:41,850 --> 00:02:42,979
of make infrastructure better only to
the extent that they really have to

114
00:02:42,979 --> 00:02:42,989
the extent that they really have to
 

115
00:02:42,989 --> 00:02:44,060
the extent that they really have to
because you know that's the best use of

116
00:02:44,060 --> 00:02:44,070
because you know that's the best use of
 

117
00:02:44,070 --> 00:02:47,900
because you know that's the best use of
their time alright so a typical starting

118
00:02:47,900 --> 00:02:47,910
their time alright so a typical starting
 

119
00:02:47,910 --> 00:02:51,830
their time alright so a typical starting
scenario in a ways when a some website

120
00:02:51,830 --> 00:02:51,840
scenario in a ways when a some website
 

121
00:02:51,840 --> 00:02:54,170
scenario in a ways when a some website
is very small is you know there's no

122
00:02:54,170 --> 00:02:54,180
is very small is you know there's no
 

123
00:02:54,180 --> 00:02:55,790
is very small is you know there's no
point in starting with anything more

124
00:02:55,790 --> 00:02:55,800
point in starting with anything more
 

125
00:02:55,800 --> 00:02:57,559
point in starting with anything more
than just a single machine right you

126
00:02:57,559 --> 00:02:57,569
than just a single machine right you
 

127
00:02:57,569 --> 00:02:59,150
than just a single machine right you
know maybe you started you only have a

128
00:02:59,150 --> 00:02:59,160
know maybe you started you only have a
 

129
00:02:59,160 --> 00:03:01,970
know maybe you started you only have a
couple users sitting in front of their

130
00:03:01,970 --> 00:03:01,980
couple users sitting in front of their
 

131
00:03:01,980 --> 00:03:05,210
couple users sitting in front of their
browsers and you know they talk over the

132
00:03:05,210 --> 00:03:05,220
browsers and you know they talk over the
 

133
00:03:05,220 --> 00:03:07,250
browsers and you know they talk over the
internet here with your single machine

134
00:03:07,250 --> 00:03:07,260
internet here with your single machine
 

135
00:03:07,260 --> 00:03:09,530
internet here with your single machine
your single machine is gonna maybe run

136
00:03:09,530 --> 00:03:09,540
your single machine is gonna maybe run
 

137
00:03:09,540 --> 00:03:16,160
your single machine is gonna maybe run
the Apache web server now maybe you

138
00:03:16,160 --> 00:03:16,170
the Apache web server now maybe you
 

139
00:03:16,170 --> 00:03:20,440
the Apache web server now maybe you
write the scripts that produce web pages

140
00:03:20,440 --> 00:03:20,450
write the scripts that produce web pages
 

141
00:03:20,450 --> 00:03:23,960
write the scripts that produce web pages
using PHP or Python or some other

142
00:03:23,960 --> 00:03:23,970
using PHP or Python or some other
 

143
00:03:23,970 --> 00:03:26,990
using PHP or Python or some other
convenient easy to program sort of

144
00:03:26,990 --> 00:03:27,000
convenient easy to program sort of
 

145
00:03:27,000 --> 00:03:29,330
convenient easy to program sort of
scripting style language and Facebook

146
00:03:29,330 --> 00:03:29,340
scripting style language and Facebook
 

147
00:03:29,340 --> 00:03:33,050
scripting style language and Facebook
uses PHP you need to store your data

148
00:03:33,050 --> 00:03:33,060
uses PHP you need to store your data
 

149
00:03:33,060 --> 00:03:35,990
uses PHP you need to store your data
somewhere or you can just download sort

150
00:03:35,990 --> 00:03:36,000
somewhere or you can just download sort
 

151
00:03:36,000 --> 00:03:41,180
somewhere or you can just download sort
of standard database and Facebook happen

152
00:03:41,180 --> 00:03:41,190
of standard database and Facebook happen
 

153
00:03:41,190 --> 00:03:42,620
of standard database and Facebook happen
to use my sequel my school is a good

154
00:03:42,620 --> 00:03:42,630
to use my sequel my school is a good
 

155
00:03:42,630 --> 00:03:45,620
to use my sequel my school is a good
choice because it implements the sequel

156
00:03:45,620 --> 00:03:45,630
choice because it implements the sequel
 

157
00:03:45,630 --> 00:03:49,069
choice because it implements the sequel
query language is very powerful and acid

158
00:03:49,069 --> 00:03:49,079
query language is very powerful and acid
 

159
00:03:49,079 --> 00:03:51,500
query language is very powerful and acid
transactions provides durable storage so

160
00:03:51,500 --> 00:03:51,510
transactions provides durable storage so
 

161
00:03:51,510 --> 00:03:54,920
transactions provides durable storage so
this is like a very very nice set up I

162
00:03:54,920 --> 00:03:54,930
this is like a very very nice set up I
 

163
00:03:54,930 --> 00:03:58,310
this is like a very very nice set up I
am will take you a long way actually but

164
00:03:58,310 --> 00:03:58,320
am will take you a long way actually but
 

165
00:03:58,320 --> 00:04:00,440
am will take you a long way actually but
supposing supposing you get successful

166
00:04:00,440 --> 00:04:00,450
supposing supposing you get successful
 

167
00:04:00,450 --> 00:04:02,660
supposing supposing you get successful
you get more and more users you know

168
00:04:02,660 --> 00:04:02,670
you get more and more users you know
 

169
00:04:02,670 --> 00:04:04,340
you get more and more users you know
you're gonna get more and more load more

170
00:04:04,340 --> 00:04:04,350
you're gonna get more and more load more
 

171
00:04:04,350 --> 00:04:07,039
you're gonna get more and more load more
and more people gonna be viewing your

172
00:04:07,039 --> 00:04:07,049
and more people gonna be viewing your
 

173
00:04:07,049 --> 00:04:09,890
and more people gonna be viewing your
website and running whatever PHP stuff

174
00:04:09,890 --> 00:04:09,900
website and running whatever PHP stuff
 

175
00:04:09,900 --> 00:04:10,580
website and running whatever PHP stuff
you're with

176
00:04:10,580 --> 00:04:10,590
you're with
 

177
00:04:10,590 --> 00:04:14,960
you're with
site provides and so at some point

178
00:04:14,960 --> 00:04:14,970
site provides and so at some point
 

179
00:04:14,970 --> 00:04:17,180
site provides and so at some point
almost certainly the first thing that's

180
00:04:17,180 --> 00:04:17,190
almost certainly the first thing that's
 

181
00:04:17,190 --> 00:04:19,280
almost certainly the first thing that's
going to go wrong is that the PHP

182
00:04:19,280 --> 00:04:19,290
going to go wrong is that the PHP
 

183
00:04:19,290 --> 00:04:21,830
going to go wrong is that the PHP
scripts are gonna take up too much CPU

184
00:04:21,830 --> 00:04:21,840
scripts are gonna take up too much CPU
 

185
00:04:21,840 --> 00:04:25,640
scripts are gonna take up too much CPU
time that's usually the first bottleneck

186
00:04:25,640 --> 00:04:25,650
time that's usually the first bottleneck
 

187
00:04:25,650 --> 00:04:26,870
time that's usually the first bottleneck
people encounter if they start with a

188
00:04:26,870 --> 00:04:26,880
people encounter if they start with a
 

189
00:04:26,880 --> 00:04:29,840
people encounter if they start with a
single server so what you need is some

190
00:04:29,840 --> 00:04:29,850
single server so what you need is some
 

191
00:04:29,850 --> 00:04:31,909
single server so what you need is some
way to get more horsepower for your PHP

192
00:04:31,909 --> 00:04:31,919
way to get more horsepower for your PHP
 

193
00:04:31,919 --> 00:04:33,830
way to get more horsepower for your PHP
scripts and so that takes us to kind of

194
00:04:33,830 --> 00:04:33,840
scripts and so that takes us to kind of
 

195
00:04:33,840 --> 00:04:38,420
scripts and so that takes us to kind of
architecture number two for websites in

196
00:04:38,420 --> 00:04:38,430
architecture number two for websites in
 

197
00:04:38,430 --> 00:04:40,460
architecture number two for websites in
which you know you have lots and lots of

198
00:04:40,460 --> 00:04:40,470
which you know you have lots and lots of
 

199
00:04:40,470 --> 00:04:44,440
which you know you have lots and lots of
users right or more users than before

200
00:04:44,440 --> 00:04:44,450
users right or more users than before
 

201
00:04:44,450 --> 00:04:47,390
users right or more users than before
you need more CPU power for your PHP

202
00:04:47,390 --> 00:04:47,400
you need more CPU power for your PHP
 

203
00:04:47,400 --> 00:04:50,030
you need more CPU power for your PHP
scripts so you run a bunch of front end

204
00:04:50,030 --> 00:04:50,040
scripts so you run a bunch of front end
 

205
00:04:50,040 --> 00:04:53,510
scripts so you run a bunch of front end
servers whose only job is to run the web

206
00:04:53,510 --> 00:04:53,520
servers whose only job is to run the web
 

207
00:04:53,520 --> 00:04:57,129
servers whose only job is to run the web
servers that users browsers talk to and

208
00:04:57,129 --> 00:04:57,139
servers that users browsers talk to and
 

209
00:04:57,139 --> 00:05:00,469
servers that users browsers talk to and
these are called front end servers so

210
00:05:00,469 --> 00:05:00,479
these are called front end servers so
 

211
00:05:00,479 --> 00:05:04,640
these are called front end servers so
these are going to run a patch either

212
00:05:04,640 --> 00:05:04,650

 

213
00:05:04,650 --> 00:05:09,230

webserver and the PHP scripts now you

214
00:05:09,230 --> 00:05:09,240
webserver and the PHP scripts now you
 

215
00:05:09,240 --> 00:05:10,550
webserver and the PHP scripts now you
know you users are going to talk to

216
00:05:10,550 --> 00:05:10,560
know you users are going to talk to
 

217
00:05:10,560 --> 00:05:11,870
know you users are going to talk to
different servers at different times

218
00:05:11,870 --> 00:05:11,880
different servers at different times
 

219
00:05:11,880 --> 00:05:14,600
different servers at different times
maybe your users Quadra each other they

220
00:05:14,600 --> 00:05:14,610
maybe your users Quadra each other they
 

221
00:05:14,610 --> 00:05:16,249
maybe your users Quadra each other they
message each other they need to see each

222
00:05:16,249 --> 00:05:16,259
message each other they need to see each
 

223
00:05:16,259 --> 00:05:17,450
message each other they need to see each
other's posts or something

224
00:05:17,450 --> 00:05:17,460
other's posts or something
 

225
00:05:17,460 --> 00:05:19,070
other's posts or something
so all these front-end servers are going

226
00:05:19,070 --> 00:05:19,080
so all these front-end servers are going
 

227
00:05:19,080 --> 00:05:23,200
so all these front-end servers are going
to need to see the same back-end data

228
00:05:23,200 --> 00:05:23,210

 

229
00:05:23,210 --> 00:05:27,110

and in order to do that you probably

230
00:05:27,110 --> 00:05:27,120
and in order to do that you probably
 

231
00:05:27,120 --> 00:05:28,879
and in order to do that you probably
can't just stick at least for a while

232
00:05:28,879 --> 00:05:28,889
can't just stick at least for a while
 

233
00:05:28,889 --> 00:05:30,290
can't just stick at least for a while
you can just stick with one database

234
00:05:30,290 --> 00:05:30,300
you can just stick with one database
 

235
00:05:30,300 --> 00:05:31,490
you can just stick with one database
server so you gonna have a single

236
00:05:31,490 --> 00:05:31,500
server so you gonna have a single
 

237
00:05:31,500 --> 00:05:35,300
server so you gonna have a single
machine already my sequel that handles

238
00:05:35,300 --> 00:05:35,310
machine already my sequel that handles
 

239
00:05:35,310 --> 00:05:37,760
machine already my sequel that handles
all of the database all queries and

240
00:05:37,760 --> 00:05:37,770
all of the database all queries and
 

241
00:05:37,770 --> 00:05:40,520
all of the database all queries and
updates reads and writes from the front

242
00:05:40,520 --> 00:05:40,530
updates reads and writes from the front
 

243
00:05:40,530 --> 00:05:43,189
updates reads and writes from the front
end servers and if you possibly can it's

244
00:05:43,189 --> 00:05:43,199
end servers and if you possibly can it's
 

245
00:05:43,199 --> 00:05:45,050
end servers and if you possibly can it's
wise to use a single server here because

246
00:05:45,050 --> 00:05:45,060
wise to use a single server here because
 

247
00:05:45,060 --> 00:05:46,550
wise to use a single server here because
as soon as you go with two servers and

248
00:05:46,550 --> 00:05:46,560
as soon as you go with two servers and
 

249
00:05:46,560 --> 00:05:49,040
as soon as you go with two servers and
somehow your data over multiple database

250
00:05:49,040 --> 00:05:49,050
somehow your data over multiple database
 

251
00:05:49,050 --> 00:05:51,610
somehow your data over multiple database
servers like gets much more complicated

252
00:05:51,610 --> 00:05:51,620
servers like gets much more complicated
 

253
00:05:51,620 --> 00:05:54,050
servers like gets much more complicated
and you need to worry about things like

254
00:05:54,050 --> 00:05:54,060
and you need to worry about things like
 

255
00:05:54,060 --> 00:05:56,540
and you need to worry about things like
do you need distributed transactions or

256
00:05:56,540 --> 00:05:56,550
do you need distributed transactions or
 

257
00:05:56,550 --> 00:05:58,820
do you need distributed transactions or
how it has the PHP scripts decide which

258
00:05:58,820 --> 00:05:58,830
how it has the PHP scripts decide which
 

259
00:05:58,830 --> 00:06:01,580
how it has the PHP scripts decide which
database server to talk to and so again

260
00:06:01,580 --> 00:06:01,590
database server to talk to and so again
 

261
00:06:01,590 --> 00:06:03,379
database server to talk to and so again
you can get a long way with this second

262
00:06:03,379 --> 00:06:03,389
you can get a long way with this second
 

263
00:06:03,389 --> 00:06:05,689
you can get a long way with this second
architecture you have as much CPU power

264
00:06:05,689 --> 00:06:05,699
architecture you have as much CPU power
 

265
00:06:05,699 --> 00:06:07,879
architecture you have as much CPU power
as you like by adding more front end

266
00:06:07,879 --> 00:06:07,889
as you like by adding more front end
 

267
00:06:07,889 --> 00:06:11,870
as you like by adding more front end
servers and up to a point a single

268
00:06:11,870 --> 00:06:11,880
servers and up to a point a single
 

269
00:06:11,880 --> 00:06:13,580
servers and up to a point a single
database server will actually be able to

270
00:06:13,580 --> 00:06:13,590
database server will actually be able to
 

271
00:06:13,590 --> 00:06:16,010
database server will actually be able to
absorb the reason rights of many front

272
00:06:16,010 --> 00:06:16,020
absorb the reason rights of many front
 

273
00:06:16,020 --> 00:06:17,990
absorb the reason rights of many front
ends but you know maybe you're very

274
00:06:17,990 --> 00:06:18,000
ends but you know maybe you're very
 

275
00:06:18,000 --> 00:06:22,600
ends but you know maybe you're very
successful you get even more users and

276
00:06:22,600 --> 00:06:22,610
successful you get even more users and
 

277
00:06:22,610 --> 00:06:24,830
successful you get even more users and
so the question is what's gonna go wrong

278
00:06:24,830 --> 00:06:24,840
so the question is what's gonna go wrong
 

279
00:06:24,840 --> 00:06:27,589
so the question is what's gonna go wrong
next and typically what goes wrong next

280
00:06:27,589 --> 00:06:27,599
next and typically what goes wrong next
 

281
00:06:27,599 --> 00:06:30,080
next and typically what goes wrong next
is that the database server since you

282
00:06:30,080 --> 00:06:30,090
is that the database server since you
 

283
00:06:30,090 --> 00:06:33,159
is that the database server since you
can always add more CPU more web servers

284
00:06:33,159 --> 00:06:33,169
can always add more CPU more web servers
 

285
00:06:33,169 --> 00:06:35,420
can always add more CPU more web servers
you know what inevitably goes wrong is

286
00:06:35,420 --> 00:06:35,430
you know what inevitably goes wrong is
 

287
00:06:35,430 --> 00:06:37,610
you know what inevitably goes wrong is
that after a while the database server

288
00:06:37,610 --> 00:06:37,620
that after a while the database server
 

289
00:06:37,620 --> 00:06:43,370
that after a while the database server
runs out of steam okay so what's the

290
00:06:43,370 --> 00:06:43,380
runs out of steam okay so what's the
 

291
00:06:43,380 --> 00:06:49,370
runs out of steam okay so what's the
next architecture this is web

292
00:06:49,370 --> 00:06:49,380
next architecture this is web
 

293
00:06:49,380 --> 00:06:51,680
next architecture this is web
architecture 3 and the kind of standard

294
00:06:51,680 --> 00:06:51,690
architecture 3 and the kind of standard
 

295
00:06:51,690 --> 00:06:55,070
architecture 3 and the kind of standard
evolution of big websites here we have

296
00:06:55,070 --> 00:06:55,080
evolution of big websites here we have
 

297
00:06:55,080 --> 00:06:57,920
evolution of big websites here we have
the same if you know now thousands and

298
00:06:57,920 --> 00:06:57,930
the same if you know now thousands and
 

299
00:06:57,930 --> 00:07:01,490
the same if you know now thousands and
thousands of users lots and lots of

300
00:07:01,490 --> 00:07:01,500
thousands of users lots and lots of
 

301
00:07:01,500 --> 00:07:04,730
thousands of users lots and lots of
front ends and now we basically we know

302
00:07:04,730 --> 00:07:04,740
front ends and now we basically we know
 

303
00:07:04,740 --> 00:07:07,899
front ends and now we basically we know
we're gonna have to have multiple

304
00:07:07,899 --> 00:07:07,909
we're gonna have to have multiple
 

305
00:07:07,909 --> 00:07:10,580
we're gonna have to have multiple
database servers so now behind the front

306
00:07:10,580 --> 00:07:10,590
database servers so now behind the front
 

307
00:07:10,590 --> 00:07:14,149
database servers so now behind the front
ends we have a whole rack of database

308
00:07:14,149 --> 00:07:14,159
ends we have a whole rack of database
 

309
00:07:14,159 --> 00:07:16,850
ends we have a whole rack of database
servers each one of them running my

310
00:07:16,850 --> 00:07:16,860
servers each one of them running my
 

311
00:07:16,860 --> 00:07:18,270
servers each one of them running my
sequel again

312
00:07:18,270 --> 00:07:18,280
sequel again
 

313
00:07:18,280 --> 00:07:21,210
sequel again
but we're going to shard the data

314
00:07:21,210 --> 00:07:21,220
but we're going to shard the data
 

315
00:07:21,220 --> 00:07:22,950
but we're going to shard the data
we're driven now to sharding the data

316
00:07:22,950 --> 00:07:22,960
we're driven now to sharding the data
 

317
00:07:22,960 --> 00:07:25,380
we're driven now to sharding the data
over the database server so you know

318
00:07:25,380 --> 00:07:25,390
over the database server so you know
 

319
00:07:25,390 --> 00:07:27,120
over the database server so you know
maybe the first one holds keys you know

320
00:07:27,120 --> 00:07:27,130
maybe the first one holds keys you know
 

321
00:07:27,130 --> 00:07:32,070
maybe the first one holds keys you know
a through G & G through second one holds

322
00:07:32,070 --> 00:07:32,080
a through G & G through second one holds
 

323
00:07:32,080 --> 00:07:34,650
a through G & G through second one holds
keys G through Q and you know whatever

324
00:07:34,650 --> 00:07:34,660
keys G through Q and you know whatever
 

325
00:07:34,660 --> 00:07:37,350
keys G through Q and you know whatever
the charting happens to be and now the

326
00:07:37,350 --> 00:07:37,360
the charting happens to be and now the
 

327
00:07:37,360 --> 00:07:38,670
the charting happens to be and now the
front-end you know you have to teach

328
00:07:38,670 --> 00:07:38,680
front-end you know you have to teach
 

329
00:07:38,680 --> 00:07:40,950
front-end you know you have to teach
your PHP scripts here to look at the

330
00:07:40,950 --> 00:07:40,960
your PHP scripts here to look at the
 

331
00:07:40,960 --> 00:07:42,240
your PHP scripts here to look at the
data they need and try to figure out

332
00:07:42,240 --> 00:07:42,250
data they need and try to figure out
 

333
00:07:42,250 --> 00:07:43,500
data they need and try to figure out
which database server they're going to

334
00:07:43,500 --> 00:07:43,510
which database server they're going to
 

335
00:07:43,510 --> 00:07:45,090
which database server they're going to
talk to it you know in different times

336
00:07:45,090 --> 00:07:45,100
talk to it you know in different times
 

337
00:07:45,100 --> 00:07:46,350
talk to it you know in different times
for different data they're going to talk

338
00:07:46,350 --> 00:07:46,360
for different data they're going to talk
 

339
00:07:46,360 --> 00:07:51,020
for different data they're going to talk
to different servers so this is sharding

340
00:07:51,020 --> 00:07:51,030

 

341
00:07:51,030 --> 00:07:53,220

and of course the reason why this gives

342
00:07:53,220 --> 00:07:53,230
and of course the reason why this gives
 

343
00:07:53,230 --> 00:07:57,450
and of course the reason why this gives
you a boost is that now the all the work

344
00:07:57,450 --> 00:07:57,460
you a boost is that now the all the work
 

345
00:07:57,460 --> 00:07:58,710
you a boost is that now the all the work
of reading and writing has split up

346
00:07:58,710 --> 00:07:58,720
of reading and writing has split up
 

347
00:07:58,720 --> 00:08:01,350
of reading and writing has split up
hopefully hopefully evenly split up

348
00:08:01,350 --> 00:08:01,360
hopefully hopefully evenly split up
 

349
00:08:01,360 --> 00:08:04,080
hopefully hopefully evenly split up
between these servers since they hold

350
00:08:04,080 --> 00:08:04,090
between these servers since they hold
 

351
00:08:04,090 --> 00:08:05,820
between these servers since they hold
different data now replicas rating word

352
00:08:05,820 --> 00:08:05,830
different data now replicas rating word
 

353
00:08:05,830 --> 00:08:08,160
different data now replicas rating word
charting the data and they can execute

354
00:08:08,160 --> 00:08:08,170
charting the data and they can execute
 

355
00:08:08,170 --> 00:08:09,950
charting the data and they can execute
in parallel and have big parallel

356
00:08:09,950 --> 00:08:09,960
in parallel and have big parallel
 

357
00:08:09,960 --> 00:08:14,970
in parallel and have big parallel
capacity to read and write data it's a

358
00:08:14,970 --> 00:08:14,980
capacity to read and write data it's a
 

359
00:08:14,980 --> 00:08:17,100
capacity to read and write data it's a
little bit painful the PHP code has to

360
00:08:17,100 --> 00:08:17,110
little bit painful the PHP code has to
 

361
00:08:17,110 --> 00:08:19,170
little bit painful the PHP code has to
know about the sharding if you change

362
00:08:19,170 --> 00:08:19,180
know about the sharding if you change
 

363
00:08:19,180 --> 00:08:21,450
know about the sharding if you change
the setup of the database servers that

364
00:08:21,450 --> 00:08:21,460
the setup of the database servers that
 

365
00:08:21,460 --> 00:08:23,430
the setup of the database servers that
you add a new database server or you

366
00:08:23,430 --> 00:08:23,440
you add a new database server or you
 

367
00:08:23,440 --> 00:08:25,320
you add a new database server or you
realize you need to split up the keys

368
00:08:25,320 --> 00:08:25,330
realize you need to split up the keys
 

369
00:08:25,330 --> 00:08:27,420
realize you need to split up the keys
differently you know now you need a

370
00:08:27,420 --> 00:08:27,430
differently you know now you need a
 

371
00:08:27,430 --> 00:08:29,310
differently you know now you need a
you're gonna have to modify the software

372
00:08:29,310 --> 00:08:29,320
you're gonna have to modify the software
 

373
00:08:29,320 --> 00:08:31,350
you're gonna have to modify the software
running on the front ends or something

374
00:08:31,350 --> 00:08:31,360
running on the front ends or something
 

375
00:08:31,360 --> 00:08:33,360
running on the front ends or something
in order for them to understand about

376
00:08:33,360 --> 00:08:33,370
in order for them to understand about
 

377
00:08:33,370 --> 00:08:35,610
in order for them to understand about
how to cut over to the new sharding so

378
00:08:35,610 --> 00:08:35,620
how to cut over to the new sharding so
 

379
00:08:35,620 --> 00:08:37,740
how to cut over to the new sharding so
there's some there's some pain here

380
00:08:37,740 --> 00:08:37,750
there's some there's some pain here
 

381
00:08:37,750 --> 00:08:40,020
there's some there's some pain here
there's also if you need transactions

382
00:08:40,020 --> 00:08:40,030
there's also if you need transactions
 

383
00:08:40,030 --> 00:08:42,750
there's also if you need transactions
and you know many people use them if you

384
00:08:42,750 --> 00:08:42,760
and you know many people use them if you
 

385
00:08:42,760 --> 00:08:45,120
and you know many people use them if you
need transactions but the data involved

386
00:08:45,120 --> 00:08:45,130
need transactions but the data involved
 

387
00:08:45,130 --> 00:08:47,130
need transactions but the data involved
in a single transaction is on more than

388
00:08:47,130 --> 00:08:47,140
in a single transaction is on more than
 

389
00:08:47,140 --> 00:08:49,860
in a single transaction is on more than
one database server you're probably

390
00:08:49,860 --> 00:08:49,870
one database server you're probably
 

391
00:08:49,870 --> 00:08:51,720
one database server you're probably
going to need two-phase commit or some

392
00:08:51,720 --> 00:08:51,730
going to need two-phase commit or some
 

393
00:08:51,730 --> 00:08:53,600
going to need two-phase commit or some
other distributed transaction scheme

394
00:08:53,600 --> 00:08:53,610
other distributed transaction scheme
 

395
00:08:53,610 --> 00:08:59,030
other distributed transaction scheme
it's also a pain and slow all right well

396
00:08:59,030 --> 00:08:59,040
it's also a pain and slow all right well
 

397
00:08:59,040 --> 00:09:03,480
it's also a pain and slow all right well
you can you can get fairly far with this

398
00:09:03,480 --> 00:09:03,490
you can you can get fairly far with this
 

399
00:09:03,490 --> 00:09:07,079
you can you can get fairly far with this
arrangement however it's quite expensive

400
00:09:07,079 --> 00:09:07,089
arrangement however it's quite expensive
 

401
00:09:07,089 --> 00:09:10,740
arrangement however it's quite expensive
my sequel or sort of you know fully

402
00:09:10,740 --> 00:09:10,750
my sequel or sort of you know fully
 

403
00:09:10,750 --> 00:09:12,510
my sequel or sort of you know fully
featured database servers like people

404
00:09:12,510 --> 00:09:12,520
featured database servers like people
 

405
00:09:12,520 --> 00:09:14,670
featured database servers like people
like to use it's not particularly fast

406
00:09:14,670 --> 00:09:14,680
like to use it's not particularly fast
 

407
00:09:14,680 --> 00:09:18,120
like to use it's not particularly fast
it can probably

408
00:09:18,120 --> 00:09:18,130
it can probably
 

409
00:09:18,130 --> 00:09:20,370
it can probably
perform a couple hundred thousand reads

410
00:09:20,370 --> 00:09:20,380
perform a couple hundred thousand reads
 

411
00:09:20,380 --> 00:09:24,330
perform a couple hundred thousand reads
per second and far fewer rights and you

412
00:09:24,330 --> 00:09:24,340
per second and far fewer rights and you
 

413
00:09:24,340 --> 00:09:29,780
per second and far fewer rights and you
know web sites tend to be read heavy so

414
00:09:29,780 --> 00:09:29,790
know web sites tend to be read heavy so
 

415
00:09:29,790 --> 00:09:32,190
know web sites tend to be read heavy so
it's likely that you're gonna run out of

416
00:09:32,190 --> 00:09:32,200
it's likely that you're gonna run out of
 

417
00:09:32,200 --> 00:09:36,290
it's likely that you're gonna run out of
steam for reads before writes that

418
00:09:36,290 --> 00:09:36,300
steam for reads before writes that
 

419
00:09:36,300 --> 00:09:38,400
steam for reads before writes that
traffic will be that we load on the web

420
00:09:38,400 --> 00:09:38,410
traffic will be that we load on the web
 

421
00:09:38,410 --> 00:09:40,140
traffic will be that we load on the web
servers will be dominated by reads and

422
00:09:40,140 --> 00:09:40,150
servers will be dominated by reads and
 

423
00:09:40,150 --> 00:09:43,650
servers will be dominated by reads and
so after a while you know you can slice

424
00:09:43,650 --> 00:09:43,660
so after a while you know you can slice
 

425
00:09:43,660 --> 00:09:45,780
so after a while you know you can slice
the data more and more thinly over more

426
00:09:45,780 --> 00:09:45,790
the data more and more thinly over more
 

427
00:09:45,790 --> 00:09:49,200
the data more and more thinly over more
and more servers but two things go wrong

428
00:09:49,200 --> 00:09:49,210
and more servers but two things go wrong
 

429
00:09:49,210 --> 00:09:51,900
and more servers but two things go wrong
with that one is that the some sometimes

430
00:09:51,900 --> 00:09:51,910
with that one is that the some sometimes
 

431
00:09:51,910 --> 00:09:54,420
with that one is that the some sometimes
you're you have specific keys that are

432
00:09:54,420 --> 00:09:54,430
you're you have specific keys that are
 

433
00:09:54,430 --> 00:09:57,330
you're you have specific keys that are
hot that are used a lot and no amount of

434
00:09:57,330 --> 00:09:57,340
hot that are used a lot and no amount of
 

435
00:09:57,340 --> 00:09:59,070
hot that are used a lot and no amount of
slicing really helps there because each

436
00:09:59,070 --> 00:09:59,080
slicing really helps there because each
 

437
00:09:59,080 --> 00:10:02,100
slicing really helps there because each
key is only on a single server so that

438
00:10:02,100 --> 00:10:02,110
key is only on a single server so that
 

439
00:10:02,110 --> 00:10:03,540
key is only on a single server so that
keeps very popular that servers can be

440
00:10:03,540 --> 00:10:03,550
keeps very popular that servers can be
 

441
00:10:03,550 --> 00:10:04,980
keeps very popular that servers can be
overloaded no matter how much you

442
00:10:04,980 --> 00:10:04,990
overloaded no matter how much you
 

443
00:10:04,990 --> 00:10:09,150
overloaded no matter how much you
partition or shard the data and the

444
00:10:09,150 --> 00:10:09,160
partition or shard the data and the
 

445
00:10:09,160 --> 00:10:10,970
partition or shard the data and the
other problem with adding was shorting

446
00:10:10,970 --> 00:10:10,980
other problem with adding was shorting
 

447
00:10:10,980 --> 00:10:13,050
other problem with adding was shorting
adding lots and lots of my sequel

448
00:10:13,050 --> 00:10:13,060
adding lots and lots of my sequel
 

449
00:10:13,060 --> 00:10:17,000
adding lots and lots of my sequel
database servers for sharding is that

450
00:10:17,000 --> 00:10:17,010
database servers for sharding is that
 

451
00:10:17,010 --> 00:10:20,070
database servers for sharding is that
it's really an expensive way to go as it

452
00:10:20,070 --> 00:10:20,080
it's really an expensive way to go as it
 

453
00:10:20,080 --> 00:10:21,630
it's really an expensive way to go as it
turns out and after a point you're gonna

454
00:10:21,630 --> 00:10:21,640
turns out and after a point you're gonna
 

455
00:10:21,640 --> 00:10:23,430
turns out and after a point you're gonna
you're going to start to think that well

456
00:10:23,430 --> 00:10:23,440
you're going to start to think that well
 

457
00:10:23,440 --> 00:10:25,050
you're going to start to think that well
instead of spending a lot of money to

458
00:10:25,050 --> 00:10:25,060
instead of spending a lot of money to
 

459
00:10:25,060 --> 00:10:27,750
instead of spending a lot of money to
add another database server running my

460
00:10:27,750 --> 00:10:27,760
add another database server running my
 

461
00:10:27,760 --> 00:10:30,870
add another database server running my
sequel I could take the same server run

462
00:10:30,870 --> 00:10:30,880
sequel I could take the same server run
 

463
00:10:30,880 --> 00:10:32,910
sequel I could take the same server run
something much faster on it like as it

464
00:10:32,910 --> 00:10:32,920
something much faster on it like as it
 

465
00:10:32,920 --> 00:10:35,460
something much faster on it like as it
happens memcache D and get a lot more

466
00:10:35,460 --> 00:10:35,470
happens memcache D and get a lot more
 

467
00:10:35,470 --> 00:10:37,410
happens memcache D and get a lot more
reads per second out of the same

468
00:10:37,410 --> 00:10:37,420
reads per second out of the same
 

469
00:10:37,420 --> 00:10:40,080
reads per second out of the same
Hardware using caching than using

470
00:10:40,080 --> 00:10:40,090
Hardware using caching than using
 

471
00:10:40,090 --> 00:10:45,630
Hardware using caching than using
databases so the next architecture and

472
00:10:45,630 --> 00:10:45,640
databases so the next architecture and
 

473
00:10:45,640 --> 00:10:48,270
databases so the next architecture and
this is now starting to resemble what

474
00:10:48,270 --> 00:10:48,280
this is now starting to resemble what
 

475
00:10:48,280 --> 00:10:51,930
this is now starting to resemble what
Facebook is using the next architecture

476
00:10:51,930 --> 00:10:51,940
Facebook is using the next architecture
 

477
00:10:51,940 --> 00:10:56,670
Facebook is using the next architecture
still need users we still have a bunch

478
00:10:56,670 --> 00:10:56,680
still need users we still have a bunch
 

479
00:10:56,680 --> 00:10:59,940
still need users we still have a bunch
of front end servers running web servers

480
00:10:59,940 --> 00:10:59,950
of front end servers running web servers
 

481
00:10:59,950 --> 00:11:03,450
of front end servers running web servers
in PHP and by now maybe a vast number of

482
00:11:03,450 --> 00:11:03,460
in PHP and by now maybe a vast number of
 

483
00:11:03,460 --> 00:11:05,100
in PHP and by now maybe a vast number of
front end servers we still have our

484
00:11:05,100 --> 00:11:05,110
front end servers we still have our
 

485
00:11:05,110 --> 00:11:06,630
front end servers we still have our
database servers because you know we

486
00:11:06,630 --> 00:11:06,640
database servers because you know we
 

487
00:11:06,640 --> 00:11:11,010
database servers because you know we
need us a system that will store data

488
00:11:11,010 --> 00:11:11,020
need us a system that will store data
 

489
00:11:11,020 --> 00:11:13,530
need us a system that will store data
safely on disk for us and we'll provide

490
00:11:13,530 --> 00:11:13,540
safely on disk for us and we'll provide
 

491
00:11:13,540 --> 00:11:17,850
safely on disk for us and we'll provide
things like transactions for us and so

492
00:11:17,850 --> 00:11:17,860
things like transactions for us and so
 

493
00:11:17,860 --> 00:11:19,290
things like transactions for us and so
you know probably want a database for

494
00:11:19,290 --> 00:11:19,300
you know probably want a database for
 

495
00:11:19,300 --> 00:11:21,930
you know probably want a database for
that but in between we're gonna have a

496
00:11:21,930 --> 00:11:21,940
that but in between we're gonna have a
 

497
00:11:21,940 --> 00:11:23,700
that but in between we're gonna have a
caching layer that's this is where

498
00:11:23,700 --> 00:11:23,710
caching layer that's this is where
 

499
00:11:23,710 --> 00:11:26,150
caching layer that's this is where
memcache D comes in

500
00:11:26,150 --> 00:11:26,160
memcache D comes in
 

501
00:11:26,160 --> 00:11:27,949
memcache D comes in
and of course there's other things you

502
00:11:27,949 --> 00:11:27,959
and of course there's other things you
 

503
00:11:27,959 --> 00:11:29,930
and of course there's other things you
could use that the memcache but memcache

504
00:11:29,930 --> 00:11:29,940
could use that the memcache but memcache
 

505
00:11:29,940 --> 00:11:31,639
could use that the memcache but memcache
D happens to be an extremely popular

506
00:11:31,639 --> 00:11:31,649
D happens to be an extremely popular
 

507
00:11:31,649 --> 00:11:34,220
D happens to be an extremely popular
caching scheme the idea now is you have

508
00:11:34,220 --> 00:11:34,230
caching scheme the idea now is you have
 

509
00:11:34,230 --> 00:11:36,949
caching scheme the idea now is you have
a whole bunch of these memcache servers

510
00:11:36,949 --> 00:11:36,959
a whole bunch of these memcache servers
 

511
00:11:36,959 --> 00:11:41,749
a whole bunch of these memcache servers
and when a front-end needs to read some

512
00:11:41,749 --> 00:11:41,759
and when a front-end needs to read some
 

513
00:11:41,759 --> 00:11:45,980
and when a front-end needs to read some
data the first thing it does is ask one

514
00:11:45,980 --> 00:11:45,990
data the first thing it does is ask one
 

515
00:11:45,990 --> 00:11:47,840
data the first thing it does is ask one
of the memcache servers look do you have

516
00:11:47,840 --> 00:11:47,850
of the memcache servers look do you have
 

517
00:11:47,850 --> 00:11:48,829
of the memcache servers look do you have
the data I need

518
00:11:48,829 --> 00:11:48,839
the data I need
 

519
00:11:48,839 --> 00:11:50,809
the data I need
so it'll send a get request with some

520
00:11:50,809 --> 00:11:50,819
so it'll send a get request with some
 

521
00:11:50,819 --> 00:11:54,800
so it'll send a get request with some
key to one of the memcache servers and

522
00:11:54,800 --> 00:11:54,810
key to one of the memcache servers and
 

523
00:11:54,810 --> 00:11:56,269
key to one of the memcache servers and
the memcache server will check it's got

524
00:11:56,269 --> 00:11:56,279
the memcache server will check it's got
 

525
00:11:56,279 --> 00:11:58,129
the memcache server will check it's got
just a table in memory it's in fact

526
00:11:58,129 --> 00:11:58,139
just a table in memory it's in fact
 

527
00:11:58,139 --> 00:12:00,679
just a table in memory it's in fact
memcache is extremely simple it's far

528
00:12:00,679 --> 00:12:00,689
memcache is extremely simple it's far
 

529
00:12:00,689 --> 00:12:04,879
memcache is extremely simple it's far
far simpler than your lab 3 for example

530
00:12:04,879 --> 00:12:04,889
far simpler than your lab 3 for example
 

531
00:12:04,889 --> 00:12:07,519
far simpler than your lab 3 for example
it just has just as a big hash table on

532
00:12:07,519 --> 00:12:07,529
it just has just as a big hash table on
 

533
00:12:07,529 --> 00:12:08,990
it just has just as a big hash table on
memory it checks with that keys in the

534
00:12:08,990 --> 00:12:09,000
memory it checks with that keys in the
 

535
00:12:09,000 --> 00:12:11,030
memory it checks with that keys in the
hash table if it is it sends back the

536
00:12:11,030 --> 00:12:11,040
hash table if it is it sends back the
 

537
00:12:11,040 --> 00:12:12,499
hash table if it is it sends back the
data saying oh yeah here's the value

538
00:12:12,499 --> 00:12:12,509
data saying oh yeah here's the value
 

539
00:12:12,509 --> 00:12:15,170
data saying oh yeah here's the value
I've cashed for that and if we if the

540
00:12:15,170 --> 00:12:15,180
I've cashed for that and if we if the
 

541
00:12:15,180 --> 00:12:16,460
I've cashed for that and if we if the
front end hits in this memcache server

542
00:12:16,460 --> 00:12:16,470
front end hits in this memcache server
 

543
00:12:16,470 --> 00:12:19,309
front end hits in this memcache server
great I can then produce the webpage

544
00:12:19,309 --> 00:12:19,319
great I can then produce the webpage
 

545
00:12:19,319 --> 00:12:21,379
great I can then produce the webpage
with that data in it if it misses in the

546
00:12:21,379 --> 00:12:21,389
with that data in it if it misses in the
 

547
00:12:21,389 --> 00:12:23,829
with that data in it if it misses in the
webserver though the front-end has to

548
00:12:23,829 --> 00:12:23,839
webserver though the front-end has to
 

549
00:12:23,839 --> 00:12:27,559
webserver though the front-end has to
then rear equesticle irrelevant database

550
00:12:27,559 --> 00:12:27,569
then rear equesticle irrelevant database
 

551
00:12:27,569 --> 00:12:30,679
then rear equesticle irrelevant database
server and the database server will say

552
00:12:30,679 --> 00:12:30,689
server and the database server will say
 

553
00:12:30,689 --> 00:12:33,019
server and the database server will say
oh you know here's the here's the data

554
00:12:33,019 --> 00:12:33,029
oh you know here's the here's the data
 

555
00:12:33,029 --> 00:12:36,769
oh you know here's the here's the data
you need and at that point in order to

556
00:12:36,769 --> 00:12:36,779
you need and at that point in order to
 

557
00:12:36,779 --> 00:12:38,990
you need and at that point in order to
cash it in for the next front-end that

558
00:12:38,990 --> 00:12:39,000
cash it in for the next front-end that
 

559
00:12:39,000 --> 00:12:42,530
cash it in for the next front-end that
needs it the front end we'll send a put

560
00:12:42,530 --> 00:12:42,540
needs it the front end we'll send a put
 

561
00:12:42,540 --> 00:12:44,660
needs it the front end we'll send a put
with the data it fashion the database

562
00:12:44,660 --> 00:12:44,670
with the data it fashion the database
 

563
00:12:44,670 --> 00:12:48,290
with the data it fashion the database
into that memcache server and because

564
00:12:48,290 --> 00:12:48,300
into that memcache server and because
 

565
00:12:48,300 --> 00:12:50,840
into that memcache server and because
memcache runs at least 10 and maybe

566
00:12:50,840 --> 00:12:50,850
memcache runs at least 10 and maybe
 

567
00:12:50,850 --> 00:12:52,730
memcache runs at least 10 and maybe
maybe more than 10 times faster for

568
00:12:52,730 --> 00:12:52,740
maybe more than 10 times faster for
 

569
00:12:52,740 --> 00:12:55,790
maybe more than 10 times faster for
weeds than the database for a given

570
00:12:55,790 --> 00:12:55,800
weeds than the database for a given
 

571
00:12:55,800 --> 00:12:58,069
weeds than the database for a given
amount of hardware it really pays off to

572
00:12:58,069 --> 00:12:58,079
amount of hardware it really pays off to
 

573
00:12:58,079 --> 00:12:59,809
amount of hardware it really pays off to
use a fair amount some of that hardware

574
00:12:59,809 --> 00:12:59,819
use a fair amount some of that hardware
 

575
00:12:59,819 --> 00:13:02,179
use a fair amount some of that hardware
for memcache as well as for the database

576
00:13:02,179 --> 00:13:02,189
for memcache as well as for the database
 

577
00:13:02,189 --> 00:13:05,030
for memcache as well as for the database
servers so people people use this

578
00:13:05,030 --> 00:13:05,040
servers so people people use this
 

579
00:13:05,040 --> 00:13:06,410
servers so people people use this
arrangement a lot and it just saves them

580
00:13:06,410 --> 00:13:06,420
arrangement a lot and it just saves them
 

581
00:13:06,420 --> 00:13:09,199
arrangement a lot and it just saves them
money because memcache is so much faster

582
00:13:09,199 --> 00:13:09,209
money because memcache is so much faster
 

583
00:13:09,209 --> 00:13:12,019
money because memcache is so much faster
for weeds than a database server still

584
00:13:12,019 --> 00:13:12,029
for weeds than a database server still
 

585
00:13:12,029 --> 00:13:13,400
for weeds than a database server still
need to send writes to the database

586
00:13:13,400 --> 00:13:13,410
need to send writes to the database
 

587
00:13:13,410 --> 00:13:15,980
need to send writes to the database
because you want right to an updates to

588
00:13:15,980 --> 00:13:15,990
because you want right to an updates to
 

589
00:13:15,990 --> 00:13:20,629
because you want right to an updates to
be stored durably on the database as

590
00:13:20,629 --> 00:13:20,639
be stored durably on the database as
 

591
00:13:20,639 --> 00:13:22,369
be stored durably on the database as
this can still be there if there's a

592
00:13:22,369 --> 00:13:22,379
this can still be there if there's a
 

593
00:13:22,379 --> 00:13:26,299
this can still be there if there's a
crash or something but you can send the

594
00:13:26,299 --> 00:13:26,309
crash or something but you can send the
 

595
00:13:26,309 --> 00:13:28,009
crash or something but you can send the
Reese to the cache very much more

596
00:13:28,009 --> 00:13:28,019
Reese to the cache very much more
 

597
00:13:28,019 --> 00:13:30,590
Reese to the cache very much more
quickly ok so we have a question the

598
00:13:30,590 --> 00:13:30,600
quickly ok so we have a question the
 

599
00:13:30,600 --> 00:13:32,629
quickly ok so we have a question the
question is why wouldn't the memcache

600
00:13:32,629 --> 00:13:32,639
question is why wouldn't the memcache
 

601
00:13:32,639 --> 00:13:34,579
question is why wouldn't the memcache
server actually hit the put on behalf of

602
00:13:34,579 --> 00:13:34,589
server actually hit the put on behalf of
 

603
00:13:34,589 --> 00:13:36,319
server actually hit the put on behalf of
the front-end and cache the response

604
00:13:36,319 --> 00:13:36,329
the front-end and cache the response
 

605
00:13:36,329 --> 00:13:37,939
the front-end and cache the response
before responding the front-end so

606
00:13:37,939 --> 00:13:37,949
before responding the front-end so
 

607
00:13:37,949 --> 00:13:39,199
before responding the front-end so
that's a great question

608
00:13:39,199 --> 00:13:39,209
that's a great question
 

609
00:13:39,209 --> 00:13:41,090
that's a great question
you could imagine a caching layer that

610
00:13:41,090 --> 00:13:41,100
you could imagine a caching layer that
 

611
00:13:41,100 --> 00:13:43,429
you could imagine a caching layer that
you would send a get to it and it would

612
00:13:43,429 --> 00:13:43,439
you would send a get to it and it would
 

613
00:13:43,439 --> 00:13:45,439
you would send a get to it and it would
if it missed the memcache layer would

614
00:13:45,439 --> 00:13:45,449
if it missed the memcache layer would
 

615
00:13:45,449 --> 00:13:48,559
if it missed the memcache layer would
would forward the request to the

616
00:13:48,559 --> 00:13:48,569
would forward the request to the
 

617
00:13:48,569 --> 00:13:50,660
would forward the request to the
database babies respond the memcache

618
00:13:50,660 --> 00:13:50,670
database babies respond the memcache
 

619
00:13:50,670 --> 00:13:52,689
database babies respond the memcache
memcache would add the data to its

620
00:13:52,689 --> 00:13:52,699
memcache would add the data to its
 

621
00:13:52,699 --> 00:13:55,670
memcache would add the data to its
tables and then respond and the reason

622
00:13:55,670 --> 00:13:55,680
tables and then respond and the reason
 

623
00:13:55,680 --> 00:13:59,329
tables and then respond and the reason
for this is that memcache is like a

624
00:13:59,329 --> 00:13:59,339
for this is that memcache is like a
 

625
00:13:59,339 --> 00:14:00,710
for this is that memcache is like a
completely separate piece of software

626
00:14:00,710 --> 00:14:00,720
completely separate piece of software
 

627
00:14:00,720 --> 00:14:02,870
completely separate piece of software
that it doesn't know anything about

628
00:14:02,870 --> 00:14:02,880
that it doesn't know anything about
 

629
00:14:02,880 --> 00:14:04,579
that it doesn't know anything about
databases and it's actually not even

630
00:14:04,579 --> 00:14:04,589
databases and it's actually not even
 

631
00:14:04,589 --> 00:14:06,499
databases and it's actually not even
necessarily used and combined in

632
00:14:06,499 --> 00:14:06,509
necessarily used and combined in
 

633
00:14:06,509 --> 00:14:08,809
necessarily used and combined in
conjunction with the database although

634
00:14:08,809 --> 00:14:08,819
conjunction with the database although
 

635
00:14:08,819 --> 00:14:12,230
conjunction with the database although
it often is so we can't bake in

636
00:14:12,230 --> 00:14:12,240
it often is so we can't bake in
 

637
00:14:12,240 --> 00:14:14,710
it often is so we can't bake in
knowledge of the database into memcache

638
00:14:14,710 --> 00:14:14,720
knowledge of the database into memcache
 

639
00:14:14,720 --> 00:14:18,470
knowledge of the database into memcache
and sort of deeper reason is that the

640
00:14:18,470 --> 00:14:18,480
and sort of deeper reason is that the
 

641
00:14:18,480 --> 00:14:22,370
and sort of deeper reason is that the
front ends are often not really storing

642
00:14:22,370 --> 00:14:22,380
front ends are often not really storing
 

643
00:14:22,380 --> 00:14:25,150
front ends are often not really storing
one for one database records in memcache

644
00:14:25,150 --> 00:14:25,160
one for one database records in memcache
 

645
00:14:25,160 --> 00:14:28,970
one for one database records in memcache
almost always or very frequently what's

646
00:14:28,970 --> 00:14:28,980
almost always or very frequently what's
 

647
00:14:28,980 --> 00:14:30,889
almost always or very frequently what's
going on is that the front-end will

648
00:14:30,889 --> 00:14:30,899
going on is that the front-end will
 

649
00:14:30,899 --> 00:14:32,780
going on is that the front-end will
issue some requests to the database and

650
00:14:32,780 --> 00:14:32,790
issue some requests to the database and
 

651
00:14:32,790 --> 00:14:35,179
issue some requests to the database and
then process the results somewhat you

652
00:14:35,179 --> 00:14:35,189
then process the results somewhat you
 

653
00:14:35,189 --> 00:14:37,490
then process the results somewhat you
know maybe take a few steps to turning

654
00:14:37,490 --> 00:14:37,500
know maybe take a few steps to turning
 

655
00:14:37,500 --> 00:14:42,939
know maybe take a few steps to turning
it into HTML or sort of collect together

656
00:14:42,939 --> 00:14:42,949
it into HTML or sort of collect together
 

657
00:14:42,949 --> 00:14:46,519
it into HTML or sort of collect together
you know results from multiple careers

658
00:14:46,519 --> 00:14:46,529
you know results from multiple careers
 

659
00:14:46,529 --> 00:14:47,900
you know results from multiple careers
on multiple rows in the database and

660
00:14:47,900 --> 00:14:47,910
on multiple rows in the database and
 

661
00:14:47,910 --> 00:14:49,850
on multiple rows in the database and
cached partially processed information

662
00:14:49,850 --> 00:14:49,860
cached partially processed information
 

663
00:14:49,860 --> 00:14:51,110
cached partially processed information
in memcache

664
00:14:51,110 --> 00:14:51,120
in memcache
 

665
00:14:51,120 --> 00:14:53,720
in memcache
just to save the next reader from having

666
00:14:53,720 --> 00:14:53,730
just to save the next reader from having
 

667
00:14:53,730 --> 00:14:56,269
just to save the next reader from having
to do the same processing and for that

668
00:14:56,269 --> 00:14:56,279
to do the same processing and for that
 

669
00:14:56,279 --> 00:14:59,809
to do the same processing and for that
reason memcache it doesn't really does

670
00:14:59,809 --> 00:14:59,819
reason memcache it doesn't really does
 

671
00:14:59,819 --> 00:15:01,400
reason memcache it doesn't really does
not understand the relationship between

672
00:15:01,400 --> 00:15:01,410
not understand the relationship between
 

673
00:15:01,410 --> 00:15:03,620
not understand the relationship between
what the friends would like to see see

674
00:15:03,620 --> 00:15:03,630
what the friends would like to see see
 

675
00:15:03,630 --> 00:15:06,079
what the friends would like to see see
cached and how did you ride that data

676
00:15:06,079 --> 00:15:06,089
cached and how did you ride that data
 

677
00:15:06,089 --> 00:15:07,340
cached and how did you ride that data
from the database that knowledge is

678
00:15:07,340 --> 00:15:07,350
from the database that knowledge is
 

679
00:15:07,350 --> 00:15:09,470
from the database that knowledge is
really only in the PHP code on the front

680
00:15:09,470 --> 00:15:09,480
really only in the PHP code on the front
 

681
00:15:09,480 --> 00:15:12,439
really only in the PHP code on the front
end so therefore even though we could be

682
00:15:12,439 --> 00:15:12,449
end so therefore even though we could be
 

683
00:15:12,449 --> 00:15:14,840
end so therefore even though we could be
architectural a good idea we can't have

684
00:15:14,840 --> 00:15:14,850
architectural a good idea we can't have
 

685
00:15:14,850 --> 00:15:17,919
architectural a good idea we can't have
this integration here sort of direct

686
00:15:17,919 --> 00:15:17,929
this integration here sort of direct
 

687
00:15:17,929 --> 00:15:20,269
this integration here sort of direct
contact between memcache and the

688
00:15:20,269 --> 00:15:20,279
contact between memcache and the
 

689
00:15:20,279 --> 00:15:22,819
contact between memcache and the
database although it might make the

690
00:15:22,819 --> 00:15:22,829
database although it might make the
 

691
00:15:22,829 --> 00:15:25,370
database although it might make the
cache consistency story much more

692
00:15:25,370 --> 00:15:25,380
cache consistency story much more
 

693
00:15:25,380 --> 00:15:27,860
cache consistency story much more
straightforward and yes

694
00:15:27,860 --> 00:15:27,870
straightforward and yes
 

695
00:15:27,870 --> 00:15:31,430
straightforward and yes
this is it's this and answer the next

696
00:15:31,430 --> 00:15:31,440
this is it's this and answer the next
 

697
00:15:31,440 --> 00:15:33,620
this is it's this and answer the next
question that is the difference between

698
00:15:33,620 --> 00:15:33,630
question that is the difference between
 

699
00:15:33,630 --> 00:15:37,090
question that is the difference between
a lookaside cash and a look through cash

700
00:15:37,090 --> 00:15:37,100
a lookaside cash and a look through cash
 

701
00:15:37,100 --> 00:15:40,010
a lookaside cash and a look through cash
the fact the lookaside business is that

702
00:15:40,010 --> 00:15:40,020
the fact the lookaside business is that
 

703
00:15:40,020 --> 00:15:42,140
the fact the lookaside business is that
the front end sort of looks asides to

704
00:15:42,140 --> 00:15:42,150
the front end sort of looks asides to
 

705
00:15:42,150 --> 00:15:44,270
the front end sort of looks asides to
the cash to see if the data is there and

706
00:15:44,270 --> 00:15:44,280
the cash to see if the data is there and
 

707
00:15:44,280 --> 00:15:45,920
the cash to see if the data is there and
if it's not it makes its own

708
00:15:45,920 --> 00:15:45,930
if it's not it makes its own
 

709
00:15:45,930 --> 00:15:48,080
if it's not it makes its own
arrangements for getting the deed on

710
00:15:48,080 --> 00:15:48,090
arrangements for getting the deed on
 

711
00:15:48,090 --> 00:15:50,990
arrangements for getting the deed on
amiss you know a look through cash my

712
00:15:50,990 --> 00:15:51,000
amiss you know a look through cash my
 

713
00:15:51,000 --> 00:15:53,150
amiss you know a look through cash my
forward request of the database and

714
00:15:53,150 --> 00:15:53,160
forward request of the database and
 

715
00:15:53,160 --> 00:15:57,260
forward request of the database and
directly and handle the response now

716
00:15:57,260 --> 00:15:57,270
directly and handle the response now
 

717
00:15:57,270 --> 00:15:59,690
directly and handle the response now
part of the reason for the popularity in

718
00:15:59,690 --> 00:15:59,700
part of the reason for the popularity in
 

719
00:15:59,700 --> 00:16:01,760
part of the reason for the popularity in
memcache is that it is it is a lookaside

720
00:16:01,760 --> 00:16:01,770
memcache is that it is it is a lookaside
 

721
00:16:01,770 --> 00:16:04,880
memcache is that it is it is a lookaside
cash that is completely neutral about

722
00:16:04,880 --> 00:16:04,890
cash that is completely neutral about
 

723
00:16:04,890 --> 00:16:07,160
cash that is completely neutral about
whether there's a database or what's in

724
00:16:07,160 --> 00:16:07,170
whether there's a database or what's in
 

725
00:16:07,170 --> 00:16:09,130
whether there's a database or what's in
the database or the relationship between

726
00:16:09,130 --> 00:16:09,140
the database or the relationship between
 

727
00:16:09,140 --> 00:16:11,510
the database or the relationship between
stuff in memcache and what's in the end

728
00:16:11,510 --> 00:16:11,520
stuff in memcache and what's in the end
 

729
00:16:11,520 --> 00:16:17,150
stuff in memcache and what's in the end
items in the database all right so this

730
00:16:17,150 --> 00:16:17,160
items in the database all right so this
 

731
00:16:17,160 --> 00:16:18,830
items in the database all right so this
is very popular arrangement very widely

732
00:16:18,830 --> 00:16:18,840
is very popular arrangement very widely
 

733
00:16:18,840 --> 00:16:21,530
is very popular arrangement very widely
used it's cost effective because

734
00:16:21,530 --> 00:16:21,540
used it's cost effective because
 

735
00:16:21,540 --> 00:16:23,300
used it's cost effective because
memcache is so much faster in the

736
00:16:23,300 --> 00:16:23,310
memcache is so much faster in the
 

737
00:16:23,310 --> 00:16:27,170
memcache is so much faster in the
database it's a bit complex every

738
00:16:27,170 --> 00:16:27,180
database it's a bit complex every
 

739
00:16:27,180 --> 00:16:29,360
database it's a bit complex every
website that makes serious you so this

740
00:16:29,360 --> 00:16:29,370
website that makes serious you so this
 

741
00:16:29,370 --> 00:16:33,140
website that makes serious you so this
faces the problem that if you don't do

742
00:16:33,140 --> 00:16:33,150
faces the problem that if you don't do
 

743
00:16:33,150 --> 00:16:35,180
faces the problem that if you don't do
something the data that's stored in the

744
00:16:35,180 --> 00:16:35,190
something the data that's stored in the
 

745
00:16:35,190 --> 00:16:37,520
something the data that's stored in the
caches will get out of sync with the

746
00:16:37,520 --> 00:16:37,530
caches will get out of sync with the
 

747
00:16:37,530 --> 00:16:40,040
caches will get out of sync with the
data in the database and so everybody

748
00:16:40,040 --> 00:16:40,050
data in the database and so everybody
 

749
00:16:40,050 --> 00:16:42,590
data in the database and so everybody
has to have a story for how to make sure

750
00:16:42,590 --> 00:16:42,600
has to have a story for how to make sure
 

751
00:16:42,600 --> 00:16:43,790
has to have a story for how to make sure
that when you modify something in the

752
00:16:43,790 --> 00:16:43,800
that when you modify something in the
 

753
00:16:43,800 --> 00:16:48,700
that when you modify something in the
database you do something to memcache to

754
00:16:48,700 --> 00:16:48,710
database you do something to memcache to
 

755
00:16:48,710 --> 00:16:50,630
database you do something to memcache to
you know take care of the fact that

756
00:16:50,630 --> 00:16:50,640
you know take care of the fact that
 

757
00:16:50,640 --> 00:16:52,550
you know take care of the fact that
memcache may then be storing stale data

758
00:16:52,550 --> 00:16:52,560
memcache may then be storing stale data
 

759
00:16:52,560 --> 00:16:54,740
memcache may then be storing stale data
that doesn't reflect the updates and a

760
00:16:54,740 --> 00:16:54,750
that doesn't reflect the updates and a
 

761
00:16:54,750 --> 00:16:56,780
that doesn't reflect the updates and a
lot of this papers about what Facebook

762
00:16:56,780 --> 00:16:56,790
lot of this papers about what Facebook
 

763
00:16:56,790 --> 00:16:58,610
lot of this papers about what Facebook
story is for that although other people

764
00:16:58,610 --> 00:16:58,620
story is for that although other people
 

765
00:16:58,620 --> 00:17:05,020
story is for that although other people
had other plans this arrangements also

766
00:17:05,020 --> 00:17:05,030
had other plans this arrangements also
 

767
00:17:05,030 --> 00:17:08,030
had other plans this arrangements also
potentially a bit fragile it allows you

768
00:17:08,030 --> 00:17:08,040
potentially a bit fragile it allows you
 

769
00:17:08,040 --> 00:17:11,960
potentially a bit fragile it allows you
to scale up to far more users then you

770
00:17:11,960 --> 00:17:11,970
to scale up to far more users then you
 

771
00:17:11,970 --> 00:17:13,430
to scale up to far more users then you
could have gone with databases alone

772
00:17:13,430 --> 00:17:13,440
could have gone with databases alone
 

773
00:17:13,440 --> 00:17:15,650
could have gone with databases alone
because memcache is so fast but what

774
00:17:15,650 --> 00:17:15,660
because memcache is so fast but what
 

775
00:17:15,660 --> 00:17:17,690
because memcache is so fast but what
that means is that you're gonna end up

776
00:17:17,690 --> 00:17:17,700
that means is that you're gonna end up
 

777
00:17:17,700 --> 00:17:20,170
that means is that you're gonna end up
with the system that's sustaining a load

778
00:17:20,170 --> 00:17:20,180
with the system that's sustaining a load
 

779
00:17:20,180 --> 00:17:24,050
with the system that's sustaining a load
that's far far higher you know orders of

780
00:17:24,050 --> 00:17:24,060
that's far far higher you know orders of
 

781
00:17:24,060 --> 00:17:25,820
that's far far higher you know orders of
magnitude higher than what the databases

782
00:17:25,820 --> 00:17:25,830
magnitude higher than what the databases
 

783
00:17:25,830 --> 00:17:29,330
magnitude higher than what the databases
could handle and thus if anything goes

784
00:17:29,330 --> 00:17:29,340
could handle and thus if anything goes
 

785
00:17:29,340 --> 00:17:30,980
could handle and thus if anything goes
wrong for example if one of your

786
00:17:30,980 --> 00:17:30,990
wrong for example if one of your
 

787
00:17:30,990 --> 00:17:34,240
wrong for example if one of your
memcache servers were to fail and

788
00:17:34,240 --> 00:17:34,250
memcache servers were to fail and
 

789
00:17:34,250 --> 00:17:36,200
memcache servers were to fail and
meaning that the front ends would now

790
00:17:36,200 --> 00:17:36,210
meaning that the front ends would now
 

791
00:17:36,210 --> 00:17:37,700
meaning that the front ends would now
have to contact the database because

792
00:17:37,700 --> 00:17:37,710
have to contact the database because
 

793
00:17:37,710 --> 00:17:40,070
have to contact the database because
they didn't hit they couldn't use this

794
00:17:40,070 --> 00:17:40,080
they didn't hit they couldn't use this
 

795
00:17:40,080 --> 00:17:41,210
they didn't hit they couldn't use this
to store data

796
00:17:41,210 --> 00:17:41,220
to store data
 

797
00:17:41,220 --> 00:17:42,620
to store data
you're gonna be increasing a load in the

798
00:17:42,620 --> 00:17:42,630
you're gonna be increasing a load in the
 

799
00:17:42,630 --> 00:17:45,440
you're gonna be increasing a load in the
databases dramatically right because

800
00:17:45,440 --> 00:17:45,450
databases dramatically right because
 

801
00:17:45,450 --> 00:17:47,110
databases dramatically right because
memcache do you know supposing it has a

802
00:17:47,110 --> 00:17:47,120
memcache do you know supposing it has a
 

803
00:17:47,120 --> 00:17:50,299
memcache do you know supposing it has a
you know hit rate of 99 percent or

804
00:17:50,299 --> 00:17:50,309
you know hit rate of 99 percent or
 

805
00:17:50,309 --> 00:17:53,210
you know hit rate of 99 percent or
whatever it happens to be you know

806
00:17:53,210 --> 00:17:53,220
whatever it happens to be you know
 

807
00:17:53,220 --> 00:17:55,039
whatever it happens to be you know
memcache is gonna be absorbing almost

808
00:17:55,039 --> 00:17:55,049
memcache is gonna be absorbing almost
 

809
00:17:55,049 --> 00:17:58,460
memcache is gonna be absorbing almost
all the reads the database backends only

810
00:17:58,460 --> 00:17:58,470
all the reads the database backends only
 

811
00:17:58,470 --> 00:18:00,440
all the reads the database backends only
going to be seeing a few percent of the

812
00:18:00,440 --> 00:18:00,450
going to be seeing a few percent of the
 

813
00:18:00,450 --> 00:18:04,520
going to be seeing a few percent of the
total reads so any failure here is gonna

814
00:18:04,520 --> 00:18:04,530
total reads so any failure here is gonna
 

815
00:18:04,530 --> 00:18:06,169
total reads so any failure here is gonna
increase that few percent of the reads

816
00:18:06,169 --> 00:18:06,179
increase that few percent of the reads
 

817
00:18:06,179 --> 00:18:07,940
increase that few percent of the reads
to maybe you know I don't know 50

818
00:18:07,940 --> 00:18:07,950
to maybe you know I don't know 50
 

819
00:18:07,950 --> 00:18:09,830
to maybe you know I don't know 50
percent of the reads or whatever which

820
00:18:09,830 --> 00:18:09,840
percent of the reads or whatever which
 

821
00:18:09,840 --> 00:18:11,659
percent of the reads or whatever which
is a huge huge order of magnitude

822
00:18:11,659 --> 00:18:11,669
is a huge huge order of magnitude
 

823
00:18:11,669 --> 00:18:16,310
is a huge huge order of magnitude
increase so as Facebook does once you've

824
00:18:16,310 --> 00:18:16,320
increase so as Facebook does once you've
 

825
00:18:16,320 --> 00:18:18,649
increase so as Facebook does once you've
got to rely on this caching layer you

826
00:18:18,649 --> 00:18:18,659
got to rely on this caching layer you
 

827
00:18:18,659 --> 00:18:24,289
got to rely on this caching layer you
need to be set up pretty serious

828
00:18:24,289 --> 00:18:24,299
need to be set up pretty serious
 

829
00:18:24,299 --> 00:18:26,419
need to be set up pretty serious
measures to make sure that you never

830
00:18:26,419 --> 00:18:26,429
measures to make sure that you never
 

831
00:18:26,429 --> 00:18:30,430
measures to make sure that you never
expose the database layer to the full

832
00:18:30,430 --> 00:18:30,440
expose the database layer to the full
 

833
00:18:30,440 --> 00:18:35,029
expose the database layer to the full
anything like the full load that the

834
00:18:35,029 --> 00:18:35,039
anything like the full load that the
 

835
00:18:35,039 --> 00:18:37,279
anything like the full load that the
caching layer is seeing and you know you

836
00:18:37,279 --> 00:18:37,289
caching layer is seeing and you know you
 

837
00:18:37,289 --> 00:18:40,070
caching layer is seeing and you know you
see in facebook they have quite a bit of

838
00:18:40,070 --> 00:18:40,080
see in facebook they have quite a bit of
 

839
00:18:40,080 --> 00:18:43,340
see in facebook they have quite a bit of
thought put into making sure the

840
00:18:43,340 --> 00:18:43,350
thought put into making sure the
 

841
00:18:43,350 --> 00:18:44,840
thought put into making sure the
databases don't ever see anything like

842
00:18:44,840 --> 00:18:44,850
databases don't ever see anything like
 

843
00:18:44,850 --> 00:18:48,850
databases don't ever see anything like
the full load okay

844
00:18:48,850 --> 00:18:48,860
the full load okay
 

845
00:18:48,860 --> 00:18:54,049
the full load okay
so far this is generic now I want to

846
00:18:54,049 --> 00:18:54,059
so far this is generic now I want to
 

847
00:18:54,059 --> 00:18:58,220
so far this is generic now I want to
sort of switch to a big picture of what

848
00:18:58,220 --> 00:18:58,230
sort of switch to a big picture of what
 

849
00:18:58,230 --> 00:19:00,590
sort of switch to a big picture of what
Facebook describes in the paper for

850
00:19:00,590 --> 00:19:00,600
Facebook describes in the paper for
 

851
00:19:00,600 --> 00:19:04,010
Facebook describes in the paper for
their overall architecture of course

852
00:19:04,010 --> 00:19:04,020
their overall architecture of course
 

853
00:19:04,020 --> 00:19:05,960
their overall architecture of course
they have lots of users every user as a

854
00:19:05,960 --> 00:19:05,970
they have lots of users every user as a
 

855
00:19:05,970 --> 00:19:08,630
they have lots of users every user as a
friendless and status and posts and

856
00:19:08,630 --> 00:19:08,640
friendless and status and posts and
 

857
00:19:08,640 --> 00:19:13,820
friendless and status and posts and
likes and photos but Facebook's very

858
00:19:13,820 --> 00:19:13,830
likes and photos but Facebook's very
 

859
00:19:13,830 --> 00:19:16,640
likes and photos but Facebook's very
easy or e nted towards showing data to

860
00:19:16,640 --> 00:19:16,650
easy or e nted towards showing data to
 

861
00:19:16,650 --> 00:19:21,380
easy or e nted towards showing data to
users and a super important aspect of

862
00:19:21,380 --> 00:19:21,390
users and a super important aspect of
 

863
00:19:21,390 --> 00:19:24,730
users and a super important aspect of
that is that fresh data is not

864
00:19:24,730 --> 00:19:24,740
that is that fresh data is not
 

865
00:19:24,740 --> 00:19:26,899
that is that fresh data is not
absolutely necessary in that

866
00:19:26,899 --> 00:19:26,909
absolutely necessary in that
 

867
00:19:26,909 --> 00:19:31,250
absolutely necessary in that
circumstance you know suppose the reads

868
00:19:31,250 --> 00:19:31,260
circumstance you know suppose the reads
 

869
00:19:31,260 --> 00:19:34,159
circumstance you know suppose the reads
are you know due to caching supposed to

870
00:19:34,159 --> 00:19:34,169
are you know due to caching supposed to
 

871
00:19:34,169 --> 00:19:36,110
are you know due to caching supposed to
reads yield data that's a few seconds

872
00:19:36,110 --> 00:19:36,120
reads yield data that's a few seconds
 

873
00:19:36,120 --> 00:19:38,419
reads yield data that's a few seconds
out of date so you're showing your users

874
00:19:38,419 --> 00:19:38,429
out of date so you're showing your users
 

875
00:19:38,429 --> 00:19:40,100
out of date so you're showing your users
data not the very latest data but the

876
00:19:40,100 --> 00:19:40,110
data not the very latest data but the
 

877
00:19:40,110 --> 00:19:41,870
data not the very latest data but the
data from a few seconds ago you know

878
00:19:41,870 --> 00:19:41,880
data from a few seconds ago you know
 

879
00:19:41,880 --> 00:19:44,990
data from a few seconds ago you know
what the users are extremely unlikely to

880
00:19:44,990 --> 00:19:45,000
what the users are extremely unlikely to
 

881
00:19:45,000 --> 00:19:48,560
what the users are extremely unlikely to
notice except in special cases right if

882
00:19:48,560 --> 00:19:48,570
notice except in special cases right if
 

883
00:19:48,570 --> 00:19:50,149
notice except in special cases right if
I'm looking at a news feed of today's

884
00:19:50,149 --> 00:19:50,159
I'm looking at a news feed of today's
 

885
00:19:50,159 --> 00:19:53,299
I'm looking at a news feed of today's
you know today's news you know if I see

886
00:19:53,299 --> 00:19:53,309
you know today's news you know if I see
 

887
00:19:53,309 --> 00:19:54,409
you know today's news you know if I see
the news from a few

888
00:19:54,409 --> 00:19:54,419
the news from a few
 

889
00:19:54,419 --> 00:19:57,619
the news from a few
times ago versus the news from now a big

890
00:19:57,619 --> 00:19:57,629
times ago versus the news from now a big
 

891
00:19:57,629 --> 00:20:00,200
times ago versus the news from now a big
deal nobody's gonna notice nobody's

892
00:20:00,200 --> 00:20:00,210
deal nobody's gonna notice nobody's
 

893
00:20:00,210 --> 00:20:01,700
deal nobody's gonna notice nobody's
gonna complain you know that's not

894
00:20:01,700 --> 00:20:01,710
gonna complain you know that's not
 

895
00:20:01,710 --> 00:20:03,799
gonna complain you know that's not
always true for all data but for a lot a

896
00:20:03,799 --> 00:20:03,809
always true for all data but for a lot a
 

897
00:20:03,809 --> 00:20:05,419
always true for all data but for a lot a
lot of the data that they have to deal

898
00:20:05,419 --> 00:20:05,429
lot of the data that they have to deal
 

899
00:20:05,429 --> 00:20:07,580
lot of the data that they have to deal
with sort of super up-to-date

900
00:20:07,580 --> 00:20:07,590
with sort of super up-to-date
 

901
00:20:07,590 --> 00:20:08,960
with sort of super up-to-date
consistency in the sense of like

902
00:20:08,960 --> 00:20:08,970
consistency in the sense of like
 

903
00:20:08,970 --> 00:20:11,539
consistency in the sense of like
linearise ability is not actually

904
00:20:11,539 --> 00:20:11,549
linearise ability is not actually
 

905
00:20:11,549 --> 00:20:14,180
linearise ability is not actually
important what is important is that you

906
00:20:14,180 --> 00:20:14,190
important what is important is that you
 

907
00:20:14,190 --> 00:20:17,840
important what is important is that you
don't cache stale data indefinitely you

908
00:20:17,840 --> 00:20:17,850
don't cache stale data indefinitely you
 

909
00:20:17,850 --> 00:20:20,149
don't cache stale data indefinitely you
know what they can't do is by mistake

910
00:20:20,149 --> 00:20:20,159
know what they can't do is by mistake
 

911
00:20:20,159 --> 00:20:22,190
know what they can't do is by mistake
have some data that they're showing

912
00:20:22,190 --> 00:20:22,200
have some data that they're showing
 

913
00:20:22,200 --> 00:20:25,249
have some data that they're showing
users that's from yesterday or last week

914
00:20:25,249 --> 00:20:25,259
users that's from yesterday or last week
 

915
00:20:25,259 --> 00:20:28,580
users that's from yesterday or last week
or even an hour ago those users really

916
00:20:28,580 --> 00:20:28,590
or even an hour ago those users really
 

917
00:20:28,590 --> 00:20:32,210
or even an hour ago those users really
will start to notice that so they don't

918
00:20:32,210 --> 00:20:32,220
will start to notice that so they don't
 

919
00:20:32,220 --> 00:20:34,879
will start to notice that so they don't
care about consistency like

920
00:20:34,879 --> 00:20:34,889
care about consistency like
 

921
00:20:34,889 --> 00:20:36,710
care about consistency like
second-by-second but they care a lot

922
00:20:36,710 --> 00:20:36,720
second-by-second but they care a lot
 

923
00:20:36,720 --> 00:20:41,779
second-by-second but they care a lot
about not not being in cannot chewing

924
00:20:41,779 --> 00:20:41,789
about not not being in cannot chewing
 

925
00:20:41,789 --> 00:20:44,149
about not not being in cannot chewing
stale data from more than well more than

926
00:20:44,149 --> 00:20:44,159
stale data from more than well more than
 

927
00:20:44,159 --> 00:20:47,659
stale data from more than well more than
a little while ago the other situation

928
00:20:47,659 --> 00:20:47,669
a little while ago the other situation
 

929
00:20:47,669 --> 00:20:48,590
a little while ago the other situation
in which they need to provide

930
00:20:48,590 --> 00:20:48,600
in which they need to provide
 

931
00:20:48,600 --> 00:20:51,139
in which they need to provide
consistency is if a user updates their

932
00:20:51,139 --> 00:20:51,149
consistency is if a user updates their
 

933
00:20:51,149 --> 00:20:54,710
consistency is if a user updates their
own data or if a user updates almost any

934
00:20:54,710 --> 00:20:54,720
own data or if a user updates almost any
 

935
00:20:54,720 --> 00:20:56,960
own data or if a user updates almost any
data and then reads that same data that

936
00:20:56,960 --> 00:20:56,970
data and then reads that same data that
 

937
00:20:56,970 --> 00:20:59,239
data and then reads that same data that
the human knows that they just updated

938
00:20:59,239 --> 00:20:59,249
the human knows that they just updated
 

939
00:20:59,249 --> 00:21:02,479
the human knows that they just updated
it's extremely confusing for the user to

940
00:21:02,479 --> 00:21:02,489
it's extremely confusing for the user to
 

941
00:21:02,489 --> 00:21:04,489
it's extremely confusing for the user to
see stale data if they know they just

942
00:21:04,489 --> 00:21:04,499
see stale data if they know they just
 

943
00:21:04,499 --> 00:21:07,609
see stale data if they know they just
changed it and so in that specific case

944
00:21:07,609 --> 00:21:07,619
changed it and so in that specific case
 

945
00:21:07,619 --> 00:21:11,659
changed it and so in that specific case
the Facebook design is also careful to

946
00:21:11,659 --> 00:21:11,669
the Facebook design is also careful to
 

947
00:21:11,669 --> 00:21:14,539
the Facebook design is also careful to
make sure that if a user changes data

948
00:21:14,539 --> 00:21:14,549
make sure that if a user changes data
 

949
00:21:14,549 --> 00:21:19,210
make sure that if a user changes data
that that user will see the change data

950
00:21:19,210 --> 00:21:19,220

 

951
00:21:19,220 --> 00:21:23,509

ok so Facebook has multiple data centers

952
00:21:23,509 --> 00:21:23,519
ok so Facebook has multiple data centers
 

953
00:21:23,519 --> 00:21:27,889
ok so Facebook has multiple data centers
which they call regions and I think at

954
00:21:27,889 --> 00:21:27,899
which they call regions and I think at
 

955
00:21:27,899 --> 00:21:30,379
which they call regions and I think at
the time this paper was written they had

956
00:21:30,379 --> 00:21:30,389
the time this paper was written they had
 

957
00:21:30,389 --> 00:21:33,849
the time this paper was written they had
two regions their sort of primary region

958
00:21:33,849 --> 00:21:33,859
two regions their sort of primary region
 

959
00:21:33,859 --> 00:21:36,680
two regions their sort of primary region
was on the west coast California and

960
00:21:36,680 --> 00:21:36,690
was on the west coast California and
 

961
00:21:36,690 --> 00:21:40,099
was on the west coast California and
their sort of secondary region was in

962
00:21:40,099 --> 00:21:40,109
their sort of secondary region was in
 

963
00:21:40,109 --> 00:21:43,759
their sort of secondary region was in
the East Coast and the two data centers

964
00:21:43,759 --> 00:21:43,769
the East Coast and the two data centers
 

965
00:21:43,769 --> 00:21:51,470
the East Coast and the two data centers
look pretty similar you

966
00:21:51,470 --> 00:21:51,480
look pretty similar you
 

967
00:21:51,480 --> 00:21:52,880
look pretty similar you
set of database servers running my

968
00:21:52,880 --> 00:21:52,890
set of database servers running my
 

969
00:21:52,890 --> 00:21:56,510
set of database servers running my
sequel the sharted date over these my

970
00:21:56,510 --> 00:21:56,520
sequel the sharted date over these my
 

971
00:21:56,520 --> 00:21:59,810
sequel the sharted date over these my
sequel database servers

972
00:21:59,810 --> 00:21:59,820

 

973
00:21:59,820 --> 00:22:03,890

they had a bunch of memcache D servers

974
00:22:03,890 --> 00:22:03,900
they had a bunch of memcache D servers
 

975
00:22:03,900 --> 00:22:05,700
they had a bunch of memcache D servers
which we'll see they are actually

976
00:22:05,700 --> 00:22:05,710
which we'll see they are actually
 

977
00:22:05,710 --> 00:22:07,470
which we'll see they are actually
arranged in independent clusters and

978
00:22:07,470 --> 00:22:07,480
arranged in independent clusters and
 

979
00:22:07,480 --> 00:22:09,620
arranged in independent clusters and
then they had a bunch of front ends

980
00:22:09,620 --> 00:22:09,630
then they had a bunch of front ends
 

981
00:22:09,630 --> 00:22:15,150
then they had a bunch of front ends
again sort of a separate arrangement in

982
00:22:15,150 --> 00:22:15,160
again sort of a separate arrangement in
 

983
00:22:15,160 --> 00:22:20,220
again sort of a separate arrangement in
each data center and there's a couple

984
00:22:20,220 --> 00:22:20,230
each data center and there's a couple
 

985
00:22:20,230 --> 00:22:22,560
each data center and there's a couple
reasons for this one is that their

986
00:22:22,560 --> 00:22:22,570
reasons for this one is that their
 

987
00:22:22,570 --> 00:22:24,360
reasons for this one is that their
customers were scattered all over the

988
00:22:24,360 --> 00:22:24,370
customers were scattered all over the
 

989
00:22:24,370 --> 00:22:27,240
customers were scattered all over the
country and it's nice just for a

990
00:22:27,240 --> 00:22:27,250
country and it's nice just for a
 

991
00:22:27,250 --> 00:22:28,290
country and it's nice just for a
performance that people on the East

992
00:22:28,290 --> 00:22:28,300
performance that people on the East
 

993
00:22:28,300 --> 00:22:29,910
performance that people on the East
Coast can talk to a nearby data center

994
00:22:29,910 --> 00:22:29,920
Coast can talk to a nearby data center
 

995
00:22:29,920 --> 00:22:31,740
Coast can talk to a nearby data center
and people on the west coast can also

996
00:22:31,740 --> 00:22:31,750
and people on the west coast can also
 

997
00:22:31,750 --> 00:22:33,450
and people on the west coast can also
talk to a nearby deficit it just makes

998
00:22:33,450 --> 00:22:33,460
talk to a nearby deficit it just makes
 

999
00:22:33,460 --> 00:22:42,300
talk to a nearby deficit it just makes
internet delays less now the the data

1000
00:22:42,300 --> 00:22:42,310
internet delays less now the the data
 

1001
00:22:42,310 --> 00:22:44,490
internet delays less now the the data
centers were not symmetric each of them

1002
00:22:44,490 --> 00:22:44,500
centers were not symmetric each of them
 

1003
00:22:44,500 --> 00:22:45,990
centers were not symmetric each of them
held a complete copy of all the data

1004
00:22:45,990 --> 00:22:46,000
held a complete copy of all the data
 

1005
00:22:46,000 --> 00:22:47,910
held a complete copy of all the data
they didn't sort of shard the data

1006
00:22:47,910 --> 00:22:47,920
they didn't sort of shard the data
 

1007
00:22:47,920 --> 00:22:50,580
they didn't sort of shard the data
across the data centers so the West

1008
00:22:50,580 --> 00:22:50,590
across the data centers so the West
 

1009
00:22:50,590 --> 00:22:54,030
across the data centers so the West
Coast I think was a primary and it sort

1010
00:22:54,030 --> 00:22:54,040
Coast I think was a primary and it sort
 

1011
00:22:54,040 --> 00:22:55,920
Coast I think was a primary and it sort
of had the real copy of the data and the

1012
00:22:55,920 --> 00:22:55,930
of had the real copy of the data and the
 

1013
00:22:55,930 --> 00:23:00,360
of had the real copy of the data and the
East Coast was a secondary and what that

1014
00:23:00,360 --> 00:23:00,370
East Coast was a secondary and what that
 

1015
00:23:00,370 --> 00:23:01,920
East Coast was a secondary and what that
really means is that all rights had to

1016
00:23:01,920 --> 00:23:01,930
really means is that all rights had to
 

1017
00:23:01,930 --> 00:23:05,910
really means is that all rights had to
be sent to the relevant database and the

1018
00:23:05,910 --> 00:23:05,920
be sent to the relevant database and the
 

1019
00:23:05,920 --> 00:23:08,190
be sent to the relevant database and the
primary day to be Center so you know any

1020
00:23:08,190 --> 00:23:08,200
primary day to be Center so you know any
 

1021
00:23:08,200 --> 00:23:12,930
primary day to be Center so you know any
right gets sent you know here and they

1022
00:23:12,930 --> 00:23:12,940
right gets sent you know here and they
 

1023
00:23:12,940 --> 00:23:15,330
right gets sent you know here and they
use a feature of my sequel they serve

1024
00:23:15,330 --> 00:23:15,340
use a feature of my sequel they serve
 

1025
00:23:15,340 --> 00:23:17,250
use a feature of my sequel they serve
asynchronous log replication scheme to

1026
00:23:17,250 --> 00:23:17,260
asynchronous log replication scheme to
 

1027
00:23:17,260 --> 00:23:21,350
asynchronous log replication scheme to
have each database in the primary region

1028
00:23:21,350 --> 00:23:21,360
have each database in the primary region
 

1029
00:23:21,360 --> 00:23:24,270
have each database in the primary region
send every update to the corresponding

1030
00:23:24,270 --> 00:23:24,280
send every update to the corresponding
 

1031
00:23:24,280 --> 00:23:26,370
send every update to the corresponding
database in secondary region so that

1032
00:23:26,370 --> 00:23:26,380
database in secondary region so that
 

1033
00:23:26,380 --> 00:23:29,630
database in secondary region so that
with a lag of maybe even a few seconds

1034
00:23:29,630 --> 00:23:29,640
with a lag of maybe even a few seconds
 

1035
00:23:29,640 --> 00:23:31,710
with a lag of maybe even a few seconds
these database servers would have

1036
00:23:31,710 --> 00:23:31,720
these database servers would have
 

1037
00:23:31,720 --> 00:23:33,810
these database servers would have
identical content the secondary database

1038
00:23:33,810 --> 00:23:33,820
identical content the secondary database
 

1039
00:23:33,820 --> 00:23:35,700
identical content the secondary database
servers would have identical content to

1040
00:23:35,700 --> 00:23:35,710
servers would have identical content to
 

1041
00:23:35,710 --> 00:23:38,130
servers would have identical content to
the primaries reads though we're local

1042
00:23:38,130 --> 00:23:38,140
the primaries reads though we're local
 

1043
00:23:38,140 --> 00:23:39,420
the primaries reads though we're local
so these front ends when they need to

1044
00:23:39,420 --> 00:23:39,430
so these front ends when they need to
 

1045
00:23:39,430 --> 00:23:41,880
so these front ends when they need to
find some data I'm in general would talk

1046
00:23:41,880 --> 00:23:41,890
find some data I'm in general would talk
 

1047
00:23:41,890 --> 00:23:44,580
find some data I'm in general would talk
to memcache memcache in that data center

1048
00:23:44,580 --> 00:23:44,590
to memcache memcache in that data center
 

1049
00:23:44,590 --> 00:23:46,590
to memcache memcache in that data center
and if they missed in memcache they

1050
00:23:46,590 --> 00:23:46,600
and if they missed in memcache they
 

1051
00:23:46,600 --> 00:23:48,630
and if they missed in memcache they
talked to the they'd read from the

1052
00:23:48,630 --> 00:23:48,640
talked to the they'd read from the
 

1053
00:23:48,640 --> 00:23:52,070
talked to the they'd read from the
database in that same data data center

1054
00:23:52,070 --> 00:23:52,080
database in that same data data center
 

1055
00:23:52,080 --> 00:23:56,870
database in that same data data center
um again though the databases are

1056
00:23:56,870 --> 00:23:56,880
um again though the databases are
 

1057
00:23:56,880 --> 00:23:59,820
um again though the databases are
complete replicas all the data's on both

1058
00:23:59,820 --> 00:23:59,830
complete replicas all the data's on both
 

1059
00:23:59,830 --> 00:24:04,170
complete replicas all the data's on both
of these these in both of these regions

1060
00:24:04,170 --> 00:24:04,180

 

1061
00:24:04,180 --> 00:24:10,660

that's the overall picture the next

1062
00:24:10,660 --> 00:24:10,670
that's the overall picture the next
 

1063
00:24:10,670 --> 00:24:11,980
that's the overall picture the next
thing I want to talk about is a few

1064
00:24:11,980 --> 00:24:11,990
thing I want to talk about is a few
 

1065
00:24:11,990 --> 00:24:18,100
thing I want to talk about is a few
details about how they how they use you

1066
00:24:18,100 --> 00:24:18,110
details about how they how they use you
 

1067
00:24:18,110 --> 00:24:21,010
details about how they how they use you
know with this leukocyte caching

1068
00:24:21,010 --> 00:24:21,020
know with this leukocyte caching
 

1069
00:24:21,020 --> 00:24:25,030
know with this leukocyte caching
actually looks like so there's really

1070
00:24:25,030 --> 00:24:25,040
actually looks like so there's really
 

1071
00:24:25,040 --> 00:24:28,540
actually looks like so there's really
there's reads and writes and this is

1072
00:24:28,540 --> 00:24:28,550
there's reads and writes and this is
 

1073
00:24:28,550 --> 00:24:31,900
there's reads and writes and this is
just what's shown in Figure two for a

1074
00:24:31,900 --> 00:24:31,910
just what's shown in Figure two for a
 

1075
00:24:31,910 --> 00:24:33,630
just what's shown in Figure two for a
read

1076
00:24:33,630 --> 00:24:33,640
read
 

1077
00:24:33,640 --> 00:24:37,350
read
which is executing on a front-end the

1078
00:24:37,350 --> 00:24:37,360
which is executing on a front-end the
 

1079
00:24:37,360 --> 00:24:39,330
which is executing on a front-end the
first thing if you read any data that

1080
00:24:39,330 --> 00:24:39,340
first thing if you read any data that
 

1081
00:24:39,340 --> 00:24:40,860
first thing if you read any data that
might be cached the first thing that

1082
00:24:40,860 --> 00:24:40,870
might be cached the first thing that
 

1083
00:24:40,870 --> 00:24:43,410
might be cached the first thing that
code in the front-end does is makes this

1084
00:24:43,410 --> 00:24:43,420
code in the front-end does is makes this
 

1085
00:24:43,420 --> 00:24:46,050
code in the front-end does is makes this
get library call with the key of the

1086
00:24:46,050 --> 00:24:46,060
get library call with the key of the
 

1087
00:24:46,060 --> 00:24:48,360
get library call with the key of the
data they want and get just generates an

1088
00:24:48,360 --> 00:24:48,370
data they want and get just generates an
 

1089
00:24:48,370 --> 00:24:51,780
data they want and get just generates an
RPC to the relevant memcache server so

1090
00:24:51,780 --> 00:24:51,790
RPC to the relevant memcache server so
 

1091
00:24:51,790 --> 00:24:56,040
RPC to the relevant memcache server so
they hash this library routine hashes on

1092
00:24:56,040 --> 00:24:56,050
they hash this library routine hashes on
 

1093
00:24:56,050 --> 00:24:57,960
they hash this library routine hashes on
the client hashes the key to pick the

1094
00:24:57,960 --> 00:24:57,970
the client hashes the key to pick the
 

1095
00:24:57,970 --> 00:25:01,410
the client hashes the key to pick the
memcache server and sends an RPC to that

1096
00:25:01,410 --> 00:25:01,420
memcache server and sends an RPC to that
 

1097
00:25:01,420 --> 00:25:04,140
memcache server and sends an RPC to that
mcat server them casually reply yes

1098
00:25:04,140 --> 00:25:04,150
mcat server them casually reply yes
 

1099
00:25:04,150 --> 00:25:06,660
mcat server them casually reply yes
here's your data or or maybe it'll point

1100
00:25:06,660 --> 00:25:06,670
here's your data or or maybe it'll point
 

1101
00:25:06,670 --> 00:25:10,080
here's your data or or maybe it'll point
nil saying I don't have that data it's

1102
00:25:10,080 --> 00:25:10,090
nil saying I don't have that data it's
 

1103
00:25:10,090 --> 00:25:18,900
nil saying I don't have that data it's
not cached so if if V is nil then the

1104
00:25:18,900 --> 00:25:18,910
not cached so if if V is nil then the
 

1105
00:25:18,910 --> 00:25:22,590
not cached so if if V is nil then the
front-end will issue whatever sequel

1106
00:25:22,590 --> 00:25:22,600
front-end will issue whatever sequel
 

1107
00:25:22,600 --> 00:25:27,500
front-end will issue whatever sequel
query is required to fetch the data from

1108
00:25:27,500 --> 00:25:27,510
query is required to fetch the data from
 

1109
00:25:27,510 --> 00:25:32,670
query is required to fetch the data from
the database and then make another RPC

1110
00:25:32,670 --> 00:25:32,680
the database and then make another RPC
 

1111
00:25:32,680 --> 00:25:36,970
the database and then make another RPC
call

1112
00:25:36,970 --> 00:25:36,980

 

1113
00:25:36,980 --> 00:25:39,800

- memk2 the relevant memcache server to

1114
00:25:39,800 --> 00:25:39,810
- memk2 the relevant memcache server to
 

1115
00:25:39,810 --> 00:25:41,750
- memk2 the relevant memcache server to
install the fetch data in the memcache

1116
00:25:41,750 --> 00:25:41,760
install the fetch data in the memcache
 

1117
00:25:41,760 --> 00:25:44,060
install the fetch data in the memcache
server so this is just the routine I

1118
00:25:44,060 --> 00:25:44,070
server so this is just the routine I
 

1119
00:25:44,070 --> 00:25:45,670
server so this is just the routine I
talked through before

1120
00:25:45,670 --> 00:25:45,680
talked through before
 

1121
00:25:45,680 --> 00:25:48,650
talked through before
it's kind of what lookaside caching does

1122
00:25:48,650 --> 00:25:48,660
it's kind of what lookaside caching does
 

1123
00:25:48,660 --> 00:25:55,530
it's kind of what lookaside caching does
and for right

1124
00:25:55,530 --> 00:25:55,540

 

1125
00:25:55,540 --> 00:25:59,880

you know V is the writing we have a key

1126
00:25:59,880 --> 00:25:59,890
you know V is the writing we have a key
 

1127
00:25:59,890 --> 00:26:01,920
you know V is the writing we have a key
and a value no Rana right and so library

1128
00:26:01,920 --> 00:26:01,930
and a value no Rana right and so library
 

1129
00:26:01,930 --> 00:26:05,040
and a value no Rana right and so library
routine on an each front end we're gonna

1130
00:26:05,040 --> 00:26:05,050
routine on an each front end we're gonna
 

1131
00:26:05,050 --> 00:26:11,100
routine on an each front end we're gonna
send the the new data to the database

1132
00:26:11,100 --> 00:26:11,110
send the the new data to the database
 

1133
00:26:11,110 --> 00:26:15,000
send the the new data to the database
and you know I as I mentioned before the

1134
00:26:15,000 --> 00:26:15,010
and you know I as I mentioned before the
 

1135
00:26:15,010 --> 00:26:16,230
and you know I as I mentioned before the
Keene the value may be a little bit

1136
00:26:16,230 --> 00:26:16,240
Keene the value may be a little bit
 

1137
00:26:16,240 --> 00:26:17,670
Keene the value may be a little bit
different you know what's stored in the

1138
00:26:17,670 --> 00:26:17,680
different you know what's stored in the
 

1139
00:26:17,680 --> 00:26:19,560
different you know what's stored in the
database is often in a somewhat

1140
00:26:19,560 --> 00:26:19,570
database is often in a somewhat
 

1141
00:26:19,570 --> 00:26:21,290
database is often in a somewhat
different form from what's stored in

1142
00:26:21,290 --> 00:26:21,300
different form from what's stored in
 

1143
00:26:21,300 --> 00:26:23,670
different form from what's stored in
memcache see but we'll imagine for now

1144
00:26:23,670 --> 00:26:23,680
memcache see but we'll imagine for now
 

1145
00:26:23,680 --> 00:26:26,340
memcache see but we'll imagine for now
the same and once the database has the

1146
00:26:26,340 --> 00:26:26,350
the same and once the database has the
 

1147
00:26:26,350 --> 00:26:29,220
the same and once the database has the
new data then the right library routine

1148
00:26:29,220 --> 00:26:29,230
new data then the right library routine
 

1149
00:26:29,230 --> 00:26:34,470
new data then the right library routine
sends an RPC to memcache detailing it

1150
00:26:34,470 --> 00:26:34,480
sends an RPC to memcache detailing it
 

1151
00:26:34,480 --> 00:26:38,220
sends an RPC to memcache detailing it
look you got to delete this key so I

1152
00:26:38,220 --> 00:26:38,230
look you got to delete this key so I
 

1153
00:26:38,230 --> 00:26:41,850
look you got to delete this key so I
want to write the writer is invalidating

1154
00:26:41,850 --> 00:26:41,860
want to write the writer is invalidating
 

1155
00:26:41,860 --> 00:26:43,770
want to write the writer is invalidating
the key in memcache do you know what

1156
00:26:43,770 --> 00:26:43,780
the key in memcache do you know what
 

1157
00:26:43,780 --> 00:26:47,370
the key in memcache do you know what
that means is that the next front-end

1158
00:26:47,370 --> 00:26:47,380
that means is that the next front-end
 

1159
00:26:47,380 --> 00:26:48,990
that means is that the next front-end
that tries to read that key from

1160
00:26:48,990 --> 00:26:49,000
that tries to read that key from
 

1161
00:26:49,000 --> 00:26:52,170
that tries to read that key from
memcache D is gonna get nil back because

1162
00:26:52,170 --> 00:26:52,180
memcache D is gonna get nil back because
 

1163
00:26:52,180 --> 00:26:54,120
memcache D is gonna get nil back because
it's no longer cached and will fetch the

1164
00:26:54,120 --> 00:26:54,130
it's no longer cached and will fetch the
 

1165
00:26:54,130 --> 00:26:56,490
it's no longer cached and will fetch the
updated value from the database and

1166
00:26:56,490 --> 00:26:56,500
updated value from the database and
 

1167
00:26:56,500 --> 00:27:01,560
updated value from the database and
install it into memcache all right so

1168
00:27:01,560 --> 00:27:01,570
install it into memcache all right so
 

1169
00:27:01,570 --> 00:27:04,200
install it into memcache all right so
this is an invalidation in particular

1170
00:27:04,200 --> 00:27:04,210
this is an invalidation in particular
 

1171
00:27:04,210 --> 00:27:06,480
this is an invalidation in particular
it's not you could imagine a scheme that

1172
00:27:06,480 --> 00:27:06,490
it's not you could imagine a scheme that
 

1173
00:27:06,490 --> 00:27:08,610
it's not you could imagine a scheme that
would send the new data to memcache T at

1174
00:27:08,610 --> 00:27:08,620
would send the new data to memcache T at
 

1175
00:27:08,620 --> 00:27:09,990
would send the new data to memcache T at
this point but it doesn't actually do

1176
00:27:09,990 --> 00:27:10,000
this point but it doesn't actually do
 

1177
00:27:10,000 --> 00:27:13,170
this point but it doesn't actually do
that instead of gliese it and actually

1178
00:27:13,170 --> 00:27:13,180
that instead of gliese it and actually
 

1179
00:27:13,180 --> 00:27:17,820
that instead of gliese it and actually
in the context of facebook scheme the

1180
00:27:17,820 --> 00:27:17,830
in the context of facebook scheme the
 

1181
00:27:17,830 --> 00:27:21,630
in the context of facebook scheme the
real reason why this delete is needed is

1182
00:27:21,630 --> 00:27:21,640
real reason why this delete is needed is
 

1183
00:27:21,640 --> 00:27:24,320
real reason why this delete is needed is
so that

1184
00:27:24,320 --> 00:27:24,330
so that
 

1185
00:27:24,330 --> 00:27:26,930
so that
we'll see their own rights because in

1186
00:27:26,930 --> 00:27:26,940
we'll see their own rights because in
 

1187
00:27:26,940 --> 00:27:29,930
we'll see their own rights because in
fact in their scheme the mem cat the my

1188
00:27:29,930 --> 00:27:29,940
fact in their scheme the mem cat the my
 

1189
00:27:29,940 --> 00:27:32,480
fact in their scheme the mem cat the my
sequel server the database servers also

1190
00:27:32,480 --> 00:27:32,490
sequel server the database servers also
 

1191
00:27:32,490 --> 00:27:35,450
sequel server the database servers also
send deletes one of you and the front

1192
00:27:35,450 --> 00:27:35,460
send deletes one of you and the front
 

1193
00:27:35,460 --> 00:27:37,490
send deletes one of you and the front
end writes something in the database the

1194
00:27:37,490 --> 00:27:37,500
end writes something in the database the
 

1195
00:27:37,500 --> 00:27:39,799
end writes something in the database the
database with the mix squeal mechanism

1196
00:27:39,799 --> 00:27:39,809
database with the mix squeal mechanism
 

1197
00:27:39,809 --> 00:27:42,019
database with the mix squeal mechanism
the paper mentions well send the

1198
00:27:42,019 --> 00:27:42,029
the paper mentions well send the
 

1199
00:27:42,029 --> 00:27:44,720
the paper mentions well send the
relevant deletes to the memcache servers

1200
00:27:44,720 --> 00:27:44,730
relevant deletes to the memcache servers
 

1201
00:27:44,730 --> 00:27:47,149
relevant deletes to the memcache servers
that that might hold this key so the

1202
00:27:47,149 --> 00:27:47,159
that that might hold this key so the
 

1203
00:27:47,159 --> 00:27:49,340
that that might hold this key so the
data the database servers will actually

1204
00:27:49,340 --> 00:27:49,350
data the database servers will actually
 

1205
00:27:49,350 --> 00:27:51,500
data the database servers will actually
invalidate stuff in memcache by-and-bye

1206
00:27:51,500 --> 00:27:51,510
invalidate stuff in memcache by-and-bye
 

1207
00:27:51,510 --> 00:27:54,529
invalidate stuff in memcache by-and-bye
may take them a while um but because

1208
00:27:54,529 --> 00:27:54,539
may take them a while um but because
 

1209
00:27:54,539 --> 00:27:57,169
may take them a while um but because
that might take a while the front ends

1210
00:27:57,169 --> 00:27:57,179
that might take a while the front ends
 

1211
00:27:57,179 --> 00:27:58,970
that might take a while the front ends
also delete the key said that a front

1212
00:27:58,970 --> 00:27:58,980
also delete the key said that a front
 

1213
00:27:58,980 --> 00:28:04,639
also delete the key said that a front
end won't see a stale value for data

1214
00:28:04,639 --> 00:28:04,649
end won't see a stale value for data
 

1215
00:28:04,649 --> 00:28:16,580
end won't see a stale value for data
that it just updated okay

1216
00:28:16,580 --> 00:28:16,590

 

1217
00:28:16,590 --> 00:28:21,380

all sort of the background of this is

1218
00:28:21,380 --> 00:28:21,390
all sort of the background of this is
 

1219
00:28:21,390 --> 00:28:23,510
all sort of the background of this is
pretty much how everybody uses memcache

1220
00:28:23,510 --> 00:28:23,520
pretty much how everybody uses memcache
 

1221
00:28:23,520 --> 00:28:24,980
pretty much how everybody uses memcache
G there's nothing yet really very

1222
00:28:24,980 --> 00:28:24,990
G there's nothing yet really very
 

1223
00:28:24,990 --> 00:28:28,970
G there's nothing yet really very
special here now eventually you know the

1224
00:28:28,970 --> 00:28:28,980
special here now eventually you know the
 

1225
00:28:28,980 --> 00:28:31,340
special here now eventually you know the
paper is all about on the surface all

1226
00:28:31,340 --> 00:28:31,350
paper is all about on the surface all
 

1227
00:28:31,350 --> 00:28:34,010
paper is all about on the surface all
about solving consistency problems and

1228
00:28:34,010 --> 00:28:34,020
about solving consistency problems and
 

1229
00:28:34,020 --> 00:28:36,919
about solving consistency problems and
indeed those are important but the

1230
00:28:36,919 --> 00:28:36,929
indeed those are important but the
 

1231
00:28:36,929 --> 00:28:39,049
indeed those are important but the
reason why they got where they ran into

1232
00:28:39,049 --> 00:28:39,059
reason why they got where they ran into
 

1233
00:28:39,059 --> 00:28:41,690
reason why they got where they ran into
those consistency problems is in large

1234
00:28:41,690 --> 00:28:41,700
those consistency problems is in large
 

1235
00:28:41,700 --> 00:28:46,370
those consistency problems is in large
part because they you know modify the

1236
00:28:46,370 --> 00:28:46,380
part because they you know modify the
 

1237
00:28:46,380 --> 00:28:47,960
part because they you know modify the
design or set up a design that had

1238
00:28:47,960 --> 00:28:47,970
design or set up a design that had
 

1239
00:28:47,970 --> 00:28:49,279
design or set up a design that had
extremely high performance because they

1240
00:28:49,279 --> 00:28:49,289
extremely high performance because they
 

1241
00:28:49,289 --> 00:28:51,320
extremely high performance because they
had extremely high load and say they

1242
00:28:51,320 --> 00:28:51,330
had extremely high load and say they
 

1243
00:28:51,330 --> 00:28:54,019
had extremely high load and say they
were desperate to get performance and

1244
00:28:54,019 --> 00:28:54,029
were desperate to get performance and
 

1245
00:28:54,029 --> 00:28:56,899
were desperate to get performance and
kind of struggled along behind the

1246
00:28:56,899 --> 00:28:56,909
kind of struggled along behind the
 

1247
00:28:56,909 --> 00:28:59,830
kind of struggled along behind the
performance improvements in order to

1248
00:28:59,830 --> 00:28:59,840
performance improvements in order to
 

1249
00:28:59,840 --> 00:29:02,090
performance improvements in order to
retain a reasonable level of consistency

1250
00:29:02,090 --> 00:29:02,100
retain a reasonable level of consistency
 

1251
00:29:02,100 --> 00:29:04,100
retain a reasonable level of consistency
and because the performance kind of came

1252
00:29:04,100 --> 00:29:04,110
and because the performance kind of came
 

1253
00:29:04,110 --> 00:29:05,600
and because the performance kind of came
first for them I'm actually going to

1254
00:29:05,600 --> 00:29:05,610
first for them I'm actually going to
 

1255
00:29:05,610 --> 00:29:07,580
first for them I'm actually going to
talk about

1256
00:29:07,580 --> 00:29:07,590
talk about
 

1257
00:29:07,590 --> 00:29:10,519
talk about
their performance architecture before

1258
00:29:10,519 --> 00:29:10,529
their performance architecture before
 

1259
00:29:10,529 --> 00:29:14,200
their performance architecture before
talking about how they fix the

1260
00:29:14,200 --> 00:29:14,210
talking about how they fix the
 

1261
00:29:14,210 --> 00:29:18,590
talking about how they fix the
consistency okay sorry there's been a

1262
00:29:18,590 --> 00:29:18,600
consistency okay sorry there's been a
 

1263
00:29:18,600 --> 00:29:21,320
consistency okay sorry there's been a
bunch of questions here that I haven't

1264
00:29:21,320 --> 00:29:21,330
bunch of questions here that I haven't
 

1265
00:29:21,330 --> 00:29:28,549
bunch of questions here that I haven't
seen let me take a peek okay so one

1266
00:29:28,549 --> 00:29:28,559
seen let me take a peek okay so one
 

1267
00:29:28,559 --> 00:29:30,019
seen let me take a peek okay so one
question this means that the replicated

1268
00:29:30,019 --> 00:29:30,029
question this means that the replicated
 

1269
00:29:30,029 --> 00:29:32,480
question this means that the replicated
updates from the primary my sequel

1270
00:29:32,480 --> 00:29:32,490
updates from the primary my sequel
 

1271
00:29:32,490 --> 00:29:34,490
updates from the primary my sequel
database to the secondary must also

1272
00:29:34,490 --> 00:29:34,500
database to the secondary must also
 

1273
00:29:34,500 --> 00:29:39,200
database to the secondary must also
issue deletes - yeah so this is I think

1274
00:29:39,200 --> 00:29:39,210
issue deletes - yeah so this is I think
 

1275
00:29:39,210 --> 00:29:40,850
issue deletes - yeah so this is I think
a reference to the previous or

1276
00:29:40,850 --> 00:29:40,860
a reference to the previous or
 

1277
00:29:40,860 --> 00:29:43,220
a reference to the previous or
architecture slide the observation is

1278
00:29:43,220 --> 00:29:43,230
architecture slide the observation is
 

1279
00:29:43,230 --> 00:29:47,090
architecture slide the observation is
that yes indeed when a front-end sends a

1280
00:29:47,090 --> 00:29:47,100
that yes indeed when a front-end sends a
 

1281
00:29:47,100 --> 00:29:49,490
that yes indeed when a front-end sends a
write to the database server today every

1282
00:29:49,490 --> 00:29:49,500
write to the database server today every
 

1283
00:29:49,500 --> 00:29:53,029
write to the database server today every
server updates its data on disk and it

1284
00:29:53,029 --> 00:29:53,039
server updates its data on disk and it
 

1285
00:29:53,039 --> 00:29:56,060
server updates its data on disk and it
will send an invalidate a delete to

1286
00:29:56,060 --> 00:29:56,070
will send an invalidate a delete to
 

1287
00:29:56,070 --> 00:29:58,250
will send an invalidate a delete to
whatever memcache server there is in the

1288
00:29:58,250 --> 00:29:58,260
whatever memcache server there is in the
 

1289
00:29:58,260 --> 00:30:00,680
whatever memcache server there is in the
local region the local data center that

1290
00:30:00,680 --> 00:30:00,690
local region the local data center that
 

1291
00:30:00,690 --> 00:30:02,450
local region the local data center that
might have had the key that was just

1292
00:30:02,450 --> 00:30:02,460
might have had the key that was just
 

1293
00:30:02,460 --> 00:30:05,060
might have had the key that was just
updated the database server also sends a

1294
00:30:05,060 --> 00:30:05,070
updated the database server also sends a
 

1295
00:30:05,070 --> 00:30:07,940
updated the database server also sends a
sort of representation of the update to

1296
00:30:07,940 --> 00:30:07,950
sort of representation of the update to
 

1297
00:30:07,950 --> 00:30:09,889
sort of representation of the update to
the corresponding database serve in the

1298
00:30:09,889 --> 00:30:09,899
the corresponding database serve in the
 

1299
00:30:09,899 --> 00:30:11,930
the corresponding database serve in the
other region which process it applies

1300
00:30:11,930 --> 00:30:11,940
other region which process it applies
 

1301
00:30:11,940 --> 00:30:15,080
other region which process it applies
the right to its disk data on disk it

1302
00:30:15,080 --> 00:30:15,090
the right to its disk data on disk it
 

1303
00:30:15,090 --> 00:30:18,769
the right to its disk data on disk it
also using them excuse sort of log

1304
00:30:18,769 --> 00:30:18,779
also using them excuse sort of log
 

1305
00:30:18,779 --> 00:30:22,159
also using them excuse sort of log
reading apparatus figures out which

1306
00:30:22,159 --> 00:30:22,169
reading apparatus figures out which
 

1307
00:30:22,169 --> 00:30:25,159
reading apparatus figures out which
memcache server might hold the key that

1308
00:30:25,159 --> 00:30:25,169
memcache server might hold the key that
 

1309
00:30:25,169 --> 00:30:27,289
memcache server might hold the key that
was just updated and sends it delete

1310
00:30:27,289 --> 00:30:27,299
was just updated and sends it delete
 

1311
00:30:27,299 --> 00:30:32,330
was just updated and sends it delete
also to that memcache server so that the

1312
00:30:32,330 --> 00:30:32,340
also to that memcache server so that the
 

1313
00:30:32,340 --> 00:30:34,730
also to that memcache server so that the
if it's the key is cache is invalidated

1314
00:30:34,730 --> 00:30:34,740
if it's the key is cache is invalidated
 

1315
00:30:34,740 --> 00:30:40,039
if it's the key is cache is invalidated
in in both data centers okay so another

1316
00:30:40,039 --> 00:30:40,049
in in both data centers okay so another
 

1317
00:30:40,049 --> 00:30:41,389
in in both data centers okay so another
question what would happen if we delete

1318
00:30:41,389 --> 00:30:41,399
question what would happen if we delete
 

1319
00:30:41,399 --> 00:30:45,200
question what would happen if we delete
first in the right and then send to the

1320
00:30:45,200 --> 00:30:45,210
first in the right and then send to the
 

1321
00:30:45,210 --> 00:30:48,250
first in the right and then send to the
database

1322
00:30:48,250 --> 00:30:48,260

 

1323
00:30:48,260 --> 00:30:50,950

so that's or with reference to this

1324
00:30:50,950 --> 00:30:50,960
so that's or with reference to this
 

1325
00:30:50,960 --> 00:30:53,180
so that's or with reference to this
thing here would what if we did to the

1326
00:30:53,180 --> 00:30:53,190
thing here would what if we did to the
 

1327
00:30:53,190 --> 00:30:58,820
thing here would what if we did to the
feet first you know if you do delete

1328
00:30:58,820 --> 00:30:58,830
feet first you know if you do delete
 

1329
00:30:58,830 --> 00:31:01,279
feet first you know if you do delete
first then you're increasing the chances

1330
00:31:01,279 --> 00:31:01,289
first then you're increasing the chances
 

1331
00:31:01,289 --> 00:31:03,649
first then you're increasing the chances
that some other clients so supposing you

1332
00:31:03,649 --> 00:31:03,659
that some other clients so supposing you
 

1333
00:31:03,659 --> 00:31:11,090
that some other clients so supposing you
delete and then send to database right

1334
00:31:11,090 --> 00:31:11,100
delete and then send to database right
 

1335
00:31:11,100 --> 00:31:13,010
delete and then send to database right
in here if another client reads that

1336
00:31:13,010 --> 00:31:13,020
in here if another client reads that
 

1337
00:31:13,020 --> 00:31:14,870
in here if another client reads that
same key they're gonna miss at this

1338
00:31:14,870 --> 00:31:14,880
same key they're gonna miss at this
 

1339
00:31:14,880 --> 00:31:18,470
same key they're gonna miss at this
point they're gonna fetch the old data

1340
00:31:18,470 --> 00:31:18,480
point they're gonna fetch the old data
 

1341
00:31:18,480 --> 00:31:20,450
point they're gonna fetch the old data
from the database and they're gonna then

1342
00:31:20,450 --> 00:31:20,460
from the database and they're gonna then
 

1343
00:31:20,460 --> 00:31:21,230
from the database and they're gonna then
insert it

1344
00:31:21,230 --> 00:31:21,240
insert it
 

1345
00:31:21,240 --> 00:31:22,970
insert it
cash and then you're going to update it

1346
00:31:22,970 --> 00:31:22,980
cash and then you're going to update it
 

1347
00:31:22,980 --> 00:31:25,480
cash and then you're going to update it
leaving memcache for a while at least

1348
00:31:25,480 --> 00:31:25,490
leaving memcache for a while at least
 

1349
00:31:25,490 --> 00:31:28,730
leaving memcache for a while at least
with stale data and then if this the

1350
00:31:28,730 --> 00:31:28,740
with stale data and then if this the
 

1351
00:31:28,740 --> 00:31:30,110
with stale data and then if this the
writing client reads it again it may see

1352
00:31:30,110 --> 00:31:30,120
writing client reads it again it may see
 

1353
00:31:30,120 --> 00:31:31,430
writing client reads it again it may see
the stale data even though it just

1354
00:31:31,430 --> 00:31:31,440
the stale data even though it just
 

1355
00:31:31,440 --> 00:31:34,810
the stale data even though it just
updated it doing the delete second um

1356
00:31:34,810 --> 00:31:34,820
updated it doing the delete second um
 

1357
00:31:34,820 --> 00:31:37,280
updated it doing the delete second um
you know these over the possibility that

1358
00:31:37,280 --> 00:31:37,290
you know these over the possibility that
 

1359
00:31:37,290 --> 00:31:40,400
you know these over the possibility that
somebody will read during this period of

1360
00:31:40,400 --> 00:31:40,410
somebody will read during this period of
 

1361
00:31:40,410 --> 00:31:43,340
somebody will read during this period of
time and see steal data but they're not

1362
00:31:43,340 --> 00:31:43,350
time and see steal data but they're not
 

1363
00:31:43,350 --> 00:31:44,540
time and see steal data but they're not
worried about stale data in general

1364
00:31:44,540 --> 00:31:44,550
worried about stale data in general
 

1365
00:31:44,550 --> 00:31:47,120
worried about stale data in general
they're really most worried in this

1366
00:31:47,120 --> 00:31:47,130
they're really most worried in this
 

1367
00:31:47,130 --> 00:31:50,390
they're really most worried in this
context about clients reading their own

1368
00:31:50,390 --> 00:31:50,400
context about clients reading their own
 

1369
00:31:50,400 --> 00:31:52,940
context about clients reading their own
rights so on balance even though there's

1370
00:31:52,940 --> 00:31:52,950
rights so on balance even though there's
 

1371
00:31:52,950 --> 00:31:56,210
rights so on balance even though there's
a consistency problem by the way I'm

1372
00:31:56,210 --> 00:31:56,220
a consistency problem by the way I'm
 

1373
00:31:56,220 --> 00:32:00,230
a consistency problem by the way I'm
doing the delete second ensures that

1374
00:32:00,230 --> 00:32:00,240
doing the delete second ensures that
 

1375
00:32:00,240 --> 00:32:02,840
doing the delete second ensures that
clients will be their own rights in

1376
00:32:02,840 --> 00:32:02,850
clients will be their own rights in
 

1377
00:32:02,850 --> 00:32:06,440
clients will be their own rights in
either case eventually the database

1378
00:32:06,440 --> 00:32:06,450
either case eventually the database
 

1379
00:32:06,450 --> 00:32:09,710
either case eventually the database
server as I'm just mentioned will send a

1380
00:32:09,710 --> 00:32:09,720
server as I'm just mentioned will send a
 

1381
00:32:09,720 --> 00:32:19,500
server as I'm just mentioned will send a
delete for the written keys

1382
00:32:19,500 --> 00:32:19,510

 

1383
00:32:19,510 --> 00:32:21,550

another question I'm confused on how

1384
00:32:21,550 --> 00:32:21,560
another question I'm confused on how
 

1385
00:32:21,560 --> 00:32:24,660
another question I'm confused on how
writing the new value shows stale data

1386
00:32:24,660 --> 00:32:24,670
writing the new value shows stale data
 

1387
00:32:24,670 --> 00:32:40,930
writing the new value shows stale data
but deleting doesn't let me see I'm not

1388
00:32:40,930 --> 00:32:40,940
but deleting doesn't let me see I'm not
 

1389
00:32:40,940 --> 00:32:42,490
but deleting doesn't let me see I'm not
really sure what the question is asking

1390
00:32:42,490 --> 00:32:42,500
really sure what the question is asking
 

1391
00:32:42,500 --> 00:32:47,760
really sure what the question is asking
the if it's with reference to this code

1392
00:32:47,760 --> 00:32:47,770
the if it's with reference to this code
 

1393
00:32:47,770 --> 00:32:53,080
the if it's with reference to this code
once the writes done okay maybe the

1394
00:32:53,080 --> 00:32:53,090
once the writes done okay maybe the
 

1395
00:32:53,090 --> 00:32:54,550
once the writes done okay maybe the
question is it's really we didn't do

1396
00:32:54,550 --> 00:32:54,560
question is it's really we didn't do
 

1397
00:32:54,560 --> 00:32:59,050
question is it's really we didn't do
delete at all so that when a client a

1398
00:32:59,050 --> 00:32:59,060
delete at all so that when a client a
 

1399
00:32:59,060 --> 00:33:02,170
delete at all so that when a client a
front web for an end did or wanted to

1400
00:33:02,170 --> 00:33:02,180
front web for an end did or wanted to
 

1401
00:33:02,180 --> 00:33:03,340
front web for an end did or wanted to
update him David would just tell the

1402
00:33:03,340 --> 00:33:03,350
update him David would just tell the
 

1403
00:33:03,350 --> 00:33:07,540
update him David would just tell the
database but not explicitly delete the

1404
00:33:07,540 --> 00:33:07,550
database but not explicitly delete the
 

1405
00:33:07,550 --> 00:33:10,410
database but not explicitly delete the
data from memcache the problem with this

1406
00:33:10,410 --> 00:33:10,420
data from memcache the problem with this
 

1407
00:33:10,420 --> 00:33:17,200
data from memcache the problem with this
is that if the client sent this write to

1408
00:33:17,200 --> 00:33:17,210
is that if the client sent this write to
 

1409
00:33:17,210 --> 00:33:19,420
is that if the client sent this write to
the database and then immediately read

1410
00:33:19,420 --> 00:33:19,430
the database and then immediately read
 

1411
00:33:19,430 --> 00:33:22,030
the database and then immediately read
the same data that read would come out

1412
00:33:22,030 --> 00:33:22,040
the same data that read would come out
 

1413
00:33:22,040 --> 00:33:24,820
the same data that read would come out
of the memcache and because memcache

1414
00:33:24,820 --> 00:33:24,830
of the memcache and because memcache
 

1415
00:33:24,830 --> 00:33:26,230
of the memcache and because memcache
still has the old data

1416
00:33:26,230 --> 00:33:26,240
still has the old data
 

1417
00:33:26,240 --> 00:33:27,580
still has the old data
you know memcache hasn't seen this right

1418
00:33:27,580 --> 00:33:27,590
you know memcache hasn't seen this right
 

1419
00:33:27,590 --> 00:33:30,790
you know memcache hasn't seen this right
yet a client that updated some data and

1420
00:33:30,790 --> 00:33:30,800
yet a client that updated some data and
 

1421
00:33:30,800 --> 00:33:32,890
yet a client that updated some data and
then read it you know updates it in the

1422
00:33:32,890 --> 00:33:32,900
then read it you know updates it in the
 

1423
00:33:32,900 --> 00:33:34,360
then read it you know updates it in the
database but it reads the data if the

1424
00:33:34,360 --> 00:33:34,370
database but it reads the data if the
 

1425
00:33:34,370 --> 00:33:36,310
database but it reads the data if the
stale data from memcache and then a

1426
00:33:36,310 --> 00:33:36,320
stale data from memcache and then a
 

1427
00:33:36,320 --> 00:33:38,440
stale data from memcache and then a
client might update some data but still

1428
00:33:38,440 --> 00:33:38,450
client might update some data but still
 

1429
00:33:38,450 --> 00:33:41,560
client might update some data but still
see the old data and if you delete it

1430
00:33:41,560 --> 00:33:41,570
see the old data and if you delete it
 

1431
00:33:41,570 --> 00:33:44,320
see the old data and if you delete it
from memcache then if a client if you do

1432
00:33:44,320 --> 00:33:44,330
from memcache then if a client if you do
 

1433
00:33:44,330 --> 00:33:46,630
from memcache then if a client if you do
do this delete than a client that writes

1434
00:33:46,630 --> 00:33:46,640
do this delete than a client that writes
 

1435
00:33:46,640 --> 00:33:49,750
do this delete than a client that writes
some data and deletes it from memcache

1436
00:33:49,750 --> 00:33:49,760
some data and deletes it from memcache
 

1437
00:33:49,760 --> 00:33:51,790
some data and deletes it from memcache
and then reads it again it'll miss in

1438
00:33:51,790 --> 00:33:51,800
and then reads it again it'll miss in
 

1439
00:33:51,800 --> 00:33:54,100
and then reads it again it'll miss in
memcache because of the delete and they

1440
00:33:54,100 --> 00:33:54,110
memcache because of the delete and they
 

1441
00:33:54,110 --> 00:33:55,090
memcache because of the delete and they
don't have to go to the database and

1442
00:33:55,090 --> 00:33:55,100
don't have to go to the database and
 

1443
00:33:55,100 --> 00:33:56,770
don't have to go to the database and
read the data and the database will give

1444
00:33:56,770 --> 00:33:56,780
read the data and the database will give
 

1445
00:33:56,780 --> 00:34:03,550
read the data and the database will give
it fresh data okay so the question is

1446
00:34:03,550 --> 00:34:03,560
it fresh data okay so the question is
 

1447
00:34:03,560 --> 00:34:06,730
it fresh data okay so the question is
how come why do we delete here

1448
00:34:06,730 --> 00:34:06,740
how come why do we delete here
 

1449
00:34:06,740 --> 00:34:10,720
how come why do we delete here
gosh why don't we just instead of this

1450
00:34:10,720 --> 00:34:10,730
gosh why don't we just instead of this
 

1451
00:34:10,730 --> 00:34:13,870
gosh why don't we just instead of this
delete have the client just directly

1452
00:34:13,870 --> 00:34:13,880
delete have the client just directly
 

1453
00:34:13,880 --> 00:34:18,250
delete have the client just directly
since it knows the new data just send a

1454
00:34:18,250 --> 00:34:18,260
since it knows the new data just send a
 

1455
00:34:18,260 --> 00:34:24,070
since it knows the new data just send a
set RPC - memcache T and this is a this

1456
00:34:24,070 --> 00:34:24,080
set RPC - memcache T and this is a this
 

1457
00:34:24,080 --> 00:34:24,940
set RPC - memcache T and this is a this
is a good question

1458
00:34:24,940 --> 00:34:24,950
is a good question
 

1459
00:34:24,950 --> 00:34:26,950
is a good question
and so here we're doing I have an

1460
00:34:26,950 --> 00:34:26,960
and so here we're doing I have an
 

1461
00:34:26,960 --> 00:34:29,080
and so here we're doing I have an
invalidate scheme this would often be

1462
00:34:29,080 --> 00:34:29,090
invalidate scheme this would often be
 

1463
00:34:29,090 --> 00:34:34,750
invalidate scheme this would often be
called an update scheme and let me try

1464
00:34:34,750 --> 00:34:34,760
called an update scheme and let me try
 

1465
00:34:34,760 --> 00:34:37,360
called an update scheme and let me try
to cook up an example that shows that

1466
00:34:37,360 --> 00:34:37,370
to cook up an example that shows that
 

1467
00:34:37,370 --> 00:34:39,100
to cook up an example that shows that
while this could probably be made to

1468
00:34:39,100 --> 00:34:39,110
while this could probably be made to
 

1469
00:34:39,110 --> 00:34:45,120
while this could probably be made to
work this update scheme it doesn't work

1470
00:34:45,120 --> 00:34:45,130

 

1471
00:34:45,130 --> 00:34:47,320

it doesn't work out of the box and you

1472
00:34:47,320 --> 00:34:47,330
it doesn't work out of the box and you
 

1473
00:34:47,330 --> 00:34:48,790
it doesn't work out of the box and you
wouldn't you need to do some careful

1474
00:34:48,790 --> 00:34:48,800
wouldn't you need to do some careful
 

1475
00:34:48,800 --> 00:34:50,560
wouldn't you need to do some careful
design in order to make it work so this

1476
00:34:50,560 --> 00:34:50,570
design in order to make it work so this
 

1477
00:34:50,570 --> 00:34:51,880
design in order to make it work so this
wasn't client wants posing up now we

1478
00:34:51,880 --> 00:34:51,890
wasn't client wants posing up now we
 

1479
00:34:51,890 --> 00:34:57,210
wasn't client wants posing up now we
have two clients

1480
00:34:57,210 --> 00:34:57,220

 

1481
00:34:57,220 --> 00:34:59,120

reading and writing the same key

1482
00:34:59,120 --> 00:34:59,130
reading and writing the same key
 

1483
00:34:59,130 --> 00:35:05,750
reading and writing the same key
interleaved so let's say client one

1484
00:35:05,750 --> 00:35:05,760
interleaved so let's say client one
 

1485
00:35:05,760 --> 00:35:11,700
interleaved so let's say client one
tells the database you know sends X plus

1486
00:35:11,700 --> 00:35:11,710
tells the database you know sends X plus
 

1487
00:35:11,710 --> 00:35:15,120
tells the database you know sends X plus
plus to the database right just

1488
00:35:15,120 --> 00:35:15,130
plus to the database right just
 

1489
00:35:15,130 --> 00:35:19,620
plus to the database right just
incrementing X and then of course or let

1490
00:35:19,620 --> 00:35:19,630
incrementing X and then of course or let
 

1491
00:35:19,630 --> 00:35:22,980
incrementing X and then of course or let
me say it's going to increment X from

1492
00:35:22,980 --> 00:35:22,990
me say it's going to increment X from
 

1493
00:35:22,990 --> 00:35:25,970
me say it's going to increment X from
zero to one so set X to one and then

1494
00:35:25,970 --> 00:35:25,980
zero to one so set X to one and then
 

1495
00:35:25,980 --> 00:35:30,480
zero to one so set X to one and then
after that client one is going to call

1496
00:35:30,480 --> 00:35:30,490
after that client one is going to call
 

1497
00:35:30,490 --> 00:35:36,390
after that client one is going to call
set of our key which is X and the value

1498
00:35:36,390 --> 00:35:36,400
set of our key which is X and the value
 

1499
00:35:36,400 --> 00:35:40,040
set of our key which is X and the value
one and write that at the memcache D

1500
00:35:40,040 --> 00:35:40,050
one and write that at the memcache D
 

1501
00:35:40,050 --> 00:35:43,230
one and write that at the memcache D
supposing meanwhile client two also

1502
00:35:43,230 --> 00:35:43,240
supposing meanwhile client two also
 

1503
00:35:43,240 --> 00:35:46,140
supposing meanwhile client two also
wants to increment X so it's going to

1504
00:35:46,140 --> 00:35:46,150
wants to increment X so it's going to
 

1505
00:35:46,150 --> 00:35:48,000
wants to increment X so it's going to
read this latest value in the database

1506
00:35:48,000 --> 00:35:48,010
read this latest value in the database
 

1507
00:35:48,010 --> 00:35:50,690
read this latest value in the database
and almost certainly these are in fact

1508
00:35:50,690 --> 00:35:50,700
and almost certainly these are in fact
 

1509
00:35:50,700 --> 00:35:54,060
and almost certainly these are in fact
transactions so what if we were doing

1510
00:35:54,060 --> 00:35:54,070
transactions so what if we were doing
 

1511
00:35:54,070 --> 00:35:55,440
transactions so what if we were doing
increment what client won't won't be

1512
00:35:55,440 --> 00:35:55,450
increment what client won't won't be
 

1513
00:35:55,450 --> 00:35:57,630
increment what client won't won't be
sending would be some sort of increment

1514
00:35:57,630 --> 00:35:57,640
sending would be some sort of increment
 

1515
00:35:57,640 --> 00:35:58,800
sending would be some sort of increment
transaction on the database for

1516
00:35:58,800 --> 00:35:58,810
transaction on the database for
 

1517
00:35:58,810 --> 00:36:00,390
transaction on the database for
correctness because the database does

1518
00:36:00,390 --> 00:36:00,400
correctness because the database does
 

1519
00:36:00,400 --> 00:36:02,700
correctness because the database does
support transactions so we're going to

1520
00:36:02,700 --> 00:36:02,710
support transactions so we're going to
 

1521
00:36:02,710 --> 00:36:04,260
support transactions so we're going to
imagine the client to increments the

1522
00:36:04,260 --> 00:36:04,270
imagine the client to increments the
 

1523
00:36:04,270 --> 00:36:07,829
imagine the client to increments the
value of x to to sends that increment to

1524
00:36:07,829 --> 00:36:07,839
value of x to to sends that increment to
 

1525
00:36:07,839 --> 00:36:09,540
value of x to to sends that increment to
the database and client two also is

1526
00:36:09,540 --> 00:36:09,550
the database and client two also is
 

1527
00:36:09,550 --> 00:36:12,060
the database and client two also is
going to do this set so it's going to

1528
00:36:12,060 --> 00:36:12,070
going to do this set so it's going to
 

1529
00:36:12,070 --> 00:36:15,960
going to do this set so it's going to
set X to be two but now what we're left

1530
00:36:15,960 --> 00:36:15,970
set X to be two but now what we're left
 

1531
00:36:15,970 --> 00:36:19,680
set X to be two but now what we're left
with is the value of one in memcache D

1532
00:36:19,680 --> 00:36:19,690
with is the value of one in memcache D
 

1533
00:36:19,690 --> 00:36:21,690
with is the value of one in memcache D
even though the correct values and the

1534
00:36:21,690 --> 00:36:21,700
even though the correct values and the
 

1535
00:36:21,700 --> 00:36:25,530
even though the correct values and the
databases to which is to say if we do

1536
00:36:25,530 --> 00:36:25,540
databases to which is to say if we do
 

1537
00:36:25,540 --> 00:36:28,050
databases to which is to say if we do
this update was set even though it does

1538
00:36:28,050 --> 00:36:28,060
this update was set even though it does
 

1539
00:36:28,060 --> 00:36:29,550
this update was set even though it does
save us some time right cuz now we're

1540
00:36:29,550 --> 00:36:29,560
save us some time right cuz now we're
 

1541
00:36:29,560 --> 00:36:31,710
save us some time right cuz now we're
saving somebody a miss in the future

1542
00:36:31,710 --> 00:36:31,720
saving somebody a miss in the future
 

1543
00:36:31,720 --> 00:36:33,089
saving somebody a miss in the future
because we directly said instead of

1544
00:36:33,089 --> 00:36:33,099
because we directly said instead of
 

1545
00:36:33,099 --> 00:36:36,120
because we directly said instead of
delete we also run the risk if the if

1546
00:36:36,120 --> 00:36:36,130
delete we also run the risk if the if
 

1547
00:36:36,130 --> 00:36:39,030
delete we also run the risk if the if
it's popular data of leaving stale data

1548
00:36:39,030 --> 00:36:39,040
it's popular data of leaving stale data
 

1549
00:36:39,040 --> 00:36:41,760
it's popular data of leaving stale data
in the database it's not that you

1550
00:36:41,760 --> 00:36:41,770
in the database it's not that you
 

1551
00:36:41,770 --> 00:36:45,839
in the database it's not that you
couldn't get this to work somehow but it

1552
00:36:45,839 --> 00:36:45,849
couldn't get this to work somehow but it
 

1553
00:36:45,849 --> 00:36:49,589
couldn't get this to work somehow but it
does require some careful thought to fix

1554
00:36:49,589 --> 00:36:49,599
does require some careful thought to fix
 

1555
00:36:49,599 --> 00:36:55,589
does require some careful thought to fix
this problem all right so that was why

1556
00:36:55,589 --> 00:36:55,599
this problem all right so that was why
 

1557
00:36:55,599 --> 00:36:58,440
this problem all right so that was why
they use invalidate and instead of

1558
00:36:58,440 --> 00:36:58,450
they use invalidate and instead of
 

1559
00:36:58,450 --> 00:37:03,099
they use invalidate and instead of
update okay so I was going to

1560
00:37:03,099 --> 00:37:03,109
update okay so I was going to
 

1561
00:37:03,109 --> 00:37:07,450
update okay so I was going to
about performance they this sort of

1562
00:37:07,450 --> 00:37:07,460
about performance they this sort of
 

1563
00:37:07,460 --> 00:37:09,779
about performance they this sort of
route of how they get performance is

1564
00:37:09,779 --> 00:37:09,789
route of how they get performance is
 

1565
00:37:09,789 --> 00:37:12,849
route of how they get performance is
through parallel parallelization

1566
00:37:12,849 --> 00:37:12,859
through parallel parallelization
 

1567
00:37:12,859 --> 00:37:16,269
through parallel parallelization
parallel execution and for a storage

1568
00:37:16,269 --> 00:37:16,279
parallel execution and for a storage
 

1569
00:37:16,279 --> 00:37:18,640
parallel execution and for a storage
system just at a high level there's

1570
00:37:18,640 --> 00:37:18,650
system just at a high level there's
 

1571
00:37:18,650 --> 00:37:21,489
system just at a high level there's
really two ways that you can get a good

1572
00:37:21,489 --> 00:37:21,499
really two ways that you can get a good
 

1573
00:37:21,499 --> 00:37:22,239
really two ways that you can get a good
performance

1574
00:37:22,239 --> 00:37:22,249
performance
 

1575
00:37:22,249 --> 00:37:27,390
performance
one is by partition which is sharding

1576
00:37:27,390 --> 00:37:27,400
one is by partition which is sharding
 

1577
00:37:27,400 --> 00:37:30,039
one is by partition which is sharding
that is you take your data and you split

1578
00:37:30,039 --> 00:37:30,049
that is you take your data and you split
 

1579
00:37:30,049 --> 00:37:32,440
that is you take your data and you split
it up over you know into ten pieces over

1580
00:37:32,440 --> 00:37:32,450
it up over you know into ten pieces over
 

1581
00:37:32,450 --> 00:37:34,059
it up over you know into ten pieces over
ten servers and those ten servers can

1582
00:37:34,059 --> 00:37:34,069
ten servers and those ten servers can
 

1583
00:37:34,069 --> 00:37:37,180
ten servers and those ten servers can
run independently hopefully the other

1584
00:37:37,180 --> 00:37:37,190
run independently hopefully the other
 

1585
00:37:37,190 --> 00:37:39,609
run independently hopefully the other
way you can use extra hardware to get

1586
00:37:39,609 --> 00:37:39,619
way you can use extra hardware to get
 

1587
00:37:39,619 --> 00:37:42,569
way you can use extra hardware to get
higher performance despite replication

1588
00:37:42,569 --> 00:37:42,579
higher performance despite replication
 

1589
00:37:42,579 --> 00:37:48,130
higher performance despite replication
at is have more than one copy of the

1590
00:37:48,130 --> 00:37:48,140
at is have more than one copy of the
 

1591
00:37:48,140 --> 00:37:51,099
at is have more than one copy of the
data and you kind of for a given amount

1592
00:37:51,099 --> 00:37:51,109
data and you kind of for a given amount
 

1593
00:37:51,109 --> 00:37:53,249
data and you kind of for a given amount
of hardware you can kind of choose

1594
00:37:53,249 --> 00:37:53,259
of hardware you can kind of choose
 

1595
00:37:53,259 --> 00:37:55,660
of hardware you can kind of choose
whether to partition your data or

1596
00:37:55,660 --> 00:37:55,670
whether to partition your data or
 

1597
00:37:55,670 --> 00:37:56,920
whether to partition your data or
replicate it in order to use that

1598
00:37:56,920 --> 00:37:56,930
replicate it in order to use that
 

1599
00:37:56,930 --> 00:38:04,509
replicate it in order to use that
hardware and there's you know from

1600
00:38:04,509 --> 00:38:04,519
hardware and there's you know from
 

1601
00:38:04,519 --> 00:38:05,499
hardware and there's you know from
memcache see what we're talking about

1602
00:38:05,499 --> 00:38:05,509
memcache see what we're talking about
 

1603
00:38:05,509 --> 00:38:09,519
memcache see what we're talking about
here is is splitting the data over the

1604
00:38:09,519 --> 00:38:09,529
here is is splitting the data over the
 

1605
00:38:09,529 --> 00:38:11,589
here is is splitting the data over the
available memcache servers by hashing

1606
00:38:11,589 --> 00:38:11,599
available memcache servers by hashing
 

1607
00:38:11,599 --> 00:38:14,499
available memcache servers by hashing
the key so that every key sort of lives

1608
00:38:14,499 --> 00:38:14,509
the key so that every key sort of lives
 

1609
00:38:14,509 --> 00:38:16,269
the key so that every key sort of lives
on one memcache server and from memcache

1610
00:38:16,269 --> 00:38:16,279
on one memcache server and from memcache
 

1611
00:38:16,279 --> 00:38:18,779
on one memcache server and from memcache
what we would be talking about here is

1612
00:38:18,779 --> 00:38:18,789
what we would be talking about here is
 

1613
00:38:18,789 --> 00:38:21,759
what we would be talking about here is
having each front-end just talk to a

1614
00:38:21,759 --> 00:38:21,769
having each front-end just talk to a
 

1615
00:38:21,769 --> 00:38:23,829
having each front-end just talk to a
single memcache server and send all its

1616
00:38:23,829 --> 00:38:23,839
single memcache server and send all its
 

1617
00:38:23,839 --> 00:38:25,809
single memcache server and send all its
requests there so that each memcache

1618
00:38:25,809 --> 00:38:25,819
requests there so that each memcache
 

1619
00:38:25,819 --> 00:38:29,019
requests there so that each memcache
server serves only a subset of the front

1620
00:38:29,019 --> 00:38:29,029
server serves only a subset of the front
 

1621
00:38:29,029 --> 00:38:31,680
server serves only a subset of the front
ends and sort of serves all their needs

1622
00:38:31,680 --> 00:38:31,690
ends and sort of serves all their needs
 

1623
00:38:31,690 --> 00:38:35,589
ends and sort of serves all their needs
and Facebook actually uses a combination

1624
00:38:35,589 --> 00:38:35,599
and Facebook actually uses a combination
 

1625
00:38:35,599 --> 00:38:39,009
and Facebook actually uses a combination
of both partition and replication for

1626
00:38:39,009 --> 00:38:39,019
of both partition and replication for
 

1627
00:38:39,019 --> 00:38:41,380
of both partition and replication for
partition the things that are in its

1628
00:38:41,380 --> 00:38:41,390
partition the things that are in its
 

1629
00:38:41,390 --> 00:38:44,339
partition the things that are in its
favor one is that it's memory efficient

1630
00:38:44,339 --> 00:38:44,349
favor one is that it's memory efficient
 

1631
00:38:44,349 --> 00:38:48,210
favor one is that it's memory efficient
because you only store a single copy of

1632
00:38:48,210 --> 00:38:48,220
because you only store a single copy of
 

1633
00:38:48,220 --> 00:38:50,710
because you only store a single copy of
each item Abita where's in replication

1634
00:38:50,710 --> 00:38:50,720
each item Abita where's in replication
 

1635
00:38:50,720 --> 00:38:52,509
each item Abita where's in replication
you're gonna store every piece of data

1636
00:38:52,509 --> 00:38:52,519
you're gonna store every piece of data
 

1637
00:38:52,519 --> 00:39:00,430
you're gonna store every piece of data
maybe on every server on the sort of

1638
00:39:00,430 --> 00:39:00,440
maybe on every server on the sort of
 

1639
00:39:00,440 --> 00:39:03,280
maybe on every server on the sort of
partition is that it's as long as your

1640
00:39:03,280 --> 00:39:03,290
partition is that it's as long as your
 

1641
00:39:03,290 --> 00:39:05,319
partition is that it's as long as your
keys are sort of equally roughly equally

1642
00:39:05,319 --> 00:39:05,329
keys are sort of equally roughly equally
 

1643
00:39:05,329 --> 00:39:07,960
keys are sort of equally roughly equally
popular works pretty well but if there's

1644
00:39:07,960 --> 00:39:07,970
popular works pretty well but if there's
 

1645
00:39:07,970 --> 00:39:10,030
popular works pretty well but if there's
some hot a few hot keys partition

1646
00:39:10,030 --> 00:39:10,040
some hot a few hot keys partition
 

1647
00:39:10,040 --> 00:39:12,130
some hot a few hot keys partition
doesn't really help you much once you

1648
00:39:12,130 --> 00:39:12,140
doesn't really help you much once you
 

1649
00:39:12,140 --> 00:39:13,599
doesn't really help you much once you
get those partition enough that those

1650
00:39:13,599 --> 00:39:13,609
get those partition enough that those
 

1651
00:39:13,609 --> 00:39:17,680
get those partition enough that those
hot keys are on different servers you

1652
00:39:17,680 --> 00:39:17,690
hot keys are on different servers you
 

1653
00:39:17,690 --> 00:39:19,150
hot keys are on different servers you
know once the if there's a single hot

1654
00:39:19,150 --> 00:39:19,160
know once the if there's a single hot
 

1655
00:39:19,160 --> 00:39:20,680
know once the if there's a single hot
key for example no amount of

1656
00:39:20,680 --> 00:39:20,690
key for example no amount of
 

1657
00:39:20,690 --> 00:39:22,900
key for example no amount of
partitioning helps you because no matter

1658
00:39:22,900 --> 00:39:22,910
partitioning helps you because no matter
 

1659
00:39:22,910 --> 00:39:25,210
partitioning helps you because no matter
of how much you partition that hot key

1660
00:39:25,210 --> 00:39:25,220
of how much you partition that hot key
 

1661
00:39:25,220 --> 00:39:34,090
of how much you partition that hot key
is still sitting on just one server

1662
00:39:34,090 --> 00:39:34,100

 

1663
00:39:34,100 --> 00:39:38,630

the problem partition is that it doesn't

1664
00:39:38,630 --> 00:39:38,640
the problem partition is that it doesn't
 

1665
00:39:38,640 --> 00:39:40,880
the problem partition is that it doesn't
mean that the front if front ends need

1666
00:39:40,880 --> 00:39:40,890
mean that the front if front ends need
 

1667
00:39:40,890 --> 00:39:42,920
mean that the front if front ends need
to use lots of data lots of different

1668
00:39:42,920 --> 00:39:42,930
to use lots of data lots of different
 

1669
00:39:42,930 --> 00:39:44,960
to use lots of data lots of different
keys it means in the end each front-end

1670
00:39:44,960 --> 00:39:44,970
keys it means in the end each front-end
 

1671
00:39:44,970 --> 00:39:47,570
keys it means in the end each front-end
is probably going to talk to lots of

1672
00:39:47,570 --> 00:39:47,580
is probably going to talk to lots of
 

1673
00:39:47,580 --> 00:39:51,050
is probably going to talk to lots of
partitions and at least if you use

1674
00:39:51,050 --> 00:39:51,060
partitions and at least if you use
 

1675
00:39:51,060 --> 00:39:53,260
partitions and at least if you use
protocols like TCP that keep state

1676
00:39:53,260 --> 00:39:53,270
protocols like TCP that keep state
 

1677
00:39:53,270 --> 00:39:58,520
protocols like TCP that keep state
there's significant overhead to as you

1678
00:39:58,520 --> 00:39:58,530
there's significant overhead to as you
 

1679
00:39:58,530 --> 00:40:00,080
there's significant overhead to as you
add more and more sort of N squared

1680
00:40:00,080 --> 00:40:00,090
add more and more sort of N squared
 

1681
00:40:00,090 --> 00:40:09,470
add more and more sort of N squared
communication for a replication it's

1682
00:40:09,470 --> 00:40:09,480
communication for a replication it's
 

1683
00:40:09,480 --> 00:40:12,820
communication for a replication it's
fantastic if if your problem is that a

1684
00:40:12,820 --> 00:40:12,830
fantastic if if your problem is that a
 

1685
00:40:12,830 --> 00:40:17,150
fantastic if if your problem is that a
few keys are popular because now you

1686
00:40:17,150 --> 00:40:17,160
few keys are popular because now you
 

1687
00:40:17,160 --> 00:40:18,380
few keys are popular because now you
know you're making replicas of those

1688
00:40:18,380 --> 00:40:18,390
know you're making replicas of those
 

1689
00:40:18,390 --> 00:40:20,359
know you're making replicas of those
those hotkeys and you can serve each

1690
00:40:20,359 --> 00:40:20,369
those hotkeys and you can serve each
 

1691
00:40:20,369 --> 00:40:24,200
those hotkeys and you can serve each
replica the same key in parallel it's

1692
00:40:24,200 --> 00:40:24,210
replica the same key in parallel it's
 

1693
00:40:24,210 --> 00:40:26,480
replica the same key in parallel it's
good because there's fewer this there's

1694
00:40:26,480 --> 00:40:26,490
good because there's fewer this there's
 

1695
00:40:26,490 --> 00:40:28,970
good because there's fewer this there's
not n squared communication each

1696
00:40:28,970 --> 00:40:28,980
not n squared communication each
 

1697
00:40:28,980 --> 00:40:30,260
not n squared communication each
front-end maybe only talks to one

1698
00:40:30,260 --> 00:40:30,270
front-end maybe only talks to one
 

1699
00:40:30,270 --> 00:40:38,260
front-end maybe only talks to one
memcache server but the bad thing is

1700
00:40:38,260 --> 00:40:38,270
memcache server but the bad thing is
 

1701
00:40:38,270 --> 00:40:40,210
memcache server but the bad thing is
it's there's a copy of data in every

1702
00:40:40,210 --> 00:40:40,220
it's there's a copy of data in every
 

1703
00:40:40,220 --> 00:40:43,570
it's there's a copy of data in every
server you can cache far fewer distinct

1704
00:40:43,570 --> 00:40:43,580
server you can cache far fewer distinct
 

1705
00:40:43,580 --> 00:40:47,590
server you can cache far fewer distinct
data items with replication then with

1706
00:40:47,590 --> 00:40:47,600
data items with replication then with
 

1707
00:40:47,600 --> 00:40:53,260
data items with replication then with
partition so there's less total data can

1708
00:40:53,260 --> 00:40:53,270
partition so there's less total data can
 

1709
00:40:53,270 --> 00:40:57,130
partition so there's less total data can
be stored so these are just generic for

1710
00:40:57,130 --> 00:40:57,140
be stored so these are just generic for
 

1711
00:40:57,140 --> 00:41:00,880
be stored so these are just generic for
pros and cons of these two main ways of

1712
00:41:00,880 --> 00:41:00,890
pros and cons of these two main ways of
 

1713
00:41:00,890 --> 00:41:02,980
pros and cons of these two main ways of
using extra hardware to get higher

1714
00:41:02,980 --> 00:41:02,990
using extra hardware to get higher
 

1715
00:41:02,990 --> 00:41:07,660
using extra hardware to get higher
performance alright so I want to talk a

1716
00:41:07,660 --> 00:41:07,670
performance alright so I want to talk a
 

1717
00:41:07,670 --> 00:41:11,140
performance alright so I want to talk a
bit about there when one sort of context

1718
00:41:11,140 --> 00:41:11,150
bit about there when one sort of context
 

1719
00:41:11,150 --> 00:41:12,700
bit about there when one sort of context
in which they use partition and

1720
00:41:12,700 --> 00:41:12,710
in which they use partition and
 

1721
00:41:12,710 --> 00:41:15,610
in which they use partition and
replication is at the level of different

1722
00:41:15,610 --> 00:41:15,620
replication is at the level of different
 

1723
00:41:15,620 --> 00:41:21,810
replication is at the level of different
regions so I just want to talk through

1724
00:41:21,810 --> 00:41:21,820
regions so I just want to talk through
 

1725
00:41:21,820 --> 00:41:26,100
regions so I just want to talk through
why it is that they decided to have

1726
00:41:26,100 --> 00:41:26,110
why it is that they decided to have
 

1727
00:41:26,110 --> 00:41:28,900
why it is that they decided to have
separate regions and kind of separate

1728
00:41:28,900 --> 00:41:28,910
separate regions and kind of separate
 

1729
00:41:28,910 --> 00:41:30,550
separate regions and kind of separate
complete data center with all the data

1730
00:41:30,550 --> 00:41:30,560
complete data center with all the data
 

1731
00:41:30,560 --> 00:41:33,940
complete data center with all the data
in each of the regions so I before I do

1732
00:41:33,940 --> 00:41:33,950
in each of the regions so I before I do
 

1733
00:41:33,950 --> 00:41:35,980
in each of the regions so I before I do
that there's a question why can't we

1734
00:41:35,980 --> 00:41:35,990
that there's a question why can't we
 

1735
00:41:35,990 --> 00:41:38,320
that there's a question why can't we
cache the same amount of data with

1736
00:41:38,320 --> 00:41:38,330
cache the same amount of data with
 

1737
00:41:38,330 --> 00:41:42,160
cache the same amount of data with
replication ok so supposing you have 10

1738
00:41:42,160 --> 00:41:42,170
replication ok so supposing you have 10
 

1739
00:41:42,170 --> 00:41:46,060
replication ok so supposing you have 10
machines each with a gigabyte of RAM and

1740
00:41:46,060 --> 00:41:46,070
machines each with a gigabyte of RAM and
 

1741
00:41:46,070 --> 00:41:48,370
machines each with a gigabyte of RAM and
you can use these 10 machines each with

1742
00:41:48,370 --> 00:41:48,380
you can use these 10 machines each with
 

1743
00:41:48,380 --> 00:41:50,230
you can use these 10 machines each with
a gigabyte of RAM for either replication

1744
00:41:50,230 --> 00:41:50,240
a gigabyte of RAM for either replication
 

1745
00:41:50,240 --> 00:41:53,950
a gigabyte of RAM for either replication
or in a partitioning scheme if you use a

1746
00:41:53,950 --> 00:41:53,960
or in a partitioning scheme if you use a
 

1747
00:41:53,960 --> 00:41:56,280
or in a partitioning scheme if you use a
partitioning scheme where each server

1748
00:41:56,280 --> 00:41:56,290
partitioning scheme where each server
 

1749
00:41:56,290 --> 00:41:58,300
partitioning scheme where each server
stores different data from the other

1750
00:41:58,300 --> 00:41:58,310
stores different data from the other
 

1751
00:41:58,310 --> 00:42:01,150
stores different data from the other
servers that you can store a total of 10

1752
00:42:01,150 --> 00:42:01,160
servers that you can store a total of 10
 

1753
00:42:01,160 --> 00:42:04,240
servers that you can store a total of 10
gigabytes of distinct data objects on

1754
00:42:04,240 --> 00:42:04,250
gigabytes of distinct data objects on
 

1755
00:42:04,250 --> 00:42:07,060
gigabytes of distinct data objects on
your 10 servers each with a gigabyte of

1756
00:42:07,060 --> 00:42:07,070
your 10 servers each with a gigabyte of
 

1757
00:42:07,070 --> 00:42:09,670
your 10 servers each with a gigabyte of
RAM so with partition you know each byte

1758
00:42:09,670 --> 00:42:09,680
RAM so with partition you know each byte
 

1759
00:42:09,680 --> 00:42:11,260
RAM so with partition you know each byte
of ram is used for different data so you

1760
00:42:11,260 --> 00:42:11,270
of ram is used for different data so you
 

1761
00:42:11,270 --> 00:42:12,460
of ram is used for different data so you
can look at the total amount of RAM you

1762
00:42:12,460 --> 00:42:12,470
can look at the total amount of RAM you
 

1763
00:42:12,470 --> 00:42:15,460
can look at the total amount of RAM you
have that's how much distinct data you

1764
00:42:15,460 --> 00:42:15,470
have that's how much distinct data you
 

1765
00:42:15,470 --> 00:42:16,930
have that's how much distinct data you
know different data items you can store

1766
00:42:16,930 --> 00:42:16,940
know different data items you can store
 

1767
00:42:16,940 --> 00:42:20,500
know different data items you can store
with replication you know assuming your

1768
00:42:20,500 --> 00:42:20,510
with replication you know assuming your
 

1769
00:42:20,510 --> 00:42:22,390
with replication you know assuming your
users are more or less looking at the

1770
00:42:22,390 --> 00:42:22,400
users are more or less looking at the
 

1771
00:42:22,400 --> 00:42:29,680
users are more or less looking at the
same stuff each each replicas each cache

1772
00:42:29,680 --> 00:42:29,690
same stuff each each replicas each cache
 

1773
00:42:29,690 --> 00:42:32,230
same stuff each each replicas each cache
replicas will end up storing roughly the

1774
00:42:32,230 --> 00:42:32,240
replicas will end up storing roughly the
 

1775
00:42:32,240 --> 00:42:36,430
replicas will end up storing roughly the
same stuff as all the other caches so

1776
00:42:36,430 --> 00:42:36,440
same stuff as all the other caches so
 

1777
00:42:36,440 --> 00:42:38,050
same stuff as all the other caches so
your 10 you have 10 gigabytes of RAM

1778
00:42:38,050 --> 00:42:38,060
your 10 you have 10 gigabytes of RAM
 

1779
00:42:38,060 --> 00:42:41,260
your 10 you have 10 gigabytes of RAM
still they and your 10 machines but each

1780
00:42:41,260 --> 00:42:41,270
still they and your 10 machines but each
 

1781
00:42:41,270 --> 00:42:42,910
still they and your 10 machines but each
of those machines stores roughly the

1782
00:42:42,910 --> 00:42:42,920
of those machines stores roughly the
 

1783
00:42:42,920 --> 00:42:44,410
of those machines stores roughly the
same data so would you end up with this

1784
00:42:44,410 --> 00:42:44,420
same data so would you end up with this
 

1785
00:42:44,420 --> 00:42:48,450
same data so would you end up with this
10 copies of the same gigabyte of items

1786
00:42:48,450 --> 00:42:48,460
10 copies of the same gigabyte of items
 

1787
00:42:48,460 --> 00:42:51,100
10 copies of the same gigabyte of items
so in a can this particular example if

1788
00:42:51,100 --> 00:42:51,110
so in a can this particular example if
 

1789
00:42:51,110 --> 00:42:52,080
so in a can this particular example if
you use replication you

1790
00:42:52,080 --> 00:42:52,090
you use replication you
 

1791
00:42:52,090 --> 00:42:54,090
you use replication you
snoring attempt as many distinct data

1792
00:42:54,090 --> 00:42:54,100
snoring attempt as many distinct data
 

1793
00:42:54,100 --> 00:42:57,000
snoring attempt as many distinct data
items and you know that may actually be

1794
00:42:57,000 --> 00:42:57,010
items and you know that may actually be
 

1795
00:42:57,010 --> 00:43:01,440
items and you know that may actually be
a good idea depending on you know sort

1796
00:43:01,440 --> 00:43:01,450
a good idea depending on you know sort
 

1797
00:43:01,450 --> 00:43:04,470
a good idea depending on you know sort
of way your data is like but it does

1798
00:43:04,470 --> 00:43:04,480
of way your data is like but it does
 

1799
00:43:04,480 --> 00:43:07,080
of way your data is like but it does
mean that replication gives you less

1800
00:43:07,080 --> 00:43:07,090
mean that replication gives you less
 

1801
00:43:07,090 --> 00:43:09,480
mean that replication gives you less
total data that's cached and you know

1802
00:43:09,480 --> 00:43:09,490
total data that's cached and you know
 

1803
00:43:09,490 --> 00:43:11,130
total data that's cached and you know
you can see there's points in the paper

1804
00:43:11,130 --> 00:43:11,140
you can see there's points in the paper
 

1805
00:43:11,140 --> 00:43:14,520
you can see there's points in the paper
word that they mention this tension

1806
00:43:14,520 --> 00:43:14,530
word that they mention this tension
 

1807
00:43:14,530 --> 00:43:18,030
word that they mention this tension
nominally they don't come down on one

1808
00:43:18,030 --> 00:43:18,040
nominally they don't come down on one
 

1809
00:43:18,040 --> 00:43:19,140
nominally they don't come down on one
side of the other because they use both

1810
00:43:19,140 --> 00:43:19,150
side of the other because they use both
 

1811
00:43:19,150 --> 00:43:27,600
side of the other because they use both
replication and charting okay okay so

1812
00:43:27,600 --> 00:43:27,610
replication and charting okay okay so
 

1813
00:43:27,610 --> 00:43:30,090
replication and charting okay okay so
the highest level at which they're

1814
00:43:30,090 --> 00:43:30,100
the highest level at which they're
 

1815
00:43:30,100 --> 00:43:33,440
the highest level at which they're
playing this game is between regions and

1816
00:43:33,440 --> 00:43:33,450
playing this game is between regions and
 

1817
00:43:33,450 --> 00:43:36,720
playing this game is between regions and
so it at this high level each region has

1818
00:43:36,720 --> 00:43:36,730
so it at this high level each region has
 

1819
00:43:36,730 --> 00:43:38,870
so it at this high level each region has
a complete replica of all the data right

1820
00:43:38,870 --> 00:43:38,880
a complete replica of all the data right
 

1821
00:43:38,880 --> 00:43:41,190
a complete replica of all the data right
they have a each region as a complete

1822
00:43:41,190 --> 00:43:41,200
they have a each region as a complete
 

1823
00:43:41,200 --> 00:43:42,840
they have a each region as a complete
set of database servers each database

1824
00:43:42,840 --> 00:43:42,850
set of database servers each database
 

1825
00:43:42,850 --> 00:43:45,330
set of database servers each database
database corresponding database servers

1826
00:43:45,330 --> 00:43:45,340
database corresponding database servers
 

1827
00:43:45,340 --> 00:43:47,880
database corresponding database servers
for the same data and assuming users are

1828
00:43:47,880 --> 00:43:47,890
for the same data and assuming users are
 

1829
00:43:47,890 --> 00:43:49,140
for the same data and assuming users are
looking at more or less the same stuff

1830
00:43:49,140 --> 00:43:49,150
looking at more or less the same stuff
 

1831
00:43:49,150 --> 00:43:52,620
looking at more or less the same stuff
that means the memcache servers in the

1832
00:43:52,620 --> 00:43:52,630
that means the memcache servers in the
 

1833
00:43:52,630 --> 00:43:55,020
that means the memcache servers in the
different regions are also storing more

1834
00:43:55,020 --> 00:43:55,030
different regions are also storing more
 

1835
00:43:55,030 --> 00:43:57,570
different regions are also storing more
or less basically replicating where we

1836
00:43:57,570 --> 00:43:57,580
or less basically replicating where we
 

1837
00:43:57,580 --> 00:43:59,340
or less basically replicating where we
have yours replicating in both the

1838
00:43:59,340 --> 00:43:59,350
have yours replicating in both the
 

1839
00:43:59,350 --> 00:44:00,750
have yours replicating in both the
database servers and the memcache

1840
00:44:00,750 --> 00:44:00,760
database servers and the memcache
 

1841
00:44:00,760 --> 00:44:04,320
database servers and the memcache
servers and the point again one point is

1842
00:44:04,320 --> 00:44:04,330
servers and the point again one point is
 

1843
00:44:04,330 --> 00:44:09,390
servers and the point again one point is
to you want a complete copy of the site

1844
00:44:09,390 --> 00:44:09,400
to you want a complete copy of the site
 

1845
00:44:09,400 --> 00:44:11,580
to you want a complete copy of the site
that's close to West Coast users in the

1846
00:44:11,580 --> 00:44:11,590
that's close to West Coast users in the
 

1847
00:44:11,590 --> 00:44:13,950
that's close to West Coast users in the
internet load early in the internet and

1848
00:44:13,950 --> 00:44:13,960
internet load early in the internet and
 

1849
00:44:13,960 --> 00:44:16,020
internet load early in the internet and
another copy of the complete website

1850
00:44:16,020 --> 00:44:16,030
another copy of the complete website
 

1851
00:44:16,030 --> 00:44:18,450
another copy of the complete website
this close to users on the East Coast

1852
00:44:18,450 --> 00:44:18,460
this close to users on the East Coast
 

1853
00:44:18,460 --> 00:44:22,230
this close to users on the East Coast
close on the internet again and the

1854
00:44:22,230 --> 00:44:22,240
close on the internet again and the
 

1855
00:44:22,240 --> 00:44:23,850
close on the internet again and the
Internet's pretty fast but coast to

1856
00:44:23,850 --> 00:44:23,860
Internet's pretty fast but coast to
 

1857
00:44:23,860 --> 00:44:27,450
Internet's pretty fast but coast to
coast is you know 50 milliseconds or

1858
00:44:27,450 --> 00:44:27,460
coast is you know 50 milliseconds or
 

1859
00:44:27,460 --> 00:44:30,060
coast is you know 50 milliseconds or
something which if you do if users have

1860
00:44:30,060 --> 00:44:30,070
something which if you do if users have
 

1861
00:44:30,070 --> 00:44:31,760
something which if you do if users have
to wait too many 50 millisecond

1862
00:44:31,760 --> 00:44:31,770
to wait too many 50 millisecond
 

1863
00:44:31,770 --> 00:44:33,810
to wait too many 50 millisecond
intervals they'll start to notice that

1864
00:44:33,810 --> 00:44:33,820
intervals they'll start to notice that
 

1865
00:44:33,820 --> 00:44:36,870
intervals they'll start to notice that
amount of time another reason is that

1866
00:44:36,870 --> 00:44:36,880
amount of time another reason is that
 

1867
00:44:36,880 --> 00:44:42,790
amount of time another reason is that
the you wanna a reason to

1868
00:44:42,790 --> 00:44:42,800
the you wanna a reason to
 

1869
00:44:42,800 --> 00:44:44,920
the you wanna a reason to
applicate the data between the two

1870
00:44:44,920 --> 00:44:44,930
applicate the data between the two
 

1871
00:44:44,930 --> 00:44:48,190
applicate the data between the two
regions is that these front ends to even

1872
00:44:48,190 --> 00:44:48,200
regions is that these front ends to even
 

1873
00:44:48,200 --> 00:44:50,730
regions is that these front ends to even
create a single web page for user

1874
00:44:50,730 --> 00:44:50,740
create a single web page for user
 

1875
00:44:50,740 --> 00:44:53,830
create a single web page for user
requests often dozens or hundreds of

1876
00:44:53,830 --> 00:44:53,840
requests often dozens or hundreds of
 

1877
00:44:53,840 --> 00:44:55,870
requests often dozens or hundreds of
distinct data items from the cache or

1878
00:44:55,870 --> 00:44:55,880
distinct data items from the cache or
 

1879
00:44:55,880 --> 00:44:58,930
distinct data items from the cache or
the databases and so the speed the

1880
00:44:58,930 --> 00:44:58,940
the databases and so the speed the
 

1881
00:44:58,940 --> 00:45:00,910
the databases and so the speed the
latency the delay at which a front-end

1882
00:45:00,910 --> 00:45:00,920
latency the delay at which a front-end
 

1883
00:45:00,920 --> 00:45:03,760
latency the delay at which a front-end
can fetch these hundreds of items from

1884
00:45:03,760 --> 00:45:03,770
can fetch these hundreds of items from
 

1885
00:45:03,770 --> 00:45:05,410
can fetch these hundreds of items from
that from the look from the memcache key

1886
00:45:05,410 --> 00:45:05,420
that from the look from the memcache key
 

1887
00:45:05,420 --> 00:45:07,870
that from the look from the memcache key
is quite important and so it's extremely

1888
00:45:07,870 --> 00:45:07,880
is quite important and so it's extremely
 

1889
00:45:07,880 --> 00:45:10,600
is quite important and so it's extremely
important to have the front and only

1890
00:45:10,600 --> 00:45:10,610
important to have the front and only
 

1891
00:45:10,610 --> 00:45:15,070
important to have the front and only
talk to only read local memcache servers

1892
00:45:15,070 --> 00:45:15,080
talk to only read local memcache servers
 

1893
00:45:15,080 --> 00:45:17,950
talk to only read local memcache servers
and local databases so that you can do

1894
00:45:17,950 --> 00:45:17,960
and local databases so that you can do
 

1895
00:45:17,960 --> 00:45:19,150
and local databases so that you can do
the hundreds of queries it needs to do

1896
00:45:19,150 --> 00:45:19,160
the hundreds of queries it needs to do
 

1897
00:45:19,160 --> 00:45:21,340
the hundreds of queries it needs to do
for a web page very rapidly so if we

1898
00:45:21,340 --> 00:45:21,350
for a web page very rapidly so if we
 

1899
00:45:21,350 --> 00:45:23,080
for a web page very rapidly so if we
have partitioned the data between the

1900
00:45:23,080 --> 00:45:23,090
have partitioned the data between the
 

1901
00:45:23,090 --> 00:45:27,100
have partitioned the data between the
two regions then a front-end you know if

1902
00:45:27,100 --> 00:45:27,110
two regions then a front-end you know if
 

1903
00:45:27,110 --> 00:45:28,870
two regions then a front-end you know if
I'm looking at my friends and some of my

1904
00:45:28,870 --> 00:45:28,880
I'm looking at my friends and some of my
 

1905
00:45:28,880 --> 00:45:29,980
I'm looking at my friends and some of my
friends are on the East Coast and some

1906
00:45:29,980 --> 00:45:29,990
friends are on the East Coast and some
 

1907
00:45:29,990 --> 00:45:31,870
friends are on the East Coast and some
on the west coast that means if we

1908
00:45:31,870 --> 00:45:31,880
on the west coast that means if we
 

1909
00:45:31,880 --> 00:45:33,850
on the west coast that means if we
partitioned that would might require the

1910
00:45:33,850 --> 00:45:33,860
partitioned that would might require the
 

1911
00:45:33,860 --> 00:45:37,110
partitioned that would might require the
front ends to actually make many

1912
00:45:37,110 --> 00:45:37,120
front ends to actually make many
 

1913
00:45:37,120 --> 00:45:39,810
front ends to actually make many
requests you know 50 milliseconds each

1914
00:45:39,810 --> 00:45:39,820
requests you know 50 milliseconds each
 

1915
00:45:39,820 --> 00:45:45,270
requests you know 50 milliseconds each
to the other data center and users would

1916
00:45:45,270 --> 00:45:45,280
to the other data center and users would
 

1917
00:45:45,280 --> 00:45:49,270
to the other data center and users would
users would see this kind of latency and

1918
00:45:49,270 --> 00:45:49,280
users would see this kind of latency and
 

1919
00:45:49,280 --> 00:45:52,120
users would see this kind of latency and
be very upset so so the reason to

1920
00:45:52,120 --> 00:45:52,130
be very upset so so the reason to
 

1921
00:45:52,130 --> 00:45:53,710
be very upset so so the reason to
another reason to replicate is to keep

1922
00:45:53,710 --> 00:45:53,720
another reason to replicate is to keep
 

1923
00:45:53,720 --> 00:45:56,290
another reason to replicate is to keep
the front ends always close to the data

1924
00:45:56,290 --> 00:45:56,300
the front ends always close to the data
 

1925
00:45:56,300 --> 00:46:00,130
the front ends always close to the data
to all the data they need of course this

1926
00:46:00,130 --> 00:46:00,140
to all the data they need of course this
 

1927
00:46:00,140 --> 00:46:01,450
to all the data they need of course this
makes writes more expensive because now

1928
00:46:01,450 --> 00:46:01,460
makes writes more expensive because now
 

1929
00:46:01,460 --> 00:46:03,490
makes writes more expensive because now
if a front-end and the secondary region

1930
00:46:03,490 --> 00:46:03,500
if a front-end and the secondary region
 

1931
00:46:03,500 --> 00:46:05,350
if a front-end and the secondary region
needs to write in estes send the data

1932
00:46:05,350 --> 00:46:05,360
needs to write in estes send the data
 

1933
00:46:05,360 --> 00:46:07,930
needs to write in estes send the data
all the way across the internet the

1934
00:46:07,930 --> 00:46:07,940
all the way across the internet the
 

1935
00:46:07,940 --> 00:46:10,360
all the way across the internet the
reads are far far more frequent than

1936
00:46:10,360 --> 00:46:10,370
reads are far far more frequent than
 

1937
00:46:10,370 --> 00:46:13,840
reads are far far more frequent than
right so it's a good trade-off although

1938
00:46:13,840 --> 00:46:13,850
right so it's a good trade-off although
 

1939
00:46:13,850 --> 00:46:15,340
right so it's a good trade-off although
the paper doesn't mention it it's

1940
00:46:15,340 --> 00:46:15,350
the paper doesn't mention it it's
 

1941
00:46:15,350 --> 00:46:18,190
the paper doesn't mention it it's
possible that another reason for

1942
00:46:18,190 --> 00:46:18,200
possible that another reason for
 

1943
00:46:18,200 --> 00:46:20,170
possible that another reason for
complete replication between the two

1944
00:46:20,170 --> 00:46:20,180
complete replication between the two
 

1945
00:46:20,180 --> 00:46:23,710
complete replication between the two
sites is so that if the primary site

1946
00:46:23,710 --> 00:46:23,720
sites is so that if the primary site
 

1947
00:46:23,720 --> 00:46:26,020
sites is so that if the primary site
goes down perhaps they could switch the

1948
00:46:26,020 --> 00:46:26,030
goes down perhaps they could switch the
 

1949
00:46:26,030 --> 00:46:27,550
goes down perhaps they could switch the
whole operation to the secondary site

1950
00:46:27,550 --> 00:46:27,560
whole operation to the secondary site
 

1951
00:46:27,560 --> 00:46:29,350
whole operation to the secondary site
but I don't know if they had that in

1952
00:46:29,350 --> 00:46:29,360
but I don't know if they had that in
 

1953
00:46:29,360 --> 00:46:34,880
but I don't know if they had that in
mind

1954
00:46:34,880 --> 00:46:34,890

 

1955
00:46:34,890 --> 00:46:38,640

okay so this is the story between

1956
00:46:38,640 --> 00:46:38,650
okay so this is the story between
 

1957
00:46:38,650 --> 00:46:40,349
okay so this is the story between
Regents is basically a story of

1958
00:46:40,349 --> 00:46:40,359
Regents is basically a story of
 

1959
00:46:40,359 --> 00:46:48,140
Regents is basically a story of
replication between the two data centers

1960
00:46:48,140 --> 00:46:48,150

 

1961
00:46:48,150 --> 00:46:51,229

all right now within a data center

1962
00:46:51,229 --> 00:46:51,239
all right now within a data center
 

1963
00:46:51,239 --> 00:47:00,259
all right now within a data center
within a region so in each region

1964
00:47:00,259 --> 00:47:00,269
within a region so in each region
 

1965
00:47:00,269 --> 00:47:07,610
within a region so in each region
there's a single set of database servers

1966
00:47:07,610 --> 00:47:07,620

 

1967
00:47:07,620 --> 00:47:11,890

so at the database level the data is

1968
00:47:11,890 --> 00:47:11,900
so at the database level the data is
 

1969
00:47:11,900 --> 00:47:14,900
so at the database level the data is
charted and not replicated inside each

1970
00:47:14,900 --> 00:47:14,910
charted and not replicated inside each
 

1971
00:47:14,910 --> 00:47:19,430
charted and not replicated inside each
region however at the memcache level

1972
00:47:19,430 --> 00:47:19,440
region however at the memcache level
 

1973
00:47:19,440 --> 00:47:21,050
region however at the memcache level
they actually use replication as well as

1974
00:47:21,050 --> 00:47:21,060
they actually use replication as well as
 

1975
00:47:21,060 --> 00:47:22,580
they actually use replication as well as
charting so they had this notion of

1976
00:47:22,580 --> 00:47:22,590
charting so they had this notion of
 

1977
00:47:22,590 --> 00:47:26,180
charting so they had this notion of
clusters so a given regions actually

1978
00:47:26,180 --> 00:47:26,190
clusters so a given regions actually
 

1979
00:47:26,190 --> 00:47:29,810
clusters so a given regions actually
supports multiple clusters of front-ends

1980
00:47:29,810 --> 00:47:29,820
supports multiple clusters of front-ends
 

1981
00:47:29,820 --> 00:47:31,670
supports multiple clusters of front-ends
and database servers so here I'm going

1982
00:47:31,670 --> 00:47:31,680
and database servers so here I'm going
 

1983
00:47:31,680 --> 00:47:34,010
and database servers so here I'm going
to have two clusters in this region this

1984
00:47:34,010 --> 00:47:34,020
to have two clusters in this region this
 

1985
00:47:34,020 --> 00:47:35,660
to have two clusters in this region this
cluster has a you know a bunch of front

1986
00:47:35,660 --> 00:47:35,670
cluster has a you know a bunch of front
 

1987
00:47:35,670 --> 00:47:40,930
cluster has a you know a bunch of front
ends and a bunch of memcache servers and

1988
00:47:40,930 --> 00:47:40,940
ends and a bunch of memcache servers and
 

1989
00:47:40,940 --> 00:47:45,680
ends and a bunch of memcache servers and
these are completely independent almost

1990
00:47:45,680 --> 00:47:45,690
these are completely independent almost
 

1991
00:47:45,690 --> 00:47:46,940
these are completely independent almost
completely independent so that a

1992
00:47:46,940 --> 00:47:46,950
completely independent so that a
 

1993
00:47:46,950 --> 00:47:49,430
completely independent so that a
front-end and cluster one sends all its

1994
00:47:49,430 --> 00:47:49,440
front-end and cluster one sends all its
 

1995
00:47:49,440 --> 00:47:51,980
front-end and cluster one sends all its
reads to the local memcache servers and

1996
00:47:51,980 --> 00:47:51,990
reads to the local memcache servers and
 

1997
00:47:51,990 --> 00:47:54,290
reads to the local memcache servers and
misses it needs to go to the one instead

1998
00:47:54,290 --> 00:47:54,300
misses it needs to go to the one instead
 

1999
00:47:54,300 --> 00:47:57,470
misses it needs to go to the one instead
of database servers and similarly each

2000
00:47:57,470 --> 00:47:57,480
of database servers and similarly each
 

2001
00:47:57,480 --> 00:48:02,670
of database servers and similarly each
front-end in this cluster

2002
00:48:02,670 --> 00:48:02,680

 

2003
00:48:02,680 --> 00:48:06,070

talks only to memcache servers in the

2004
00:48:06,070 --> 00:48:06,080
talks only to memcache servers in the
 

2005
00:48:06,080 --> 00:48:11,470
talks only to memcache servers in the
same cluster so why do they have this

2006
00:48:11,470 --> 00:48:11,480
same cluster so why do they have this
 

2007
00:48:11,480 --> 00:48:15,370
same cluster so why do they have this
multiple clusters why not just have you

2008
00:48:15,370 --> 00:48:15,380
multiple clusters why not just have you
 

2009
00:48:15,380 --> 00:48:16,570
multiple clusters why not just have you
know essentially a single cluster a

2010
00:48:16,570 --> 00:48:16,580
know essentially a single cluster a
 

2011
00:48:16,580 --> 00:48:18,520
know essentially a single cluster a
single set of front end servers and a

2012
00:48:18,520 --> 00:48:18,530
single set of front end servers and a
 

2013
00:48:18,530 --> 00:48:20,680
single set of front end servers and a
single set of memcache server is shared

2014
00:48:20,680 --> 00:48:20,690
single set of memcache server is shared
 

2015
00:48:20,690 --> 00:48:24,130
single set of memcache server is shared
by all those front ends one is that if

2016
00:48:24,130 --> 00:48:24,140
by all those front ends one is that if
 

2017
00:48:24,140 --> 00:48:26,170
by all those front ends one is that if
you did that and and that would mean you

2018
00:48:26,170 --> 00:48:26,180
you did that and and that would mean you
 

2019
00:48:26,180 --> 00:48:27,820
you did that and and that would mean you
know if you need to scale up capacity

2020
00:48:27,820 --> 00:48:27,830
know if you need to scale up capacity
 

2021
00:48:27,830 --> 00:48:29,350
know if you need to scale up capacity
you sort of be adding more and more

2022
00:48:29,350 --> 00:48:29,360
you sort of be adding more and more
 

2023
00:48:29,360 --> 00:48:31,810
you sort of be adding more and more
memcache servers in front ends to the

2024
00:48:31,810 --> 00:48:31,820
memcache servers in front ends to the
 

2025
00:48:31,820 --> 00:48:36,220
memcache servers in front ends to the
same cluster you don't get any win

2026
00:48:36,220 --> 00:48:36,230
same cluster you don't get any win
 

2027
00:48:36,230 --> 00:48:38,980
same cluster you don't get any win
therefore in performance for popular

2028
00:48:38,980 --> 00:48:38,990
therefore in performance for popular
 

2029
00:48:38,990 --> 00:48:43,090
therefore in performance for popular
Keys you know so there the data sort of

2030
00:48:43,090 --> 00:48:43,100
Keys you know so there the data sort of
 

2031
00:48:43,100 --> 00:48:44,560
Keys you know so there the data sort of
this memcache service is sort of a mix

2032
00:48:44,560 --> 00:48:44,570
this memcache service is sort of a mix
 

2033
00:48:44,570 --> 00:48:46,390
this memcache service is sort of a mix
you know most of it is maybe only used

2034
00:48:46,390 --> 00:48:46,400
you know most of it is maybe only used
 

2035
00:48:46,400 --> 00:48:48,130
you know most of it is maybe only used
by a small number of users but there's

2036
00:48:48,130 --> 00:48:48,140
by a small number of users but there's
 

2037
00:48:48,140 --> 00:48:49,780
by a small number of users but there's
some stuff there that lots and lots of

2038
00:48:49,780 --> 00:48:49,790
some stuff there that lots and lots of
 

2039
00:48:49,790 --> 00:48:52,060
some stuff there that lots and lots of
users need to look at and by using

2040
00:48:52,060 --> 00:48:52,070
users need to look at and by using
 

2041
00:48:52,070 --> 00:48:55,360
users need to look at and by using
replication as well as sharding they get

2042
00:48:55,360 --> 00:48:55,370
replication as well as sharding they get
 

2043
00:48:55,370 --> 00:48:57,910
replication as well as sharding they get
you know multiple copies of the very

2044
00:48:57,910 --> 00:48:57,920
you know multiple copies of the very
 

2045
00:48:57,920 --> 00:49:00,790
you know multiple copies of the very
popular keys and therefore they get sort

2046
00:49:00,790 --> 00:49:00,800
popular keys and therefore they get sort
 

2047
00:49:00,800 --> 00:49:02,760
popular keys and therefore they get sort
of parallel serving of those keys

2048
00:49:02,760 --> 00:49:02,770
of parallel serving of those keys
 

2049
00:49:02,770 --> 00:49:07,870
of parallel serving of those keys
between the different clusters another

2050
00:49:07,870 --> 00:49:07,880
between the different clusters another
 

2051
00:49:07,880 --> 00:49:11,350
between the different clusters another
reason to not want to increase the size

2052
00:49:11,350 --> 00:49:11,360
reason to not want to increase the size
 

2053
00:49:11,360 --> 00:49:13,330
reason to not want to increase the size
of the cluster individual cluster too

2054
00:49:13,330 --> 00:49:13,340
of the cluster individual cluster too
 

2055
00:49:13,340 --> 00:49:16,420
of the cluster individual cluster too
much is that all the data within a

2056
00:49:16,420 --> 00:49:16,430
much is that all the data within a
 

2057
00:49:16,430 --> 00:49:19,540
much is that all the data within a
cluster is spread over partitioned over

2058
00:49:19,540 --> 00:49:19,550
cluster is spread over partitioned over
 

2059
00:49:19,550 --> 00:49:21,790
cluster is spread over partitioned over
all the memcache servers and any one

2060
00:49:21,790 --> 00:49:21,800
all the memcache servers and any one
 

2061
00:49:21,800 --> 00:49:23,770
all the memcache servers and any one
front end is typically actually going to

2062
00:49:23,770 --> 00:49:23,780
front end is typically actually going to
 

2063
00:49:23,780 --> 00:49:26,410
front end is typically actually going to
need data from probably every single

2064
00:49:26,410 --> 00:49:26,420
need data from probably every single
 

2065
00:49:26,420 --> 00:49:30,640
need data from probably every single
memcache server eventually and so this

2066
00:49:30,640 --> 00:49:30,650
memcache server eventually and so this
 

2067
00:49:30,650 --> 00:49:31,630
memcache server eventually and so this
means you have a sort of n-squared

2068
00:49:31,630 --> 00:49:31,640
means you have a sort of n-squared
 

2069
00:49:31,640 --> 00:49:33,370
means you have a sort of n-squared
communication pattern between the front

2070
00:49:33,370 --> 00:49:33,380
communication pattern between the front
 

2071
00:49:33,380 --> 00:49:38,050
communication pattern between the front
ends and the memcache servers and to the

2072
00:49:38,050 --> 00:49:38,060
ends and the memcache servers and to the
 

2073
00:49:38,060 --> 00:49:39,580
ends and the memcache servers and to the
extent that they're using TCP for the

2074
00:49:39,580 --> 00:49:39,590
extent that they're using TCP for the
 

2075
00:49:39,590 --> 00:49:41,350
extent that they're using TCP for the
communication that involves a lot of

2076
00:49:41,350 --> 00:49:41,360
communication that involves a lot of
 

2077
00:49:41,360 --> 00:49:44,170
communication that involves a lot of
overhead a lot of sort of connection

2078
00:49:44,170 --> 00:49:44,180
overhead a lot of sort of connection
 

2079
00:49:44,180 --> 00:49:46,330
overhead a lot of sort of connection
state for all the different TCP so they

2080
00:49:46,330 --> 00:49:46,340
state for all the different TCP so they
 

2081
00:49:46,340 --> 00:49:50,110
state for all the different TCP so they
wanted to limit so you know this is N

2082
00:49:50,110 --> 00:49:50,120
wanted to limit so you know this is N
 

2083
00:49:50,120 --> 00:49:55,390
wanted to limit so you know this is N
squared CCP's they want to limit the

2084
00:49:55,390 --> 00:49:55,400
squared CCP's they want to limit the
 

2085
00:49:55,400 --> 00:49:57,430
squared CCP's they want to limit the
growth of this and the way to do that is

2086
00:49:57,430 --> 00:49:57,440
growth of this and the way to do that is
 

2087
00:49:57,440 --> 00:49:58,960
growth of this and the way to do that is
to make sure that no one cluster gets to

2088
00:49:58,960 --> 00:49:58,970
to make sure that no one cluster gets to
 

2089
00:49:58,970 --> 00:50:01,630
to make sure that no one cluster gets to
be too big so this N squared doesn't get

2090
00:50:01,630 --> 00:50:01,640
be too big so this N squared doesn't get
 

2091
00:50:01,640 --> 00:50:09,000
be too big so this N squared doesn't get
too large

2092
00:50:09,000 --> 00:50:09,010

 

2093
00:50:09,010 --> 00:50:13,050

and well related to that is this in

2094
00:50:13,050 --> 00:50:13,060
and well related to that is this in
 

2095
00:50:13,060 --> 00:50:14,730
and well related to that is this in
caste congestion business they're

2096
00:50:14,730 --> 00:50:14,740
caste congestion business they're
 

2097
00:50:14,740 --> 00:50:17,280
caste congestion business they're
talking about the if a frontman needs

2098
00:50:17,280 --> 00:50:17,290
talking about the if a frontman needs
 

2099
00:50:17,290 --> 00:50:20,520
talking about the if a frontman needs
data from lots of memcache servers it's

2100
00:50:20,520 --> 00:50:20,530
data from lots of memcache servers it's
 

2101
00:50:20,530 --> 00:50:21,660
data from lots of memcache servers it's
actually it's gonna send out the

2102
00:50:21,660 --> 00:50:21,670
actually it's gonna send out the
 

2103
00:50:21,670 --> 00:50:23,280
actually it's gonna send out the
requests more or less all at the same

2104
00:50:23,280 --> 00:50:23,290
requests more or less all at the same
 

2105
00:50:23,290 --> 00:50:25,260
requests more or less all at the same
time and that means this front-end is

2106
00:50:25,260 --> 00:50:25,270
time and that means this front-end is
 

2107
00:50:25,270 --> 00:50:26,850
time and that means this front-end is
gonna get the responses from all the

2108
00:50:26,850 --> 00:50:26,860
gonna get the responses from all the
 

2109
00:50:26,860 --> 00:50:28,470
gonna get the responses from all the
memcache servers to query it more or

2110
00:50:28,470 --> 00:50:28,480
memcache servers to query it more or
 

2111
00:50:28,480 --> 00:50:30,510
memcache servers to query it more or
less the same side time and that may

2112
00:50:30,510 --> 00:50:30,520
less the same side time and that may
 

2113
00:50:30,520 --> 00:50:32,160
less the same side time and that may
mean dozens or hundreds of packets

2114
00:50:32,160 --> 00:50:32,170
mean dozens or hundreds of packets
 

2115
00:50:32,170 --> 00:50:34,620
mean dozens or hundreds of packets
arriving here all at the same time which

2116
00:50:34,620 --> 00:50:34,630
arriving here all at the same time which
 

2117
00:50:34,630 --> 00:50:36,690
arriving here all at the same time which
if you're not careful we'll cause packet

2118
00:50:36,690 --> 00:50:36,700
if you're not careful we'll cause packet
 

2119
00:50:36,700 --> 00:50:41,880
if you're not careful we'll cause packet
losses that's in caste congestion and in

2120
00:50:41,880 --> 00:50:41,890
losses that's in caste congestion and in
 

2121
00:50:41,890 --> 00:50:43,500
losses that's in caste congestion and in
order to limit how bad that was that you

2122
00:50:43,500 --> 00:50:43,510
order to limit how bad that was that you
 

2123
00:50:43,510 --> 00:50:44,730
order to limit how bad that was that you
had a bunch of techniques they talked

2124
00:50:44,730 --> 00:50:44,740
had a bunch of techniques they talked
 

2125
00:50:44,740 --> 00:50:47,100
had a bunch of techniques they talked
about but one of them was not making the

2126
00:50:47,100 --> 00:50:47,110
about but one of them was not making the
 

2127
00:50:47,110 --> 00:50:49,140
about but one of them was not making the
clusters too large so that the number of

2128
00:50:49,140 --> 00:50:49,150
clusters too large so that the number of
 

2129
00:50:49,150 --> 00:50:51,510
clusters too large so that the number of
memcache has given front-end tend to

2130
00:50:51,510 --> 00:50:51,520
memcache has given front-end tend to
 

2131
00:50:51,520 --> 00:50:53,640
memcache has given front-end tend to
talk to and they might be contributing

2132
00:50:53,640 --> 00:50:53,650
talk to and they might be contributing
 

2133
00:50:53,650 --> 00:50:55,980
talk to and they might be contributing
to the same caste never got to be too

2134
00:50:55,980 --> 00:50:55,990
to the same caste never got to be too
 

2135
00:50:55,990 --> 00:50:59,640
to the same caste never got to be too
large and a final reason the paper

2136
00:50:59,640 --> 00:50:59,650
large and a final reason the paper
 

2137
00:50:59,650 --> 00:51:02,190
large and a final reason the paper
mentions is that it's or behind this is

2138
00:51:02,190 --> 00:51:02,200
mentions is that it's or behind this is
 

2139
00:51:02,200 --> 00:51:04,980
mentions is that it's or behind this is
is a big network in the data center and

2140
00:51:04,980 --> 00:51:04,990
is a big network in the data center and
 

2141
00:51:04,990 --> 00:51:08,610
is a big network in the data center and
it's hard to build networks that are

2142
00:51:08,610 --> 00:51:08,620
it's hard to build networks that are
 

2143
00:51:08,620 --> 00:51:11,850
it's hard to build networks that are
both fast like many bits per second and

2144
00:51:11,850 --> 00:51:11,860
both fast like many bits per second and
 

2145
00:51:11,860 --> 00:51:13,860
both fast like many bits per second and
can talk to lots and lots of different

2146
00:51:13,860 --> 00:51:13,870
can talk to lots and lots of different
 

2147
00:51:13,870 --> 00:51:16,470
can talk to lots and lots of different
computers and by splitting the data

2148
00:51:16,470 --> 00:51:16,480
computers and by splitting the data
 

2149
00:51:16,480 --> 00:51:19,200
computers and by splitting the data
center up into these clusters and having

2150
00:51:19,200 --> 00:51:19,210
center up into these clusters and having
 

2151
00:51:19,210 --> 00:51:20,790
center up into these clusters and having
most of the communication go on just

2152
00:51:20,790 --> 00:51:20,800
most of the communication go on just
 

2153
00:51:20,800 --> 00:51:22,710
most of the communication go on just
within each cluster that means they need

2154
00:51:22,710 --> 00:51:22,720
within each cluster that means they need
 

2155
00:51:22,720 --> 00:51:25,200
within each cluster that means they need
a smaller they need you know a modest

2156
00:51:25,200 --> 00:51:25,210
a smaller they need you know a modest
 

2157
00:51:25,210 --> 00:51:27,360
a smaller they need you know a modest
size fast Network for this cluster and a

2158
00:51:27,360 --> 00:51:27,370
size fast Network for this cluster and a
 

2159
00:51:27,370 --> 00:51:29,040
size fast Network for this cluster and a
modest size you know reasonably fast

2160
00:51:29,040 --> 00:51:29,050
modest size you know reasonably fast
 

2161
00:51:29,050 --> 00:51:30,390
modest size you know reasonably fast
network for this cluster but they don't

2162
00:51:30,390 --> 00:51:30,400
network for this cluster but they don't
 

2163
00:51:30,400 --> 00:51:32,040
network for this cluster but they don't
have to build a single network that can

2164
00:51:32,040 --> 00:51:32,050
have to build a single network that can
 

2165
00:51:32,050 --> 00:51:34,280
have to build a single network that can
sort of handle all of the traffic

2166
00:51:34,280 --> 00:51:34,290
sort of handle all of the traffic
 

2167
00:51:34,290 --> 00:51:37,080
sort of handle all of the traffic
between among all the computers of the

2168
00:51:37,080 --> 00:51:37,090
between among all the computers of the
 

2169
00:51:37,090 --> 00:51:41,210
between among all the computers of the
giant cluster so it limits how expensive

2170
00:51:41,210 --> 00:51:41,220
giant cluster so it limits how expensive
 

2171
00:51:41,220 --> 00:51:44,610
giant cluster so it limits how expensive
underlying network is on the other hand

2172
00:51:44,610 --> 00:51:44,620
underlying network is on the other hand
 

2173
00:51:44,620 --> 00:51:46,140
underlying network is on the other hand
of course they're replicating the data

2174
00:51:46,140 --> 00:51:46,150
of course they're replicating the data
 

2175
00:51:46,150 --> 00:51:50,010
of course they're replicating the data
and the two clusters and for items that

2176
00:51:50,010 --> 00:51:50,020
and the two clusters and for items that
 

2177
00:51:50,020 --> 00:51:51,420
and the two clusters and for items that
aren't very popular and aren't really

2178
00:51:51,420 --> 00:51:51,430
aren't very popular and aren't really
 

2179
00:51:51,430 --> 00:51:53,490
aren't very popular and aren't really
going to benefit from the performance

2180
00:51:53,490 --> 00:51:53,500
going to benefit from the performance
 

2181
00:51:53,500 --> 00:51:58,110
going to benefit from the performance
win of having multiple copies this it's

2182
00:51:58,110 --> 00:51:58,120
win of having multiple copies this it's
 

2183
00:51:58,120 --> 00:52:00,360
win of having multiple copies this it's
wasteful to sit on all this RAM and you

2184
00:52:00,360 --> 00:52:00,370
wasteful to sit on all this RAM and you
 

2185
00:52:00,370 --> 00:52:01,440
wasteful to sit on all this RAM and you
know we're talking about hundreds or

2186
00:52:01,440 --> 00:52:01,450
know we're talking about hundreds or
 

2187
00:52:01,450 --> 00:52:03,690
know we're talking about hundreds or
thousands of servers so the amount of

2188
00:52:03,690 --> 00:52:03,700
thousands of servers so the amount of
 

2189
00:52:03,700 --> 00:52:05,100
thousands of servers so the amount of
money they spent on RAM for the memcache

2190
00:52:05,100 --> 00:52:05,110
money they spent on RAM for the memcache
 

2191
00:52:05,110 --> 00:52:10,530
money they spent on RAM for the memcache
services is no joke so in addition to

2192
00:52:10,530 --> 00:52:10,540
services is no joke so in addition to
 

2193
00:52:10,540 --> 00:52:13,980
services is no joke so in addition to
the pool of memcache servers inside each

2194
00:52:13,980 --> 00:52:13,990
the pool of memcache servers inside each
 

2195
00:52:13,990 --> 00:52:17,210
the pool of memcache servers inside each
cluster there's also this regional pool

2196
00:52:17,210 --> 00:52:17,220
cluster there's also this regional pool
 

2197
00:52:17,220 --> 00:52:20,670
cluster there's also this regional pool
of memcache servers that's

2198
00:52:20,670 --> 00:52:20,680
of memcache servers that's
 

2199
00:52:20,680 --> 00:52:23,099
of memcache servers that's
shared by all the clusters in a region

2200
00:52:23,099 --> 00:52:23,109
shared by all the clusters in a region
 

2201
00:52:23,109 --> 00:52:28,319
shared by all the clusters in a region
and into this regional pool they then

2202
00:52:28,319 --> 00:52:28,329
and into this regional pool they then
 

2203
00:52:28,329 --> 00:52:30,599
and into this regional pool they then
modify the software on the front end so

2204
00:52:30,599 --> 00:52:30,609
modify the software on the front end so
 

2205
00:52:30,609 --> 00:52:32,069
modify the software on the front end so
that the software on the front end knows

2206
00:52:32,069 --> 00:52:32,079
that the software on the front end knows
 

2207
00:52:32,079 --> 00:52:32,880
that the software on the front end knows
aha

2208
00:52:32,880 --> 00:52:32,890
aha
 

2209
00:52:32,890 --> 00:52:35,970
aha
this key the data for this skis actually

2210
00:52:35,970 --> 00:52:35,980
this key the data for this skis actually
 

2211
00:52:35,980 --> 00:52:38,280
this key the data for this skis actually
not use that often instead of storing it

2212
00:52:38,280 --> 00:52:38,290
not use that often instead of storing it
 

2213
00:52:38,290 --> 00:52:41,400
not use that often instead of storing it
on a memcache server my own cluster I'm

2214
00:52:41,400 --> 00:52:41,410
on a memcache server my own cluster I'm
 

2215
00:52:41,410 --> 00:52:43,290
on a memcache server my own cluster I'm
going to store this not very popular key

2216
00:52:43,290 --> 00:52:43,300
going to store this not very popular key
 

2217
00:52:43,300 --> 00:52:47,730
going to store this not very popular key
in the appropriate memcache server of

2218
00:52:47,730 --> 00:52:47,740
in the appropriate memcache server of
 

2219
00:52:47,740 --> 00:52:55,470
in the appropriate memcache server of
the regional pool so this is

2220
00:52:55,470 --> 00:52:55,480

 

2221
00:52:55,480 --> 00:53:00,359

the regional pool and this is just sort

2222
00:53:00,359 --> 00:53:00,369
the regional pool and this is just sort
 

2223
00:53:00,369 --> 00:53:02,329
the regional pool and this is just sort
of an admission that some data is not

2224
00:53:02,329 --> 00:53:02,339
of an admission that some data is not
 

2225
00:53:02,339 --> 00:53:04,410
of an admission that some data is not
popular enough to want to have lots of

2226
00:53:04,410 --> 00:53:04,420
popular enough to want to have lots of
 

2227
00:53:04,420 --> 00:53:06,660
popular enough to want to have lots of
replicas of it they can save money by

2228
00:53:06,660 --> 00:53:06,670
replicas of it they can save money by
 

2229
00:53:06,670 --> 00:53:14,160
replicas of it they can save money by
only cashing a single copy all right so

2230
00:53:14,160 --> 00:53:14,170
only cashing a single copy all right so
 

2231
00:53:14,170 --> 00:53:15,510
only cashing a single copy all right so
that's how they get that's this kind of

2232
00:53:15,510 --> 00:53:15,520
that's how they get that's this kind of
 

2233
00:53:15,520 --> 00:53:18,890
that's how they get that's this kind of
Carol replication versus partitioning

2234
00:53:18,890 --> 00:53:18,900
Carol replication versus partitioning
 

2235
00:53:18,900 --> 00:53:22,589
Carol replication versus partitioning
strategy they use inside each inside

2236
00:53:22,589 --> 00:53:22,599
strategy they use inside each inside
 

2237
00:53:22,599 --> 00:53:26,160
strategy they use inside each inside
each region a difficulty they had that

2238
00:53:26,160 --> 00:53:26,170
each region a difficulty they had that
 

2239
00:53:26,170 --> 00:53:28,760
each region a difficulty they had that
they discuss is that when they want to

2240
00:53:28,760 --> 00:53:28,770
they discuss is that when they want to
 

2241
00:53:28,770 --> 00:53:32,069
they discuss is that when they want to
create a new cluster in a data center

2242
00:53:32,069 --> 00:53:32,079
create a new cluster in a data center
 

2243
00:53:32,079 --> 00:53:34,500
create a new cluster in a data center
they actually have a sort of temporary

2244
00:53:34,500 --> 00:53:34,510
they actually have a sort of temporary
 

2245
00:53:34,510 --> 00:53:36,690
they actually have a sort of temporary
performance problem as they're getting

2246
00:53:36,690 --> 00:53:36,700
performance problem as they're getting
 

2247
00:53:36,700 --> 00:53:38,910
performance problem as they're getting
that cluster going so you know supposing

2248
00:53:38,910 --> 00:53:38,920
that cluster going so you know supposing
 

2249
00:53:38,920 --> 00:53:41,220
that cluster going so you know supposing
they decide to install you know couple

2250
00:53:41,220 --> 00:53:41,230
they decide to install you know couple
 

2251
00:53:41,230 --> 00:53:42,960
they decide to install you know couple
hundred machines to be a new cluster

2252
00:53:42,960 --> 00:53:42,970
hundred machines to be a new cluster
 

2253
00:53:42,970 --> 00:53:44,789
hundred machines to be a new cluster
with the front end new front ends new

2254
00:53:44,789 --> 00:53:44,799
with the front end new front ends new
 

2255
00:53:44,799 --> 00:53:47,819
with the front end new front ends new
memcache errors and then they fire it up

2256
00:53:47,819 --> 00:53:47,829
memcache errors and then they fire it up
 

2257
00:53:47,829 --> 00:53:50,160
memcache errors and then they fire it up
and you know maybe cause half the users

2258
00:53:50,160 --> 00:53:50,170
and you know maybe cause half the users
 

2259
00:53:50,170 --> 00:53:52,620
and you know maybe cause half the users
to start using the new cluster I'm gonna

2260
00:53:52,620 --> 00:53:52,630
to start using the new cluster I'm gonna
 

2261
00:53:52,630 --> 00:53:55,020
to start using the new cluster I'm gonna
have to use the old cluster well in the

2262
00:53:55,020 --> 00:53:55,030
have to use the old cluster well in the
 

2263
00:53:55,030 --> 00:53:56,700
have to use the old cluster well in the
beginning there's nothing in these

2264
00:53:56,700 --> 00:53:56,710
beginning there's nothing in these
 

2265
00:53:56,710 --> 00:53:59,010
beginning there's nothing in these
memcache servers and all the front end

2266
00:53:59,010 --> 00:53:59,020
memcache servers and all the front end
 

2267
00:53:59,020 --> 00:54:00,210
memcache servers and all the front end
servers are gonna miss on the memcache

2268
00:54:00,210 --> 00:54:00,220
servers are gonna miss on the memcache
 

2269
00:54:00,220 --> 00:54:04,380
servers are gonna miss on the memcache
servers and have to go to the databases

2270
00:54:04,380 --> 00:54:04,390
servers and have to go to the databases
 

2271
00:54:04,390 --> 00:54:06,720
servers and have to go to the databases
and at least at the beginning until

2272
00:54:06,720 --> 00:54:06,730
and at least at the beginning until
 

2273
00:54:06,730 --> 00:54:08,400
and at least at the beginning until
these memcache service gets populated

2274
00:54:08,400 --> 00:54:08,410
these memcache service gets populated
 

2275
00:54:08,410 --> 00:54:10,650
these memcache service gets populated
with all the sort of data that's used a

2276
00:54:10,650 --> 00:54:10,660
with all the sort of data that's used a
 

2277
00:54:10,660 --> 00:54:12,930
with all the sort of data that's used a
lot this is gonna increase the load on

2278
00:54:12,930 --> 00:54:12,940
lot this is gonna increase the load on
 

2279
00:54:12,940 --> 00:54:15,000
lot this is gonna increase the load on
the database servers absolutely enormous

2280
00:54:15,000 --> 00:54:15,010
the database servers absolutely enormous
 

2281
00:54:15,010 --> 00:54:18,089
the database servers absolutely enormous
leap because before we added the new

2282
00:54:18,089 --> 00:54:18,099
leap because before we added the new
 

2283
00:54:18,099 --> 00:54:19,859
leap because before we added the new
clusters maybe the database servers only

2284
00:54:19,859 --> 00:54:19,869
clusters maybe the database servers only
 

2285
00:54:19,869 --> 00:54:22,589
clusters maybe the database servers only
saw one percent of the reads because

2286
00:54:22,589 --> 00:54:22,599
saw one percent of the reads because
 

2287
00:54:22,599 --> 00:54:24,270
saw one percent of the reads because
maybe these memcache servers have a hit

2288
00:54:24,270 --> 00:54:24,280
maybe these memcache servers have a hit
 

2289
00:54:24,280 --> 00:54:27,059
maybe these memcache servers have a hit
rate of say 99 percent for reads the

2290
00:54:27,059 --> 00:54:27,069
rate of say 99 percent for reads the
 

2291
00:54:27,069 --> 00:54:28,410
rate of say 99 percent for reads the
only one percent of all that means go to

2292
00:54:28,410 --> 00:54:28,420
only one percent of all that means go to
 

2293
00:54:28,420 --> 00:54:30,750
only one percent of all that means go to
the database servers before we added the

2294
00:54:30,750 --> 00:54:30,760
the database servers before we added the
 

2295
00:54:30,760 --> 00:54:33,510
the database servers before we added the
new cluster if we add a new cluster with

2296
00:54:33,510 --> 00:54:33,520
new cluster if we add a new cluster with
 

2297
00:54:33,520 --> 00:54:35,520
new cluster if we add a new cluster with
nothing in the memcache servers and send

2298
00:54:35,520 --> 00:54:35,530
nothing in the memcache servers and send
 

2299
00:54:35,530 --> 00:54:37,500
nothing in the memcache servers and send
half the traffic to it it's gonna get a

2300
00:54:37,500 --> 00:54:37,510
half the traffic to it it's gonna get a
 

2301
00:54:37,510 --> 00:54:39,829
half the traffic to it it's gonna get a
hundred percent miss rate initially

2302
00:54:39,829 --> 00:54:39,839
hundred percent miss rate initially
 

2303
00:54:39,839 --> 00:54:44,490
hundred percent miss rate initially
right and so that'll mean you know we

2304
00:54:44,490 --> 00:54:44,500
right and so that'll mean you know we
 

2305
00:54:44,500 --> 00:54:46,770
right and so that'll mean you know we
gone from and so the overall miss write

2306
00:54:46,770 --> 00:54:46,780
gone from and so the overall miss write
 

2307
00:54:46,780 --> 00:54:48,480
gone from and so the overall miss write
will now be 50 percent so we've gone

2308
00:54:48,480 --> 00:54:48,490
will now be 50 percent so we've gone
 

2309
00:54:48,490 --> 00:54:51,599
will now be 50 percent so we've gone
from these database servers serving one

2310
00:54:51,599 --> 00:54:51,609
from these database servers serving one
 

2311
00:54:51,609 --> 00:54:54,450
from these database servers serving one
percent of the reads to them serving 50

2312
00:54:54,450 --> 00:54:54,460
percent of the reads to them serving 50
 

2313
00:54:54,460 --> 00:54:56,400
percent of the reads to them serving 50
percent of the reads so at least in this

2314
00:54:56,400 --> 00:54:56,410
percent of the reads so at least in this
 

2315
00:54:56,410 --> 00:54:58,520
percent of the reads so at least in this
imaginary example we've been quite

2316
00:54:58,520 --> 00:54:58,530
imaginary example we've been quite
 

2317
00:54:58,530 --> 00:55:00,599
imaginary example we've been quite
firing up this new cluster we may

2318
00:55:00,599 --> 00:55:00,609
firing up this new cluster we may
 

2319
00:55:00,609 --> 00:55:02,549
firing up this new cluster we may
increase the load on the databases by a

2320
00:55:02,549 --> 00:55:02,559
increase the load on the databases by a
 

2321
00:55:02,559 --> 00:55:05,069
increase the load on the databases by a
factor of 50 and chances are the

2322
00:55:05,069 --> 00:55:05,079
factor of 50 and chances are the
 

2323
00:55:05,079 --> 00:55:07,319
factor of 50 and chances are the
database servers were running you know

2324
00:55:07,319 --> 00:55:07,329
database servers were running you know
 

2325
00:55:07,329 --> 00:55:09,120
database servers were running you know
reasonably Coast's the capacity and

2326
00:55:09,120 --> 00:55:09,130
reasonably Coast's the capacity and
 

2327
00:55:09,130 --> 00:55:11,999
reasonably Coast's the capacity and
certainly not a factor of 50/50 under

2328
00:55:11,999 --> 00:55:12,009
certainly not a factor of 50/50 under
 

2329
00:55:12,009 --> 00:55:14,970
certainly not a factor of 50/50 under
capacity and so this would be the

2330
00:55:14,970 --> 00:55:14,980
capacity and so this would be the
 

2331
00:55:14,980 --> 00:55:17,700
capacity and so this would be the
absolute end of the world if they just

2332
00:55:17,700 --> 00:55:17,710
absolute end of the world if they just
 

2333
00:55:17,710 --> 00:55:20,579
absolute end of the world if they just
fired up a new cluster like that and so

2334
00:55:20,579 --> 00:55:20,589
fired up a new cluster like that and so
 

2335
00:55:20,589 --> 00:55:26,640
fired up a new cluster like that and so
instead they have this cold start idea

2336
00:55:26,640 --> 00:55:26,650
instead they have this cold start idea
 

2337
00:55:26,650 --> 00:55:29,940
instead they have this cold start idea
in which a new cluster is sort of marked

2338
00:55:29,940 --> 00:55:29,950
in which a new cluster is sort of marked
 

2339
00:55:29,950 --> 00:55:33,680
in which a new cluster is sort of marked
by some flag somewhere as being in this

2340
00:55:33,680 --> 00:55:33,690
by some flag somewhere as being in this
 

2341
00:55:33,690 --> 00:55:38,180
by some flag somewhere as being in this
cold start state and in that situation

2342
00:55:38,180 --> 00:55:38,190
cold start state and in that situation
 

2343
00:55:38,190 --> 00:55:40,589
cold start state and in that situation
when a front end and the new cluster

2344
00:55:40,589 --> 00:55:40,599
when a front end and the new cluster
 

2345
00:55:40,599 --> 00:55:45,089
when a front end and the new cluster
misses that actually first first it has

2346
00:55:45,089 --> 00:55:45,099
misses that actually first first it has
 

2347
00:55:45,099 --> 00:55:48,359
misses that actually first first it has
its own local memcache if that says no I

2348
00:55:48,359 --> 00:55:48,369
its own local memcache if that says no I
 

2349
00:55:48,369 --> 00:55:49,980
its own local memcache if that says no I
don't have the data then the front end

2350
00:55:49,980 --> 00:55:49,990
don't have the data then the front end
 

2351
00:55:49,990 --> 00:55:51,900
don't have the data then the front end
we'll ask the corresponding memcache in

2352
00:55:51,900 --> 00:55:51,910
we'll ask the corresponding memcache in
 

2353
00:55:51,910 --> 00:55:54,569
we'll ask the corresponding memcache in
another cluster in some warm cluster

2354
00:55:54,569 --> 00:55:54,579
another cluster in some warm cluster
 

2355
00:55:54,579 --> 00:55:56,400
another cluster in some warm cluster
that already has the data for the data

2356
00:55:56,400 --> 00:55:56,410
that already has the data for the data
 

2357
00:55:56,410 --> 00:55:58,289
that already has the data for the data
if it's popular data chances are it'll

2358
00:55:58,289 --> 00:55:58,299
if it's popular data chances are it'll
 

2359
00:55:58,299 --> 00:56:01,559
if it's popular data chances are it'll
be cached my friend and will get its

2360
00:56:01,559 --> 00:56:01,569
be cached my friend and will get its
 

2361
00:56:01,569 --> 00:56:05,519
be cached my friend and will get its
data and then it will install it in the

2362
00:56:05,519 --> 00:56:05,529
data and then it will install it in the
 

2363
00:56:05,529 --> 00:56:08,670
data and then it will install it in the
local memcache and it's only if both

2364
00:56:08,670 --> 00:56:08,680
local memcache and it's only if both
 

2365
00:56:08,680 --> 00:56:10,829
local memcache and it's only if both
local memcache and the warm memcache

2366
00:56:10,829 --> 00:56:10,839
local memcache and the warm memcache
 

2367
00:56:10,839 --> 00:56:13,170
local memcache and the warm memcache
don't have the data that this is front

2368
00:56:13,170 --> 00:56:13,180
don't have the data that this is front
 

2369
00:56:13,180 --> 00:56:15,210
don't have the data that this is front
end and the new cluster will read from

2370
00:56:15,210 --> 00:56:15,220
end and the new cluster will read from
 

2371
00:56:15,220 --> 00:56:20,670
end and the new cluster will read from
the database servers and so this is it

2372
00:56:20,670 --> 00:56:20,680
the database servers and so this is it
 

2373
00:56:20,680 --> 00:56:21,990
the database servers and so this is it
and so they run in this kind of cold

2374
00:56:21,990 --> 00:56:22,000
and so they run in this kind of cold
 

2375
00:56:22,000 --> 00:56:24,480
and so they run in this kind of cold
mode for a little while the paper I

2376
00:56:24,480 --> 00:56:24,490
mode for a little while the paper I
 

2377
00:56:24,490 --> 00:56:25,980
mode for a little while the paper I
think mentions a couple hours until the

2378
00:56:25,980 --> 00:56:25,990
think mentions a couple hours until the
 

2379
00:56:25,990 --> 00:56:28,170
think mentions a couple hours until the
memcache servers source and the new

2380
00:56:28,170 --> 00:56:28,180
memcache servers source and the new
 

2381
00:56:28,180 --> 00:56:30,390
memcache servers source and the new
clusters start to have all the popular

2382
00:56:30,390 --> 00:56:30,400
clusters start to have all the popular
 

2383
00:56:30,400 --> 00:56:32,640
clusters start to have all the popular
data and then they can turn off this

2384
00:56:32,640 --> 00:56:32,650
data and then they can turn off this
 

2385
00:56:32,650 --> 00:56:35,730
data and then they can turn off this
cold feature and just use the local

2386
00:56:35,730 --> 00:56:35,740
cold feature and just use the local
 

2387
00:56:35,740 --> 00:56:42,650
cold feature and just use the local
cluster memcache alone it's alright

2388
00:56:42,650 --> 00:56:42,660
cluster memcache alone it's alright
 

2389
00:56:42,660 --> 00:56:47,400
cluster memcache alone it's alright
so another another load problem that the

2390
00:56:47,400 --> 00:56:47,410
so another another load problem that the
 

2391
00:56:47,410 --> 00:56:49,620
so another another load problem that the
paper talks about if they ran into and

2392
00:56:49,620 --> 00:56:49,630
paper talks about if they ran into and
 

2393
00:56:49,630 --> 00:56:52,529
paper talks about if they ran into and
this is a load problem again deriving

2394
00:56:52,529 --> 00:56:52,539
this is a load problem again deriving
 

2395
00:56:52,539 --> 00:56:55,970
this is a load problem again deriving
from this kind of look aside caching

2396
00:56:55,970 --> 00:56:55,980
from this kind of look aside caching
 

2397
00:56:55,980 --> 00:56:59,839
from this kind of look aside caching
strategies is called the thundering herd

2398
00:56:59,839 --> 00:56:59,849
strategies is called the thundering herd
 

2399
00:56:59,849 --> 00:57:06,480
strategies is called the thundering herd
and the the scenario

2400
00:57:06,480 --> 00:57:06,490
and the the scenario
 

2401
00:57:06,490 --> 00:57:09,270
and the the scenario
is that supposing we have some piece of

2402
00:57:09,270 --> 00:57:09,280
is that supposing we have some piece of
 

2403
00:57:09,280 --> 00:57:12,300
is that supposing we have some piece of
data there's lotsa memcache servers but

2404
00:57:12,300 --> 00:57:12,310
data there's lotsa memcache servers but
 

2405
00:57:12,310 --> 00:57:13,920
data there's lotsa memcache servers but
there's some piece of data stored on

2406
00:57:13,920 --> 00:57:13,930
there's some piece of data stored on
 

2407
00:57:13,930 --> 00:57:16,590
there's some piece of data stored on
this memcache server there's a whole

2408
00:57:16,590 --> 00:57:16,600
this memcache server there's a whole
 

2409
00:57:16,600 --> 00:57:20,300
this memcache server there's a whole
bunch of front ends that are ordinarily

2410
00:57:20,300 --> 00:57:20,310
bunch of front ends that are ordinarily
 

2411
00:57:20,310 --> 00:57:23,550
bunch of front ends that are ordinarily
reading that one piece of very popular

2412
00:57:23,550 --> 00:57:23,560
reading that one piece of very popular
 

2413
00:57:23,560 --> 00:57:25,890
reading that one piece of very popular
data so they're all sending constantly

2414
00:57:25,890 --> 00:57:25,900
data so they're all sending constantly
 

2415
00:57:25,900 --> 00:57:27,359
data so they're all sending constantly
sending get requests for that data the

2416
00:57:27,359 --> 00:57:27,369
sending get requests for that data the
 

2417
00:57:27,369 --> 00:57:29,460
sending get requests for that data the
memcache server has it in the cache it

2418
00:57:29,460 --> 00:57:29,470
memcache server has it in the cache it
 

2419
00:57:29,470 --> 00:57:31,440
memcache server has it in the cache it
answers them and you know their memcache

2420
00:57:31,440 --> 00:57:31,450
answers them and you know their memcache
 

2421
00:57:31,450 --> 00:57:33,810
answers them and you know their memcache
server is conserve like millions to

2422
00:57:33,810 --> 00:57:33,820
server is conserve like millions to
 

2423
00:57:33,820 --> 00:57:36,090
server is conserve like millions to
million requests per second so we're

2424
00:57:36,090 --> 00:57:36,100
million requests per second so we're
 

2425
00:57:36,100 --> 00:57:39,240
million requests per second so we're
doing pretty good and of course there's

2426
00:57:39,240 --> 00:57:39,250
doing pretty good and of course there's
 

2427
00:57:39,250 --> 00:57:40,530
doing pretty good and of course there's
some database server sitting back here

2428
00:57:40,530 --> 00:57:40,540
some database server sitting back here
 

2429
00:57:40,540 --> 00:57:42,210
some database server sitting back here
that has the real copy of that data but

2430
00:57:42,210 --> 00:57:42,220
that has the real copy of that data but
 

2431
00:57:42,220 --> 00:57:43,410
that has the real copy of that data but
we're not bothering it because it is

2432
00:57:43,410 --> 00:57:43,420
we're not bothering it because it is
 

2433
00:57:43,420 --> 00:57:46,080
we're not bothering it because it is
cached well suppose some front-end comes

2434
00:57:46,080 --> 00:57:46,090
cached well suppose some front-end comes
 

2435
00:57:46,090 --> 00:57:49,560
cached well suppose some front-end comes
along and modifies this very popular

2436
00:57:49,560 --> 00:57:49,570
along and modifies this very popular
 

2437
00:57:49,570 --> 00:57:51,000
along and modifies this very popular
data so it's going to send a write to

2438
00:57:51,000 --> 00:57:51,010
data so it's going to send a write to
 

2439
00:57:51,010 --> 00:57:53,070
data so it's going to send a write to
the database with the new data and then

2440
00:57:53,070 --> 00:57:53,080
the database with the new data and then
 

2441
00:57:53,080 --> 00:57:57,390
the database with the new data and then
it's gonna send a delete to the memcache

2442
00:57:57,390 --> 00:57:57,400
it's gonna send a delete to the memcache
 

2443
00:57:57,400 --> 00:57:58,560
it's gonna send a delete to the memcache
server because that's the way rights

2444
00:57:58,560 --> 00:57:58,570
server because that's the way rights
 

2445
00:57:58,570 --> 00:58:00,570
server because that's the way rights
work so now we've just deleted this

2446
00:58:00,570 --> 00:58:00,580
work so now we've just deleted this
 

2447
00:58:00,580 --> 00:58:02,790
work so now we've just deleted this
extremely popular data we have all these

2448
00:58:02,790 --> 00:58:02,800
extremely popular data we have all these
 

2449
00:58:02,800 --> 00:58:04,590
extremely popular data we have all these
front ends constantly sending gets for

2450
00:58:04,590 --> 00:58:04,600
front ends constantly sending gets for
 

2451
00:58:04,600 --> 00:58:08,310
front ends constantly sending gets for
that data they're all gonna miss all at

2452
00:58:08,310 --> 00:58:08,320
that data they're all gonna miss all at
 

2453
00:58:08,320 --> 00:58:13,650
that data they're all gonna miss all at
the same time they're all gonna now

2454
00:58:13,650 --> 00:58:13,660
the same time they're all gonna now
 

2455
00:58:13,660 --> 00:58:17,400
the same time they're all gonna now
having missed send a read request to the

2456
00:58:17,400 --> 00:58:17,410
having missed send a read request to the
 

2457
00:58:17,410 --> 00:58:19,740
having missed send a read request to the
front end database all at the same time

2458
00:58:19,740 --> 00:58:19,750
front end database all at the same time
 

2459
00:58:19,750 --> 00:58:22,080
front end database all at the same time
and so now this front-end database is

2460
00:58:22,080 --> 00:58:22,090
and so now this front-end database is
 

2461
00:58:22,090 --> 00:58:23,820
and so now this front-end database is
faced with maybe dozens or hundreds of

2462
00:58:23,820 --> 00:58:23,830
faced with maybe dozens or hundreds of
 

2463
00:58:23,830 --> 00:58:25,650
faced with maybe dozens or hundreds of
simultaneous requests for this data so

2464
00:58:25,650 --> 00:58:25,660
simultaneous requests for this data so
 

2465
00:58:25,660 --> 00:58:27,150
simultaneous requests for this data so
the Loews here is gonna be pretty high

2466
00:58:27,150 --> 00:58:27,160
the Loews here is gonna be pretty high
 

2467
00:58:27,160 --> 00:58:30,570
the Loews here is gonna be pretty high
and it's particularly disappointing

2468
00:58:30,570 --> 00:58:30,580
and it's particularly disappointing
 

2469
00:58:30,580 --> 00:58:33,599
and it's particularly disappointing
because we know that all these requests

2470
00:58:33,599 --> 00:58:33,609
because we know that all these requests
 

2471
00:58:33,609 --> 00:58:35,370
because we know that all these requests
are for the same key so the database is

2472
00:58:35,370 --> 00:58:35,380
are for the same key so the database is
 

2473
00:58:35,380 --> 00:58:36,780
are for the same key so the database is
going to do the same work over and over

2474
00:58:36,780 --> 00:58:36,790
going to do the same work over and over
 

2475
00:58:36,790 --> 00:58:39,180
going to do the same work over and over
again to respond with the latest written

2476
00:58:39,180 --> 00:58:39,190
again to respond with the latest written
 

2477
00:58:39,190 --> 00:58:46,170
again to respond with the latest written
copy of that key until finally the front

2478
00:58:46,170 --> 00:58:46,180
copy of that key until finally the front
 

2479
00:58:46,180 --> 00:58:48,450
copy of that key until finally the front
ends get around to installing the new

2480
00:58:48,450 --> 00:58:48,460
ends get around to installing the new
 

2481
00:58:48,460 --> 00:58:50,609
ends get around to installing the new
key in memcache and then people start

2482
00:58:50,609 --> 00:58:50,619
key in memcache and then people start
 

2483
00:58:50,619 --> 00:58:53,099
key in memcache and then people start
hitting again and so this is the

2484
00:58:53,099 --> 00:58:53,109
hitting again and so this is the
 

2485
00:58:53,109 --> 00:58:55,109
hitting again and so this is the
Thundering hurt what we'd really like is

2486
00:58:55,109 --> 00:58:55,119
Thundering hurt what we'd really like is
 

2487
00:58:55,119 --> 00:58:58,800
Thundering hurt what we'd really like is
a single you know if a miss if there's a

2488
00:58:58,800 --> 00:58:58,810
a single you know if a miss if there's a
 

2489
00:58:58,810 --> 00:59:01,260
a single you know if a miss if there's a
right and the leads and a miss happens

2490
00:59:01,260 --> 00:59:01,270
right and the leads and a miss happens
 

2491
00:59:01,270 --> 00:59:03,540
right and the leads and a miss happens
in memcache we'd like what we'd like is

2492
00:59:03,540 --> 00:59:03,550
in memcache we'd like what we'd like is
 

2493
00:59:03,550 --> 00:59:05,580
in memcache we'd like what we'd like is
the for the first front end that misses

2494
00:59:05,580 --> 00:59:05,590
the for the first front end that misses
 

2495
00:59:05,590 --> 00:59:07,380
the for the first front end that misses
to fetch the data and install it and for

2496
00:59:07,380 --> 00:59:07,390
to fetch the data and install it and for
 

2497
00:59:07,390 --> 00:59:09,390
to fetch the data and install it and for
the other front ends just like take a

2498
00:59:09,390 --> 00:59:09,400
the other front ends just like take a
 

2499
00:59:09,400 --> 00:59:11,700
the other front ends just like take a
deep breath then wait until the new data

2500
00:59:11,700 --> 00:59:11,710
deep breath then wait until the new data
 

2501
00:59:11,710 --> 00:59:15,370
deep breath then wait until the new data
is cached and that's

2502
00:59:15,370 --> 00:59:15,380
is cached and that's
 

2503
00:59:15,380 --> 00:59:17,019
is cached and that's
just what their design does if you look

2504
00:59:17,019 --> 00:59:17,029
just what their design does if you look
 

2505
00:59:17,029 --> 00:59:21,099
just what their design does if you look
at the if this thing called Elise which

2506
00:59:21,099 --> 00:59:21,109
at the if this thing called Elise which
 

2507
00:59:21,109 --> 00:59:26,109
at the if this thing called Elise which
is different from the pieces were used

2508
00:59:26,109 --> 00:59:26,119
is different from the pieces were used
 

2509
00:59:26,119 --> 00:59:30,039
is different from the pieces were used
to but they call Elise and we start from

2510
00:59:30,039 --> 00:59:30,049
to but they call Elise and we start from
 

2511
00:59:30,049 --> 00:59:33,329
to but they call Elise and we start from
scratch in the scenario again let's see

2512
00:59:33,329 --> 00:59:33,339
scratch in the scenario again let's see
 

2513
00:59:33,339 --> 00:59:35,529
scratch in the scenario again let's see
so now suppose we have a popular piece

2514
00:59:35,529 --> 00:59:35,539
so now suppose we have a popular piece
 

2515
00:59:35,539 --> 00:59:40,630
so now suppose we have a popular piece
of data the first front end that asks

2516
00:59:40,630 --> 00:59:40,640
of data the first front end that asks
 

2517
00:59:40,640 --> 00:59:44,769
of data the first front end that asks
for a data that's missing memcache Devo

2518
00:59:44,769 --> 00:59:44,779
for a data that's missing memcache Devo
 

2519
00:59:44,779 --> 00:59:46,029
for a data that's missing memcache Devo
will send back an error saying oh no I

2520
00:59:46,029 --> 00:59:46,039
will send back an error saying oh no I
 

2521
00:59:46,039 --> 00:59:47,650
will send back an error saying oh no I
don't have the data in my cache but it

2522
00:59:47,650 --> 00:59:47,660
don't have the data in my cache but it
 

2523
00:59:47,660 --> 00:59:51,519
don't have the data in my cache but it
will install Elise which is a bit unique

2524
00:59:51,519 --> 00:59:51,529
will install Elise which is a bit unique
 

2525
00:59:51,529 --> 00:59:55,059
will install Elise which is a bit unique
number it'll pick a least number install

2526
00:59:55,059 --> 00:59:55,069
number it'll pick a least number install
 

2527
00:59:55,069 --> 00:59:57,460
number it'll pick a least number install
it in a table and the send this lease

2528
00:59:57,460 --> 00:59:57,470
it in a table and the send this lease
 

2529
00:59:57,470 --> 01:00:01,240
it in a table and the send this lease
token back to the front end and then

2530
01:00:01,240 --> 01:00:01,250
token back to the front end and then
 

2531
01:00:01,250 --> 01:00:03,069
token back to the front end and then
other front ends that come in and ask

2532
01:00:03,069 --> 01:00:03,079
other front ends that come in and ask
 

2533
01:00:03,079 --> 01:00:05,880
other front ends that come in and ask
for the same Keith they'll simply get a

2534
01:00:05,880 --> 01:00:05,890
for the same Keith they'll simply get a
 

2535
01:00:05,890 --> 01:00:10,839
for the same Keith they'll simply get a
just be asked to wait you know a quarter

2536
01:00:10,839 --> 01:00:10,849
just be asked to wait you know a quarter
 

2537
01:00:10,849 --> 01:00:12,249
just be asked to wait you know a quarter
of a second or whatever some reasonable

2538
01:00:12,249 --> 01:00:12,259
of a second or whatever some reasonable
 

2539
01:00:12,259 --> 01:00:13,779
of a second or whatever some reasonable
amount of time by the memcache D because

2540
01:00:13,779 --> 01:00:13,789
amount of time by the memcache D because
 

2541
01:00:13,789 --> 01:00:15,220
amount of time by the memcache D because
the memcache key will see a haha I've

2542
01:00:15,220 --> 01:00:15,230
the memcache key will see a haha I've
 

2543
01:00:15,230 --> 01:00:16,870
the memcache key will see a haha I've
already issued the lease for that key

2544
01:00:16,870 --> 01:00:16,880
already issued the lease for that key
 

2545
01:00:16,880 --> 01:00:18,910
already issued the lease for that key
now there's at least potentially a V

2546
01:00:18,910 --> 01:00:18,920
now there's at least potentially a V
 

2547
01:00:18,920 --> 01:00:21,519
now there's at least potentially a V
Sparky the server will notice it's

2548
01:00:21,519 --> 01:00:21,529
Sparky the server will notice it's
 

2549
01:00:21,529 --> 01:00:22,930
Sparky the server will notice it's
already issued at least for the can tell

2550
01:00:22,930 --> 01:00:22,940
already issued at least for the can tell
 

2551
01:00:22,940 --> 01:00:26,249
already issued at least for the can tell
these ones to wait so only one of the

2552
01:00:26,249 --> 01:00:26,259
these ones to wait so only one of the
 

2553
01:00:26,259 --> 01:00:28,779
these ones to wait so only one of the
server's guess Elise this server then

2554
01:00:28,779 --> 01:00:28,789
server's guess Elise this server then
 

2555
01:00:28,789 --> 01:00:33,220
server's guess Elise this server then
asks for the data from the database when

2556
01:00:33,220 --> 01:00:33,230
asks for the data from the database when
 

2557
01:00:33,230 --> 01:00:35,170
asks for the data from the database when
against the responds back mom

2558
01:00:35,170 --> 01:00:35,180
against the responds back mom
 

2559
01:00:35,180 --> 01:00:40,200
against the responds back mom
then it sends the put for the new data

2560
01:00:40,200 --> 01:00:40,210

 

2561
01:00:40,210 --> 01:00:43,349

with a key and the value of God and the

2562
01:00:43,349 --> 01:00:43,359
with a key and the value of God and the
 

2563
01:00:43,359 --> 01:00:45,029
with a key and the value of God and the
least proved that it was the one who was

2564
01:00:45,029 --> 01:00:45,039
least proved that it was the one who was
 

2565
01:00:45,039 --> 01:00:46,769
least proved that it was the one who was
allowed to write the data memcache

2566
01:00:46,769 --> 01:00:46,779
allowed to write the data memcache
 

2567
01:00:46,779 --> 01:00:48,180
allowed to write the data memcache
people looking for these today aha yeah

2568
01:00:48,180 --> 01:00:48,190
people looking for these today aha yeah
 

2569
01:00:48,190 --> 01:00:51,630
people looking for these today aha yeah
you are the the person whose lease was

2570
01:00:51,630 --> 01:00:51,640
you are the the person whose lease was
 

2571
01:00:51,640 --> 01:00:52,950
you are the the person whose lease was
granted and it'll actually do the

2572
01:00:52,950 --> 01:00:52,960
granted and it'll actually do the
 

2573
01:00:52,960 --> 01:00:55,680
granted and it'll actually do the
install by and by these other friends

2574
01:00:55,680 --> 01:00:55,690
install by and by these other friends
 

2575
01:00:55,690 --> 01:00:57,240
install by and by these other friends
who are told the wait will reissue their

2576
01:00:57,240 --> 01:00:57,250
who are told the wait will reissue their
 

2577
01:00:57,250 --> 01:01:00,210
who are told the wait will reissue their
reads now that it will be there and so

2578
01:01:00,210 --> 01:01:00,220
reads now that it will be there and so
 

2579
01:01:00,220 --> 01:01:03,420
reads now that it will be there and so
we all if all goes well get just one

2580
01:01:03,420 --> 01:01:03,430
we all if all goes well get just one
 

2581
01:01:03,430 --> 01:01:05,279
we all if all goes well get just one
request to the database instead of

2582
01:01:05,279 --> 01:01:05,289
request to the database instead of
 

2583
01:01:05,289 --> 01:01:08,730
request to the database instead of
dozens or hundreds and I think it's the

2584
01:01:08,730 --> 01:01:08,740
dozens or hundreds and I think it's the
 

2585
01:01:08,740 --> 01:01:10,079
dozens or hundreds and I think it's the
sense in which is the lease is if the

2586
01:01:10,079 --> 01:01:10,089
sense in which is the lease is if the
 

2587
01:01:10,089 --> 01:01:14,250
sense in which is the lease is if the
front-end fails at an awkward moment and

2588
01:01:14,250 --> 01:01:14,260
front-end fails at an awkward moment and
 

2589
01:01:14,260 --> 01:01:15,990
front-end fails at an awkward moment and
doesn't actually request the data from

2590
01:01:15,990 --> 01:01:16,000
doesn't actually request the data from
 

2591
01:01:16,000 --> 01:01:17,640
doesn't actually request the data from
the database or doesn't get around it

2592
01:01:17,640 --> 01:01:17,650
the database or doesn't get around it
 

2593
01:01:17,650 --> 01:01:19,559
the database or doesn't get around it
installing it memcache D eventually

2594
01:01:19,559 --> 01:01:19,569
installing it memcache D eventually
 

2595
01:01:19,569 --> 01:01:21,690
installing it memcache D eventually
memcache D will delete the lease cuz it

2596
01:01:21,690 --> 01:01:21,700
memcache D will delete the lease cuz it
 

2597
01:01:21,700 --> 01:01:23,670
memcache D will delete the lease cuz it
times out and the next front end to ask

2598
01:01:23,670 --> 01:01:23,680
times out and the next front end to ask
 

2599
01:01:23,680 --> 01:01:26,760
times out and the next front end to ask
will get a new lease and will hope that

2600
01:01:26,760 --> 01:01:26,770
will get a new lease and will hope that
 

2601
01:01:26,770 --> 01:01:28,289
will get a new lease and will hope that
it will talk to the database and install

2602
01:01:28,289 --> 01:01:28,299
it will talk to the database and install
 

2603
01:01:28,299 --> 01:01:32,309
it will talk to the database and install
new data so yes they answer the question

2604
01:01:32,309 --> 01:01:32,319
new data so yes they answer the question
 

2605
01:01:32,319 --> 01:01:35,700
new data so yes they answer the question
the lease does up a time out in case the

2606
01:01:35,700 --> 01:01:35,710
the lease does up a time out in case the
 

2607
01:01:35,710 --> 01:01:41,130
the lease does up a time out in case the
first front end fails yes yes okay so

2608
01:01:41,130 --> 01:01:41,140
first front end fails yes yes okay so
 

2609
01:01:41,140 --> 01:01:43,019
first front end fails yes yes okay so
these leases are the their solution to

2610
01:01:43,019 --> 01:01:43,029
these leases are the their solution to
 

2611
01:01:43,029 --> 01:01:48,120
these leases are the their solution to
the Thundering Herd problem um another

2612
01:01:48,120 --> 01:01:48,130
the Thundering Herd problem um another
 

2613
01:01:48,130 --> 01:01:49,920
the Thundering Herd problem um another
problem they have is that if one of

2614
01:01:49,920 --> 01:01:49,930
problem they have is that if one of
 

2615
01:01:49,930 --> 01:01:54,420
problem they have is that if one of
these memcache servers fails the most

2616
01:01:54,420 --> 01:01:54,430
these memcache servers fails the most
 

2617
01:01:54,430 --> 01:01:56,339
these memcache servers fails the most
natural you-know-whats if they don't do

2618
01:01:56,339 --> 01:01:56,349
natural you-know-whats if they don't do
 

2619
01:01:56,349 --> 01:01:58,049
natural you-know-whats if they don't do
anything special if the memcache server

2620
01:01:58,049 --> 01:01:58,059
anything special if the memcache server
 

2621
01:01:58,059 --> 01:02:00,299
anything special if the memcache server
fails the front ends will send a request

2622
01:02:00,299 --> 01:02:00,309
fails the front ends will send a request
 

2623
01:02:00,309 --> 01:02:02,460
fails the front ends will send a request
they'll get back a timeout and network

2624
01:02:02,460 --> 01:02:02,470
they'll get back a timeout and network
 

2625
01:02:02,470 --> 01:02:04,140
they'll get back a timeout and network
will say jeez that you know I couldn't

2626
01:02:04,140 --> 01:02:04,150
will say jeez that you know I couldn't
 

2627
01:02:04,150 --> 01:02:05,809
will say jeez that you know I couldn't
contact that host never got a response

2628
01:02:05,809 --> 01:02:05,819
contact that host never got a response
 

2629
01:02:05,819 --> 01:02:09,029
contact that host never got a response
and what the real I BRE

2630
01:02:09,029 --> 01:02:09,039
and what the real I BRE
 

2631
01:02:09,039 --> 01:02:10,859
and what the real I BRE
software does is it then sense it

2632
01:02:10,859 --> 01:02:10,869
software does is it then sense it
 

2633
01:02:10,869 --> 01:02:13,680
software does is it then sense it
requests the database so if a memcache

2634
01:02:13,680 --> 01:02:13,690
requests the database so if a memcache
 

2635
01:02:13,690 --> 01:02:14,970
requests the database so if a memcache
server fails and we don't do anything

2636
01:02:14,970 --> 01:02:14,980
server fails and we don't do anything
 

2637
01:02:14,980 --> 01:02:17,250
server fails and we don't do anything
special the database is now going to be

2638
01:02:17,250 --> 01:02:17,260
special the database is now going to be
 

2639
01:02:17,260 --> 01:02:19,710
special the database is now going to be
exposed directly to the reads all of

2640
01:02:19,710 --> 01:02:19,720
exposed directly to the reads all of
 

2641
01:02:19,720 --> 01:02:21,000
exposed directly to the reads all of
these reefs and I'm catch server West

2642
01:02:21,000 --> 01:02:21,010
these reefs and I'm catch server West
 

2643
01:02:21,010 --> 01:02:22,769
these reefs and I'm catch server West
serving this is the memcache server may

2644
01:02:22,769 --> 01:02:22,779
serving this is the memcache server may
 

2645
01:02:22,779 --> 01:02:23,849
serving this is the memcache server may
well have been serving you know a

2646
01:02:23,849 --> 01:02:23,859
well have been serving you know a
 

2647
01:02:23,859 --> 01:02:26,760
well have been serving you know a
million reads per second that may mean

2648
01:02:26,760 --> 01:02:26,770
million reads per second that may mean
 

2649
01:02:26,770 --> 01:02:29,010
million reads per second that may mean
that the database server would be then

2650
01:02:29,010 --> 01:02:29,020
that the database server would be then
 

2651
01:02:29,020 --> 01:02:30,329
that the database server would be then
exposed to those million reads per

2652
01:02:30,329 --> 01:02:30,339
exposed to those million reads per
 

2653
01:02:30,339 --> 01:02:31,620
exposed to those million reads per
second then it's nowhere near fast

2654
01:02:31,620 --> 01:02:31,630
second then it's nowhere near fast
 

2655
01:02:31,630 --> 01:02:37,430
second then it's nowhere near fast
enough to deal with all those weeds now

2656
01:02:37,430 --> 01:02:37,440
enough to deal with all those weeds now
 

2657
01:02:37,440 --> 01:02:39,599
enough to deal with all those weeds now
Facebook they don't really talk about in

2658
01:02:39,599 --> 01:02:39,609
Facebook they don't really talk about in
 

2659
01:02:39,609 --> 01:02:40,950
Facebook they don't really talk about in
the paper but they do have automated

2660
01:02:40,950 --> 01:02:40,960
the paper but they do have automated
 

2661
01:02:40,960 --> 01:02:44,279
the paper but they do have automated
machinery to replace a failed memcache

2662
01:02:44,279 --> 01:02:44,289
machinery to replace a failed memcache
 

2663
01:02:44,289 --> 01:02:48,000
machinery to replace a failed memcache
server but that takes a while to sort of

2664
01:02:48,000 --> 01:02:48,010
server but that takes a while to sort of
 

2665
01:02:48,010 --> 01:02:51,539
server but that takes a while to sort of
set up a new server a new memcache

2666
01:02:51,539 --> 01:02:51,549
set up a new server a new memcache
 

2667
01:02:51,549 --> 01:02:53,840
set up a new server a new memcache
server and redirect all the front-end

2668
01:02:53,840 --> 01:02:53,850
server and redirect all the front-end
 

2669
01:02:53,850 --> 01:02:55,370
server and redirect all the front-end
to the new server instead of the old

2670
01:02:55,370 --> 01:02:55,380
to the new server instead of the old
 

2671
01:02:55,380 --> 01:02:57,140
to the new server instead of the old
server so in the meantime they need a

2672
01:02:57,140 --> 01:02:57,150
server so in the meantime they need a
 

2673
01:02:57,150 --> 01:03:00,170
server so in the meantime they need a
sort of temporary solution and that's

2674
01:03:00,170 --> 01:03:00,180
sort of temporary solution and that's
 

2675
01:03:00,180 --> 01:03:06,500
sort of temporary solution and that's
this gutter idea so let's say the scoop

2676
01:03:06,500 --> 01:03:06,510
this gutter idea so let's say the scoop
 

2677
01:03:06,510 --> 01:03:11,870
this gutter idea so let's say the scoop
is that we have our front ends we have

2678
01:03:11,870 --> 01:03:11,880
is that we have our front ends we have
 

2679
01:03:11,880 --> 01:03:13,880
is that we have our front ends we have
the sort of ordinary set of memcache

2680
01:03:13,880 --> 01:03:13,890
the sort of ordinary set of memcache
 

2681
01:03:13,890 --> 01:03:17,600
the sort of ordinary set of memcache
servers

2682
01:03:17,600 --> 01:03:17,610

 

2683
01:03:17,610 --> 01:03:21,000

the database the one of the memcache

2684
01:03:21,000 --> 01:03:21,010
the database the one of the memcache
 

2685
01:03:21,010 --> 01:03:23,490
the database the one of the memcache
service has failed we're kind of waiting

2686
01:03:23,490 --> 01:03:23,500
service has failed we're kind of waiting
 

2687
01:03:23,500 --> 01:03:26,520
service has failed we're kind of waiting
until the automatic memcache server

2688
01:03:26,520 --> 01:03:26,530
until the automatic memcache server
 

2689
01:03:26,530 --> 01:03:27,960
until the automatic memcache server
replacement system replaces this

2690
01:03:27,960 --> 01:03:27,970
replacement system replaces this
 

2691
01:03:27,970 --> 01:03:30,770
replacement system replaces this
memcache server in the meantime

2692
01:03:30,770 --> 01:03:30,780
memcache server in the meantime
 

2693
01:03:30,780 --> 01:03:32,970
memcache server in the meantime
friends are sending requests to it they

2694
01:03:32,970 --> 01:03:32,980
friends are sending requests to it they
 

2695
01:03:32,980 --> 01:03:35,460
friends are sending requests to it they
get a sort of server did not respond

2696
01:03:35,460 --> 01:03:35,470
get a sort of server did not respond
 

2697
01:03:35,470 --> 01:03:38,790
get a sort of server did not respond
error from the network and then there's

2698
01:03:38,790 --> 01:03:38,800
error from the network and then there's
 

2699
01:03:38,800 --> 01:03:46,099
error from the network and then there's
a presumably small set of gutter servers

2700
01:03:46,099 --> 01:03:46,109

 

2701
01:03:46,109 --> 01:03:50,910

whose only purpose in life is to eye

2702
01:03:50,910 --> 01:03:50,920
whose only purpose in life is to eye
 

2703
01:03:50,920 --> 01:03:55,950
whose only purpose in life is to eye
they must be idle except when a real

2704
01:03:55,950 --> 01:03:55,960
they must be idle except when a real
 

2705
01:03:55,960 --> 01:03:57,569
they must be idle except when a real
memcache server fails and when the front

2706
01:03:57,569 --> 01:03:57,579
memcache server fails and when the front
 

2707
01:03:57,579 --> 01:04:00,180
memcache server fails and when the front
end gets an error back saying that get

2708
01:04:00,180 --> 01:04:00,190
end gets an error back saying that get
 

2709
01:04:00,190 --> 01:04:01,800
end gets an error back saying that get
couldn't contact the memcache server

2710
01:04:01,800 --> 01:04:01,810
couldn't contact the memcache server
 

2711
01:04:01,810 --> 01:04:05,130
couldn't contact the memcache server
it'll send the same request to one of

2712
01:04:05,130 --> 01:04:05,140
it'll send the same request to one of
 

2713
01:04:05,140 --> 01:04:06,329
it'll send the same request to one of
the gutter servers and though the paper

2714
01:04:06,329 --> 01:04:06,339
the gutter servers and though the paper
 

2715
01:04:06,339 --> 01:04:08,339
the gutter servers and though the paper
doesn't say I imagine that the front end

2716
01:04:08,339 --> 01:04:08,349
doesn't say I imagine that the front end
 

2717
01:04:08,349 --> 01:04:10,200
doesn't say I imagine that the front end
will again hash the key in order to

2718
01:04:10,200 --> 01:04:10,210
will again hash the key in order to
 

2719
01:04:10,210 --> 01:04:13,790
will again hash the key in order to
choose which gutter server to talk to

2720
01:04:13,790 --> 01:04:13,800

 

2721
01:04:13,800 --> 01:04:17,579

and if the gutter server has the value

2722
01:04:17,579 --> 01:04:17,589
and if the gutter server has the value
 

2723
01:04:17,589 --> 01:04:18,809
and if the gutter server has the value
that's great

2724
01:04:18,809 --> 01:04:18,819
that's great
 

2725
01:04:18,819 --> 01:04:21,030
that's great
otherwise the front end server will

2726
01:04:21,030 --> 01:04:21,040
otherwise the front end server will
 

2727
01:04:21,040 --> 01:04:22,620
otherwise the front end server will
contact the database server to read the

2728
01:04:22,620 --> 01:04:22,630
contact the database server to read the
 

2729
01:04:22,630 --> 01:04:25,920
contact the database server to read the
value and then install it in the

2730
01:04:25,920 --> 01:04:25,930
value and then install it in the
 

2731
01:04:25,930 --> 01:04:27,329
value and then install it in the
memcache server in case somebody else

2732
01:04:27,329 --> 01:04:27,339
memcache server in case somebody else
 

2733
01:04:27,339 --> 01:04:28,740
memcache server in case somebody else
answer asks for the same data

2734
01:04:28,740 --> 01:04:28,750
answer asks for the same data
 

2735
01:04:28,750 --> 01:04:32,400
answer asks for the same data
so while this means down the gutter

2736
01:04:32,400 --> 01:04:32,410
so while this means down the gutter
 

2737
01:04:32,410 --> 01:04:38,280
so while this means down the gutter
servers will handle basically handle its

2738
01:04:38,280 --> 01:04:38,290
servers will handle basically handle its
 

2739
01:04:38,290 --> 01:04:39,900
servers will handle basically handle its
request and so they'll be a miss you

2740
01:04:39,900 --> 01:04:39,910
request and so they'll be a miss you
 

2741
01:04:39,910 --> 01:04:41,730
request and so they'll be a miss you
know handled by lease leases the

2742
01:04:41,730 --> 01:04:41,740
know handled by lease leases the
 

2743
01:04:41,740 --> 01:04:42,569
know handled by lease leases the
Thundering Herd

2744
01:04:42,569 --> 01:04:42,579
Thundering Herd
 

2745
01:04:42,579 --> 01:04:44,849
Thundering Herd
they'll be at least I need a Miss on

2746
01:04:44,849 --> 01:04:44,859
they'll be at least I need a Miss on
 

2747
01:04:44,859 --> 01:04:46,800
they'll be at least I need a Miss on
each of the items that was a no-fail

2748
01:04:46,800 --> 01:04:46,810
each of the items that was a no-fail
 

2749
01:04:46,810 --> 01:04:49,050
each of the items that was a no-fail
memcache server so there will be some

2750
01:04:49,050 --> 01:04:49,060
memcache server so there will be some
 

2751
01:04:49,060 --> 01:04:50,309
memcache server so there will be some
load in the database server but then

2752
01:04:50,309 --> 01:04:50,319
load in the database server but then
 

2753
01:04:50,319 --> 01:04:51,720
load in the database server but then
hopefully quickly this memcache server

2754
01:04:51,720 --> 01:04:51,730
hopefully quickly this memcache server
 

2755
01:04:51,730 --> 01:04:54,450
hopefully quickly this memcache server
will I get all the data that's listen

2756
01:04:54,450 --> 01:04:54,460
will I get all the data that's listen
 

2757
01:04:54,460 --> 01:05:00,270
will I get all the data that's listen
use and provide good service and then by

2758
01:05:00,270 --> 01:05:00,280
use and provide good service and then by
 

2759
01:05:00,280 --> 01:05:01,530
use and provide good service and then by
and by this will be replaced and then

2760
01:05:01,530 --> 01:05:01,540
and by this will be replaced and then
 

2761
01:05:01,540 --> 01:05:03,329
and by this will be replaced and then
the friends will know to talk to a

2762
01:05:03,329 --> 01:05:03,339
the friends will know to talk to a
 

2763
01:05:03,339 --> 01:05:07,170
the friends will know to talk to a
different replacement server and because

2764
01:05:07,170 --> 01:05:07,180
different replacement server and because
 

2765
01:05:07,180 --> 01:05:09,089
different replacement server and because
they don't and this is today's question

2766
01:05:09,089 --> 01:05:09,099
they don't and this is today's question
 

2767
01:05:09,099 --> 01:05:13,140
they don't and this is today's question
I think that they don't send deletes to

2768
01:05:13,140 --> 01:05:13,150
I think that they don't send deletes to
 

2769
01:05:13,150 --> 01:05:14,970
I think that they don't send deletes to
these gutter servers because since a

2770
01:05:14,970 --> 01:05:14,980
these gutter servers because since a
 

2771
01:05:14,980 --> 01:05:16,559
these gutter servers because since a
gutter server could have taken over for

2772
01:05:16,559 --> 01:05:16,569
gutter server could have taken over for
 

2773
01:05:16,569 --> 01:05:20,730
gutter server could have taken over for
anyone and maybe more than one of the

2774
01:05:20,730 --> 01:05:20,740
anyone and maybe more than one of the
 

2775
01:05:20,740 --> 01:05:22,109
anyone and maybe more than one of the
ordinary memcache service it could

2776
01:05:22,109 --> 01:05:22,119
ordinary memcache service it could
 

2777
01:05:22,119 --> 01:05:26,750
ordinary memcache service it could
actually have cache the caching any key

2778
01:05:26,750 --> 01:05:26,760
actually have cache the caching any key
 

2779
01:05:26,760 --> 01:05:30,900
actually have cache the caching any key
so that would mean that and there may be

2780
01:05:30,900 --> 01:05:30,910
so that would mean that and there may be
 

2781
01:05:30,910 --> 01:05:33,390
so that would mean that and there may be
you know friends talking to it that

2782
01:05:33,390 --> 01:05:33,400
you know friends talking to it that
 

2783
01:05:33,400 --> 01:05:35,280
you know friends talking to it that
would mean that whenever a front-end

2784
01:05:35,280 --> 01:05:35,290
would mean that whenever a front-end
 

2785
01:05:35,290 --> 01:05:36,720
would mean that whenever a front-end
needs it to delete a key from memcache

2786
01:05:36,720 --> 01:05:36,730
needs it to delete a key from memcache
 

2787
01:05:36,730 --> 01:05:40,559
needs it to delete a key from memcache
or when the squeal on the database sends

2788
01:05:40,559 --> 01:05:40,569
or when the squeal on the database sends
 

2789
01:05:40,569 --> 01:05:42,510
or when the squeal on the database sends
a delete for any key to the relevant

2790
01:05:42,510 --> 01:05:42,520
a delete for any key to the relevant
 

2791
01:05:42,520 --> 01:05:46,410
a delete for any key to the relevant
memcache server yeah you know the the

2792
01:05:46,410 --> 01:05:46,420
memcache server yeah you know the the
 

2793
01:05:46,420 --> 01:05:47,730
memcache server yeah you know the the
natural design would be that it would

2794
01:05:47,730 --> 01:05:47,740
natural design would be that it would
 

2795
01:05:47,740 --> 01:05:51,599
natural design would be that it would
also send a copy of that delete to every

2796
01:05:51,599 --> 01:05:51,609
also send a copy of that delete to every
 

2797
01:05:51,609 --> 01:05:53,790
also send a copy of that delete to every
one of the gutter servers and the same

2798
01:05:53,790 --> 01:05:53,800
one of the gutter servers and the same
 

2799
01:05:53,800 --> 01:05:55,109
one of the gutter servers and the same
for front ends that are deleting data

2800
01:05:55,109 --> 01:05:55,119
for front ends that are deleting data
 

2801
01:05:55,119 --> 01:05:56,609
for front ends that are deleting data
they would delete from the memcache

2802
01:05:56,609 --> 01:05:56,619
they would delete from the memcache
 

2803
01:05:56,619 --> 01:05:58,170
they would delete from the memcache
stores but they would also have to leave

2804
01:05:58,170 --> 01:05:58,180
stores but they would also have to leave
 

2805
01:05:58,180 --> 01:05:59,979
stores but they would also have to leave
potentially from any

2806
01:05:59,979 --> 01:05:59,989
potentially from any
 

2807
01:05:59,989 --> 01:06:04,279
potentially from any
MCAD gutter server that would double the

2808
01:06:04,279 --> 01:06:04,289
MCAD gutter server that would double the
 

2809
01:06:04,289 --> 01:06:05,450
MCAD gutter server that would double the
amount of defeats that had to be sent

2810
01:06:05,450 --> 01:06:05,460
amount of defeats that had to be sent
 

2811
01:06:05,460 --> 01:06:06,829
amount of defeats that had to be sent
around even though most of the time

2812
01:06:06,829 --> 01:06:06,839
around even though most of the time
 

2813
01:06:06,839 --> 01:06:08,210
around even though most of the time
these gutter servers aren't doing

2814
01:06:08,210 --> 01:06:08,220
these gutter servers aren't doing
 

2815
01:06:08,220 --> 01:06:09,680
these gutter servers aren't doing
anything and don't cache anything and it

2816
01:06:09,680 --> 01:06:09,690
anything and don't cache anything and it
 

2817
01:06:09,690 --> 01:06:11,839
anything and don't cache anything and it
doesn't matter and so in order to avoid

2818
01:06:11,839 --> 01:06:11,849
doesn't matter and so in order to avoid
 

2819
01:06:11,849 --> 01:06:15,609
doesn't matter and so in order to avoid
all these extra deletes they actually

2820
01:06:15,609 --> 01:06:15,619
all these extra deletes they actually
 

2821
01:06:15,619 --> 01:06:18,289
all these extra deletes they actually
fix the gutter servers so that they

2822
01:06:18,289 --> 01:06:18,299
fix the gutter servers so that they
 

2823
01:06:18,299 --> 01:06:22,609
fix the gutter servers so that they
delete Keys very rapidly instead of

2824
01:06:22,609 --> 01:06:22,619
delete Keys very rapidly instead of
 

2825
01:06:22,619 --> 01:06:23,930
delete Keys very rapidly instead of
hanging on to them until they're

2826
01:06:23,930 --> 01:06:23,940
hanging on to them until they're
 

2827
01:06:23,940 --> 01:06:27,979
hanging on to them until they're
explicitly deleted that was answer to

2828
01:06:27,979 --> 01:06:27,989
explicitly deleted that was answer to
 

2829
01:06:27,989 --> 01:06:34,339
explicitly deleted that was answer to
the question all right so I wanna talk a

2830
01:06:34,339 --> 01:06:34,349
the question all right so I wanna talk a
 

2831
01:06:34,349 --> 01:06:38,989
the question all right so I wanna talk a
bit about consistency all this at a

2832
01:06:38,989 --> 01:06:38,999
bit about consistency all this at a
 

2833
01:06:38,999 --> 01:06:43,150
bit about consistency all this at a
super high level you know the

2834
01:06:43,150 --> 01:06:43,160
super high level you know the
 

2835
01:06:43,160 --> 01:06:45,200
super high level you know the
consistency problem is that there's lots

2836
01:06:45,200 --> 01:06:45,210
consistency problem is that there's lots
 

2837
01:06:45,210 --> 01:06:47,569
consistency problem is that there's lots
of copies of the data for any given

2838
01:06:47,569 --> 01:06:47,579
of copies of the data for any given
 

2839
01:06:47,579 --> 01:06:50,509
of copies of the data for any given
piece of data you know there's a copy in

2840
01:06:50,509 --> 01:06:50,519
piece of data you know there's a copy in
 

2841
01:06:50,519 --> 01:06:53,059
piece of data you know there's a copy in
the primary database there's a copy in

2842
01:06:53,059 --> 01:06:53,069
the primary database there's a copy in
 

2843
01:06:53,069 --> 01:06:54,739
the primary database there's a copy in
the corresponding database server of

2844
01:06:54,739 --> 01:06:54,749
the corresponding database server of
 

2845
01:06:54,749 --> 01:06:58,039
the corresponding database server of
each of the secondary regions there's a

2846
01:06:58,039 --> 01:06:58,049
each of the secondary regions there's a
 

2847
01:06:58,049 --> 01:07:01,789
each of the secondary regions there's a
copy of that key in each local cluster

2848
01:07:01,789 --> 01:07:01,799
copy of that key in each local cluster
 

2849
01:07:01,799 --> 01:07:03,920
copy of that key in each local cluster
in one of the memcache keys in each

2850
01:07:03,920 --> 01:07:03,930
in one of the memcache keys in each
 

2851
01:07:03,930 --> 01:07:06,349
in one of the memcache keys in each
local cluster there may be copies of

2852
01:07:06,349 --> 01:07:06,359
local cluster there may be copies of
 

2853
01:07:06,359 --> 01:07:08,690
local cluster there may be copies of
that key and the gutter servers and

2854
01:07:08,690 --> 01:07:08,700
that key and the gutter servers and
 

2855
01:07:08,700 --> 01:07:11,390
that key and the gutter servers and
there may be copies of the key in the

2856
01:07:11,390 --> 01:07:11,400
there may be copies of the key in the
 

2857
01:07:11,400 --> 01:07:13,160
there may be copies of the key in the
memcache servers and the gutter memcache

2858
01:07:13,160 --> 01:07:13,170
memcache servers and the gutter memcache
 

2859
01:07:13,170 --> 01:07:14,839
memcache servers and the gutter memcache
servers at each other region so we have

2860
01:07:14,839 --> 01:07:14,849
servers at each other region so we have
 

2861
01:07:14,849 --> 01:07:17,390
servers at each other region so we have
lots and lots of copies of every piece

2862
01:07:17,390 --> 01:07:17,400
lots and lots of copies of every piece
 

2863
01:07:17,400 --> 01:07:19,249
lots and lots of copies of every piece
of data running around when a write

2864
01:07:19,249 --> 01:07:19,259
of data running around when a write
 

2865
01:07:19,259 --> 01:07:22,309
of data running around when a write
comes in you know the stuff has to

2866
01:07:22,309 --> 01:07:22,319
comes in you know the stuff has to
 

2867
01:07:22,319 --> 01:07:23,920
comes in you know the stuff has to
happen on all those copies and

2868
01:07:23,920 --> 01:07:23,930
happen on all those copies and
 

2869
01:07:23,930 --> 01:07:26,359
happen on all those copies and
furthermore the writes may come from

2870
01:07:26,359 --> 01:07:26,369
furthermore the writes may come from
 

2871
01:07:26,369 --> 01:07:28,309
furthermore the writes may come from
multiple sources the same key may be

2872
01:07:28,309 --> 01:07:28,319
multiple sources the same key may be
 

2873
01:07:28,319 --> 01:07:30,200
multiple sources the same key may be
written at the same time by multiple

2874
01:07:30,200 --> 01:07:30,210
written at the same time by multiple
 

2875
01:07:30,210 --> 01:07:31,999
written at the same time by multiple
front ends and this region may be by

2876
01:07:31,999 --> 01:07:32,009
front ends and this region may be by
 

2877
01:07:32,009 --> 01:07:35,900
front ends and this region may be by
friends and other regions too and so

2878
01:07:35,900 --> 01:07:35,910
friends and other regions too and so
 

2879
01:07:35,910 --> 01:07:38,239
friends and other regions too and so
it's this concurrency and multiple

2880
01:07:38,239 --> 01:07:38,249
it's this concurrency and multiple
 

2881
01:07:38,249 --> 01:07:40,489
it's this concurrency and multiple
copies and sort of multiple sources of

2882
01:07:40,489 --> 01:07:40,499
copies and sort of multiple sources of
 

2883
01:07:40,499 --> 01:07:42,849
copies and sort of multiple sources of
writes since there's multiple front ends

2884
01:07:42,849 --> 01:07:42,859
writes since there's multiple front ends
 

2885
01:07:42,859 --> 01:07:47,029
writes since there's multiple front ends
it creates a lot of opportunity for not

2886
01:07:47,029 --> 01:07:47,039
it creates a lot of opportunity for not
 

2887
01:07:47,039 --> 01:07:49,430
it creates a lot of opportunity for not
just for there to be stale data but for

2888
01:07:49,430 --> 01:07:49,440
just for there to be stale data but for
 

2889
01:07:49,440 --> 01:07:52,249
just for there to be stale data but for
data stale data to be left in the system

2890
01:07:52,249 --> 01:07:52,259
data stale data to be left in the system
 

2891
01:07:52,259 --> 01:07:58,700
data stale data to be left in the system
for long periods of time and so I want

2892
01:07:58,700 --> 01:07:58,710
for long periods of time and so I want
 

2893
01:07:58,710 --> 01:08:02,150
for long periods of time and so I want
to I want to illustrate what are those

2894
01:08:02,150 --> 01:08:02,160
to I want to illustrate what are those
 

2895
01:08:02,160 --> 01:08:03,440
to I want to illustrate what are those
problems actually in a sense we've

2896
01:08:03,440 --> 01:08:03,450
problems actually in a sense we've
 

2897
01:08:03,450 --> 01:08:05,209
problems actually in a sense we've
already talked a bit about this when

2898
01:08:05,209 --> 01:08:05,219
already talked a bit about this when
 

2899
01:08:05,219 --> 01:08:08,690
already talked a bit about this when
somebody asked why the front ends don't

2900
01:08:08,690 --> 01:08:08,700
somebody asked why the front ends don't
 

2901
01:08:08,700 --> 01:08:10,489
somebody asked why the front ends don't
update why do they delete instead of

2902
01:08:10,489 --> 01:08:10,499
update why do they delete instead of
 

2903
01:08:10,499 --> 01:08:12,079
update why do they delete instead of
updating so that's certainly one

2904
01:08:12,079 --> 01:08:12,089
updating so that's certainly one
 

2905
01:08:12,089 --> 01:08:13,560
updating so that's certainly one
instance of the kind of weather

2906
01:08:13,560 --> 01:08:13,570
instance of the kind of weather
 

2907
01:08:13,570 --> 01:08:17,040
instance of the kind of weather
multiple sources of data and so we have

2908
01:08:17,040 --> 01:08:17,050
multiple sources of data and so we have
 

2909
01:08:17,050 --> 01:08:22,050
multiple sources of data and so we have
trouble enforcing correct order but

2910
01:08:22,050 --> 01:08:22,060
trouble enforcing correct order but
 

2911
01:08:22,060 --> 01:08:25,820
trouble enforcing correct order but
here's another example of a race an

2912
01:08:25,820 --> 01:08:25,830
here's another example of a race an
 

2913
01:08:25,830 --> 01:08:28,440
here's another example of a race an
update race that if they hadn't done

2914
01:08:28,440 --> 01:08:28,450
update race that if they hadn't done
 

2915
01:08:28,450 --> 01:08:30,410
update race that if they hadn't done
something about it would have left data

2916
01:08:30,410 --> 01:08:30,420
something about it would have left data
 

2917
01:08:30,420 --> 01:08:31,770
something about it would have left data
indefinitely

2918
01:08:31,770 --> 01:08:31,780
indefinitely
 

2919
01:08:31,780 --> 01:08:36,530
indefinitely
stale data and definitely in memcache

2920
01:08:36,530 --> 01:08:36,540

 

2921
01:08:36,540 --> 01:08:38,700

it's going to be a similar flavor to the

2922
01:08:38,700 --> 01:08:38,710
it's going to be a similar flavor to the
 

2923
01:08:38,710 --> 01:08:40,530
it's going to be a similar flavor to the
previous example so supposing we have

2924
01:08:40,530 --> 01:08:40,540
previous example so supposing we have
 

2925
01:08:40,540 --> 01:08:47,420
previous example so supposing we have
client one he wants to read a key but

2926
01:08:47,420 --> 01:08:47,430
client one he wants to read a key but
 

2927
01:08:47,430 --> 01:08:51,750
client one he wants to read a key but
memcache says it doesn't have the data

2928
01:08:51,750 --> 01:08:51,760
memcache says it doesn't have the data
 

2929
01:08:51,760 --> 01:08:55,860
memcache says it doesn't have the data
it's a Miss so C one's gonna read the

2930
01:08:55,860 --> 01:08:55,870
it's a Miss so C one's gonna read the
 

2931
01:08:55,870 --> 01:09:02,340
it's a Miss so C one's gonna read the
data from from the database and let's

2932
01:09:02,340 --> 01:09:02,350
data from from the database and let's
 

2933
01:09:02,350 --> 01:09:07,740
data from from the database and let's
say it gets back some value that you

2934
01:09:07,740 --> 01:09:07,750
say it gets back some value that you
 

2935
01:09:07,750 --> 01:09:09,580
say it gets back some value that you
want

2936
01:09:09,580 --> 01:09:09,590
want
 

2937
01:09:09,590 --> 01:09:12,980
want
meanwhile client to wants to update this

2938
01:09:12,980 --> 01:09:12,990
meanwhile client to wants to update this
 

2939
01:09:12,990 --> 01:09:18,500
meanwhile client to wants to update this
data so it sends you know its rates he

2940
01:09:18,500 --> 01:09:18,510
data so it sends you know its rates he
 

2941
01:09:18,510 --> 01:09:22,870
data so it sends you know its rates he
equals v2 and sends that to the database

2942
01:09:22,870 --> 01:09:22,880
equals v2 and sends that to the database
 

2943
01:09:22,880 --> 01:09:26,660
equals v2 and sends that to the database
and then you know the rule for writes

2944
01:09:26,660 --> 01:09:26,670
and then you know the rule for writes
 

2945
01:09:26,670 --> 01:09:28,160
and then you know the rule for writes
the code for writes that we saw is that

2946
01:09:28,160 --> 01:09:28,170
the code for writes that we saw is that
 

2947
01:09:28,170 --> 01:09:29,720
the code for writes that we saw is that
the next thing we do is delete it from

2948
01:09:29,720 --> 01:09:29,730
the next thing we do is delete it from
 

2949
01:09:29,730 --> 01:09:33,650
the next thing we do is delete it from
the database from memcache d.c c2 is

2950
01:09:33,650 --> 01:09:33,660
the database from memcache d.c c2 is
 

2951
01:09:33,660 --> 01:09:35,380
the database from memcache d.c c2 is
going to delete

2952
01:09:35,380 --> 01:09:35,390
going to delete
 

2953
01:09:35,390 --> 01:09:39,430
going to delete
ah the key from the database oh that's a

2954
01:09:39,430 --> 01:09:39,440
ah the key from the database oh that's a
 

2955
01:09:39,440 --> 01:09:41,440
ah the key from the database oh that's a
Friday you know it was actually c2

2956
01:09:41,440 --> 01:09:41,450
Friday you know it was actually c2
 

2957
01:09:41,450 --> 01:09:42,970
Friday you know it was actually c2
doesn't really know what's in memcache d

2958
01:09:42,970 --> 01:09:42,980
doesn't really know what's in memcache d
 

2959
01:09:42,980 --> 01:09:44,350
doesn't really know what's in memcache d
but the leading was ever there is always

2960
01:09:44,350 --> 01:09:44,360
but the leading was ever there is always
 

2961
01:09:44,360 --> 01:09:48,420
but the leading was ever there is always
safe because certainly not gonna cause a

2962
01:09:48,420 --> 01:09:48,430
safe because certainly not gonna cause a
 

2963
01:09:48,430 --> 01:09:50,980
safe because certainly not gonna cause a
stale data to be deleting won't cause

2964
01:09:50,980 --> 01:09:50,990
stale data to be deleting won't cause
 

2965
01:09:50,990 --> 01:09:53,350
stale data to be deleting won't cause
her to be stilled Leena um and this is

2966
01:09:53,350 --> 01:09:53,360
her to be stilled Leena um and this is
 

2967
01:09:53,360 --> 01:09:55,300
her to be stilled Leena um and this is
the sense that the paper claims that

2968
01:09:55,300 --> 01:09:55,310
the sense that the paper claims that
 

2969
01:09:55,310 --> 01:09:59,200
the sense that the paper claims that
delete is idempotent said delete it's

2970
01:09:59,200 --> 01:09:59,210
delete is idempotent said delete it's
 

2971
01:09:59,210 --> 01:10:02,800
delete is idempotent said delete it's
always safe to kabhi but if you recall

2972
01:10:02,800 --> 01:10:02,810
always safe to kabhi but if you recall
 

2973
01:10:02,810 --> 01:10:05,950
always safe to kabhi but if you recall
the pseudocode for what a read does if

2974
01:10:05,950 --> 01:10:05,960
the pseudocode for what a read does if
 

2975
01:10:05,960 --> 01:10:07,540
the pseudocode for what a read does if
you miss and you read the data from the

2976
01:10:07,540 --> 01:10:07,550
you miss and you read the data from the
 

2977
01:10:07,550 --> 01:10:09,130
you miss and you read the data from the
database you're supposed to just insert

2978
01:10:09,130 --> 01:10:09,140
database you're supposed to just insert
 

2979
01:10:09,140 --> 01:10:12,130
database you're supposed to just insert
that data into memcache so client 1 you

2980
01:10:12,130 --> 01:10:12,140
that data into memcache so client 1 you
 

2981
01:10:12,140 --> 01:10:13,840
that data into memcache so client 1 you
know may have been slow and finally gets

2982
01:10:13,840 --> 01:10:13,850
know may have been slow and finally gets
 

2983
01:10:13,850 --> 01:10:19,420
know may have been slow and finally gets
around to sending a set RPC two memcache

2984
01:10:19,420 --> 01:10:19,430
around to sending a set RPC two memcache
 

2985
01:10:19,430 --> 01:10:21,700
around to sending a set RPC two memcache
T but it read version 1 and read a you

2986
01:10:21,700 --> 01:10:21,710
T but it read version 1 and read a you
 

2987
01:10:21,710 --> 01:10:23,860
T but it read version 1 and read a you
know what is now an old outdated version

2988
01:10:23,860 --> 01:10:23,870
know what is now an old outdated version
 

2989
01:10:23,870 --> 01:10:26,590
know what is now an old outdated version
of the data from the database but it's

2990
01:10:26,590 --> 01:10:26,600
of the data from the database but it's
 

2991
01:10:26,600 --> 01:10:33,010
of the data from the database but it's
going to set that into

2992
01:10:33,010 --> 01:10:33,020

 

2993
01:10:33,020 --> 01:10:35,650

set this into memcache and yeah you know

2994
01:10:35,650 --> 01:10:35,660
set this into memcache and yeah you know
 

2995
01:10:35,660 --> 01:10:36,970
set this into memcache and yeah you know
one other thing that happened is that we

2996
01:10:36,970 --> 01:10:36,980
one other thing that happened is that we
 

2997
01:10:36,980 --> 01:10:39,160
one other thing that happened is that we
know the database is is whenever you

2998
01:10:39,160 --> 01:10:39,170
know the database is is whenever you
 

2999
01:10:39,170 --> 01:10:40,720
know the database is is whenever you
write something I'm database that sends

3000
01:10:40,720 --> 01:10:40,730
write something I'm database that sends
 

3001
01:10:40,730 --> 01:10:42,820
write something I'm database that sends
deletes to memcache D so of course maybe

3002
01:10:42,820 --> 01:10:42,830
deletes to memcache D so of course maybe
 

3003
01:10:42,830 --> 01:10:44,260
deletes to memcache D so of course maybe
at this point the database will also

3004
01:10:44,260 --> 01:10:44,270
at this point the database will also
 

3005
01:10:44,270 --> 01:10:47,500
at this point the database will also
have sent a delete

3006
01:10:47,500 --> 01:10:47,510
have sent a delete
 

3007
01:10:47,510 --> 01:10:51,050
have sent a delete
for k2m caste and so now we get to

3008
01:10:51,050 --> 01:10:51,060
for k2m caste and so now we get to
 

3009
01:10:51,060 --> 01:10:52,070
for k2m caste and so now we get to
deletes but it doesn't really matter

3010
01:10:52,070 --> 01:10:52,080
deletes but it doesn't really matter
 

3011
01:10:52,080 --> 01:10:53,150
deletes but it doesn't really matter
right these lease may already have

3012
01:10:53,150 --> 01:10:53,160
right these lease may already have
 

3013
01:10:53,160 --> 01:10:55,190
right these lease may already have
happened by the time client one gets

3014
01:10:55,190 --> 01:10:55,200
happened by the time client one gets
 

3015
01:10:55,200 --> 01:10:59,720
happened by the time client one gets
around to updating this key and so at

3016
01:10:59,720 --> 01:10:59,730
around to updating this key and so at
 

3017
01:10:59,730 --> 01:11:03,470
around to updating this key and so at
this point indefinitely the memcache D

3018
01:11:03,470 --> 01:11:03,480
this point indefinitely the memcache D
 

3019
01:11:03,480 --> 01:11:06,410
this point indefinitely the memcache D
will be cashing a stale version of of

3020
01:11:06,410 --> 01:11:06,420
will be cashing a stale version of of
 

3021
01:11:06,420 --> 01:11:08,030
will be cashing a stale version of of
this data and there's just no mechanism

3022
01:11:08,030 --> 01:11:08,040
this data and there's just no mechanism
 

3023
01:11:08,040 --> 01:11:11,810
this data and there's just no mechanism
anymore or this is them if the system

3024
01:11:11,810 --> 01:11:11,820
anymore or this is them if the system
 

3025
01:11:11,820 --> 01:11:14,090
anymore or this is them if the system
worked in just this way there's no

3026
01:11:14,090 --> 01:11:14,100
worked in just this way there's no
 

3027
01:11:14,100 --> 01:11:16,550
worked in just this way there's no
mechanism for the memcache D to ever see

3028
01:11:16,550 --> 01:11:16,560
mechanism for the memcache D to ever see
 

3029
01:11:16,560 --> 01:11:20,300
mechanism for the memcache D to ever see
to ever get the actual correct value

3030
01:11:20,300 --> 01:11:20,310
to ever get the actual correct value
 

3031
01:11:20,310 --> 01:11:23,660
to ever get the actual correct value
it's gonna store and serve up stale data

3032
01:11:23,660 --> 01:11:23,670
it's gonna store and serve up stale data
 

3033
01:11:23,670 --> 01:11:27,359
it's gonna store and serve up stale data
for key K forever

3034
01:11:27,359 --> 01:11:27,369

 

3035
01:11:27,369 --> 01:11:30,209

and they because they ran into this and

3036
01:11:30,209 --> 01:11:30,219
and they because they ran into this and
 

3037
01:11:30,219 --> 01:11:32,680
and they because they ran into this and
while they're okay with data being

3038
01:11:32,680 --> 01:11:32,690
while they're okay with data being
 

3039
01:11:32,690 --> 01:11:35,080
while they're okay with data being
somewhat out-of-date they're not okay

3040
01:11:35,080 --> 01:11:35,090
somewhat out-of-date they're not okay
 

3041
01:11:35,090 --> 01:11:37,240
somewhat out-of-date they're not okay
with data being out of date forever

3042
01:11:37,240 --> 01:11:37,250
with data being out of date forever
 

3043
01:11:37,250 --> 01:11:38,979
with data being out of date forever
because users will eventually notice

3044
01:11:38,979 --> 01:11:38,989
because users will eventually notice
 

3045
01:11:38,989 --> 01:11:42,339
because users will eventually notice
that they're seeing ancient data and so

3046
01:11:42,339 --> 01:11:42,349
that they're seeing ancient data and so
 

3047
01:11:42,349 --> 01:11:44,260
that they're seeing ancient data and so
they had to solve this they had to make

3048
01:11:44,260 --> 01:11:44,270
they had to solve this they had to make
 

3049
01:11:44,270 --> 01:11:49,240
they had to solve this they had to make
sure that this scenario didn't happen

3050
01:11:49,240 --> 01:11:49,250

 

3051
01:11:49,250 --> 01:11:51,339

they actually solved this this problem

3052
01:11:51,339 --> 01:11:51,349
they actually solved this this problem
 

3053
01:11:51,349 --> 01:11:54,910
they actually solved this this problem
also with the lease mechanism at the

3054
01:11:54,910 --> 01:11:54,920
also with the lease mechanism at the
 

3055
01:11:54,920 --> 01:11:56,290
also with the lease mechanism at the
same lease mechanism that we describe

3056
01:11:56,290 --> 01:11:56,300
same lease mechanism that we describe
 

3057
01:11:56,300 --> 01:11:58,540
same lease mechanism that we describe
for the Thundering hoard although

3058
01:11:58,540 --> 01:11:58,550
for the Thundering hoard although
 

3059
01:11:58,550 --> 01:12:01,450
for the Thundering hoard although
there's an extension to the lease

3060
01:12:01,450 --> 01:12:01,460
there's an extension to the lease
 

3061
01:12:01,460 --> 01:12:04,149
there's an extension to the lease
mechanism that makes this work so what

3062
01:12:04,149 --> 01:12:04,159
mechanism that makes this work so what
 

3063
01:12:04,159 --> 01:12:06,459
mechanism that makes this work so what
happens is that when memcache descends

3064
01:12:06,459 --> 01:12:06,469
happens is that when memcache descends
 

3065
01:12:06,469 --> 01:12:07,930
happens is that when memcache descends
back a Miss indication seeing the data

3066
01:12:07,930 --> 01:12:07,940
back a Miss indication seeing the data
 

3067
01:12:07,940 --> 01:12:10,000
back a Miss indication seeing the data
wasn't in the cache it's gonna grant the

3068
01:12:10,000 --> 01:12:10,010
wasn't in the cache it's gonna grant the
 

3069
01:12:10,010 --> 01:12:13,089
wasn't in the cache it's gonna grant the
lease so we get the Miss indication plus

3070
01:12:13,089 --> 01:12:13,099
lease so we get the Miss indication plus
 

3071
01:12:13,099 --> 01:12:17,319
lease so we get the Miss indication plus
this lease which is basically just a big

3072
01:12:17,319 --> 01:12:17,329
this lease which is basically just a big
 

3073
01:12:17,329 --> 01:12:19,450
this lease which is basically just a big
unique number and the memcache server is

3074
01:12:19,450 --> 01:12:19,460
unique number and the memcache server is
 

3075
01:12:19,460 --> 01:12:21,580
unique number and the memcache server is
gonna remember that the association

3076
01:12:21,580 --> 01:12:21,590
gonna remember that the association
 

3077
01:12:21,590 --> 01:12:23,830
gonna remember that the association
between this lease and this key it knows

3078
01:12:23,830 --> 01:12:23,840
between this lease and this key it knows
 

3079
01:12:23,840 --> 01:12:27,430
between this lease and this key it knows
that somebody out there with a lease to

3080
01:12:27,430 --> 01:12:27,440
that somebody out there with a lease to
 

3081
01:12:27,440 --> 01:12:31,330
that somebody out there with a lease to
update this key the new rule is that

3082
01:12:31,330 --> 01:12:31,340
update this key the new rule is that
 

3083
01:12:31,340 --> 01:12:34,689
update this key the new rule is that
when the when the memcache server gets a

3084
01:12:34,689 --> 01:12:34,699
when the when the memcache server gets a
 

3085
01:12:34,699 --> 01:12:36,790
when the when the memcache server gets a
delete from either another client or

3086
01:12:36,790 --> 01:12:36,800
delete from either another client or
 

3087
01:12:36,800 --> 01:12:39,669
delete from either another client or
from the database server the memcache

3088
01:12:39,669 --> 01:12:39,679
from the database server the memcache
 

3089
01:12:39,679 --> 01:12:42,430
from the database server the memcache
server is gonna as well as deleting the

3090
01:12:42,430 --> 01:12:42,440
server is gonna as well as deleting the
 

3091
01:12:42,440 --> 01:12:44,410
server is gonna as well as deleting the
item is going to invalidate this lease

3092
01:12:44,410 --> 01:12:44,420
item is going to invalidate this lease
 

3093
01:12:44,420 --> 01:12:46,839
item is going to invalidate this lease
so as soon as either these deletes come

3094
01:12:46,839 --> 01:12:46,849
so as soon as either these deletes come
 

3095
01:12:46,849 --> 01:12:49,569
so as soon as either these deletes come
in assuming that Elyse arrived first the

3096
01:12:49,569 --> 01:12:49,579
in assuming that Elyse arrived first the
 

3097
01:12:49,579 --> 01:12:52,450
in assuming that Elyse arrived first the
memcache server is gonna believe this

3098
01:12:52,450 --> 01:12:52,460
memcache server is gonna believe this
 

3099
01:12:52,460 --> 01:12:55,240
memcache server is gonna believe this
lease from its table about leases this

3100
01:12:55,240 --> 01:12:55,250
lease from its table about leases this
 

3101
01:12:55,250 --> 01:12:59,669
lease from its table about leases this
set

3102
01:12:59,669 --> 01:12:59,679

 

3103
01:12:59,679 --> 01:13:02,729

is the lease back from the front end now

3104
01:13:02,729 --> 01:13:02,739
is the lease back from the front end now
 

3105
01:13:02,739 --> 01:13:05,729
is the lease back from the front end now
when the set arrives the memcache server

3106
01:13:05,729 --> 01:13:05,739
when the set arrives the memcache server
 

3107
01:13:05,739 --> 01:13:06,959
when the set arrives the memcache server
will look at the lease and say wait a

3108
01:13:06,959 --> 01:13:06,969
will look at the lease and say wait a
 

3109
01:13:06,969 --> 01:13:09,750
will look at the lease and say wait a
minute I you don't have a lease for this

3110
01:13:09,750 --> 01:13:09,760
minute I you don't have a lease for this
 

3111
01:13:09,760 --> 01:13:12,270
minute I you don't have a lease for this
key all right invalid if these fit this

3112
01:13:12,270 --> 01:13:12,280
key all right invalid if these fit this
 

3113
01:13:12,280 --> 01:13:14,970
key all right invalid if these fit this
key I'm gonna ignore this set so because

3114
01:13:14,970 --> 01:13:14,980
key I'm gonna ignore this set so because
 

3115
01:13:14,980 --> 01:13:16,620
key I'm gonna ignore this set so because
the lease has been because one of these

3116
01:13:16,620 --> 01:13:16,630
the lease has been because one of these
 

3117
01:13:16,630 --> 01:13:18,959
the lease has been because one of these
if one of these deletes came in before

3118
01:13:18,959 --> 01:13:18,969
if one of these deletes came in before
 

3119
01:13:18,969 --> 01:13:21,689
if one of these deletes came in before
the set this sees to be invalid in

3120
01:13:21,689 --> 01:13:21,699
the set this sees to be invalid in
 

3121
01:13:21,699 --> 01:13:24,030
the set this sees to be invalid in
invalidated and the memcache server

3122
01:13:24,030 --> 01:13:24,040
invalidated and the memcache server
 

3123
01:13:24,040 --> 01:13:27,120
invalidated and the memcache server
would ignore this set and that would

3124
01:13:27,120 --> 01:13:27,130
would ignore this set and that would
 

3125
01:13:27,130 --> 01:13:29,910
would ignore this set and that would
mean that the key would note just stay

3126
01:13:29,910 --> 01:13:29,920
mean that the key would note just stay
 

3127
01:13:29,920 --> 01:13:33,330
mean that the key would note just stay
missing from memcache and the next

3128
01:13:33,330 --> 01:13:33,340
missing from memcache and the next
 

3129
01:13:33,340 --> 01:13:34,890
missing from memcache and the next
client that tried to read that key

3130
01:13:34,890 --> 01:13:34,900
client that tried to read that key
 

3131
01:13:34,900 --> 01:13:37,050
client that tried to read that key
you'll get a Miss would read the fresh

3132
01:13:37,050 --> 01:13:37,060
you'll get a Miss would read the fresh
 

3133
01:13:37,060 --> 01:13:40,110
you'll get a Miss would read the fresh
data now from the database and would

3134
01:13:40,110 --> 01:13:40,120
data now from the database and would
 

3135
01:13:40,120 --> 01:13:41,550
data now from the database and would
install it in memcache and presumably

3136
01:13:41,550 --> 01:13:41,560
install it in memcache and presumably
 

3137
01:13:41,560 --> 01:13:43,890
install it in memcache and presumably
the second time around

3138
01:13:43,890 --> 01:13:43,900
the second time around
 

3139
01:13:43,900 --> 01:13:46,910
the second time around
the second readers lease would be valid

3140
01:13:46,910 --> 01:13:46,920
the second readers lease would be valid
 

3141
01:13:46,920 --> 01:13:49,890
the second readers lease would be valid
um you may and indeed you should ask

3142
01:13:49,890 --> 01:13:49,900
um you may and indeed you should ask
 

3143
01:13:49,900 --> 01:13:51,030
um you may and indeed you should ask
what happened that the order is

3144
01:13:51,030 --> 01:13:51,040
what happened that the order is
 

3145
01:13:51,040 --> 01:13:53,959
what happened that the order is
different so supposing these deletes

3146
01:13:53,959 --> 01:13:53,969
different so supposing these deletes
 

3147
01:13:53,969 --> 01:13:56,419
different so supposing these deletes
instead of happening before the set

3148
01:13:56,419 --> 01:13:56,429
instead of happening before the set
 

3149
01:13:56,429 --> 01:13:59,479
instead of happening before the set
these deletes were instead to have

3150
01:13:59,479 --> 01:13:59,489
these deletes were instead to have
 

3151
01:13:59,489 --> 01:14:02,399
these deletes were instead to have
happen after the set I want to make sure

3152
01:14:02,399 --> 01:14:02,409
happen after the set I want to make sure
 

3153
01:14:02,409 --> 01:14:05,850
happen after the set I want to make sure
this scheme still works then and so how

3154
01:14:05,850 --> 01:14:05,860
this scheme still works then and so how
 

3155
01:14:05,860 --> 01:14:08,820
this scheme still works then and so how
things would play out then is that since

3156
01:14:08,820 --> 01:14:08,830
things would play out then is that since
 

3157
01:14:08,830 --> 01:14:12,570
things would play out then is that since
if these Dilys were late happened after

3158
01:14:12,570 --> 01:14:12,580
if these Dilys were late happened after
 

3159
01:14:12,580 --> 01:14:14,729
if these Dilys were late happened after
the set the memcache server wouldn't

3160
01:14:14,729 --> 01:14:14,739
the set the memcache server wouldn't
 

3161
01:14:14,739 --> 01:14:17,090
the set the memcache server wouldn't
delete these from its table of visas

3162
01:14:17,090 --> 01:14:17,100
delete these from its table of visas
 

3163
01:14:17,100 --> 01:14:19,350
delete these from its table of visas
Solis would still be there when the set

3164
01:14:19,350 --> 01:14:19,360
Solis would still be there when the set
 

3165
01:14:19,360 --> 01:14:22,140
Solis would still be there when the set
came and yes indeed we would still then

3166
01:14:22,140 --> 01:14:22,150
came and yes indeed we would still then
 

3167
01:14:22,150 --> 01:14:25,620
came and yes indeed we would still then
it would accept the setting we would be

3168
01:14:25,620 --> 01:14:25,630
it would accept the setting we would be
 

3169
01:14:25,630 --> 01:14:30,030
it would accept the setting we would be
setting key to a stale value but our

3170
01:14:30,030 --> 01:14:30,040
setting key to a stale value but our
 

3171
01:14:30,040 --> 01:14:31,500
setting key to a stale value but our
assumption was this time that the

3172
01:14:31,500 --> 01:14:31,510
assumption was this time that the
 

3173
01:14:31,510 --> 01:14:33,240
assumption was this time that the
deletes had been late and that means the

3174
01:14:33,240 --> 01:14:33,250
deletes had been late and that means the
 

3175
01:14:33,250 --> 01:14:35,250
deletes had been late and that means the
Dilys are yet to arrive and when they

3176
01:14:35,250 --> 01:14:35,260
Dilys are yet to arrive and when they
 

3177
01:14:35,260 --> 01:14:37,290
Dilys are yet to arrive and when they
when these deletes arrive then this stay

3178
01:14:37,290 --> 01:14:37,300
when these deletes arrive then this stay
 

3179
01:14:37,300 --> 01:14:39,479
when these deletes arrive then this stay
on theta will be knocked out of the

3180
01:14:39,479 --> 01:14:39,489
on theta will be knocked out of the
 

3181
01:14:39,489 --> 01:14:41,370
on theta will be knocked out of the
cache and so the stale date will be in

3182
01:14:41,370 --> 01:14:41,380
cache and so the stale date will be in
 

3183
01:14:41,380 --> 01:14:42,990
cache and so the stale date will be in
the cache a little bit longer but we

3184
01:14:42,990 --> 01:14:43,000
the cache a little bit longer but we
 

3185
01:14:43,000 --> 01:14:45,750
the cache a little bit longer but we
won't have this situation where stale

3186
01:14:45,750 --> 01:14:45,760
won't have this situation where stale
 

3187
01:14:45,760 --> 01:14:47,600
won't have this situation where stale
data is sitting in the cache

3188
01:14:47,600 --> 01:14:47,610
data is sitting in the cache
 

3189
01:14:47,610 --> 01:14:52,250
data is sitting in the cache
indefinitely and never deleted

3190
01:14:52,250 --> 01:14:52,260

 

3191
01:14:52,260 --> 01:14:54,880

any questions

3192
01:14:54,880 --> 01:14:54,890
any questions
 

3193
01:14:54,890 --> 01:15:07,900
any questions
lissa machinery okay um to wrap up you

3194
01:15:07,900 --> 01:15:07,910
lissa machinery okay um to wrap up you
 

3195
01:15:07,910 --> 01:15:10,940
lissa machinery okay um to wrap up you
it's certainly fair to view this system

3196
01:15:10,940 --> 01:15:10,950
it's certainly fair to view this system
 

3197
01:15:10,950 --> 01:15:12,800
it's certainly fair to view this system
a lot of the complexity of the system as

3198
01:15:12,800 --> 01:15:12,810
a lot of the complexity of the system as
 

3199
01:15:12,810 --> 01:15:14,900
a lot of the complexity of the system as
stemming from the fact that it was sort

3200
01:15:14,900 --> 01:15:14,910
stemming from the fact that it was sort
 

3201
01:15:14,910 --> 01:15:17,320
stemming from the fact that it was sort
of put together out of pieces that

3202
01:15:17,320 --> 01:15:17,330
of put together out of pieces that
 

3203
01:15:17,330 --> 01:15:20,000
of put together out of pieces that
didn't know about each other like it

3204
01:15:20,000 --> 01:15:20,010
didn't know about each other like it
 

3205
01:15:20,010 --> 01:15:21,890
didn't know about each other like it
would be nice for example memcached he

3206
01:15:21,890 --> 01:15:21,900
would be nice for example memcached he
 

3207
01:15:21,900 --> 01:15:24,050
would be nice for example memcached he
knew about the database I'm understand

3208
01:15:24,050 --> 01:15:24,060
knew about the database I'm understand
 

3209
01:15:24,060 --> 01:15:25,880
knew about the database I'm understand
memcache D and the database kind of

3210
01:15:25,880 --> 01:15:25,890
memcache D and the database kind of
 

3211
01:15:25,890 --> 01:15:31,870
memcache D and the database kind of
cooperated in a consistency scheme and

3212
01:15:31,870 --> 01:15:31,880
cooperated in a consistency scheme and
 

3213
01:15:31,880 --> 01:15:35,930
cooperated in a consistency scheme and
perhaps if Facebook could have at the

3214
01:15:35,930 --> 01:15:35,940
perhaps if Facebook could have at the
 

3215
01:15:35,940 --> 01:15:38,350
perhaps if Facebook could have at the
very beginning you know predicted the

3216
01:15:38,350 --> 01:15:38,360
very beginning you know predicted the
 

3217
01:15:38,360 --> 01:15:40,430
very beginning you know predicted the
how things would play out on what the

3218
01:15:40,430 --> 01:15:40,440
how things would play out on what the
 

3219
01:15:40,440 --> 01:15:42,400
how things would play out on what the
problems would be and if they have had

3220
01:15:42,400 --> 01:15:42,410
problems would be and if they have had
 

3221
01:15:42,410 --> 01:15:44,480
problems would be and if they have had
enough engineers to work on it they

3222
01:15:44,480 --> 01:15:44,490
enough engineers to work on it they
 

3223
01:15:44,490 --> 01:15:45,590
enough engineers to work on it they
could have from the beginning built a

3224
01:15:45,590 --> 01:15:45,600
could have from the beginning built a
 

3225
01:15:45,600 --> 01:15:48,470
could have from the beginning built a
system that could provide both all the

3226
01:15:48,470 --> 01:15:48,480
system that could provide both all the
 

3227
01:15:48,480 --> 01:15:50,110
system that could provide both all the
things they needed high-performance

3228
01:15:50,110 --> 01:15:50,120
things they needed high-performance
 

3229
01:15:50,120 --> 01:15:54,110
things they needed high-performance
multi data center replication partition

3230
01:15:54,110 --> 01:15:54,120
multi data center replication partition
 

3231
01:15:54,120 --> 01:15:57,610
multi data center replication partition
and everything and they're having

3232
01:15:57,610 --> 01:15:57,620
and everything and they're having
 

3233
01:15:57,620 --> 01:15:59,570
and everything and they're having
companies that have done that so the

3234
01:15:59,570 --> 01:15:59,580
companies that have done that so the
 

3235
01:15:59,580 --> 01:16:01,700
companies that have done that so the
example I know of that sort of most

3236
01:16:01,700 --> 01:16:01,710
example I know of that sort of most
 

3237
01:16:01,710 --> 01:16:06,410
example I know of that sort of most
directly comparable to the system in

3238
01:16:06,410 --> 01:16:06,420
directly comparable to the system in
 

3239
01:16:06,420 --> 01:16:08,840
directly comparable to the system in
this paper is that if you care about

3240
01:16:08,840 --> 01:16:08,850
this paper is that if you care about
 

3241
01:16:08,850 --> 01:16:10,790
this paper is that if you care about
this stuff you might want to look at it

3242
01:16:10,790 --> 01:16:10,800
this stuff you might want to look at it
 

3243
01:16:10,800 --> 01:16:16,810
this stuff you might want to look at it
is Yahoo's peanuts storage system which

3244
01:16:16,810 --> 01:16:16,820
is Yahoo's peanuts storage system which
 

3245
01:16:16,820 --> 01:16:20,530
is Yahoo's peanuts storage system which
in a sort of designed from scratch and

3246
01:16:20,530 --> 01:16:20,540
in a sort of designed from scratch and
 

3247
01:16:20,540 --> 01:16:23,090
in a sort of designed from scratch and
you know different different in many

3248
01:16:23,090 --> 01:16:23,100
you know different different in many
 

3249
01:16:23,100 --> 01:16:26,090
you know different different in many
details but it does provide multi-site

3250
01:16:26,090 --> 01:16:26,100
details but it does provide multi-site
 

3251
01:16:26,100 --> 01:16:30,140
details but it does provide multi-site
replication with consistency and good

3252
01:16:30,140 --> 01:16:30,150
replication with consistency and good
 

3253
01:16:30,150 --> 01:16:32,720
replication with consistency and good
performance so it's possible to do

3254
01:16:32,720 --> 01:16:32,730
performance so it's possible to do
 

3255
01:16:32,730 --> 01:16:34,840
performance so it's possible to do
better but you know all the issues are

3256
01:16:34,840 --> 01:16:34,850
better but you know all the issues are
 

3257
01:16:34,850 --> 01:16:37,120
better but you know all the issues are
present that's just had a more

3258
01:16:37,120 --> 01:16:37,130
present that's just had a more
 

3259
01:16:37,130 --> 01:16:40,310
present that's just had a more
integrated perhaps elegant set of

3260
01:16:40,310 --> 01:16:40,320
integrated perhaps elegant set of
 

3261
01:16:40,320 --> 01:16:41,260
integrated perhaps elegant set of
solutions

3262
01:16:41,260 --> 01:16:41,270
solutions
 

3263
01:16:41,270 --> 01:16:44,800
solutions
the takeaway so for us from this paper

3264
01:16:44,800 --> 01:16:44,810
the takeaway so for us from this paper
 

3265
01:16:44,810 --> 01:16:47,960
the takeaway so for us from this paper
one is that for them at least and for

3266
01:16:47,960 --> 01:16:47,970
one is that for them at least and for
 

3267
01:16:47,970 --> 01:16:50,300
one is that for them at least and for
many big operations caching is vital

3268
01:16:50,300 --> 01:16:50,310
many big operations caching is vital
 

3269
01:16:50,310 --> 01:16:54,200
many big operations caching is vital
absolutely vital for to survive high

3270
01:16:54,200 --> 01:16:54,210
absolutely vital for to survive high
 

3271
01:16:54,210 --> 01:16:57,050
absolutely vital for to survive high
load and the caching is not so much

3272
01:16:57,050 --> 01:16:57,060
load and the caching is not so much
 

3273
01:16:57,060 --> 01:16:59,570
load and the caching is not so much
about reducing latency it's much more

3274
01:16:59,570 --> 01:16:59,580
about reducing latency it's much more
 

3275
01:16:59,580 --> 01:17:02,740
about reducing latency it's much more
about hiding enormous load from

3276
01:17:02,740 --> 01:17:02,750
about hiding enormous load from
 

3277
01:17:02,750 --> 01:17:05,560
about hiding enormous load from
relatively slow

3278
01:17:05,560 --> 01:17:05,570
relatively slow
 

3279
01:17:05,570 --> 01:17:08,870
relatively slow
storage servers that's what a cache is

3280
01:17:08,870 --> 01:17:08,880
storage servers that's what a cache is
 

3281
01:17:08,880 --> 01:17:11,509
storage servers that's what a cache is
really doing for Facebook is hiding sort

3282
01:17:11,509 --> 01:17:11,519
really doing for Facebook is hiding sort
 

3283
01:17:11,519 --> 01:17:13,250
really doing for Facebook is hiding sort
of concealing almost all the load from

3284
01:17:13,250 --> 01:17:13,260
of concealing almost all the load from
 

3285
01:17:13,260 --> 01:17:18,049
of concealing almost all the load from
the database servers another takeaway is

3286
01:17:18,049 --> 01:17:18,059
the database servers another takeaway is
 

3287
01:17:18,059 --> 01:17:20,720
the database servers another takeaway is
that you always in big systems you

3288
01:17:20,720 --> 01:17:20,730
that you always in big systems you
 

3289
01:17:20,730 --> 01:17:23,120
that you always in big systems you
always need to be thinking about caching

3290
01:17:23,120 --> 01:17:23,130
always need to be thinking about caching
 

3291
01:17:23,130 --> 01:17:25,879
always need to be thinking about caching
versus control versus sorry partition

3292
01:17:25,879 --> 01:17:25,889
versus control versus sorry partition
 

3293
01:17:25,889 --> 01:17:28,399
versus control versus sorry partition
versus replication I mean you need ways

3294
01:17:28,399 --> 01:17:28,409
versus replication I mean you need ways
 

3295
01:17:28,409 --> 01:17:32,239
versus replication I mean you need ways
of either formally or informally sort of

3296
01:17:32,239 --> 01:17:32,249
of either formally or informally sort of
 

3297
01:17:32,249 --> 01:17:34,009
of either formally or informally sort of
deciding how much your resources are

3298
01:17:34,009 --> 01:17:34,019
deciding how much your resources are
 

3299
01:17:34,019 --> 01:17:35,629
deciding how much your resources are
going to be devoted to partitioning and

3300
01:17:35,629 --> 01:17:35,639
going to be devoted to partitioning and
 

3301
01:17:35,639 --> 01:17:40,569
going to be devoted to partitioning and
how much to replication and finally

3302
01:17:40,569 --> 01:17:40,579
how much to replication and finally
 

3303
01:17:40,579 --> 01:17:42,770
how much to replication and finally
ideally you'd be able to do a better job

3304
01:17:42,770 --> 01:17:42,780
ideally you'd be able to do a better job
 

3305
01:17:42,780 --> 01:17:45,229
ideally you'd be able to do a better job
in this paper about from the beginning

3306
01:17:45,229 --> 01:17:45,239
in this paper about from the beginning
 

3307
01:17:45,239 --> 01:17:47,209
in this paper about from the beginning
integrating the different storage layers

3308
01:17:47,209 --> 01:17:47,219
integrating the different storage layers
 

3309
01:17:47,219 --> 01:17:51,459
integrating the different storage layers
in order to achieve good consistency

3310
01:17:51,459 --> 01:17:51,469
in order to achieve good consistency
 

3311
01:17:51,469 --> 01:17:56,209
in order to achieve good consistency
okay that is all I have to say please

3312
01:17:56,209 --> 01:17:56,219
okay that is all I have to say please
 

3313
01:17:56,219 --> 01:17:59,510
okay that is all I have to say please
ask me questions if you have

