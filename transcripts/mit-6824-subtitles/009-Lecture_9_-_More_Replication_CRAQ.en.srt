1
00:00:00,729 --> 00:00:03,399

today I want to do two things I want to

2
00:00:03,399 --> 00:00:03,409
today I want to do two things I want to
 

3
00:00:03,409 --> 00:00:06,190
today I want to do two things I want to
finish the discussion of zookeeper and

4
00:00:06,190 --> 00:00:06,200
finish the discussion of zookeeper and
 

5
00:00:06,200 --> 00:00:10,600
finish the discussion of zookeeper and
then talk about crack the particular

6
00:00:10,600 --> 00:00:10,610
then talk about crack the particular
 

7
00:00:10,610 --> 00:00:12,310
then talk about crack the particular
things that I'm most interested in

8
00:00:12,310 --> 00:00:12,320
things that I'm most interested in
 

9
00:00:12,320 --> 00:00:15,129
things that I'm most interested in
talking about a bad zookeeper are the

10
00:00:15,129 --> 00:00:15,139
talking about a bad zookeeper are the
 

11
00:00:15,139 --> 00:00:17,680
talking about a bad zookeeper are the
design of its API that allows the

12
00:00:17,680 --> 00:00:17,690
design of its API that allows the
 

13
00:00:17,690 --> 00:00:19,170
design of its API that allows the
zookeeper to be a general-purpose

14
00:00:19,170 --> 00:00:19,180
zookeeper to be a general-purpose
 

15
00:00:19,180 --> 00:00:21,640
zookeeper to be a general-purpose
service that really bites off

16
00:00:21,640 --> 00:00:21,650
service that really bites off
 

17
00:00:21,650 --> 00:00:24,550
service that really bites off
significant tasks that distributed

18
00:00:24,550 --> 00:00:24,560
significant tasks that distributed
 

19
00:00:24,560 --> 00:00:27,190
significant tasks that distributed
systems need so why is this you know why

20
00:00:27,190 --> 00:00:27,200
systems need so why is this you know why
 

21
00:00:27,200 --> 00:00:29,860
systems need so why is this you know why
is that a good API design and then the

22
00:00:29,860 --> 00:00:29,870
is that a good API design and then the
 

23
00:00:29,870 --> 00:00:33,639
is that a good API design and then the
really more specific topic of mini

24
00:00:33,639 --> 00:00:33,649
really more specific topic of mini
 

25
00:00:33,649 --> 00:00:35,169
really more specific topic of mini
transactions turns out this is a

26
00:00:35,169 --> 00:00:35,179
transactions turns out this is a
 

27
00:00:35,179 --> 00:00:38,590
transactions turns out this is a
worthwhile idea to know so they got API

28
00:00:38,590 --> 00:00:38,600
worthwhile idea to know so they got API
 

29
00:00:38,600 --> 00:00:50,110
worthwhile idea to know so they got API
and I'm just just a recall zookeepers

30
00:00:50,110 --> 00:00:50,120
and I'm just just a recall zookeepers
 

31
00:00:50,120 --> 00:00:52,149
and I'm just just a recall zookeepers
based on raft and so we can think of it

32
00:00:52,149 --> 00:00:52,159
based on raft and so we can think of it
 

33
00:00:52,159 --> 00:00:54,939
based on raft and so we can think of it
as being and indeed it is fault tolerant

34
00:00:54,939 --> 00:00:54,949
as being and indeed it is fault tolerant
 

35
00:00:54,949 --> 00:00:56,410
as being and indeed it is fault tolerant
and does the right thing with respect to

36
00:00:56,410 --> 00:00:56,420
and does the right thing with respect to
 

37
00:00:56,420 --> 00:01:00,669
and does the right thing with respect to
partitions it has this sort of

38
00:01:00,669 --> 00:01:00,679
partitions it has this sort of
 

39
00:01:00,679 --> 00:01:04,090
partitions it has this sort of
performance enhancement by which reads

40
00:01:04,090 --> 00:01:04,100
performance enhancement by which reads
 

41
00:01:04,100 --> 00:01:06,190
performance enhancement by which reads
can be processed at any replica and

42
00:01:06,190 --> 00:01:06,200
can be processed at any replica and
 

43
00:01:06,200 --> 00:01:08,050
can be processed at any replica and
therefore the reads can be stale so we

44
00:01:08,050 --> 00:01:08,060
therefore the reads can be stale so we
 

45
00:01:08,060 --> 00:01:09,310
therefore the reads can be stale so we
just have to keep this in mind as we're

46
00:01:09,310 --> 00:01:09,320
just have to keep this in mind as we're
 

47
00:01:09,320 --> 00:01:12,550
just have to keep this in mind as we're
analyzing various uses of the zookeeper

48
00:01:12,550 --> 00:01:12,560
analyzing various uses of the zookeeper
 

49
00:01:12,560 --> 00:01:15,639
analyzing various uses of the zookeeper
interface on the other hand zookeeper

50
00:01:15,639 --> 00:01:15,649
interface on the other hand zookeeper
 

51
00:01:15,649 --> 00:01:18,160
interface on the other hand zookeeper
does guarantee that every replicas

52
00:01:18,160 --> 00:01:18,170
does guarantee that every replicas
 

53
00:01:18,170 --> 00:01:20,679
does guarantee that every replicas
process the stream of rights in order

54
00:01:20,679 --> 00:01:20,689
process the stream of rights in order
 

55
00:01:20,689 --> 00:01:22,560
process the stream of rights in order
one at a time with all replicas

56
00:01:22,560 --> 00:01:22,570
one at a time with all replicas
 

57
00:01:22,570 --> 00:01:24,910
one at a time with all replicas
executing the rights in the same order

58
00:01:24,910 --> 00:01:24,920
executing the rights in the same order
 

59
00:01:24,920 --> 00:01:27,969
executing the rights in the same order
so that the replicas advance sort of in

60
00:01:27,969 --> 00:01:27,979
so that the replicas advance sort of in
 

61
00:01:27,979 --> 00:01:30,160
so that the replicas advance sort of in
their states of all than exactly the

62
00:01:30,160 --> 00:01:30,170
their states of all than exactly the
 

63
00:01:30,170 --> 00:01:33,399
their states of all than exactly the
same way and that all of the operation

64
00:01:33,399 --> 00:01:33,409
same way and that all of the operation
 

65
00:01:33,409 --> 00:01:36,700
same way and that all of the operation
reads and writes produced by a generated

66
00:01:36,700 --> 00:01:36,710
reads and writes produced by a generated
 

67
00:01:36,710 --> 00:01:38,649
reads and writes produced by a generated
by a single client or processed by the

68
00:01:38,649 --> 00:01:38,659
by a single client or processed by the
 

69
00:01:38,659 --> 00:01:40,990
by a single client or processed by the
system also in order both in the order

70
00:01:40,990 --> 00:01:41,000
system also in order both in the order
 

71
00:01:41,000 --> 00:01:43,889
system also in order both in the order
that the client issued them in and

72
00:01:43,889 --> 00:01:43,899
that the client issued them in and
 

73
00:01:43,899 --> 00:01:45,940
that the client issued them in and
successive operations from a given

74
00:01:45,940 --> 00:01:45,950
successive operations from a given
 

75
00:01:45,950 --> 00:01:48,849
successive operations from a given
client always see the same state or

76
00:01:48,849 --> 00:01:48,859
client always see the same state or
 

77
00:01:48,859 --> 00:01:51,669
client always see the same state or
later in the right stream as the

78
00:01:51,669 --> 00:01:51,679
later in the right stream as the
 

79
00:01:51,679 --> 00:01:53,859
later in the right stream as the
previous read operation right any

80
00:01:53,859 --> 00:01:53,869
previous read operation right any
 

81
00:01:53,869 --> 00:01:59,289
previous read operation right any
operation from that client okay so

82
00:01:59,289 --> 00:01:59,299
operation from that client okay so
 

83
00:01:59,299 --> 00:02:02,109
operation from that client okay so
before I dive into what the API looks

84
00:02:02,109 --> 00:02:02,119
before I dive into what the API looks
 

85
00:02:02,119 --> 00:02:06,190
before I dive into what the API looks
like and why it's useful it's worth just

86
00:02:06,190 --> 00:02:06,200
like and why it's useful it's worth just
 

87
00:02:06,200 --> 00:02:08,169
like and why it's useful it's worth just
thinking about what kinds of problems

88
00:02:08,169 --> 00:02:08,179
thinking about what kinds of problems
 

89
00:02:08,179 --> 00:02:10,240
thinking about what kinds of problems
zookeeper is aiming to solve or could be

90
00:02:10,240 --> 00:02:10,250
zookeeper is aiming to solve or could be
 

91
00:02:10,250 --> 00:02:12,460
zookeeper is aiming to solve or could be
expected to solve so

92
00:02:12,460 --> 00:02:12,470
expected to solve so
 

93
00:02:12,470 --> 00:02:13,809
expected to solve so
for me

94
00:02:13,809 --> 00:02:13,819
for me
 

95
00:02:13,819 --> 00:02:23,020
for me
a totally central example of motivation

96
00:02:23,020 --> 00:02:23,030
a totally central example of motivation
 

97
00:02:23,030 --> 00:02:25,149
a totally central example of motivation
of why you would want to use ooh keeper

98
00:02:25,149 --> 00:02:25,159
of why you would want to use ooh keeper
 

99
00:02:25,159 --> 00:02:28,239
of why you would want to use ooh keeper
this is it as an implementation of the

100
00:02:28,239 --> 00:02:28,249
this is it as an implementation of the
 

101
00:02:28,249 --> 00:02:31,539
this is it as an implementation of the
test and set service that vmware ft

102
00:02:31,539 --> 00:02:31,549
test and set service that vmware ft
 

103
00:02:31,549 --> 00:02:34,959
test and set service that vmware ft
required in order for either server to

104
00:02:34,959 --> 00:02:34,969
required in order for either server to
 

105
00:02:34,969 --> 00:02:38,559
required in order for either server to
take over when the other one failed it

106
00:02:38,559 --> 00:02:38,569
take over when the other one failed it
 

107
00:02:38,569 --> 00:02:39,970
take over when the other one failed it
was a bit of a mystery in the vmware

108
00:02:39,970 --> 00:02:39,980
was a bit of a mystery in the vmware
 

109
00:02:39,980 --> 00:02:40,330
was a bit of a mystery in the vmware
paper

110
00:02:40,330 --> 00:02:40,340
paper
 

111
00:02:40,340 --> 00:02:43,270
paper
what is this test instant service how is

112
00:02:43,270 --> 00:02:43,280
what is this test instant service how is
 

113
00:02:43,280 --> 00:02:45,159
what is this test instant service how is
it may you know is it fault tolerant

114
00:02:45,159 --> 00:02:45,169
it may you know is it fault tolerant
 

115
00:02:45,169 --> 00:02:49,809
it may you know is it fault tolerant
does it itself tolerate partitions but

116
00:02:49,809 --> 00:02:49,819
does it itself tolerate partitions but
 

117
00:02:49,819 --> 00:02:51,610
does it itself tolerate partitions but
zookeeper actually gives us the tools to

118
00:02:51,610 --> 00:02:51,620
zookeeper actually gives us the tools to
 

119
00:02:51,620 --> 00:02:55,839
zookeeper actually gives us the tools to
write a fault tolerant test and set

120
00:02:55,839 --> 00:02:55,849
write a fault tolerant test and set
 

121
00:02:55,849 --> 00:03:00,189
write a fault tolerant test and set
service of exactly the kind that vmware

122
00:03:00,189 --> 00:03:00,199
service of exactly the kind that vmware
 

123
00:03:00,199 --> 00:03:03,520
service of exactly the kind that vmware
ft needed that is fault tolerant and

124
00:03:03,520 --> 00:03:03,530
ft needed that is fault tolerant and
 

125
00:03:03,530 --> 00:03:05,319
ft needed that is fault tolerant and
does do the right thing under partitions

126
00:03:05,319 --> 00:03:05,329
does do the right thing under partitions
 

127
00:03:05,329 --> 00:03:06,819
does do the right thing under partitions
that's sort of a central kind of thing

128
00:03:06,819 --> 00:03:06,829
that's sort of a central kind of thing
 

129
00:03:06,829 --> 00:03:09,399
that's sort of a central kind of thing
that zookeepers doing there's also a

130
00:03:09,399 --> 00:03:09,409
that zookeepers doing there's also a
 

131
00:03:09,409 --> 00:03:10,839
that zookeepers doing there's also a
bunch of other ways that turns out

132
00:03:10,839 --> 00:03:10,849
bunch of other ways that turns out
 

133
00:03:10,849 --> 00:03:12,369
bunch of other ways that turns out
people use it suki was very successful

134
00:03:12,369 --> 00:03:12,379
people use it suki was very successful
 

135
00:03:12,379 --> 00:03:15,849
people use it suki was very successful
people use it for a lot of stuff one

136
00:03:15,849 --> 00:03:15,859
people use it for a lot of stuff one
 

137
00:03:15,859 --> 00:03:17,649
people use it for a lot of stuff one
kind of thing people use is just to

138
00:03:17,649 --> 00:03:17,659
kind of thing people use is just to
 

139
00:03:17,659 --> 00:03:20,050
kind of thing people use is just to
publish just configuration information

140
00:03:20,050 --> 00:03:20,060
publish just configuration information
 

141
00:03:20,060 --> 00:03:21,789
publish just configuration information
for other servers to use like for

142
00:03:21,789 --> 00:03:21,799
for other servers to use like for
 

143
00:03:21,799 --> 00:03:24,179
for other servers to use like for
example the IP address of the current

144
00:03:24,179 --> 00:03:24,189
example the IP address of the current
 

145
00:03:24,189 --> 00:03:29,110
example the IP address of the current
master for some set of workers this is

146
00:03:29,110 --> 00:03:29,120
master for some set of workers this is
 

147
00:03:29,120 --> 00:03:34,499
master for some set of workers this is
just config configuration information

148
00:03:34,499 --> 00:03:34,509

 

149
00:03:34,509 --> 00:03:37,059

another classic use of zookeepers to

150
00:03:37,059 --> 00:03:37,069
another classic use of zookeepers to
 

151
00:03:37,069 --> 00:03:39,009
another classic use of zookeepers to
elect a master you know if we want to

152
00:03:39,009 --> 00:03:39,019
elect a master you know if we want to
 

153
00:03:39,019 --> 00:03:41,110
elect a master you know if we want to
have a when the old master fails we need

154
00:03:41,110 --> 00:03:41,120
have a when the old master fails we need
 

155
00:03:41,120 --> 00:03:43,119
have a when the old master fails we need
to have everyone agree on who the new

156
00:03:43,119 --> 00:03:43,129
to have everyone agree on who the new
 

157
00:03:43,129 --> 00:03:45,280
to have everyone agree on who the new
master is and only elect one master even

158
00:03:45,280 --> 00:03:45,290
master is and only elect one master even
 

159
00:03:45,290 --> 00:03:49,330
master is and only elect one master even
if there's partitions you can elect a

160
00:03:49,330 --> 00:03:49,340
if there's partitions you can elect a
 

161
00:03:49,340 --> 00:03:58,569
if there's partitions you can elect a
master using zookeeper primitives if the

162
00:03:58,569 --> 00:03:58,579
master using zookeeper primitives if the
 

163
00:03:58,579 --> 00:04:00,369
master using zookeeper primitives if the
master for small amounts of stated

164
00:04:00,369 --> 00:04:00,379
master for small amounts of stated
 

165
00:04:00,379 --> 00:04:02,349
master for small amounts of stated
anyway if whatever master you elect

166
00:04:02,349 --> 00:04:02,359
anyway if whatever master you elect
 

167
00:04:02,359 --> 00:04:03,670
anyway if whatever master you elect
needs to keep some state it needs to

168
00:04:03,670 --> 00:04:03,680
needs to keep some state it needs to
 

169
00:04:03,680 --> 00:04:06,330
needs to keep some state it needs to
keep it up-to-date like maybe you know

170
00:04:06,330 --> 00:04:06,340
keep it up-to-date like maybe you know
 

171
00:04:06,340 --> 00:04:09,369
keep it up-to-date like maybe you know
informations such as who the primary is

172
00:04:09,369 --> 00:04:09,379
informations such as who the primary is
 

173
00:04:09,379 --> 00:04:10,990
informations such as who the primary is
for a given chunk of data like you'd

174
00:04:10,990 --> 00:04:11,000
for a given chunk of data like you'd
 

175
00:04:11,000 --> 00:04:13,899
for a given chunk of data like you'd
want in GFS the master can store its

176
00:04:13,899 --> 00:04:13,909
want in GFS the master can store its
 

177
00:04:13,909 --> 00:04:16,089
want in GFS the master can store its
state in zookeeper it knows new keepers

178
00:04:16,089 --> 00:04:16,099
state in zookeeper it knows new keepers
 

179
00:04:16,099 --> 00:04:17,560
state in zookeeper it knows new keepers
not going to lose it if the master

180
00:04:17,560 --> 00:04:17,570
not going to lose it if the master
 

181
00:04:17,570 --> 00:04:19,390
not going to lose it if the master
crashes and we elect a new master to

182
00:04:19,390 --> 00:04:19,400
crashes and we elect a new master to
 

183
00:04:19,400 --> 00:04:21,370
crashes and we elect a new master to
replace it that new master can just read

184
00:04:21,370 --> 00:04:21,380
replace it that new master can just read
 

185
00:04:21,380 --> 00:04:22,629
replace it that new master can just read
the old master state right out of

186
00:04:22,629 --> 00:04:22,639
the old master state right out of
 

187
00:04:22,639 --> 00:04:24,939
the old master state right out of
zookeeper and rely on it actually being

188
00:04:24,939 --> 00:04:24,949
zookeeper and rely on it actually being
 

189
00:04:24,949 --> 00:04:27,040
zookeeper and rely on it actually being
there

190
00:04:27,040 --> 00:04:27,050
there
 

191
00:04:27,050 --> 00:04:30,350
there
other things you might imagine maybe you

192
00:04:30,350 --> 00:04:30,360
other things you might imagine maybe you
 

193
00:04:30,360 --> 00:04:32,300
other things you might imagine maybe you
know MapReduce like systems workers

194
00:04:32,300 --> 00:04:32,310
know MapReduce like systems workers
 

195
00:04:32,310 --> 00:04:34,010
know MapReduce like systems workers
could register themselves by creating

196
00:04:34,010 --> 00:04:34,020
could register themselves by creating
 

197
00:04:34,020 --> 00:04:38,900
could register themselves by creating
little files and zookeeper and again

198
00:04:38,900 --> 00:04:38,910
little files and zookeeper and again
 

199
00:04:38,910 --> 00:04:40,730
little files and zookeeper and again
with systems like MapReduce you can

200
00:04:40,730 --> 00:04:40,740
with systems like MapReduce you can
 

201
00:04:40,740 --> 00:04:43,040
with systems like MapReduce you can
imagine the master telling the workers

202
00:04:43,040 --> 00:04:43,050
imagine the master telling the workers
 

203
00:04:43,050 --> 00:04:45,380
imagine the master telling the workers
what to do by writing things in

204
00:04:45,380 --> 00:04:45,390
what to do by writing things in
 

205
00:04:45,390 --> 00:04:47,930
what to do by writing things in
zookeeper like writing lists of work in

206
00:04:47,930 --> 00:04:47,940
zookeeper like writing lists of work in
 

207
00:04:47,940 --> 00:04:49,940
zookeeper like writing lists of work in
zookeeper and then worker sort of take

208
00:04:49,940 --> 00:04:49,950
zookeeper and then worker sort of take
 

209
00:04:49,950 --> 00:04:52,280
zookeeper and then worker sort of take
those work items one by one out of

210
00:04:52,280 --> 00:04:52,290
those work items one by one out of
 

211
00:04:52,290 --> 00:04:54,260
those work items one by one out of
zookeeper and delete them as they

212
00:04:54,260 --> 00:04:54,270
zookeeper and delete them as they
 

213
00:04:54,270 --> 00:04:56,330
zookeeper and delete them as they
complete them but people use zookeeper

214
00:04:56,330 --> 00:04:56,340
complete them but people use zookeeper
 

215
00:04:56,340 --> 00:05:03,790
complete them but people use zookeeper
for all these things question

216
00:05:03,790 --> 00:05:03,800

 

217
00:05:03,800 --> 00:05:11,950

yeah

218
00:05:11,950 --> 00:05:11,960

 

219
00:05:11,960 --> 00:05:16,520

exactly yeah so the question is oh how

220
00:05:16,520 --> 00:05:16,530
exactly yeah so the question is oh how
 

221
00:05:16,530 --> 00:05:18,200
exactly yeah so the question is oh how
people use zookeeper and in generally

222
00:05:18,200 --> 00:05:18,210
people use zookeeper and in generally
 

223
00:05:18,210 --> 00:05:19,850
people use zookeeper and in generally
yeah you you would if you're running

224
00:05:19,850 --> 00:05:19,860
yeah you you would if you're running
 

225
00:05:19,860 --> 00:05:21,380
yeah you you would if you're running
some big data center and you run all

226
00:05:21,380 --> 00:05:21,390
some big data center and you run all
 

227
00:05:21,390 --> 00:05:23,150
some big data center and you run all
kinds of stuff in your data center you

228
00:05:23,150 --> 00:05:23,160
kinds of stuff in your data center you
 

229
00:05:23,160 --> 00:05:26,030
kinds of stuff in your data center you
know web servers storage systems

230
00:05:26,030 --> 00:05:26,040
know web servers storage systems
 

231
00:05:26,040 --> 00:05:28,100
know web servers storage systems
MapReduce who knows what you might fire

232
00:05:28,100 --> 00:05:28,110
MapReduce who knows what you might fire
 

233
00:05:28,110 --> 00:05:30,260
MapReduce who knows what you might fire
up a zookeeper one zookeeper cluster

234
00:05:30,260 --> 00:05:30,270
up a zookeeper one zookeeper cluster
 

235
00:05:30,270 --> 00:05:31,940
up a zookeeper one zookeeper cluster
because this general purpose can be used

236
00:05:31,940 --> 00:05:31,950
because this general purpose can be used
 

237
00:05:31,950 --> 00:05:34,580
because this general purpose can be used
for lots of things so you know five or

238
00:05:34,580 --> 00:05:34,590
for lots of things so you know five or
 

239
00:05:34,590 --> 00:05:37,400
for lots of things so you know five or
seven zookeeper replicas and then as you

240
00:05:37,400 --> 00:05:37,410
seven zookeeper replicas and then as you
 

241
00:05:37,410 --> 00:05:39,530
seven zookeeper replicas and then as you
deploy various services you would design

242
00:05:39,530 --> 00:05:39,540
deploy various services you would design
 

243
00:05:39,540 --> 00:05:41,060
deploy various services you would design
the services to store some of the

244
00:05:41,060 --> 00:05:41,070
the services to store some of the
 

245
00:05:41,070 --> 00:05:43,220
the services to store some of the
critical state in your one zookeeper

246
00:05:43,220 --> 00:05:43,230
critical state in your one zookeeper
 

247
00:05:43,230 --> 00:05:50,750
critical state in your one zookeeper
cluster alright the API zookeeper looks

248
00:05:50,750 --> 00:05:50,760
cluster alright the API zookeeper looks
 

249
00:05:50,760 --> 00:05:53,410
cluster alright the API zookeeper looks
like a filesystem some levels it's got a

250
00:05:53,410 --> 00:05:53,420
like a filesystem some levels it's got a
 

251
00:05:53,420 --> 00:05:56,120
like a filesystem some levels it's got a
directory hierarchy you know there's a

252
00:05:56,120 --> 00:05:56,130
directory hierarchy you know there's a
 

253
00:05:56,130 --> 00:05:58,610
directory hierarchy you know there's a
root directory and then maybe you could

254
00:05:58,610 --> 00:05:58,620
root directory and then maybe you could
 

255
00:05:58,620 --> 00:06:01,340
root directory and then maybe you could
maybe each application has its own sub

256
00:06:01,340 --> 00:06:01,350
maybe each application has its own sub
 

257
00:06:01,350 --> 00:06:03,110
maybe each application has its own sub
directory so maybe the application one

258
00:06:03,110 --> 00:06:03,120
directory so maybe the application one
 

259
00:06:03,120 --> 00:06:05,950
directory so maybe the application one
keeps its files here in this directory

260
00:06:05,950 --> 00:06:05,960
keeps its files here in this directory
 

261
00:06:05,960 --> 00:06:08,180
keeps its files here in this directory
app two keeps its files in this

262
00:06:08,180 --> 00:06:08,190
app two keeps its files in this
 

263
00:06:08,190 --> 00:06:11,510
app two keeps its files in this
directory and you know these directories

264
00:06:11,510 --> 00:06:11,520
directory and you know these directories
 

265
00:06:11,520 --> 00:06:12,920
directory and you know these directories
have files and directories underneath

266
00:06:12,920 --> 00:06:12,930
have files and directories underneath
 

267
00:06:12,930 --> 00:06:13,910
have files and directories underneath
them

268
00:06:13,910 --> 00:06:13,920
them
 

269
00:06:13,920 --> 00:06:16,550
them
one reason for this is just because you

270
00:06:16,550 --> 00:06:16,560
one reason for this is just because you
 

271
00:06:16,560 --> 00:06:18,160
one reason for this is just because you
keeper is like just mentioned is a

272
00:06:18,160 --> 00:06:18,170
keeper is like just mentioned is a
 

273
00:06:18,170 --> 00:06:20,630
keeper is like just mentioned is a
design to be shared between many

274
00:06:20,630 --> 00:06:20,640
design to be shared between many
 

275
00:06:20,640 --> 00:06:23,150
design to be shared between many
possibly unrelated activities we just

276
00:06:23,150 --> 00:06:23,160
possibly unrelated activities we just
 

277
00:06:23,160 --> 00:06:25,310
possibly unrelated activities we just
need a naming system to be able to keep

278
00:06:25,310 --> 00:06:25,320
need a naming system to be able to keep
 

279
00:06:25,320 --> 00:06:27,040
need a naming system to be able to keep
the information from these activities

280
00:06:27,040 --> 00:06:27,050
the information from these activities
 

281
00:06:27,050 --> 00:06:30,140
the information from these activities
distinct so they don't get confused and

282
00:06:30,140 --> 00:06:30,150
distinct so they don't get confused and
 

283
00:06:30,150 --> 00:06:32,060
distinct so they don't get confused and
read each other's data by mistake

284
00:06:32,060 --> 00:06:32,070
read each other's data by mistake
 

285
00:06:32,070 --> 00:06:34,940
read each other's data by mistake
within each application it turns out

286
00:06:34,940 --> 00:06:34,950
within each application it turns out
 

287
00:06:34,950 --> 00:06:36,590
within each application it turns out
that a lot of convenient ways of using

288
00:06:36,590 --> 00:06:36,600
that a lot of convenient ways of using
 

289
00:06:36,600 --> 00:06:39,500
that a lot of convenient ways of using
zookeeper will involve creating multiple

290
00:06:39,500 --> 00:06:39,510
zookeeper will involve creating multiple
 

291
00:06:39,510 --> 00:06:42,320
zookeeper will involve creating multiple
files let's see a couple examples like

292
00:06:42,320 --> 00:06:42,330
files let's see a couple examples like
 

293
00:06:42,330 --> 00:06:47,150
files let's see a couple examples like
this in a few minutes okay so it looks

294
00:06:47,150 --> 00:06:47,160
this in a few minutes okay so it looks
 

295
00:06:47,160 --> 00:06:49,310
this in a few minutes okay so it looks
like a filesystem this is you know not

296
00:06:49,310 --> 00:06:49,320
like a filesystem this is you know not
 

297
00:06:49,320 --> 00:06:50,990
like a filesystem this is you know not
very deep it doesn't it's not actually

298
00:06:50,990 --> 00:06:51,000
very deep it doesn't it's not actually
 

299
00:06:51,000 --> 00:06:52,910
very deep it doesn't it's not actually
you know you can't really use it like a

300
00:06:52,910 --> 00:06:52,920
you know you can't really use it like a
 

301
00:06:52,920 --> 00:06:54,500
you know you can't really use it like a
file system in the sense of mounting it

302
00:06:54,500 --> 00:06:54,510
file system in the sense of mounting it
 

303
00:06:54,510 --> 00:06:56,240
file system in the sense of mounting it
and running LS and cat and all those

304
00:06:56,240 --> 00:06:56,250
and running LS and cat and all those
 

305
00:06:56,250 --> 00:06:58,280
and running LS and cat and all those
things it's just that internally it

306
00:06:58,280 --> 00:06:58,290
things it's just that internally it
 

307
00:06:58,290 --> 00:07:00,350
things it's just that internally it
names objects with these path names so

308
00:07:00,350 --> 00:07:00,360
names objects with these path names so
 

309
00:07:00,360 --> 00:07:04,250
names objects with these path names so
you know one this x y&z here few

310
00:07:04,250 --> 00:07:04,260
you know one this x y&z here few
 

311
00:07:04,260 --> 00:07:06,200
you know one this x y&z here few
different files you know when you talk

312
00:07:06,200 --> 00:07:06,210
different files you know when you talk
 

313
00:07:06,210 --> 00:07:08,240
different files you know when you talk
to me you send an RPC - zookeeper saying

314
00:07:08,240 --> 00:07:08,250
to me you send an RPC - zookeeper saying
 

315
00:07:08,250 --> 00:07:11,180
to me you send an RPC - zookeeper saying
you know please read this data you would

316
00:07:11,180 --> 00:07:11,190
you know please read this data you would
 

317
00:07:11,190 --> 00:07:13,340
you know please read this data you would
name the data you want maybe add up to

318
00:07:13,340 --> 00:07:13,350
name the data you want maybe add up to
 

319
00:07:13,350 --> 00:07:16,910
name the data you want maybe add up to
slash X there's just a sort of

320
00:07:16,910 --> 00:07:16,920
slash X there's just a sort of
 

321
00:07:16,920 --> 00:07:21,380
slash X there's just a sort of
hierarchical naming scheme these these

322
00:07:21,380 --> 00:07:21,390
hierarchical naming scheme these these
 

323
00:07:21,390 --> 00:07:23,770
hierarchical naming scheme these these
files and directories are called Z nodes

324
00:07:23,770 --> 00:07:23,780
files and directories are called Z nodes
 

325
00:07:23,780 --> 00:07:27,610
files and directories are called Z nodes
and it turns out it's there's three

326
00:07:27,610 --> 00:07:27,620
and it turns out it's there's three
 

327
00:07:27,620 --> 00:07:30,160
and it turns out it's there's three
types you have to know about that helps

328
00:07:30,160 --> 00:07:30,170
types you have to know about that helps
 

329
00:07:30,170 --> 00:07:31,510
types you have to know about that helps
you keep or solve various problems for

330
00:07:31,510 --> 00:07:31,520
you keep or solve various problems for
 

331
00:07:31,520 --> 00:07:33,250
you keep or solve various problems for
us there's just regular Z nodes where if

332
00:07:33,250 --> 00:07:33,260
us there's just regular Z nodes where if
 

333
00:07:33,260 --> 00:07:36,370
us there's just regular Z nodes where if
you create one it's permanent until you

334
00:07:36,370 --> 00:07:36,380
you create one it's permanent until you
 

335
00:07:36,380 --> 00:07:40,360
you create one it's permanent until you
delete it there's a femoral Z nodes

336
00:07:40,360 --> 00:07:40,370
delete it there's a femoral Z nodes
 

337
00:07:40,370 --> 00:07:42,790
delete it there's a femoral Z nodes
where if a client creates an ephemeral Z

338
00:07:42,790 --> 00:07:42,800
where if a client creates an ephemeral Z
 

339
00:07:42,800 --> 00:07:45,700
where if a client creates an ephemeral Z
node zookeeper will delete that

340
00:07:45,700 --> 00:07:45,710
node zookeeper will delete that
 

341
00:07:45,710 --> 00:07:48,159
node zookeeper will delete that
ephemeral Z node if it believes that the

342
00:07:48,159 --> 00:07:48,169
ephemeral Z node if it believes that the
 

343
00:07:48,169 --> 00:07:50,020
ephemeral Z node if it believes that the
client has died it's actually tied to

344
00:07:50,020 --> 00:07:50,030
client has died it's actually tied to
 

345
00:07:50,030 --> 00:07:52,629
client has died it's actually tied to
client sessions so clients have to sort

346
00:07:52,629 --> 00:07:52,639
client sessions so clients have to sort
 

347
00:07:52,639 --> 00:07:54,520
client sessions so clients have to sort
of send a little heartbeat in every once

348
00:07:54,520 --> 00:07:54,530
of send a little heartbeat in every once
 

349
00:07:54,530 --> 00:07:56,350
of send a little heartbeat in every once
a while into the zookeeper into

350
00:07:56,350 --> 00:07:56,360
a while into the zookeeper into
 

351
00:07:56,360 --> 00:07:57,670
a while into the zookeeper into
zookeeper say oh I'm still alive I'm

352
00:07:57,670 --> 00:07:57,680
zookeeper say oh I'm still alive I'm
 

353
00:07:57,680 --> 00:07:59,830
zookeeper say oh I'm still alive I'm
still alive so zookeeper won't delete

354
00:07:59,830 --> 00:07:59,840
still alive so zookeeper won't delete
 

355
00:07:59,840 --> 00:08:04,210
still alive so zookeeper won't delete
their ephemeral files and the last

356
00:08:04,210 --> 00:08:04,220
their ephemeral files and the last
 

357
00:08:04,220 --> 00:08:07,230
their ephemeral files and the last
characteristic files may have is

358
00:08:07,230 --> 00:08:07,240
characteristic files may have is
 

359
00:08:07,240 --> 00:08:10,750
characteristic files may have is
sequential and that means when you ask

360
00:08:10,750 --> 00:08:10,760
sequential and that means when you ask
 

361
00:08:10,760 --> 00:08:12,370
sequential and that means when you ask
to create a file with a given name what

362
00:08:12,370 --> 00:08:12,380
to create a file with a given name what
 

363
00:08:12,380 --> 00:08:14,710
to create a file with a given name what
you actually end up creating is a file

364
00:08:14,710 --> 00:08:14,720
you actually end up creating is a file
 

365
00:08:14,720 --> 00:08:16,570
you actually end up creating is a file
with that name but with a number

366
00:08:16,570 --> 00:08:16,580
with that name but with a number
 

367
00:08:16,580 --> 00:08:18,820
with that name but with a number
appended to the main and zookeeper

368
00:08:18,820 --> 00:08:18,830
appended to the main and zookeeper
 

369
00:08:18,830 --> 00:08:21,219
appended to the main and zookeeper
guarantees never to repeat a number if

370
00:08:21,219 --> 00:08:21,229
guarantees never to repeat a number if
 

371
00:08:21,229 --> 00:08:23,430
guarantees never to repeat a number if
multiple clients try to create

372
00:08:23,430 --> 00:08:23,440
multiple clients try to create
 

373
00:08:23,440 --> 00:08:25,719
multiple clients try to create
sequential files at the same time and

374
00:08:25,719 --> 00:08:25,729
sequential files at the same time and
 

375
00:08:25,729 --> 00:08:29,920
sequential files at the same time and
also to always use montt increasing

376
00:08:29,920 --> 00:08:29,930
also to always use montt increasing
 

377
00:08:29,930 --> 00:08:32,230
also to always use montt increasing
numbers for the for the sequence numbers

378
00:08:32,230 --> 00:08:32,240
numbers for the for the sequence numbers
 

379
00:08:32,240 --> 00:08:34,420
numbers for the for the sequence numbers
that are pens to filenames and we'll see

380
00:08:34,420 --> 00:08:34,430
that are pens to filenames and we'll see
 

381
00:08:34,430 --> 00:08:37,709
that are pens to filenames and we'll see
all of these things come up in examples

382
00:08:37,709 --> 00:08:37,719
all of these things come up in examples
 

383
00:08:37,719 --> 00:08:40,690
all of these things come up in examples
at one level the operations the RPC

384
00:08:40,690 --> 00:08:40,700
at one level the operations the RPC
 

385
00:08:40,700 --> 00:08:44,650
at one level the operations the RPC
interface that zookeeper exposes is sort

386
00:08:44,650 --> 00:08:44,660
interface that zookeeper exposes is sort
 

387
00:08:44,660 --> 00:08:47,890
interface that zookeeper exposes is sort
of what you might expect for your files

388
00:08:47,890 --> 00:08:47,900
of what you might expect for your files
 

389
00:08:47,900 --> 00:08:51,340
of what you might expect for your files
was to create RPC where you give it a

390
00:08:51,340 --> 00:08:51,350
was to create RPC where you give it a
 

391
00:08:51,350 --> 00:08:57,910
was to create RPC where you give it a
name really a full path name some

392
00:08:57,910 --> 00:08:57,920
name really a full path name some
 

393
00:08:57,920 --> 00:09:02,020
name really a full path name some
initial data and some combination of

394
00:09:02,020 --> 00:09:02,030
initial data and some combination of
 

395
00:09:02,030 --> 00:09:09,190
initial data and some combination of
these flags and interesting semantics of

396
00:09:09,190 --> 00:09:09,200
these flags and interesting semantics of
 

397
00:09:09,200 --> 00:09:11,530
these flags and interesting semantics of
create is that it's exclusive that is

398
00:09:11,530 --> 00:09:11,540
create is that it's exclusive that is
 

399
00:09:11,540 --> 00:09:13,690
create is that it's exclusive that is
when I send a create into zookeeper ask

400
00:09:13,690 --> 00:09:13,700
when I send a create into zookeeper ask
 

401
00:09:13,700 --> 00:09:15,220
when I send a create into zookeeper ask
it to create a file so you keep your

402
00:09:15,220 --> 00:09:15,230
it to create a file so you keep your
 

403
00:09:15,230 --> 00:09:18,130
it to create a file so you keep your
responds with a yes or no if that file

404
00:09:18,130 --> 00:09:18,140
responds with a yes or no if that file
 

405
00:09:18,140 --> 00:09:20,200
responds with a yes or no if that file
didn't exist and I'm the first client

406
00:09:20,200 --> 00:09:20,210
didn't exist and I'm the first client
 

407
00:09:20,210 --> 00:09:21,820
didn't exist and I'm the first client
who wants to create it zookeeper says

408
00:09:21,820 --> 00:09:21,830
who wants to create it zookeeper says
 

409
00:09:21,830 --> 00:09:23,530
who wants to create it zookeeper says
yes and creates the file the file

410
00:09:23,530 --> 00:09:23,540
yes and creates the file the file
 

411
00:09:23,540 --> 00:09:26,050
yes and creates the file the file
already exists zookeeper says no or

412
00:09:26,050 --> 00:09:26,060
already exists zookeeper says no or
 

413
00:09:26,060 --> 00:09:28,720
already exists zookeeper says no or
returns an error so clients know it's

414
00:09:28,720 --> 00:09:28,730
returns an error so clients know it's
 

415
00:09:28,730 --> 00:09:30,520
returns an error so clients know it's
exclusive create and clients know

416
00:09:30,520 --> 00:09:30,530
exclusive create and clients know
 

417
00:09:30,530 --> 00:09:32,230
exclusive create and clients know
whether they were the one client if

418
00:09:32,230 --> 00:09:32,240
whether they were the one client if
 

419
00:09:32,240 --> 00:09:33,460
whether they were the one client if
multiple clients are trying to create

420
00:09:33,460 --> 00:09:33,470
multiple clients are trying to create
 

421
00:09:33,470 --> 00:09:35,380
multiple clients are trying to create
the same file which we'll see in locking

422
00:09:35,380 --> 00:09:35,390
the same file which we'll see in locking
 

423
00:09:35,390 --> 00:09:36,730
the same file which we'll see in locking
samples

424
00:09:36,730 --> 00:09:36,740
samples
 

425
00:09:36,740 --> 00:09:38,380
samples
the clients will know whether they were

426
00:09:38,380 --> 00:09:38,390
the clients will know whether they were
 

427
00:09:38,390 --> 00:09:40,210
the clients will know whether they were
the one who actually managed to create

428
00:09:40,210 --> 00:09:40,220
the one who actually managed to create
 

429
00:09:40,220 --> 00:09:46,170
the one who actually managed to create
the file

430
00:09:46,170 --> 00:09:46,180

 

431
00:09:46,180 --> 00:09:54,520

there's also delete and one thing I

432
00:09:54,520 --> 00:09:54,530
there's also delete and one thing I
 

433
00:09:54,530 --> 00:09:56,260
there's also delete and one thing I
didn't mention is ever easy note has a

434
00:09:56,260 --> 00:09:56,270
didn't mention is ever easy note has a
 

435
00:09:56,270 --> 00:09:57,820
didn't mention is ever easy note has a
version as a current version number that

436
00:09:57,820 --> 00:09:57,830
version as a current version number that
 

437
00:09:57,830 --> 00:10:01,660
version as a current version number that
advances as its modified and delete

438
00:10:01,660 --> 00:10:01,670
advances as its modified and delete
 

439
00:10:01,670 --> 00:10:06,040
advances as its modified and delete
along with some other update operations

440
00:10:06,040 --> 00:10:06,050
along with some other update operations
 

441
00:10:06,050 --> 00:10:07,810
along with some other update operations
you can send an a version number saying

442
00:10:07,810 --> 00:10:07,820
you can send an a version number saying
 

443
00:10:07,820 --> 00:10:10,300
you can send an a version number saying
only do this operation if the files

444
00:10:10,300 --> 00:10:10,310
only do this operation if the files
 

445
00:10:10,310 --> 00:10:12,310
only do this operation if the files
current version number is the version

446
00:10:12,310 --> 00:10:12,320
current version number is the version
 

447
00:10:12,320 --> 00:10:15,370
current version number is the version
that was specified and that'll turn out

448
00:10:15,370 --> 00:10:15,380
that was specified and that'll turn out
 

449
00:10:15,380 --> 00:10:17,230
that was specified and that'll turn out
to be helpful if you're worried about in

450
00:10:17,230 --> 00:10:17,240
to be helpful if you're worried about in
 

451
00:10:17,240 --> 00:10:18,820
to be helpful if you're worried about in
situations where multiple clients might

452
00:10:18,820 --> 00:10:18,830
situations where multiple clients might
 

453
00:10:18,830 --> 00:10:20,800
situations where multiple clients might
be trying to do the same operation at

454
00:10:20,800 --> 00:10:20,810
be trying to do the same operation at
 

455
00:10:20,810 --> 00:10:23,560
be trying to do the same operation at
the same time so you can pass a version

456
00:10:23,560 --> 00:10:23,570
the same time so you can pass a version
 

457
00:10:23,570 --> 00:10:27,460
the same time so you can pass a version
saying only delete there's an exists

458
00:10:27,460 --> 00:10:27,470
saying only delete there's an exists
 

459
00:10:27,470 --> 00:10:33,340
saying only delete there's an exists
call oh does this path named Xenu exist

460
00:10:33,340 --> 00:10:33,350
call oh does this path named Xenu exist
 

461
00:10:33,350 --> 00:10:36,460
call oh does this path named Xenu exist
an interesting extra argument is that

462
00:10:36,460 --> 00:10:36,470
an interesting extra argument is that
 

463
00:10:36,470 --> 00:10:39,730
an interesting extra argument is that
you can ask to watch for changes to

464
00:10:39,730 --> 00:10:39,740
you can ask to watch for changes to
 

465
00:10:39,740 --> 00:10:42,220
you can ask to watch for changes to
whatever path name you specified you can

466
00:10:42,220 --> 00:10:42,230
whatever path name you specified you can
 

467
00:10:42,230 --> 00:10:43,750
whatever path name you specified you can
say does this path name exist and

468
00:10:43,750 --> 00:10:43,760
say does this path name exist and
 

469
00:10:43,760 --> 00:10:46,540
say does this path name exist and
whether or not exists it exists now if

470
00:10:46,540 --> 00:10:46,550
whether or not exists it exists now if
 

471
00:10:46,550 --> 00:10:48,250
whether or not exists it exists now if
you set this watch if you pass in true

472
00:10:48,250 --> 00:10:48,260
you set this watch if you pass in true
 

473
00:10:48,260 --> 00:10:50,440
you set this watch if you pass in true
for this watch flag zookeeper guarantees

474
00:10:50,440 --> 00:10:50,450
for this watch flag zookeeper guarantees
 

475
00:10:50,450 --> 00:10:53,590
for this watch flag zookeeper guarantees
to notify the client if anything changes

476
00:10:53,590 --> 00:10:53,600
to notify the client if anything changes
 

477
00:10:53,600 --> 00:10:55,420
to notify the client if anything changes
about that path name like it's created

478
00:10:55,420 --> 00:10:55,430
about that path name like it's created
 

479
00:10:55,430 --> 00:11:00,900
about that path name like it's created
or deleted or modified and furthermore

480
00:11:00,900 --> 00:11:00,910
or deleted or modified and furthermore
 

481
00:11:00,910 --> 00:11:03,820
or deleted or modified and furthermore
the the check for whether the file

482
00:11:03,820 --> 00:11:03,830
the the check for whether the file
 

483
00:11:03,830 --> 00:11:06,730
the the check for whether the file
exists and the setting of the watch

484
00:11:06,730 --> 00:11:06,740
exists and the setting of the watch
 

485
00:11:06,740 --> 00:11:08,980
exists and the setting of the watch
point of the watching information in the

486
00:11:08,980 --> 00:11:08,990
point of the watching information in the
 

487
00:11:08,990 --> 00:11:11,890
point of the watching information in the
inside zookeeper or atomic so nothing

488
00:11:11,890 --> 00:11:11,900
inside zookeeper or atomic so nothing
 

489
00:11:11,900 --> 00:11:13,320
inside zookeeper or atomic so nothing
can happen between the point at which

490
00:11:13,320 --> 00:11:13,330
can happen between the point at which
 

491
00:11:13,330 --> 00:11:16,510
can happen between the point at which
the point in the write stream which

492
00:11:16,510 --> 00:11:16,520
the point in the write stream which
 

493
00:11:16,520 --> 00:11:18,670
the point in the write stream which
zookeeper looks to see whether the path

494
00:11:18,670 --> 00:11:18,680
zookeeper looks to see whether the path
 

495
00:11:18,680 --> 00:11:20,440
zookeeper looks to see whether the path
exists and the point in the write stream

496
00:11:20,440 --> 00:11:20,450
exists and the point in the write stream
 

497
00:11:20,450 --> 00:11:23,830
exists and the point in the write stream
at which zookeeper inserts the watch

498
00:11:23,830 --> 00:11:23,840
at which zookeeper inserts the watch
 

499
00:11:23,840 --> 00:11:25,870
at which zookeeper inserts the watch
into its table and then that's like very

500
00:11:25,870 --> 00:11:25,880
into its table and then that's like very
 

501
00:11:25,880 --> 00:11:31,420
into its table and then that's like very
important for for correctness we also

502
00:11:31,420 --> 00:11:31,430
important for for correctness we also
 

503
00:11:31,430 --> 00:11:37,420
important for for correctness we also
get D then you get a path and again the

504
00:11:37,420 --> 00:11:37,430
get D then you get a path and again the
 

505
00:11:37,430 --> 00:11:40,620
get D then you get a path and again the
watch flag and now the watch just

506
00:11:40,620 --> 00:11:40,630
watch flag and now the watch just
 

507
00:11:40,630 --> 00:11:43,960
watch flag and now the watch just
applies to the contents of that file

508
00:11:43,960 --> 00:11:43,970
applies to the contents of that file
 

509
00:11:43,970 --> 00:11:50,460
applies to the contents of that file
there's set data

510
00:11:50,460 --> 00:11:50,470

 

511
00:11:50,470 --> 00:11:55,900

again path the new data and this

512
00:11:55,900 --> 00:11:55,910
again path the new data and this
 

513
00:11:55,910 --> 00:11:58,060
again path the new data and this
conditional version that if you pass an

514
00:11:58,060 --> 00:11:58,070
conditional version that if you pass an
 

515
00:11:58,070 --> 00:12:00,100
conditional version that if you pass an
inversion then zookeeper only actually

516
00:12:00,100 --> 00:12:00,110
inversion then zookeeper only actually
 

517
00:12:00,110 --> 00:12:02,170
inversion then zookeeper only actually
does the right if the current version

518
00:12:02,170 --> 00:12:02,180
does the right if the current version
 

519
00:12:02,180 --> 00:12:03,400
does the right if the current version
number of the file is equal to the

520
00:12:03,400 --> 00:12:03,410
number of the file is equal to the
 

521
00:12:03,410 --> 00:12:10,360
number of the file is equal to the
number you passed in okay so let's see

522
00:12:10,360 --> 00:12:10,370
number you passed in okay so let's see
 

523
00:12:10,370 --> 00:12:13,210
number you passed in okay so let's see
how we use this the first maybe almost

524
00:12:13,210 --> 00:12:13,220
how we use this the first maybe almost
 

525
00:12:13,220 --> 00:12:14,980
how we use this the first maybe almost
this first very simple example is

526
00:12:14,980 --> 00:12:14,990
this first very simple example is
 

527
00:12:14,990 --> 00:12:17,370
this first very simple example is
supposing we have a file in zookeeper

528
00:12:17,370 --> 00:12:17,380
supposing we have a file in zookeeper
 

529
00:12:17,380 --> 00:12:20,110
supposing we have a file in zookeeper
and we want to store a number in that

530
00:12:20,110 --> 00:12:20,120
and we want to store a number in that
 

531
00:12:20,120 --> 00:12:21,580
and we want to store a number in that
file and we want to be able to increment

532
00:12:21,580 --> 00:12:21,590
file and we want to be able to increment
 

533
00:12:21,590 --> 00:12:23,080
file and we want to be able to increment
that number so we're keeping maybe a

534
00:12:23,080 --> 00:12:23,090
that number so we're keeping maybe a
 

535
00:12:23,090 --> 00:12:24,910
that number so we're keeping maybe a
statistics count and whenever a client

536
00:12:24,910 --> 00:12:24,920
statistics count and whenever a client
 

537
00:12:24,920 --> 00:12:27,970
statistics count and whenever a client
you know I know gets a request from a

538
00:12:27,970 --> 00:12:27,980
you know I know gets a request from a
 

539
00:12:27,980 --> 00:12:29,290
you know I know gets a request from a
web user or something it's going to

540
00:12:29,290 --> 00:12:29,300
web user or something it's going to
 

541
00:12:29,300 --> 00:12:34,890
web user or something it's going to
increment that count in zookeeper and

542
00:12:34,890 --> 00:12:34,900
increment that count in zookeeper and
 

543
00:12:34,900 --> 00:12:36,790
increment that count in zookeeper and
more than one client may want to

544
00:12:36,790 --> 00:12:36,800
more than one client may want to
 

545
00:12:36,800 --> 00:12:39,250
more than one client may want to
increment the count that's the critical

546
00:12:39,250 --> 00:12:39,260
increment the count that's the critical
 

547
00:12:39,260 --> 00:12:47,350
increment the count that's the critical
thing so an example so one thing to sort

548
00:12:47,350 --> 00:12:47,360
thing so an example so one thing to sort
 

549
00:12:47,360 --> 00:12:49,690
thing so an example so one thing to sort
of get out of the way is whether we

550
00:12:49,690 --> 00:12:49,700
of get out of the way is whether we
 

551
00:12:49,700 --> 00:12:52,180
of get out of the way is whether we
actually need some specialized interface

552
00:12:52,180 --> 00:12:52,190
actually need some specialized interface
 

553
00:12:52,190 --> 00:12:57,100
actually need some specialized interface
in order to support client coordination

554
00:12:57,100 --> 00:12:57,110
in order to support client coordination
 

555
00:12:57,110 --> 00:12:59,140
in order to support client coordination
as opposed to just data this looks like

556
00:12:59,140 --> 00:12:59,150
as opposed to just data this looks like
 

557
00:12:59,150 --> 00:13:01,060
as opposed to just data this looks like
a file system could we just provide the

558
00:13:01,060 --> 00:13:01,070
a file system could we just provide the
 

559
00:13:01,070 --> 00:13:03,210
a file system could we just provide the
ordinary readwrite kind of file system

560
00:13:03,210 --> 00:13:03,220
ordinary readwrite kind of file system
 

561
00:13:03,220 --> 00:13:06,220
ordinary readwrite kind of file system
stuff that dated that typical storage

562
00:13:06,220 --> 00:13:06,230
stuff that dated that typical storage
 

563
00:13:06,230 --> 00:13:09,670
stuff that dated that typical storage
systems provide so for example some of

564
00:13:09,670 --> 00:13:09,680
systems provide so for example some of
 

565
00:13:09,680 --> 00:13:11,170
systems provide so for example some of
you have started and you'll all start

566
00:13:11,170 --> 00:13:11,180
you have started and you'll all start
 

567
00:13:11,180 --> 00:13:13,210
you have started and you'll all start
soon Ladd 3 in which you build a key

568
00:13:13,210 --> 00:13:13,220
soon Ladd 3 in which you build a key
 

569
00:13:13,220 --> 00:13:15,940
soon Ladd 3 in which you build a key
value store where the two operations are

570
00:13:15,940 --> 00:13:15,950
value store where the two operations are
 

571
00:13:15,950 --> 00:13:20,200
value store where the two operations are
the only operations are put key value

572
00:13:20,200 --> 00:13:20,210
the only operations are put key value
 

573
00:13:20,210 --> 00:13:27,400
the only operations are put key value
and so one question is can we do you

574
00:13:27,400 --> 00:13:27,410
and so one question is can we do you
 

575
00:13:27,410 --> 00:13:28,630
and so one question is can we do you
know all these things that we might want

576
00:13:28,630 --> 00:13:28,640
know all these things that we might want
 

577
00:13:28,640 --> 00:13:30,190
know all these things that we might want
to do with zookeeper can we just do them

578
00:13:30,190 --> 00:13:30,200
to do with zookeeper can we just do them
 

579
00:13:30,200 --> 00:13:32,170
to do with zookeeper can we just do them
with lab 3 with a key with a key value

580
00:13:32,170 --> 00:13:32,180
with lab 3 with a key with a key value
 

581
00:13:32,180 --> 00:13:35,320
with lab 3 with a key with a key value
put get interface so supposing for my I

582
00:13:35,320 --> 00:13:35,330
put get interface so supposing for my I
 

583
00:13:35,330 --> 00:13:38,800
put get interface so supposing for my I
want to implement this count thing maybe

584
00:13:38,800 --> 00:13:38,810
want to implement this count thing maybe
 

585
00:13:38,810 --> 00:13:40,750
want to implement this count thing maybe
I could implement the count with just

586
00:13:40,750 --> 00:13:40,760
I could implement the count with just
 

587
00:13:40,760 --> 00:13:43,390
I could implement the count with just
lab threes key value interface so you

588
00:13:43,390 --> 00:13:43,400
lab threes key value interface so you
 

589
00:13:43,400 --> 00:13:45,670
lab threes key value interface so you
might increment the count by saying x

590
00:13:45,670 --> 00:13:45,680
might increment the count by saying x
 

591
00:13:45,680 --> 00:13:49,600
might increment the count by saying x
equals get you know whatever key were

592
00:13:49,600 --> 00:13:49,610
equals get you know whatever key were
 

593
00:13:49,610 --> 00:13:59,539
equals get you know whatever key were
using and then put that key an X plus 1

594
00:13:59,539 --> 00:13:59,549

 

595
00:13:59,549 --> 00:14:08,699

why why is this a bad answer yes yes oh

596
00:14:08,699 --> 00:14:08,709
why why is this a bad answer yes yes oh
 

597
00:14:08,709 --> 00:14:11,069
why why is this a bad answer yes yes oh
it's not atomic that is absolutely the

598
00:14:11,069 --> 00:14:11,079
it's not atomic that is absolutely the
 

599
00:14:11,079 --> 00:14:15,900
it's not atomic that is absolutely the
root of the problem here and you know

600
00:14:15,900 --> 00:14:15,910
root of the problem here and you know
 

601
00:14:15,910 --> 00:14:19,679
root of the problem here and you know
the abstract way of putting it but one

602
00:14:19,679 --> 00:14:19,689
the abstract way of putting it but one
 

603
00:14:19,689 --> 00:14:20,939
the abstract way of putting it but one
way of looking at it is that of two

604
00:14:20,939 --> 00:14:20,949
way of looking at it is that of two
 

605
00:14:20,949 --> 00:14:22,530
way of looking at it is that of two
clients both want to increment the

606
00:14:22,530 --> 00:14:22,540
clients both want to increment the
 

607
00:14:22,540 --> 00:14:24,509
clients both want to increment the
counter at the same time they're both

608
00:14:24,509 --> 00:14:24,519
counter at the same time they're both
 

609
00:14:24,519 --> 00:14:26,429
counter at the same time they're both
gonna read they're both gonna use get to

610
00:14:26,429 --> 00:14:26,439
gonna read they're both gonna use get to
 

611
00:14:26,439 --> 00:14:28,429
gonna read they're both gonna use get to
read the old value and get you know ten

612
00:14:28,429 --> 00:14:28,439
read the old value and get you know ten
 

613
00:14:28,439 --> 00:14:30,960
read the old value and get you know ten
those gonna add one to ten and get 11

614
00:14:30,960 --> 00:14:30,970
those gonna add one to ten and get 11
 

615
00:14:30,970 --> 00:14:33,329
those gonna add one to ten and get 11
and I was gonna call put with 11 so now

616
00:14:33,329 --> 00:14:33,339
and I was gonna call put with 11 so now
 

617
00:14:33,339 --> 00:14:36,059
and I was gonna call put with 11 so now
we've increased the counter by one but

618
00:14:36,059 --> 00:14:36,069
we've increased the counter by one but
 

619
00:14:36,069 --> 00:14:37,769
we've increased the counter by one but
two clients were doing it so surely we

620
00:14:37,769 --> 00:14:37,779
two clients were doing it so surely we
 

621
00:14:37,779 --> 00:14:39,179
two clients were doing it so surely we
should have ended up increasing it by

622
00:14:39,179 --> 00:14:39,189
should have ended up increasing it by
 

623
00:14:39,189 --> 00:14:44,280
should have ended up increasing it by
two so that's why the lab three cannot

624
00:14:44,280 --> 00:14:44,290
two so that's why the lab three cannot
 

625
00:14:44,290 --> 00:14:46,999
two so that's why the lab three cannot
be used for even this simple example

626
00:14:46,999 --> 00:14:47,009
be used for even this simple example
 

627
00:14:47,009 --> 00:14:50,009
be used for even this simple example
furthermore in the sort of zookeeper

628
00:14:50,009 --> 00:14:50,019
furthermore in the sort of zookeeper
 

629
00:14:50,019 --> 00:14:52,949
furthermore in the sort of zookeeper
world where guests can return stale data

630
00:14:52,949 --> 00:14:52,959
world where guests can return stale data
 

631
00:14:52,959 --> 00:14:55,859
world where guests can return stale data
is not lab 3 or gets are not allowed to

632
00:14:55,859 --> 00:14:55,869
is not lab 3 or gets are not allowed to
 

633
00:14:55,869 --> 00:14:57,869
is not lab 3 or gets are not allowed to
return stale data but in zookeeper reads

634
00:14:57,869 --> 00:14:57,879
return stale data but in zookeeper reads
 

635
00:14:57,879 --> 00:15:00,479
return stale data but in zookeeper reads
can be stale and so if you read a stale

636
00:15:00,479 --> 00:15:00,489
can be stale and so if you read a stale
 

637
00:15:00,489 --> 00:15:02,460
can be stale and so if you read a stale
version of the current counter and add

638
00:15:02,460 --> 00:15:02,470
version of the current counter and add
 

639
00:15:02,470 --> 00:15:03,059
version of the current counter and add
one to it

640
00:15:03,059 --> 00:15:03,069
one to it
 

641
00:15:03,069 --> 00:15:05,819
one to it
you're now writing the wrong value you

642
00:15:05,819 --> 00:15:05,829
you're now writing the wrong value you
 

643
00:15:05,829 --> 00:15:09,329
you're now writing the wrong value you
know if 30 values 11 but you're get

644
00:15:09,329 --> 00:15:09,339
know if 30 values 11 but you're get
 

645
00:15:09,339 --> 00:15:12,090
know if 30 values 11 but you're get
returns a stale value of 10 you add 1 to

646
00:15:12,090 --> 00:15:12,100
returns a stale value of 10 you add 1 to
 

647
00:15:12,100 --> 00:15:14,069
returns a stale value of 10 you add 1 to
that and put 11 that's a mistake because

648
00:15:14,069 --> 00:15:14,079
that and put 11 that's a mistake because
 

649
00:15:14,079 --> 00:15:15,989
that and put 11 that's a mistake because
we really should have been putting 12 so

650
00:15:15,989 --> 00:15:15,999
we really should have been putting 12 so
 

651
00:15:15,999 --> 00:15:17,460
we really should have been putting 12 so
zookeeper has this additional problem

652
00:15:17,460 --> 00:15:17,470
zookeeper has this additional problem
 

653
00:15:17,470 --> 00:15:19,590
zookeeper has this additional problem
that we have to worry about that

654
00:15:19,590 --> 00:15:19,600
that we have to worry about that
 

655
00:15:19,600 --> 00:15:25,159
that we have to worry about that
that gets don't return the latest data

656
00:15:25,159 --> 00:15:25,169

 

657
00:15:25,169 --> 00:15:32,509

ok so how would you do this in zookeeper

658
00:15:32,509 --> 00:15:32,519
ok so how would you do this in zookeeper
 

659
00:15:32,519 --> 00:15:40,410
ok so how would you do this in zookeeper
here's how I would do this in zookeeper

660
00:15:40,410 --> 00:15:40,420

 

661
00:15:40,420 --> 00:15:42,699

it turns out you need to do you need to

662
00:15:42,699 --> 00:15:42,709
it turns out you need to do you need to
 

663
00:15:42,709 --> 00:15:46,329
it turns out you need to do you need to
wrap this code Siemens in a loop because

664
00:15:46,329 --> 00:15:46,339
wrap this code Siemens in a loop because
 

665
00:15:46,339 --> 00:15:48,009
wrap this code Siemens in a loop because
it's not guaranteed to succeed the first

666
00:15:48,009 --> 00:15:48,019
it's not guaranteed to succeed the first
 

667
00:15:48,019 --> 00:15:55,050
it's not guaranteed to succeed the first
time so we're just gonna say while true

668
00:15:55,050 --> 00:15:55,060

 

669
00:15:55,060 --> 00:15:57,160

we're gonna call get data to get the

670
00:15:57,160 --> 00:15:57,170
we're gonna call get data to get the
 

671
00:15:57,170 --> 00:15:59,139
we're gonna call get data to get the
current value of the counter and the

672
00:15:59,139 --> 00:15:59,149
current value of the counter and the
 

673
00:15:59,149 --> 00:16:01,629
current value of the counter and the
current version so we're gonna say X V

674
00:16:01,629 --> 00:16:01,639
current version so we're gonna say X V
 

675
00:16:01,639 --> 00:16:09,699
current version so we're gonna say X V
equals I'm get data and we need to say

676
00:16:09,699 --> 00:16:09,709
equals I'm get data and we need to say
 

677
00:16:09,709 --> 00:16:11,230
equals I'm get data and we need to say
final name I don't care what the file

678
00:16:11,230 --> 00:16:11,240
final name I don't care what the file
 

679
00:16:11,240 --> 00:16:13,660
final name I don't care what the file
name is we just say that nice now we get

680
00:16:13,660 --> 00:16:13,670
name is we just say that nice now we get
 

681
00:16:13,670 --> 00:16:16,930
name is we just say that nice now we get
the well we get a value and a version

682
00:16:16,930 --> 00:16:16,940
the well we get a value and a version
 

683
00:16:16,940 --> 00:16:20,019
the well we get a value and a version
number possibly not fresh possibly stale

684
00:16:20,019 --> 00:16:20,029
number possibly not fresh possibly stale
 

685
00:16:20,029 --> 00:16:26,019
number possibly not fresh possibly stale
but maybe fresh and then we're gonna use

686
00:16:26,019 --> 00:16:26,029
but maybe fresh and then we're gonna use
 

687
00:16:26,029 --> 00:16:45,629
but maybe fresh and then we're gonna use
a conditional put a conditional setting

688
00:16:45,629 --> 00:16:45,639

 

689
00:16:45,639 --> 00:16:48,610

and if set data is a set data operation

690
00:16:48,610 --> 00:16:48,620
and if set data is a set data operation
 

691
00:16:48,620 --> 00:16:50,170
and if set data is a set data operation
return true meaning it actually did set

692
00:16:50,170 --> 00:16:50,180
return true meaning it actually did set
 

693
00:16:50,180 --> 00:16:52,300
return true meaning it actually did set
the value we're gonna break otherwise

694
00:16:52,300 --> 00:16:52,310
the value we're gonna break otherwise
 

695
00:16:52,310 --> 00:16:55,290
the value we're gonna break otherwise
just go back to the top of the loop

696
00:16:55,290 --> 00:16:55,300
just go back to the top of the loop
 

697
00:16:55,300 --> 00:17:00,189
just go back to the top of the loop
otherwise so what's going on here is

698
00:17:00,189 --> 00:17:00,199
otherwise so what's going on here is
 

699
00:17:00,199 --> 00:17:03,069
otherwise so what's going on here is
that we read some value and some version

700
00:17:03,069 --> 00:17:03,079
that we read some value and some version
 

701
00:17:03,079 --> 00:17:04,929
that we read some value and some version
number maybe still maybe fresh out of

702
00:17:04,929 --> 00:17:04,939
number maybe still maybe fresh out of
 

703
00:17:04,939 --> 00:17:07,149
number maybe still maybe fresh out of
the replicas the set data we send

704
00:17:07,149 --> 00:17:07,159
the replicas the set data we send
 

705
00:17:07,159 --> 00:17:08,380
the replicas the set data we send
actually did the zookeeper leader

706
00:17:08,380 --> 00:17:08,390
actually did the zookeeper leader
 

707
00:17:08,390 --> 00:17:10,659
actually did the zookeeper leader
because all rights go to the leader and

708
00:17:10,659 --> 00:17:10,669
because all rights go to the leader and
 

709
00:17:10,669 --> 00:17:12,699
because all rights go to the leader and
what this means is only set the value to

710
00:17:12,699 --> 00:17:12,709
what this means is only set the value to
 

711
00:17:12,709 --> 00:17:15,309
what this means is only set the value to
X plus one if the version with the real

712
00:17:15,309 --> 00:17:15,319
X plus one if the version with the real
 

713
00:17:15,319 --> 00:17:19,980
X plus one if the version with the real
version the latest version is still is V

714
00:17:19,980 --> 00:17:19,990
version the latest version is still is V
 

715
00:17:19,990 --> 00:17:23,590
version the latest version is still is V
so if we read fresh data and nothing

716
00:17:23,590 --> 00:17:23,600
so if we read fresh data and nothing
 

717
00:17:23,600 --> 00:17:24,880
so if we read fresh data and nothing
else is going on in the system like no

718
00:17:24,880 --> 00:17:24,890
else is going on in the system like no
 

719
00:17:24,890 --> 00:17:26,679
else is going on in the system like no
other clients are trying to increment

720
00:17:26,679 --> 00:17:26,689
other clients are trying to increment
 

721
00:17:26,689 --> 00:17:29,169
other clients are trying to increment
this then we'll read the latest version

722
00:17:29,169 --> 00:17:29,179
this then we'll read the latest version
 

723
00:17:29,179 --> 00:17:31,270
this then we'll read the latest version
latest value we'll add one to the latest

724
00:17:31,270 --> 00:17:31,280
latest value we'll add one to the latest
 

725
00:17:31,280 --> 00:17:34,299
latest value we'll add one to the latest
value specify the latest version and our

726
00:17:34,299 --> 00:17:34,309
value specify the latest version and our
 

727
00:17:34,309 --> 00:17:35,950
value specify the latest version and our
set data will be accepted by the leader

728
00:17:35,950 --> 00:17:35,960
set data will be accepted by the leader
 

729
00:17:35,960 --> 00:17:39,399
set data will be accepted by the leader
and we'll get back a positive reply to

730
00:17:39,399 --> 00:17:39,409
and we'll get back a positive reply to
 

731
00:17:39,409 --> 00:17:42,460
and we'll get back a positive reply to
our request after it's committed and

732
00:17:42,460 --> 00:17:42,470
our request after it's committed and
 

733
00:17:42,470 --> 00:17:45,100
our request after it's committed and
we'll break because we're done if we got

734
00:17:45,100 --> 00:17:45,110
we'll break because we're done if we got
 

735
00:17:45,110 --> 00:17:47,950
we'll break because we're done if we got
stale data here or this was fresh data

736
00:17:47,950 --> 00:17:47,960
stale data here or this was fresh data
 

737
00:17:47,960 --> 00:17:50,170
stale data here or this was fresh data
but by the time

738
00:17:50,170 --> 00:17:50,180
but by the time
 

739
00:17:50,180 --> 00:17:52,120
but by the time
our set data got to the leader some

740
00:17:52,120 --> 00:17:52,130
our set data got to the leader some
 

741
00:17:52,130 --> 00:17:55,480
our set data got to the leader some
other clients set data and some other

742
00:17:55,480 --> 00:17:55,490
other clients set data and some other
 

743
00:17:55,490 --> 00:17:56,710
other clients set data and some other
client is trying to increment their set

744
00:17:56,710 --> 00:17:56,720
client is trying to increment their set
 

745
00:17:56,720 --> 00:17:58,630
client is trying to increment their set
data got there before us our version

746
00:17:58,630 --> 00:17:58,640
data got there before us our version
 

747
00:17:58,640 --> 00:18:00,160
data got there before us our version
number will no longer be fresh in either

748
00:18:00,160 --> 00:18:00,170
number will no longer be fresh in either
 

749
00:18:00,170 --> 00:18:03,040
number will no longer be fresh in either
those cases this set data will fail and

750
00:18:03,040 --> 00:18:03,050
those cases this set data will fail and
 

751
00:18:03,050 --> 00:18:05,500
those cases this set data will fail and
we'll get an error response back it

752
00:18:05,500 --> 00:18:05,510
we'll get an error response back it
 

753
00:18:05,510 --> 00:18:08,980
we'll get an error response back it
won't break out of the loop and we'll go

754
00:18:08,980 --> 00:18:08,990
won't break out of the loop and we'll go
 

755
00:18:08,990 --> 00:18:11,560
won't break out of the loop and we'll go
back and try again and hopefully we'll

756
00:18:11,560 --> 00:18:11,570
back and try again and hopefully we'll
 

757
00:18:11,570 --> 00:18:25,900
back and try again and hopefully we'll
succeed this time yes yes so the

758
00:18:25,900 --> 00:18:25,910
succeed this time yes yes so the
 

759
00:18:25,910 --> 00:18:27,640
succeed this time yes yes so the
question is could this it's a while loop

760
00:18:27,640 --> 00:18:27,650
question is could this it's a while loop
 

761
00:18:27,650 --> 00:18:29,560
question is could this it's a while loop
or we guaranteed is ever going to finish

762
00:18:29,560 --> 00:18:29,570
or we guaranteed is ever going to finish
 

763
00:18:29,570 --> 00:18:32,530
or we guaranteed is ever going to finish
and no no we're not really guaranteed

764
00:18:32,530 --> 00:18:32,540
and no no we're not really guaranteed
 

765
00:18:32,540 --> 00:18:36,970
and no no we're not really guaranteed
that we're gonna finish in practice you

766
00:18:36,970 --> 00:18:36,980
that we're gonna finish in practice you
 

767
00:18:36,980 --> 00:18:39,610
that we're gonna finish in practice you
know so for example if our replicas were

768
00:18:39,610 --> 00:18:39,620
know so for example if our replicas were
 

769
00:18:39,620 --> 00:18:42,370
know so for example if our replicas were
reading from is cut off from the leader

770
00:18:42,370 --> 00:18:42,380
reading from is cut off from the leader
 

771
00:18:42,380 --> 00:18:45,240
reading from is cut off from the leader
and permanently gives us stale data then

772
00:18:45,240 --> 00:18:45,250
and permanently gives us stale data then
 

773
00:18:45,250 --> 00:18:47,380
and permanently gives us stale data then
you know maybe this is not gonna work

774
00:18:47,380 --> 00:18:47,390
you know maybe this is not gonna work
 

775
00:18:47,390 --> 00:18:51,720
you know maybe this is not gonna work
out but you know but in real life well

776
00:18:51,720 --> 00:18:51,730
out but you know but in real life well
 

777
00:18:51,730 --> 00:18:53,980
out but you know but in real life well
in real life the you know leaders

778
00:18:53,980 --> 00:18:53,990
in real life the you know leaders
 

779
00:18:53,990 --> 00:18:56,500
in real life the you know leaders
pushing all the replicas towards having

780
00:18:56,500 --> 00:18:56,510
pushing all the replicas towards having
 

781
00:18:56,510 --> 00:18:58,840
pushing all the replicas towards having
identical data to the leader so you know

782
00:18:58,840 --> 00:18:58,850
identical data to the leader so you know
 

783
00:18:58,850 --> 00:19:00,970
identical data to the leader so you know
if we just got stale data here probably

784
00:19:00,970 --> 00:19:00,980
if we just got stale data here probably
 

785
00:19:00,980 --> 00:19:02,710
if we just got stale data here probably
when we go back you know maybe we should

786
00:19:02,710 --> 00:19:02,720
when we go back you know maybe we should
 

787
00:19:02,720 --> 00:19:04,750
when we go back you know maybe we should
sleep for 10 milliseconds or something

788
00:19:04,750 --> 00:19:04,760
sleep for 10 milliseconds or something
 

789
00:19:04,760 --> 00:19:07,030
sleep for 10 milliseconds or something
at this point but when we go back here

790
00:19:07,030 --> 00:19:07,040
at this point but when we go back here
 

791
00:19:07,040 --> 00:19:08,140
at this point but when we go back here
eventually we're gonna see the latest

792
00:19:08,140 --> 00:19:08,150
eventually we're gonna see the latest
 

793
00:19:08,150 --> 00:19:10,060
eventually we're gonna see the latest
data the situation under which this

794
00:19:10,060 --> 00:19:10,070
data the situation under which this
 

795
00:19:10,070 --> 00:19:13,450
data the situation under which this
might genuinely be pretty bad news is if

796
00:19:13,450 --> 00:19:13,460
might genuinely be pretty bad news is if
 

797
00:19:13,460 --> 00:19:17,080
might genuinely be pretty bad news is if
there's a very high continuous load of

798
00:19:17,080 --> 00:19:17,090
there's a very high continuous load of
 

799
00:19:17,090 --> 00:19:18,670
there's a very high continuous load of
increments from clients you know if we

800
00:19:18,670 --> 00:19:18,680
increments from clients you know if we
 

801
00:19:18,680 --> 00:19:21,160
increments from clients you know if we
have a thousand clients all trying to do

802
00:19:21,160 --> 00:19:21,170
have a thousand clients all trying to do
 

803
00:19:21,170 --> 00:19:25,570
have a thousand clients all trying to do
increments the risk is that maybe none

804
00:19:25,570 --> 00:19:25,580
increments the risk is that maybe none
 

805
00:19:25,580 --> 00:19:30,040
increments the risk is that maybe none
of them will succeed or something I

806
00:19:30,040 --> 00:19:30,050
of them will succeed or something I
 

807
00:19:30,050 --> 00:19:31,810
of them will succeed or something I
think one of them will succeed because I

808
00:19:31,810 --> 00:19:31,820
think one of them will succeed because I
 

809
00:19:31,820 --> 00:19:35,260
think one of them will succeed because I
think one of the most succeed because

810
00:19:35,260 --> 00:19:35,270
think one of the most succeed because
 

811
00:19:35,270 --> 00:19:37,510
think one of the most succeed because
you know the the first one that gets its

812
00:19:37,510 --> 00:19:37,520
you know the the first one that gets its
 

813
00:19:37,520 --> 00:19:40,540
you know the the first one that gets its
set data into the leader will succeed

814
00:19:40,540 --> 00:19:40,550
set data into the leader will succeed
 

815
00:19:40,550 --> 00:19:41,830
set data into the leader will succeed
and the rest will all fail because their

816
00:19:41,830 --> 00:19:41,840
and the rest will all fail because their
 

817
00:19:41,840 --> 00:19:43,780
and the rest will all fail because their
version numbers are all too low and then

818
00:19:43,780 --> 00:19:43,790
version numbers are all too low and then
 

819
00:19:43,790 --> 00:19:46,510
version numbers are all too low and then
the next 999 will put and get data's in

820
00:19:46,510 --> 00:19:46,520
the next 999 will put and get data's in
 

821
00:19:46,520 --> 00:19:48,430
the next 999 will put and get data's in
and one of them will succeed so it all

822
00:19:48,430 --> 00:19:48,440
and one of them will succeed so it all
 

823
00:19:48,440 --> 00:19:50,350
and one of them will succeed so it all
have a sort of N squared complexity to

824
00:19:50,350 --> 00:19:50,360
have a sort of N squared complexity to
 

825
00:19:50,360 --> 00:19:54,370
have a sort of N squared complexity to
get through all of the all other clients

826
00:19:54,370 --> 00:19:54,380
get through all of the all other clients
 

827
00:19:54,380 --> 00:19:55,930
get through all of the all other clients
which is very damaging but it will

828
00:19:55,930 --> 00:19:55,940
which is very damaging but it will
 

829
00:19:55,940 --> 00:19:57,790
which is very damaging but it will
finish eventually and so if you thought

830
00:19:57,790 --> 00:19:57,800
finish eventually and so if you thought
 

831
00:19:57,800 --> 00:19:59,440
finish eventually and so if you thought
you were gonna have a lot of clients you

832
00:19:59,440 --> 00:19:59,450
you were gonna have a lot of clients you
 

833
00:19:59,450 --> 00:20:01,900
you were gonna have a lot of clients you
would use a different strategy here this

834
00:20:01,900 --> 00:20:01,910
would use a different strategy here this
 

835
00:20:01,910 --> 00:20:02,390
would use a different strategy here this
is good

836
00:20:02,390 --> 00:20:02,400
is good
 

837
00:20:02,400 --> 00:20:17,150
is good
or load situations yes if they fit in

838
00:20:17,150 --> 00:20:17,160
or load situations yes if they fit in
 

839
00:20:17,160 --> 00:20:18,980
or load situations yes if they fit in
memory it's no problem if they don't fit

840
00:20:18,980 --> 00:20:18,990
memory it's no problem if they don't fit
 

841
00:20:18,990 --> 00:20:21,650
memory it's no problem if they don't fit
memory it's a disaster so yeah when

842
00:20:21,650 --> 00:20:21,660
memory it's a disaster so yeah when
 

843
00:20:21,660 --> 00:20:23,450
memory it's a disaster so yeah when
you're using zookeeper you have to keep

844
00:20:23,450 --> 00:20:23,460
you're using zookeeper you have to keep
 

845
00:20:23,460 --> 00:20:26,300
you're using zookeeper you have to keep
in mind that it's yeah it's great for

846
00:20:26,300 --> 00:20:26,310
in mind that it's yeah it's great for
 

847
00:20:26,310 --> 00:20:29,210
in mind that it's yeah it's great for
100 megabytes of stuff and probably

848
00:20:29,210 --> 00:20:29,220
100 megabytes of stuff and probably
 

849
00:20:29,220 --> 00:20:31,490
100 megabytes of stuff and probably
terrible for 100 gigabytes of stuff so

850
00:20:31,490 --> 00:20:31,500
terrible for 100 gigabytes of stuff so
 

851
00:20:31,500 --> 00:20:32,900
terrible for 100 gigabytes of stuff so
that's why people think of it as storing

852
00:20:32,900 --> 00:20:32,910
that's why people think of it as storing
 

853
00:20:32,910 --> 00:20:35,150
that's why people think of it as storing
configuration information rather than

854
00:20:35,150 --> 00:20:35,160
configuration information rather than
 

855
00:20:35,160 --> 00:20:38,890
configuration information rather than
their we old data of your big website

856
00:20:38,890 --> 00:20:38,900
their we old data of your big website
 

857
00:20:38,900 --> 00:20:53,690
their we old data of your big website
yes I mean it's sort of watch into this

858
00:20:53,690 --> 00:20:53,700
yes I mean it's sort of watch into this
 

859
00:20:53,700 --> 00:20:58,730
yes I mean it's sort of watch into this
sequence

860
00:20:58,730 --> 00:20:58,740

 

861
00:20:58,740 --> 00:21:04,640

yet that could be so if we want if we

862
00:21:04,640 --> 00:21:04,650
yet that could be so if we want if we
 

863
00:21:04,650 --> 00:21:06,680
yet that could be so if we want if we
wanted to fix this to work under high

864
00:21:06,680 --> 00:21:06,690
wanted to fix this to work under high
 

865
00:21:06,690 --> 00:21:13,580
wanted to fix this to work under high
load then you would certainly want to

866
00:21:13,580 --> 00:21:13,590
load then you would certainly want to
 

867
00:21:13,590 --> 00:21:17,030
load then you would certainly want to
sleep at this point where I'm not well

868
00:21:17,030 --> 00:21:17,040
sleep at this point where I'm not well
 

869
00:21:17,040 --> 00:21:19,730
sleep at this point where I'm not well
the way I would fix this my instinct I'm

870
00:21:19,730 --> 00:21:19,740
the way I would fix this my instinct I'm
 

871
00:21:19,740 --> 00:21:21,799
the way I would fix this my instinct I'm
fixing this would be to insert asleep

872
00:21:21,799 --> 00:21:21,809
fixing this would be to insert asleep
 

873
00:21:21,809 --> 00:21:25,940
fixing this would be to insert asleep
here and furthermore double the amount

874
00:21:25,940 --> 00:21:25,950
here and furthermore double the amount
 

875
00:21:25,950 --> 00:21:30,560
here and furthermore double the amount
of it sort of randomized sleep whose

876
00:21:30,560 --> 00:21:30,570
of it sort of randomized sleep whose
 

877
00:21:30,570 --> 00:21:33,169
of it sort of randomized sleep whose
span of randomness doubles each time we

878
00:21:33,169 --> 00:21:33,179
span of randomness doubles each time we
 

879
00:21:33,179 --> 00:21:37,070
span of randomness doubles each time we
fail and that's a sort of tried and true

880
00:21:37,070 --> 00:21:37,080
fail and that's a sort of tried and true
 

881
00:21:37,080 --> 00:21:39,460
fail and that's a sort of tried and true
strategies exponential back-off is a

882
00:21:39,460 --> 00:21:39,470
strategies exponential back-off is a
 

883
00:21:39,470 --> 00:21:42,380
strategies exponential back-off is a
it's actually similar to raft leader

884
00:21:42,380 --> 00:21:42,390
it's actually similar to raft leader
 

885
00:21:42,390 --> 00:21:44,840
it's actually similar to raft leader
election it's a reasonable strategy for

886
00:21:44,840 --> 00:21:44,850
election it's a reasonable strategy for
 

887
00:21:44,850 --> 00:21:47,210
election it's a reasonable strategy for
adapting to an unknown number of

888
00:21:47,210 --> 00:21:47,220
adapting to an unknown number of
 

889
00:21:47,220 --> 00:21:54,890
adapting to an unknown number of
concurrent clients so okay tell me

890
00:21:54,890 --> 00:21:54,900
concurrent clients so okay tell me
 

891
00:21:54,900 --> 00:22:03,290
concurrent clients so okay tell me
what's right okay so we're getting data

892
00:22:03,290 --> 00:22:03,300
what's right okay so we're getting data
 

893
00:22:03,300 --> 00:22:17,910
what's right okay so we're getting data
and then watching its true

894
00:22:17,910 --> 00:22:17,920

 

895
00:22:17,920 --> 00:22:22,740

so yes so if somebody else modifies the

896
00:22:22,740 --> 00:22:22,750
so yes so if somebody else modifies the
 

897
00:22:22,750 --> 00:22:25,050
so yes so if somebody else modifies the
data before you call set data maybe

898
00:22:25,050 --> 00:22:25,060
data before you call set data maybe
 

899
00:22:25,060 --> 00:22:28,620
data before you call set data maybe
you'll get a watch notification um the

900
00:22:28,620 --> 00:22:28,630
you'll get a watch notification um the
 

901
00:22:28,630 --> 00:22:30,600
you'll get a watch notification um the
problem is the timing is not working in

902
00:22:30,600 --> 00:22:30,610
problem is the timing is not working in
 

903
00:22:30,610 --> 00:22:32,280
problem is the timing is not working in
your favor like the amount of time

904
00:22:32,280 --> 00:22:32,290
your favor like the amount of time
 

905
00:22:32,290 --> 00:22:34,680
your favor like the amount of time
between when I received the data here

906
00:22:34,680 --> 00:22:34,690
between when I received the data here
 

907
00:22:34,690 --> 00:22:37,200
between when I received the data here
and when I send off the message to the

908
00:22:37,200 --> 00:22:37,210
and when I send off the message to the
 

909
00:22:37,210 --> 00:22:39,720
and when I send off the message to the
leader with this new set data is zero

910
00:22:39,720 --> 00:22:39,730
leader with this new set data is zero
 

911
00:22:39,730 --> 00:22:42,260
leader with this new set data is zero
that's how much time will pass here

912
00:22:42,260 --> 00:22:42,270
that's how much time will pass here
 

913
00:22:42,270 --> 00:22:47,730
that's how much time will pass here
roughly and if some other client is sent

914
00:22:47,730 --> 00:22:47,740
roughly and if some other client is sent
 

915
00:22:47,740 --> 00:22:51,660
roughly and if some other client is sent
in increment at about this time it's

916
00:22:51,660 --> 00:22:51,670
in increment at about this time it's
 

917
00:22:51,670 --> 00:22:53,400
in increment at about this time it's
actually quite a long time between when

918
00:22:53,400 --> 00:22:53,410
actually quite a long time between when
 

919
00:22:53,410 --> 00:22:54,750
actually quite a long time between when
that client sends in the increment and

920
00:22:54,750 --> 00:22:54,760
that client sends in the increment and
 

921
00:22:54,760 --> 00:22:56,190
that client sends in the increment and
when it works its way through the leader

922
00:22:56,190 --> 00:22:56,200
when it works its way through the leader
 

923
00:22:56,200 --> 00:22:58,170
when it works its way through the leader
and is sent out to the followers and

924
00:22:58,170 --> 00:22:58,180
and is sent out to the followers and
 

925
00:22:58,180 --> 00:22:59,790
and is sent out to the followers and
actually executed the followers and the

926
00:22:59,790 --> 00:22:59,800
actually executed the followers and the
 

927
00:22:59,800 --> 00:23:01,530
actually executed the followers and the
followers look it up in their watch

928
00:23:01,530 --> 00:23:01,540
followers look it up in their watch
 

929
00:23:01,540 --> 00:23:03,870
followers look it up in their watch
table and send me a notification so I

930
00:23:03,870 --> 00:23:03,880
table and send me a notification so I
 

931
00:23:03,880 --> 00:23:17,580
table and send me a notification so I
think

932
00:23:17,580 --> 00:23:17,590

 

933
00:23:17,590 --> 00:23:25,900

it won't give you any read result or if

934
00:23:25,900 --> 00:23:25,910
it won't give you any read result or if
 

935
00:23:25,910 --> 00:23:28,660
it won't give you any read result or if
you read at a point if you're gonna read

936
00:23:28,660 --> 00:23:28,670
you read at a point if you're gonna read
 

937
00:23:28,670 --> 00:23:30,310
you read at a point if you're gonna read
at a point that's after where the

938
00:23:30,310 --> 00:23:30,320
at a point that's after where the
 

939
00:23:30,320 --> 00:23:32,410
at a point that's after where the
modification occurred that should raise

940
00:23:32,410 --> 00:23:32,420
modification occurred that should raise
 

941
00:23:32,420 --> 00:23:34,810
modification occurred that should raise
the watch you'll get the notification of

942
00:23:34,810 --> 00:23:34,820
the watch you'll get the notification of
 

943
00:23:34,820 --> 00:23:36,190
the watch you'll get the notification of
the watch before you get the read

944
00:23:36,190 --> 00:23:36,200
the watch before you get the read
 

945
00:23:36,200 --> 00:23:40,510
the watch before you get the read
response but in any case I think nothing

946
00:23:40,510 --> 00:23:40,520
response but in any case I think nothing
 

947
00:23:40,520 --> 00:23:42,850
response but in any case I think nothing
like this could save us because what's

948
00:23:42,850 --> 00:23:42,860
like this could save us because what's
 

949
00:23:42,860 --> 00:23:45,640
like this could save us because what's
gonna happen is all thousand clients are

950
00:23:45,640 --> 00:23:45,650
gonna happen is all thousand clients are
 

951
00:23:45,650 --> 00:23:47,640
gonna happen is all thousand clients are
gonna do the same thing whatever it is

952
00:23:47,640 --> 00:23:47,650
gonna do the same thing whatever it is
 

953
00:23:47,650 --> 00:23:50,380
gonna do the same thing whatever it is
right they're all gonna do again and set

954
00:23:50,380 --> 00:23:50,390
right they're all gonna do again and set
 

955
00:23:50,390 --> 00:23:52,090
right they're all gonna do again and set
a watch and whatever they're all gonna

956
00:23:52,090 --> 00:23:52,100
a watch and whatever they're all gonna
 

957
00:23:52,100 --> 00:23:53,470
a watch and whatever they're all gonna
get the notification at the same time

958
00:23:53,470 --> 00:23:53,480
get the notification at the same time
 

959
00:23:53,480 --> 00:23:54,820
get the notification at the same time
they're all gonna make the same decision

960
00:23:54,820 --> 00:23:54,830
they're all gonna make the same decision
 

961
00:23:54,830 --> 00:23:57,880
they're all gonna make the same decision
about well they're all not gonna get to

962
00:23:57,880 --> 00:23:57,890
about well they're all not gonna get to
 

963
00:23:57,890 --> 00:23:59,350
about well they're all not gonna get to
watch because none of them has done the

964
00:23:59,350 --> 00:23:59,360
watch because none of them has done the
 

965
00:23:59,360 --> 00:24:01,330
watch because none of them has done the
put data yet right

966
00:24:01,330 --> 00:24:01,340
put data yet right
 

967
00:24:01,340 --> 00:24:03,940
put data yet right
so the worst case is all the clients are

968
00:24:03,940 --> 00:24:03,950
so the worst case is all the clients are
 

969
00:24:03,950 --> 00:24:05,680
so the worst case is all the clients are
starting at the same point they all do a

970
00:24:05,680 --> 00:24:05,690
starting at the same point they all do a
 

971
00:24:05,690 --> 00:24:07,990
starting at the same point they all do a
get they all get version one they all

972
00:24:07,990 --> 00:24:08,000
get they all get version one they all
 

973
00:24:08,000 --> 00:24:09,400
get they all get version one they all
set a watch point they don't get a

974
00:24:09,400 --> 00:24:09,410
set a watch point they don't get a
 

975
00:24:09,410 --> 00:24:10,690
set a watch point they don't get a
notification because no change has

976
00:24:10,690 --> 00:24:10,700
notification because no change has
 

977
00:24:10,700 --> 00:24:14,440
notification because no change has
occurred they all send a set data RPC to

978
00:24:14,440 --> 00:24:14,450
occurred they all send a set data RPC to
 

979
00:24:14,450 --> 00:24:17,890
occurred they all send a set data RPC to
the leader all thousand of them the

980
00:24:17,890 --> 00:24:17,900
the leader all thousand of them the
 

981
00:24:17,900 --> 00:24:21,070
the leader all thousand of them the
first one changes the data and now the

982
00:24:21,070 --> 00:24:21,080
first one changes the data and now the
 

983
00:24:21,080 --> 00:24:23,350
first one changes the data and now the
other 999 and get a notification when

984
00:24:23,350 --> 00:24:23,360
other 999 and get a notification when
 

985
00:24:23,360 --> 00:24:24,970
other 999 and get a notification when
it's too late because they've already

986
00:24:24,970 --> 00:24:24,980
it's too late because they've already
 

987
00:24:24,980 --> 00:24:29,770
it's too late because they've already
sent the set data so it's possible that

988
00:24:29,770 --> 00:24:29,780
sent the set data so it's possible that
 

989
00:24:29,780 --> 00:24:33,340
sent the set data so it's possible that
watch could help us here but sort of

990
00:24:33,340 --> 00:24:33,350
watch could help us here but sort of
 

991
00:24:33,350 --> 00:24:38,950
watch could help us here but sort of
straightforward version of watch I have

992
00:24:38,950 --> 00:24:38,960
straightforward version of watch I have
 

993
00:24:38,960 --> 00:24:42,220
straightforward version of watch I have
a feeling if you wanted the the mail

994
00:24:42,220 --> 00:24:42,230
a feeling if you wanted the the mail
 

995
00:24:42,230 --> 00:24:43,270
a feeling if you wanted the the mail
we'll talk about this in a few minutes

996
00:24:43,270 --> 00:24:43,280
we'll talk about this in a few minutes
 

997
00:24:43,280 --> 00:24:48,100
we'll talk about this in a few minutes
but the anon heard the second locking

998
00:24:48,100 --> 00:24:48,110
but the anon heard the second locking
 

999
00:24:48,110 --> 00:24:50,980
but the anon heard the second locking
example absolutely solves this kind of

1000
00:24:50,980 --> 00:24:50,990
example absolutely solves this kind of
 

1001
00:24:50,990 --> 00:24:53,140
example absolutely solves this kind of
problem so we could adapt to the second

1002
00:24:53,140 --> 00:24:53,150
problem so we could adapt to the second
 

1003
00:24:53,150 --> 00:24:54,760
problem so we could adapt to the second
locking example from the paper to try to

1004
00:24:54,760 --> 00:24:54,770
locking example from the paper to try to
 

1005
00:24:54,770 --> 00:24:57,490
locking example from the paper to try to
cause the increments to happen one at a

1006
00:24:57,490 --> 00:24:57,500
cause the increments to happen one at a
 

1007
00:24:57,500 --> 00:25:00,580
cause the increments to happen one at a
time if there's a huge number of clients

1008
00:25:00,580 --> 00:25:00,590
time if there's a huge number of clients
 

1009
00:25:00,590 --> 00:25:03,700
time if there's a huge number of clients
who want to do it other questions about

1010
00:25:03,700 --> 00:25:03,710
who want to do it other questions about
 

1011
00:25:03,710 --> 00:25:08,560
who want to do it other questions about
this example okay this is an example of

1012
00:25:08,560 --> 00:25:08,570
this example okay this is an example of
 

1013
00:25:08,570 --> 00:25:11,050
this example okay this is an example of
a what many people call a mini

1014
00:25:11,050 --> 00:25:11,060
a what many people call a mini
 

1015
00:25:11,060 --> 00:25:13,960
a what many people call a mini
transaction all right it's transactional

1016
00:25:13,960 --> 00:25:13,970
transaction all right it's transactional
 

1017
00:25:13,970 --> 00:25:15,730
transaction all right it's transactional
in a sense that wow there's you know a

1018
00:25:15,730 --> 00:25:15,740
in a sense that wow there's you know a
 

1019
00:25:15,740 --> 00:25:17,500
in a sense that wow there's you know a
lot of funny stuff happening here the

1020
00:25:17,500 --> 00:25:17,510
lot of funny stuff happening here the
 

1021
00:25:17,510 --> 00:25:22,150
lot of funny stuff happening here the
effect is that once it all succeeds we

1022
00:25:22,150 --> 00:25:22,160
effect is that once it all succeeds we
 

1023
00:25:22,160 --> 00:25:23,740
effect is that once it all succeeds we
have achieved an atomic

1024
00:25:23,740 --> 00:25:23,750
have achieved an atomic
 

1025
00:25:23,750 --> 00:25:26,410
have achieved an atomic
read-modify-write of the counter right

1026
00:25:26,410 --> 00:25:26,420
read-modify-write of the counter right
 

1027
00:25:26,420 --> 00:25:28,740
read-modify-write of the counter right
the difficulty here

1028
00:25:28,740 --> 00:25:28,750
the difficulty here
 

1029
00:25:28,750 --> 00:25:35,970
the difficulty here
is that it's not atomic the reading the

1030
00:25:35,970 --> 00:25:35,980
is that it's not atomic the reading the
 

1031
00:25:35,980 --> 00:25:37,410
is that it's not atomic the reading the
right the read the modifying the right

1032
00:25:37,410 --> 00:25:37,420
right the read the modifying the right
 

1033
00:25:37,420 --> 00:25:40,140
right the read the modifying the right
are not atomic the thing that we have

1034
00:25:40,140 --> 00:25:40,150
are not atomic the thing that we have
 

1035
00:25:40,150 --> 00:25:42,630
are not atomic the thing that we have
pulled off here is that this sequence

1036
00:25:42,630 --> 00:25:42,640
pulled off here is that this sequence
 

1037
00:25:42,640 --> 00:25:47,400
pulled off here is that this sequence
once it finishes is atomic right we

1038
00:25:47,400 --> 00:25:47,410
once it finishes is atomic right we
 

1039
00:25:47,410 --> 00:25:49,260
once it finishes is atomic right we
actually man and once we have to be on

1040
00:25:49,260 --> 00:25:49,270
actually man and once we have to be on
 

1041
00:25:49,270 --> 00:25:50,970
actually man and once we have to be on
the pass through this that we succeeded

1042
00:25:50,970 --> 00:25:50,980
the pass through this that we succeeded
 

1043
00:25:50,980 --> 00:25:53,750
the pass through this that we succeeded
we managed to read increment and write

1044
00:25:53,750 --> 00:25:53,760
we managed to read increment and write
 

1045
00:25:53,760 --> 00:25:56,430
we managed to read increment and write
without anything else intervening we

1046
00:25:56,430 --> 00:25:56,440
without anything else intervening we
 

1047
00:25:56,440 --> 00:25:59,960
without anything else intervening we
managed to do these two steps atomically

1048
00:25:59,960 --> 00:25:59,970
managed to do these two steps atomically
 

1049
00:25:59,970 --> 00:26:05,100
managed to do these two steps atomically
and you know this is not because this

1050
00:26:05,100 --> 00:26:05,110
and you know this is not because this
 

1051
00:26:05,110 --> 00:26:06,780
and you know this is not because this
isn't a full database transaction like

1052
00:26:06,780 --> 00:26:06,790
isn't a full database transaction like
 

1053
00:26:06,790 --> 00:26:09,090
isn't a full database transaction like
real databases allow fully general

1054
00:26:09,090 --> 00:26:09,100
real databases allow fully general
 

1055
00:26:09,100 --> 00:26:10,680
real databases allow fully general
transactions where you can say start

1056
00:26:10,680 --> 00:26:10,690
transactions where you can say start
 

1057
00:26:10,690 --> 00:26:12,240
transactions where you can say start
transaction and then read or write

1058
00:26:12,240 --> 00:26:12,250
transaction and then read or write
 

1059
00:26:12,250 --> 00:26:14,010
transaction and then read or write
anything you like maybe thousands of

1060
00:26:14,010 --> 00:26:14,020
anything you like maybe thousands of
 

1061
00:26:14,020 --> 00:26:15,600
anything you like maybe thousands of
different data items whatever who knows

1062
00:26:15,600 --> 00:26:15,610
different data items whatever who knows
 

1063
00:26:15,610 --> 00:26:17,460
different data items whatever who knows
what and then say end transaction and

1064
00:26:17,460 --> 00:26:17,470
what and then say end transaction and
 

1065
00:26:17,470 --> 00:26:19,440
what and then say end transaction and
the database will cleverly commit the

1066
00:26:19,440 --> 00:26:19,450
the database will cleverly commit the
 

1067
00:26:19,450 --> 00:26:21,420
the database will cleverly commit the
whole thing as an atomic transaction so

1068
00:26:21,420 --> 00:26:21,430
whole thing as an atomic transaction so
 

1069
00:26:21,430 --> 00:26:22,530
whole thing as an atomic transaction so
real transactions can be very

1070
00:26:22,530 --> 00:26:22,540
real transactions can be very
 

1071
00:26:22,540 --> 00:26:25,800
real transactions can be very
complicated zookeeper supports this

1072
00:26:25,800 --> 00:26:25,810
complicated zookeeper supports this
 

1073
00:26:25,810 --> 00:26:27,870
complicated zookeeper supports this
extremely simplified version of you know

1074
00:26:27,870 --> 00:26:27,880
extremely simplified version of you know
 

1075
00:26:27,880 --> 00:26:30,870
extremely simplified version of you know
when you're sort of one we can do it

1076
00:26:30,870 --> 00:26:30,880
when you're sort of one we can do it
 

1077
00:26:30,880 --> 00:26:34,530
when you're sort of one we can do it
atomic sort of operations on one piece

1078
00:26:34,530 --> 00:26:34,540
atomic sort of operations on one piece
 

1079
00:26:34,540 --> 00:26:37,440
atomic sort of operations on one piece
of data but it's enough to get increment

1080
00:26:37,440 --> 00:26:37,450
of data but it's enough to get increment
 

1081
00:26:37,450 --> 00:26:39,240
of data but it's enough to get increment
and some other things so these are for

1082
00:26:39,240 --> 00:26:39,250
and some other things so these are for
 

1083
00:26:39,250 --> 00:26:40,650
and some other things so these are for
that reason since they're not general

1084
00:26:40,650 --> 00:26:40,660
that reason since they're not general
 

1085
00:26:40,660 --> 00:26:42,630
that reason since they're not general
but they do provide atomicity these are

1086
00:26:42,630 --> 00:26:42,640
but they do provide atomicity these are
 

1087
00:26:42,640 --> 00:26:50,460
but they do provide atomicity these are
often called mini transactions and it

1088
00:26:50,460 --> 00:26:50,470
often called mini transactions and it
 

1089
00:26:50,470 --> 00:26:52,140
often called mini transactions and it
turns out this pattern can be made to

1090
00:26:52,140 --> 00:26:52,150
turns out this pattern can be made to
 

1091
00:26:52,150 --> 00:26:54,960
turns out this pattern can be made to
work with various other things too like

1092
00:26:54,960 --> 00:26:54,970
work with various other things too like
 

1093
00:26:54,970 --> 00:26:57,350
work with various other things too like
if we wanted to do the test and set that

1094
00:26:57,350 --> 00:26:57,360
if we wanted to do the test and set that
 

1095
00:26:57,360 --> 00:27:00,900
if we wanted to do the test and set that
vmware ft requires it can be implemented

1096
00:27:00,900 --> 00:27:00,910
vmware ft requires it can be implemented
 

1097
00:27:00,910 --> 00:27:02,580
vmware ft requires it can be implemented
with very much this setup you know maybe

1098
00:27:02,580 --> 00:27:02,590
with very much this setup you know maybe
 

1099
00:27:02,590 --> 00:27:06,660
with very much this setup you know maybe
the old value if it's zero then we try

1100
00:27:06,660 --> 00:27:06,670
the old value if it's zero then we try
 

1101
00:27:06,670 --> 00:27:08,490
the old value if it's zero then we try
to set it to one but give this version

1102
00:27:08,490 --> 00:27:08,500
to set it to one but give this version
 

1103
00:27:08,500 --> 00:27:10,380
to set it to one but give this version
number you know nobody else intervened

1104
00:27:10,380 --> 00:27:10,390
number you know nobody else intervened
 

1105
00:27:10,390 --> 00:27:11,820
number you know nobody else intervened
and we were the one who actually managed

1106
00:27:11,820 --> 00:27:11,830
and we were the one who actually managed
 

1107
00:27:11,830 --> 00:27:13,050
and we were the one who actually managed
to set it to one because the version

1108
00:27:13,050 --> 00:27:13,060
to set it to one because the version
 

1109
00:27:13,060 --> 00:27:14,790
to set it to one because the version
number hadn't changed but i'm leader got

1110
00:27:14,790 --> 00:27:14,800
number hadn't changed but i'm leader got
 

1111
00:27:14,800 --> 00:27:17,220
number hadn't changed but i'm leader got
our request and we win somebody else

1112
00:27:17,220 --> 00:27:17,230
our request and we win somebody else
 

1113
00:27:17,230 --> 00:27:21,270
our request and we win somebody else
changes to one after we read it then the

1114
00:27:21,270 --> 00:27:21,280
changes to one after we read it then the
 

1115
00:27:21,280 --> 00:27:23,130
changes to one after we read it then the
leader will tell us that we lost so you

1116
00:27:23,130 --> 00:27:23,140
leader will tell us that we lost so you
 

1117
00:27:23,140 --> 00:27:24,870
leader will tell us that we lost so you
can do test and set with this pattern

1118
00:27:24,870 --> 00:27:24,880
can do test and set with this pattern
 

1119
00:27:24,880 --> 00:27:29,910
can do test and set with this pattern
also and you should remember this is the

1120
00:27:29,910 --> 00:27:29,920
also and you should remember this is the
 

1121
00:27:29,920 --> 00:27:33,490
also and you should remember this is the
strategy

1122
00:27:33,490 --> 00:27:33,500

 

1123
00:27:33,500 --> 00:27:38,450

okay alright next example I want to talk

1124
00:27:38,450 --> 00:27:38,460
okay alright next example I want to talk
 

1125
00:27:38,460 --> 00:27:42,440
okay alright next example I want to talk
about is these locks and I'm talking

1126
00:27:42,440 --> 00:27:42,450
about is these locks and I'm talking
 

1127
00:27:42,450 --> 00:27:43,820
about is these locks and I'm talking
about this because it's in the paper not

1128
00:27:43,820 --> 00:27:43,830
about this because it's in the paper not
 

1129
00:27:43,830 --> 00:27:46,700
about this because it's in the paper not
because I strongly believe that this

1130
00:27:46,700 --> 00:27:46,710
because I strongly believe that this
 

1131
00:27:46,710 --> 00:27:52,629
because I strongly believe that this
kind of lock is useful but they have

1132
00:27:52,629 --> 00:27:52,639
kind of lock is useful but they have
 

1133
00:27:52,639 --> 00:27:57,639
kind of lock is useful but they have
they have an example in which a choir

1134
00:27:57,639 --> 00:27:57,649

 

1135
00:27:57,649 --> 00:28:01,850

has a couple steps one we try to create

1136
00:28:01,850 --> 00:28:01,860
has a couple steps one we try to create
 

1137
00:28:01,860 --> 00:28:05,779
has a couple steps one we try to create
we have a lock file and we try to create

1138
00:28:05,779 --> 00:28:05,789
we have a lock file and we try to create
 

1139
00:28:05,789 --> 00:28:11,480
we have a lock file and we try to create
the lock file now again some file with a

1140
00:28:11,480 --> 00:28:11,490
the lock file now again some file with a
 

1141
00:28:11,490 --> 00:28:17,409
the lock file now again some file with a
femoral set to true and so if that

1142
00:28:17,409 --> 00:28:17,419
femoral set to true and so if that
 

1143
00:28:17,419 --> 00:28:22,250
femoral set to true and so if that
succeeds then or not we've acquired the

1144
00:28:22,250 --> 00:28:22,260
succeeds then or not we've acquired the
 

1145
00:28:22,260 --> 00:28:27,230
succeeds then or not we've acquired the
lock the second step that doesn't

1146
00:28:27,230 --> 00:28:27,240
lock the second step that doesn't
 

1147
00:28:27,240 --> 00:28:32,080
lock the second step that doesn't
succeed then we want to wait for whoever

1148
00:28:32,080 --> 00:28:32,090
succeed then we want to wait for whoever
 

1149
00:28:32,090 --> 00:28:34,909
succeed then we want to wait for whoever
did acquire the lock what if this isn't

1150
00:28:34,909 --> 00:28:34,919
did acquire the lock what if this isn't
 

1151
00:28:34,919 --> 00:28:36,320
did acquire the lock what if this isn't
true that means the lock file already

1152
00:28:36,320 --> 00:28:36,330
true that means the lock file already
 

1153
00:28:36,330 --> 00:28:37,879
true that means the lock file already
exists I mean somebody else has acquired

1154
00:28:37,879 --> 00:28:37,889
exists I mean somebody else has acquired
 

1155
00:28:37,889 --> 00:28:39,320
exists I mean somebody else has acquired
the lock and so we want to wait for them

1156
00:28:39,320 --> 00:28:39,330
the lock and so we want to wait for them
 

1157
00:28:39,330 --> 00:28:40,639
the lock and so we want to wait for them
to release the lock and they're gonna

1158
00:28:40,639 --> 00:28:40,649
to release the lock and they're gonna
 

1159
00:28:40,649 --> 00:28:42,110
to release the lock and they're gonna
release the lock by deleting this file

1160
00:28:42,110 --> 00:28:42,120
release the lock by deleting this file
 

1161
00:28:42,120 --> 00:28:56,730
release the lock by deleting this file
so we're gonna watch yes

1162
00:28:56,730 --> 00:28:56,740

 

1163
00:28:56,740 --> 00:28:59,520

alright so we're gonna watch we're gonna

1164
00:28:59,520 --> 00:28:59,530
alright so we're gonna watch we're gonna
 

1165
00:28:59,530 --> 00:29:11,010
alright so we're gonna watch we're gonna
gonna call exists and watching is true

1166
00:29:11,010 --> 00:29:11,020
gonna call exists and watching is true
 

1167
00:29:11,020 --> 00:29:15,340
gonna call exists and watching is true
now it turns out that um okay and and

1168
00:29:15,340 --> 00:29:15,350
now it turns out that um okay and and
 

1169
00:29:15,350 --> 00:29:17,230
now it turns out that um okay and and
and if the file still exists right which

1170
00:29:17,230 --> 00:29:17,240
and if the file still exists right which
 

1171
00:29:17,240 --> 00:29:18,760
and if the file still exists right which
we expect it to because after all they

1172
00:29:18,760 --> 00:29:18,770
we expect it to because after all they
 

1173
00:29:18,770 --> 00:29:20,170
we expect it to because after all they
didn't exist presumably would have

1174
00:29:20,170 --> 00:29:20,180
didn't exist presumably would have
 

1175
00:29:20,180 --> 00:29:21,730
didn't exist presumably would have
returned here so if it exists we want to

1176
00:29:21,730 --> 00:29:21,740
returned here so if it exists we want to
 

1177
00:29:21,740 --> 00:29:25,030
returned here so if it exists we want to
wait for the notification we're waiting

1178
00:29:25,030 --> 00:29:25,040
wait for the notification we're waiting
 

1179
00:29:25,040 --> 00:29:29,740
wait for the notification we're waiting
for this watch notification call this

1180
00:29:29,740 --> 00:29:29,750
for this watch notification call this
 

1181
00:29:29,750 --> 00:29:39,550
for this watch notification call this
three and a step for go to what so the

1182
00:29:39,550 --> 00:29:39,560
three and a step for go to what so the
 

1183
00:29:39,560 --> 00:29:41,230
three and a step for go to what so the
usual deal is you know we call create

1184
00:29:41,230 --> 00:29:41,240
usual deal is you know we call create
 

1185
00:29:41,240 --> 00:29:45,640
usual deal is you know we call create
you know maybe we win if it fails we

1186
00:29:45,640 --> 00:29:45,650
you know maybe we win if it fails we
 

1187
00:29:45,650 --> 00:29:47,470
you know maybe we win if it fails we
wait for whoever owns a lock to release

1188
00:29:47,470 --> 00:29:47,480
wait for whoever owns a lock to release
 

1189
00:29:47,480 --> 00:29:49,780
wait for whoever owns a lock to release
it we get the watch notification when

1190
00:29:49,780 --> 00:29:49,790
it we get the watch notification when
 

1191
00:29:49,790 --> 00:29:51,670
it we get the watch notification when
the file is deleted at that point this

1192
00:29:51,670 --> 00:29:51,680
the file is deleted at that point this
 

1193
00:29:51,680 --> 00:29:53,230
the file is deleted at that point this
wait finishes and we go back to Mon and

1194
00:29:53,230 --> 00:29:53,240
wait finishes and we go back to Mon and
 

1195
00:29:53,240 --> 00:29:54,580
wait finishes and we go back to Mon and
try to recreate the file hopefully we

1196
00:29:54,580 --> 00:29:54,590
try to recreate the file hopefully we
 

1197
00:29:54,590 --> 00:29:59,350
try to recreate the file hopefully we
will get the file this time okay so we

1198
00:29:59,350 --> 00:29:59,360
will get the file this time okay so we
 

1199
00:29:59,360 --> 00:30:01,560
will get the file this time okay so we
should ask ourselves questions about

1200
00:30:01,560 --> 00:30:01,570
should ask ourselves questions about
 

1201
00:30:01,570 --> 00:30:04,240
should ask ourselves questions about
possible interleavings of other clients

1202
00:30:04,240 --> 00:30:04,250
possible interleavings of other clients
 

1203
00:30:04,250 --> 00:30:07,900
possible interleavings of other clients
activities with our four steps so one we

1204
00:30:07,900 --> 00:30:07,910
activities with our four steps so one we
 

1205
00:30:07,910 --> 00:30:09,520
activities with our four steps so one we
know for sure we know of already if

1206
00:30:09,520 --> 00:30:09,530
know for sure we know of already if
 

1207
00:30:09,530 --> 00:30:11,080
know for sure we know of already if
another client calls create at the same

1208
00:30:11,080 --> 00:30:11,090
another client calls create at the same
 

1209
00:30:11,090 --> 00:30:16,540
another client calls create at the same
time then the zookeeper leader is going

1210
00:30:16,540 --> 00:30:16,550
time then the zookeeper leader is going
 

1211
00:30:16,550 --> 00:30:19,120
time then the zookeeper leader is going
to process those two to create rpcs one

1212
00:30:19,120 --> 00:30:19,130
to process those two to create rpcs one
 

1213
00:30:19,130 --> 00:30:20,290
to process those two to create rpcs one
at a time in some order

1214
00:30:20,290 --> 00:30:20,300
at a time in some order
 

1215
00:30:20,300 --> 00:30:23,230
at a time in some order
so either mike reid will be executed

1216
00:30:23,230 --> 00:30:23,240
so either mike reid will be executed
 

1217
00:30:23,240 --> 00:30:23,590
so either mike reid will be executed
first

1218
00:30:23,590 --> 00:30:23,600
first
 

1219
00:30:23,600 --> 00:30:24,970
first
or the other clients create will be

1220
00:30:24,970 --> 00:30:24,980
or the other clients create will be
 

1221
00:30:24,980 --> 00:30:28,030
or the other clients create will be
executed first minds executed first i'm

1222
00:30:28,030 --> 00:30:28,040
executed first minds executed first i'm
 

1223
00:30:28,040 --> 00:30:29,680
executed first minds executed first i'm
going to get a true back in return and

1224
00:30:29,680 --> 00:30:29,690
going to get a true back in return and
 

1225
00:30:29,690 --> 00:30:31,540
going to get a true back in return and
acquire the lock and the other client is

1226
00:30:31,540 --> 00:30:31,550
acquire the lock and the other client is
 

1227
00:30:31,550 --> 00:30:33,910
acquire the lock and the other client is
guaranteed to get a false return and if

1228
00:30:33,910 --> 00:30:33,920
guaranteed to get a false return and if
 

1229
00:30:33,920 --> 00:30:35,530
guaranteed to get a false return and if
there are pcs processed first they'll

1230
00:30:35,530 --> 00:30:35,540
there are pcs processed first they'll
 

1231
00:30:35,540 --> 00:30:36,820
there are pcs processed first they'll
get the true return and i'm guaranteed

1232
00:30:36,820 --> 00:30:36,830
get the true return and i'm guaranteed
 

1233
00:30:36,830 --> 00:30:38,650
get the true return and i'm guaranteed
to get the false return and in either

1234
00:30:38,650 --> 00:30:38,660
to get the false return and in either
 

1235
00:30:38,660 --> 00:30:40,120
to get the false return and in either
case the file will be created

1236
00:30:40,120 --> 00:30:40,130
case the file will be created
 

1237
00:30:40,130 --> 00:30:45,660
case the file will be created
so we're okay if we have simultaneous

1238
00:30:45,660 --> 00:30:45,670
so we're okay if we have simultaneous
 

1239
00:30:45,670 --> 00:30:51,160
so we're okay if we have simultaneous
executions of one another question is

1240
00:30:51,160 --> 00:30:51,170
executions of one another question is
 

1241
00:30:51,170 --> 00:30:54,910
executions of one another question is
well you know if I if create doesn't

1242
00:30:54,910 --> 00:30:54,920
well you know if I if create doesn't
 

1243
00:30:54,920 --> 00:30:57,400
well you know if I if create doesn't
succeed for me and I'm gonna call exists

1244
00:30:57,400 --> 00:30:57,410
succeed for me and I'm gonna call exists
 

1245
00:30:57,410 --> 00:31:01,120
succeed for me and I'm gonna call exists
what happens if the lock is released

1246
00:31:01,120 --> 00:31:01,130
what happens if the lock is released
 

1247
00:31:01,130 --> 00:31:03,340
what happens if the lock is released
actually between the create and the

1248
00:31:03,340 --> 00:31:03,350
actually between the create and the
 

1249
00:31:03,350 --> 00:31:09,730
actually between the create and the
exists

1250
00:31:09,730 --> 00:31:09,740

 

1251
00:31:09,740 --> 00:31:12,140

so this is the reason why I rap I have a

1252
00:31:12,140 --> 00:31:12,150
so this is the reason why I rap I have a
 

1253
00:31:12,150 --> 00:31:14,060
so this is the reason why I rap I have a
knife around me around the exists is

1254
00:31:14,060 --> 00:31:14,070
knife around me around the exists is
 

1255
00:31:14,070 --> 00:31:15,860
knife around me around the exists is
because it actually might be released

1256
00:31:15,860 --> 00:31:15,870
because it actually might be released
 

1257
00:31:15,870 --> 00:31:19,520
because it actually might be released
before I call exists because it could

1258
00:31:19,520 --> 00:31:19,530
before I call exists because it could
 

1259
00:31:19,530 --> 00:31:20,990
before I call exists because it could
have been acquired quite a long time ago

1260
00:31:20,990 --> 00:31:21,000
have been acquired quite a long time ago
 

1261
00:31:21,000 --> 00:31:22,610
have been acquired quite a long time ago
by some other client and then if the

1262
00:31:22,610 --> 00:31:22,620
by some other client and then if the
 

1263
00:31:22,620 --> 00:31:25,010
by some other client and then if the
file doesn't exist at this point then

1264
00:31:25,010 --> 00:31:25,020
file doesn't exist at this point then
 

1265
00:31:25,020 --> 00:31:26,630
file doesn't exist at this point then
this will fail and I'll just go directly

1266
00:31:26,630 --> 00:31:26,640
this will fail and I'll just go directly
 

1267
00:31:26,640 --> 00:31:32,140
this will fail and I'll just go directly
back to this go to one and try again

1268
00:31:32,140 --> 00:31:32,150

 

1269
00:31:32,150 --> 00:31:35,090

similarly and actually more interesting

1270
00:31:35,090 --> 00:31:35,100
similarly and actually more interesting
 

1271
00:31:35,100 --> 00:31:39,350
similarly and actually more interesting
is what happens if the whoever holds it

1272
00:31:39,350 --> 00:31:39,360
is what happens if the whoever holds it
 

1273
00:31:39,360 --> 00:31:43,610
is what happens if the whoever holds it
now releases it just as I call exist or

1274
00:31:43,610 --> 00:31:43,620
now releases it just as I call exist or
 

1275
00:31:43,620 --> 00:31:45,890
now releases it just as I call exist or
as the replica I'm talking to is in the

1276
00:31:45,890 --> 00:31:45,900
as the replica I'm talking to is in the
 

1277
00:31:45,900 --> 00:31:49,880
as the replica I'm talking to is in the
middle of processing my exists requests

1278
00:31:49,880 --> 00:31:49,890
middle of processing my exists requests
 

1279
00:31:49,890 --> 00:31:54,920
middle of processing my exists requests
and the answer to that is that the

1280
00:31:54,920 --> 00:31:54,930
and the answer to that is that the
 

1281
00:31:54,930 --> 00:31:57,290
and the answer to that is that the
whatever replica I'm looking at you know

1282
00:31:57,290 --> 00:31:57,300
whatever replica I'm looking at you know
 

1283
00:31:57,300 --> 00:32:02,870
whatever replica I'm looking at you know
it's log or guaranteed that rights occur

1284
00:32:02,870 --> 00:32:02,880
it's log or guaranteed that rights occur
 

1285
00:32:02,880 --> 00:32:04,160
it's log or guaranteed that rights occur
in some order right

1286
00:32:04,160 --> 00:32:04,170
in some order right
 

1287
00:32:04,170 --> 00:32:06,200
in some order right
so the repla I'm talking to it's it's

1288
00:32:06,200 --> 00:32:06,210
so the repla I'm talking to it's it's
 

1289
00:32:06,210 --> 00:32:10,450
so the repla I'm talking to it's it's
log its proceeding in some way and my

1290
00:32:10,450 --> 00:32:10,460
log its proceeding in some way and my
 

1291
00:32:10,460 --> 00:32:14,990
log its proceeding in some way and my
exists call is guaranteed to be executed

1292
00:32:14,990 --> 00:32:15,000
exists call is guaranteed to be executed
 

1293
00:32:15,000 --> 00:32:18,410
exists call is guaranteed to be executed
between two log entries in the right

1294
00:32:18,410 --> 00:32:18,420
between two log entries in the right
 

1295
00:32:18,420 --> 00:32:21,410
between two log entries in the right
stream right this is a this is a

1296
00:32:21,410 --> 00:32:21,420
stream right this is a this is a
 

1297
00:32:21,420 --> 00:32:24,560
stream right this is a this is a
read-only request and you know the

1298
00:32:24,560 --> 00:32:24,570
read-only request and you know the
 

1299
00:32:24,570 --> 00:32:26,120
read-only request and you know the
problem is that somebody's delete

1300
00:32:26,120 --> 00:32:26,130
problem is that somebody's delete
 

1301
00:32:26,130 --> 00:32:27,980
problem is that somebody's delete
request is being processed at about this

1302
00:32:27,980 --> 00:32:27,990
request is being processed at about this
 

1303
00:32:27,990 --> 00:32:32,030
request is being processed at about this
time so somewhere in the log is going

1304
00:32:32,030 --> 00:32:32,040
time so somewhere in the log is going
 

1305
00:32:32,040 --> 00:32:35,120
time so somewhere in the log is going
either is going to be the delete request

1306
00:32:35,120 --> 00:32:35,130
either is going to be the delete request
 

1307
00:32:35,130 --> 00:32:37,940
either is going to be the delete request
from the other client and the rep and

1308
00:32:37,940 --> 00:32:37,950
from the other client and the rep and
 

1309
00:32:37,950 --> 00:32:40,460
from the other client and the rep and
you know this is my mind the replica

1310
00:32:40,460 --> 00:32:40,470
you know this is my mind the replica
 

1311
00:32:40,470 --> 00:32:42,140
you know this is my mind the replica
that I'm talking to zookeeper replicas

1312
00:32:42,140 --> 00:32:42,150
that I'm talking to zookeeper replicas
 

1313
00:32:42,150 --> 00:32:44,990
that I'm talking to zookeeper replicas
I'm talking to his log my watch my

1314
00:32:44,990 --> 00:32:45,000
I'm talking to his log my watch my
 

1315
00:32:45,000 --> 00:32:47,330
I'm talking to his log my watch my
exists RPC is either processed

1316
00:32:47,330 --> 00:32:47,340
exists RPC is either processed
 

1317
00:32:47,340 --> 00:32:50,270
exists RPC is either processed
completely processed here in which case

1318
00:32:50,270 --> 00:32:50,280
completely processed here in which case
 

1319
00:32:50,280 --> 00:32:53,270
completely processed here in which case
the replica sees oh the file still

1320
00:32:53,270 --> 00:32:53,280
the replica sees oh the file still
 

1321
00:32:53,280 --> 00:32:56,830
the replica sees oh the file still
exists and the replica inserts the watch

1322
00:32:56,830 --> 00:32:56,840
exists and the replica inserts the watch
 

1323
00:32:56,840 --> 00:32:59,240
exists and the replica inserts the watch
information into its watch table at this

1324
00:32:59,240 --> 00:32:59,250
information into its watch table at this
 

1325
00:32:59,250 --> 00:33:02,510
information into its watch table at this
point and only then executes the delete

1326
00:33:02,510 --> 00:33:02,520
point and only then executes the delete
 

1327
00:33:02,520 --> 00:33:03,980
point and only then executes the delete
so when the delete comes in were

1328
00:33:03,980 --> 00:33:03,990
so when the delete comes in were
 

1329
00:33:03,990 --> 00:33:05,870
so when the delete comes in were
guaranteed that my watch request is in

1330
00:33:05,870 --> 00:33:05,880
guaranteed that my watch request is in
 

1331
00:33:05,880 --> 00:33:07,520
guaranteed that my watch request is in
the replicas watch table and it will

1332
00:33:07,520 --> 00:33:07,530
the replicas watch table and it will
 

1333
00:33:07,530 --> 00:33:11,240
the replicas watch table and it will
send me a notification right or my exist

1334
00:33:11,240 --> 00:33:11,250
send me a notification right or my exist
 

1335
00:33:11,250 --> 00:33:15,130
send me a notification right or my exist
requests is executed here at a point

1336
00:33:15,130 --> 00:33:15,140
requests is executed here at a point
 

1337
00:33:15,140 --> 00:33:17,750
requests is executed here at a point
after the delete happen the file doesn't

1338
00:33:17,750 --> 00:33:17,760
after the delete happen the file doesn't
 

1339
00:33:17,760 --> 00:33:20,630
after the delete happen the file doesn't
exist and so now the call returns true

1340
00:33:20,630 --> 00:33:20,640
exist and so now the call returns true
 

1341
00:33:20,640 --> 00:33:20,960
exist and so now the call returns true
and

1342
00:33:20,960 --> 00:33:20,970
and
 

1343
00:33:20,970 --> 00:33:23,330
and
no well actually a watch table entry is

1344
00:33:23,330 --> 00:33:23,340
no well actually a watch table entry is
 

1345
00:33:23,340 --> 00:33:27,590
no well actually a watch table entry is
entered but we don't care right so it's

1346
00:33:27,590 --> 00:33:27,600
entered but we don't care right so it's
 

1347
00:33:27,600 --> 00:33:28,760
entered but we don't care right so it's
quite important that the rights are

1348
00:33:28,760 --> 00:33:28,770
quite important that the rights are
 

1349
00:33:28,770 --> 00:33:32,450
quite important that the rights are
sequenced and that reads happen at

1350
00:33:32,450 --> 00:33:32,460
sequenced and that reads happen at
 

1351
00:33:32,460 --> 00:33:54,860
sequenced and that reads happen at
definite points between rights yes well

1352
00:33:54,860 --> 00:33:54,870
definite points between rights yes well
 

1353
00:33:54,870 --> 00:33:57,140
definite points between rights yes well
okay so yes so this is where the exists

1354
00:33:57,140 --> 00:33:57,150
okay so yes so this is where the exists
 

1355
00:33:57,150 --> 00:33:58,970
okay so yes so this is where the exists
is executed the file doesn't exist at

1356
00:33:58,970 --> 00:33:58,980
is executed the file doesn't exist at
 

1357
00:33:58,980 --> 00:34:01,310
is executed the file doesn't exist at
this point exists returns false we don't

1358
00:34:01,310 --> 00:34:01,320
this point exists returns false we don't
 

1359
00:34:01,320 --> 00:34:04,880
this point exists returns false we don't
wait we go to one we create the file and

1360
00:34:04,880 --> 00:34:04,890
wait we go to one we create the file and
 

1361
00:34:04,890 --> 00:34:08,659
wait we go to one we create the file and
return we did install a watch here that

1362
00:34:08,659 --> 00:34:08,669
return we did install a watch here that
 

1363
00:34:08,669 --> 00:34:10,849
return we did install a watch here that
watch will be triggered it doesn't

1364
00:34:10,849 --> 00:34:10,859
watch will be triggered it doesn't
 

1365
00:34:10,859 --> 00:34:11,810
watch will be triggered it doesn't
really matter because we're not really

1366
00:34:11,810 --> 00:34:11,820
really matter because we're not really
 

1367
00:34:11,820 --> 00:34:13,040
really matter because we're not really
waiting for it but the watch will be

1368
00:34:13,040 --> 00:34:13,050
waiting for it but the watch will be
 

1369
00:34:13,050 --> 00:34:23,290
waiting for it but the watch will be
triggered by this created

1370
00:34:23,290 --> 00:34:23,300

 

1371
00:34:23,300 --> 00:34:26,800

we're not waiting for it but yeah okay

1372
00:34:26,800 --> 00:34:26,810
we're not waiting for it but yeah okay
 

1373
00:34:26,810 --> 00:34:28,930
we're not waiting for it but yeah okay
so the file doesn't exist we go to one

1374
00:34:28,930 --> 00:34:28,940
so the file doesn't exist we go to one
 

1375
00:34:28,940 --> 00:34:31,240
so the file doesn't exist we go to one
somebody else has created the file we

1376
00:34:31,240 --> 00:34:31,250
somebody else has created the file we
 

1377
00:34:31,250 --> 00:34:33,190
somebody else has created the file we
try to create the file that fails we

1378
00:34:33,190 --> 00:34:33,200
try to create the file that fails we
 

1379
00:34:33,200 --> 00:34:35,860
try to create the file that fails we
install another watch and it's a dis

1380
00:34:35,860 --> 00:34:35,870
install another watch and it's a dis
 

1381
00:34:35,870 --> 00:34:38,560
install another watch and it's a dis
watch that we're not waiting for so this

1382
00:34:38,560 --> 00:34:38,570
watch that we're not waiting for so this
 

1383
00:34:38,570 --> 00:34:40,120
watch that we're not waiting for so this
way does not a wait for anything to

1384
00:34:40,120 --> 00:34:40,130
way does not a wait for anything to
 

1385
00:34:40,130 --> 00:34:42,250
way does not a wait for anything to
happen although it doesn't really matter

1386
00:34:42,250 --> 00:34:42,260
happen although it doesn't really matter
 

1387
00:34:42,260 --> 00:34:47,950
happen although it doesn't really matter
in the moment it's not harmful to to to

1388
00:34:47,950 --> 00:34:47,960
in the moment it's not harmful to to to
 

1389
00:34:47,960 --> 00:34:49,330
in the moment it's not harmful to to to
break out of this loop early it's just

1390
00:34:49,330 --> 00:34:49,340
break out of this loop early it's just
 

1391
00:34:49,340 --> 00:34:53,560
break out of this loop early it's just
wasteful anyway we've all the history

1392
00:34:53,560 --> 00:34:53,570
wasteful anyway we've all the history
 

1393
00:34:53,570 --> 00:34:57,250
wasteful anyway we've all the history
this code leaves watches sort of in the

1394
00:34:57,250 --> 00:34:57,260
this code leaves watches sort of in the
 

1395
00:34:57,260 --> 00:34:58,570
this code leaves watches sort of in the
system and I don't really know what does

1396
00:34:58,570 --> 00:34:58,580
system and I don't really know what does
 

1397
00:34:58,580 --> 00:35:00,730
system and I don't really know what does
my new watch on the same file override

1398
00:35:00,730 --> 00:35:00,740
my new watch on the same file override
 

1399
00:35:00,740 --> 00:35:08,550
my new watch on the same file override
my old watch I'm not actually sure

1400
00:35:08,550 --> 00:35:08,560

 

1401
00:35:08,560 --> 00:35:12,250

okay I'm finally this example and the

1402
00:35:12,250 --> 00:35:12,260
okay I'm finally this example and the
 

1403
00:35:12,260 --> 00:35:13,990
okay I'm finally this example and the
previous example suffle suffer from the

1404
00:35:13,990 --> 00:35:14,000
previous example suffle suffer from the
 

1405
00:35:14,000 --> 00:35:16,150
previous example suffle suffer from the
herd effect we also heard effect we

1406
00:35:16,150 --> 00:35:16,160
herd effect we also heard effect we
 

1407
00:35:16,160 --> 00:35:18,130
herd effect we also heard effect we
talked about I mean what we were talking

1408
00:35:18,130 --> 00:35:18,140
talked about I mean what we were talking
 

1409
00:35:18,140 --> 00:35:19,990
talked about I mean what we were talking
about when we were worrying about oh but

1410
00:35:19,990 --> 00:35:20,000
about when we were worrying about oh but
 

1411
00:35:20,000 --> 00:35:22,120
about when we were worrying about oh but
if clients I'll try to increment this at

1412
00:35:22,120 --> 00:35:22,130
if clients I'll try to increment this at
 

1413
00:35:22,130 --> 00:35:22,990
if clients I'll try to increment this at
the same time

1414
00:35:22,990 --> 00:35:23,000
the same time
 

1415
00:35:23,000 --> 00:35:25,230
the same time
gosh that's going to have N squared

1416
00:35:25,230 --> 00:35:25,240
gosh that's going to have N squared
 

1417
00:35:25,240 --> 00:35:28,000
gosh that's going to have N squared
complexity as far as how long it takes

1418
00:35:28,000 --> 00:35:28,010
complexity as far as how long it takes
 

1419
00:35:28,010 --> 00:35:30,130
complexity as far as how long it takes
to get to all thousand clients this lock

1420
00:35:30,130 --> 00:35:30,140
to get to all thousand clients this lock
 

1421
00:35:30,140 --> 00:35:32,350
to get to all thousand clients this lock
scheme also suffers from the herd effect

1422
00:35:32,350 --> 00:35:32,360
scheme also suffers from the herd effect
 

1423
00:35:32,360 --> 00:35:35,200
scheme also suffers from the herd effect
in that if there are a thousand clients

1424
00:35:35,200 --> 00:35:35,210
in that if there are a thousand clients
 

1425
00:35:35,210 --> 00:35:37,750
in that if there are a thousand clients
trying to get the lock then the amount

1426
00:35:37,750 --> 00:35:37,760
trying to get the lock then the amount
 

1427
00:35:37,760 --> 00:35:40,570
trying to get the lock then the amount
of time that's required to sort of grant

1428
00:35:40,570 --> 00:35:40,580
of time that's required to sort of grant
 

1429
00:35:40,580 --> 00:35:43,120
of time that's required to sort of grant
the lock to each one of the thousand

1430
00:35:43,120 --> 00:35:43,130
the lock to each one of the thousand
 

1431
00:35:43,130 --> 00:35:44,890
the lock to each one of the thousand
clients is proportional to a thousand

1432
00:35:44,890 --> 00:35:44,900
clients is proportional to a thousand
 

1433
00:35:44,900 --> 00:35:47,800
clients is proportional to a thousand
squared because after every release all

1434
00:35:47,800 --> 00:35:47,810
squared because after every release all
 

1435
00:35:47,810 --> 00:35:50,620
squared because after every release all
of the remaining clients get triggered

1436
00:35:50,620 --> 00:35:50,630
of the remaining clients get triggered
 

1437
00:35:50,630 --> 00:35:52,210
of the remaining clients get triggered
by this watch all of the remaining

1438
00:35:52,210 --> 00:35:52,220
by this watch all of the remaining
 

1439
00:35:52,220 --> 00:35:53,860
by this watch all of the remaining
clients go back up here and send in a

1440
00:35:53,860 --> 00:35:53,870
clients go back up here and send in a
 

1441
00:35:53,870 --> 00:35:55,720
clients go back up here and send in a
create and so the total number create

1442
00:35:55,720 --> 00:35:55,730
create and so the total number create
 

1443
00:35:55,730 --> 00:35:59,230
create and so the total number create
our pcs generated is basically a

1444
00:35:59,230 --> 00:35:59,240
our pcs generated is basically a
 

1445
00:35:59,240 --> 00:36:02,680
our pcs generated is basically a
thousand squared so this suffers from

1446
00:36:02,680 --> 00:36:02,690
thousand squared so this suffers from
 

1447
00:36:02,690 --> 00:36:06,160
thousand squared so this suffers from
this herd the whole herd of waiting

1448
00:36:06,160 --> 00:36:06,170
this herd the whole herd of waiting
 

1449
00:36:06,170 --> 00:36:15,370
this herd the whole herd of waiting
clients is beating on zookeeper another

1450
00:36:15,370 --> 00:36:15,380
clients is beating on zookeeper another
 

1451
00:36:15,380 --> 00:36:17,260
clients is beating on zookeeper another
name for this is that it's a non

1452
00:36:17,260 --> 00:36:17,270
name for this is that it's a non
 

1453
00:36:17,270 --> 00:36:23,110
name for this is that it's a non
scalable lock or yeah okay and so the

1454
00:36:23,110 --> 00:36:23,120
scalable lock or yeah okay and so the
 

1455
00:36:23,120 --> 00:36:26,830
scalable lock or yeah okay and so the
paper is a real deal and we'll see it

1456
00:36:26,830 --> 00:36:26,840
paper is a real deal and we'll see it
 

1457
00:36:26,840 --> 00:36:31,270
paper is a real deal and we'll see it
more and in other systems and soon

1458
00:36:31,270 --> 00:36:31,280
more and in other systems and soon
 

1459
00:36:31,280 --> 00:36:32,980
more and in other systems and soon
enough serious end of problems the paper

1460
00:36:32,980 --> 00:36:32,990
enough serious end of problems the paper
 

1461
00:36:32,990 --> 00:36:34,660
enough serious end of problems the paper
actually talks about how to solve it

1462
00:36:34,660 --> 00:36:34,670
actually talks about how to solve it
 

1463
00:36:34,670 --> 00:36:36,460
actually talks about how to solve it
using zookeeper and the interesting

1464
00:36:36,460 --> 00:36:36,470
using zookeeper and the interesting
 

1465
00:36:36,470 --> 00:36:37,150
using zookeeper and the interesting
thing is that Zook

1466
00:36:37,150 --> 00:36:37,160
thing is that Zook
 

1467
00:36:37,160 --> 00:36:40,329
thing is that Zook
it's actually expressive enough to be

1468
00:36:40,329 --> 00:36:40,339
it's actually expressive enough to be
 

1469
00:36:40,339 --> 00:36:46,420
it's actually expressive enough to be
able to build a more complex lock scheme

1470
00:36:46,420 --> 00:36:46,430
able to build a more complex lock scheme
 

1471
00:36:46,430 --> 00:36:48,400
able to build a more complex lock scheme
that doesn't suffer from this hurt

1472
00:36:48,400 --> 00:36:48,410
that doesn't suffer from this hurt
 

1473
00:36:48,410 --> 00:36:49,900
that doesn't suffer from this hurt
effect that even of a thousand clients

1474
00:36:49,900 --> 00:36:49,910
effect that even of a thousand clients
 

1475
00:36:49,910 --> 00:36:53,650
effect that even of a thousand clients
are waiting the cost of one client

1476
00:36:53,650 --> 00:36:53,660
are waiting the cost of one client
 

1477
00:36:53,660 --> 00:36:55,240
are waiting the cost of one client
giving up a lock and another acquiring

1478
00:36:55,240 --> 00:36:55,250
giving up a lock and another acquiring
 

1479
00:36:55,250 --> 00:36:58,990
giving up a lock and another acquiring
it is order 1 instead of order n and

1480
00:36:58,990 --> 00:36:59,000
it is order 1 instead of order n and
 

1481
00:36:59,000 --> 00:37:02,109
it is order 1 instead of order n and
this is the because it's a little bit

1482
00:37:02,109 --> 00:37:02,119
this is the because it's a little bit
 

1483
00:37:02,119 --> 00:37:05,470
this is the because it's a little bit
complex this is the pseudocode in the

1484
00:37:05,470 --> 00:37:05,480
complex this is the pseudocode in the
 

1485
00:37:05,480 --> 00:37:08,260
complex this is the pseudocode in the
paper in section 2.4 it's on page 6 if

1486
00:37:08,260 --> 00:37:08,270
paper in section 2.4 it's on page 6 if
 

1487
00:37:08,270 --> 00:37:23,589
paper in section 2.4 it's on page 6 if
you want to follow along so this is and

1488
00:37:23,589 --> 00:37:23,599
you want to follow along so this is and
 

1489
00:37:23,599 --> 00:37:25,539
you want to follow along so this is and
so this time there is not a single lock

1490
00:37:25,539 --> 00:37:25,549
so this time there is not a single lock
 

1491
00:37:25,549 --> 00:37:27,039
so this time there is not a single lock
file

1492
00:37:27,039 --> 00:37:27,049
file
 

1493
00:37:27,049 --> 00:37:37,990
file
there's no yes it is just a name that

1494
00:37:37,990 --> 00:37:38,000
there's no yes it is just a name that
 

1495
00:37:38,000 --> 00:37:40,000
there's no yes it is just a name that
allows us to all talk about the same

1496
00:37:40,000 --> 00:37:40,010
allows us to all talk about the same
 

1497
00:37:40,010 --> 00:37:50,769
allows us to all talk about the same
lock so it's just a name know now I've

1498
00:37:50,769 --> 00:37:50,779
lock so it's just a name know now I've
 

1499
00:37:50,779 --> 00:37:53,010
lock so it's just a name know now I've
acquired the lock and I can do I can

1500
00:37:53,010 --> 00:37:53,020
acquired the lock and I can do I can
 

1501
00:37:53,020 --> 00:37:55,839
acquired the lock and I can do I can
whatever the lock was protecting you

1502
00:37:55,839 --> 00:37:55,849
whatever the lock was protecting you
 

1503
00:37:55,849 --> 00:37:57,940
whatever the lock was protecting you
know maybe only one of us at a time

1504
00:37:57,940 --> 00:37:57,950
know maybe only one of us at a time
 

1505
00:37:57,950 --> 00:37:59,260
know maybe only one of us at a time
should be allowed to give a lecture in

1506
00:37:59,260 --> 00:37:59,270
should be allowed to give a lecture in
 

1507
00:37:59,270 --> 00:38:00,789
should be allowed to give a lecture in
this lecture hall if you want to give a

1508
00:38:00,789 --> 00:38:00,799
this lecture hall if you want to give a
 

1509
00:38:00,799 --> 00:38:02,109
this lecture hall if you want to give a
lecture in this lecture hall you first

1510
00:38:02,109 --> 00:38:02,119
lecture in this lecture hall you first
 

1511
00:38:02,119 --> 00:38:06,990
lecture in this lecture hall you first
have to acquire the lock called 34 100

1512
00:38:06,990 --> 00:38:07,000
have to acquire the lock called 34 100
 

1513
00:38:07,000 --> 00:38:10,599
have to acquire the lock called 34 100
the that turns out it's yes it's a Z

1514
00:38:10,599 --> 00:38:10,609
the that turns out it's yes it's a Z
 

1515
00:38:10,609 --> 00:38:12,579
the that turns out it's yes it's a Z
node and zookeeper but it like nobody

1516
00:38:12,579 --> 00:38:12,589
node and zookeeper but it like nobody
 

1517
00:38:12,589 --> 00:38:14,589
node and zookeeper but it like nobody
cares about its contents we just need it

1518
00:38:14,589 --> 00:38:14,599
cares about its contents we just need it
 

1519
00:38:14,599 --> 00:38:16,089
cares about its contents we just need it
to be able to agree on a name for the

1520
00:38:16,089 --> 00:38:16,099
to be able to agree on a name for the
 

1521
00:38:16,099 --> 00:38:21,760
to be able to agree on a name for the
lock that's the sense in which that's

1522
00:38:21,760 --> 00:38:21,770
lock that's the sense in which that's
 

1523
00:38:21,770 --> 00:38:23,200
lock that's the sense in which that's
piyah this it looks like a file system

1524
00:38:23,200 --> 00:38:23,210
piyah this it looks like a file system
 

1525
00:38:23,210 --> 00:38:28,559
piyah this it looks like a file system
but it's really a naming system alright

1526
00:38:28,559 --> 00:38:28,569
but it's really a naming system alright
 

1527
00:38:28,569 --> 00:38:31,420
but it's really a naming system alright
so step one is we create a sequential

1528
00:38:31,420 --> 00:38:31,430
so step one is we create a sequential
 

1529
00:38:31,430 --> 00:38:37,100
so step one is we create a sequential
file

1530
00:38:37,100 --> 00:38:37,110

 

1531
00:38:37,110 --> 00:38:39,830

and so yeah we give it a prefix name but

1532
00:38:39,830 --> 00:38:39,840
and so yeah we give it a prefix name but
 

1533
00:38:39,840 --> 00:38:42,560
and so yeah we give it a prefix name but
what it actually creates is you know if

1534
00:38:42,560 --> 00:38:42,570
what it actually creates is you know if
 

1535
00:38:42,570 --> 00:38:45,530
what it actually creates is you know if
this is the 27th file sequential file

1536
00:38:45,530 --> 00:38:45,540
this is the 27th file sequential file
 

1537
00:38:45,540 --> 00:38:48,260
this is the 27th file sequential file
created with with prefix F you know

1538
00:38:48,260 --> 00:38:48,270
created with with prefix F you know
 

1539
00:38:48,270 --> 00:38:53,230
created with with prefix F you know
maybe we get F 27 or something and and

1540
00:38:53,230 --> 00:38:53,240
maybe we get F 27 or something and and
 

1541
00:38:53,240 --> 00:38:56,210
maybe we get F 27 or something and and
in the sequenced in the sequence of

1542
00:38:56,210 --> 00:38:56,220
in the sequenced in the sequence of
 

1543
00:38:56,220 --> 00:38:58,700
in the sequenced in the sequence of
writes that zookeeper is it's working

1544
00:38:58,700 --> 00:38:58,710
writes that zookeeper is it's working
 

1545
00:38:58,710 --> 00:39:03,020
writes that zookeeper is it's working
through successive creates get ascending

1546
00:39:03,020 --> 00:39:03,030
through successive creates get ascending
 

1547
00:39:03,030 --> 00:39:05,690
through successive creates get ascending
guaranteed ascending never descending

1548
00:39:05,690 --> 00:39:05,700
guaranteed ascending never descending
 

1549
00:39:05,700 --> 00:39:08,330
guaranteed ascending never descending
always ascending sequence numbers when

1550
00:39:08,330 --> 00:39:08,340
always ascending sequence numbers when
 

1551
00:39:08,340 --> 00:39:15,320
always ascending sequence numbers when
you create a sequential file there was

1552
00:39:15,320 --> 00:39:15,330
you create a sequential file there was
 

1553
00:39:15,330 --> 00:39:16,760
you create a sequential file there was
an operation I left off from the list it

1554
00:39:16,760 --> 00:39:16,770
an operation I left off from the list it
 

1555
00:39:16,770 --> 00:39:18,140
an operation I left off from the list it
turns out you can get a list of files

1556
00:39:18,140 --> 00:39:18,150
turns out you can get a list of files
 

1557
00:39:18,150 --> 00:39:25,210
turns out you can get a list of files
you can get a list of files underneath

1558
00:39:25,210 --> 00:39:25,220
you can get a list of files underneath
 

1559
00:39:25,220 --> 00:39:29,090
you can get a list of files underneath
you give the name of Zeno that's

1560
00:39:29,090 --> 00:39:29,100
you give the name of Zeno that's
 

1561
00:39:29,100 --> 00:39:30,410
you give the name of Zeno that's
actually a directory with files in it

1562
00:39:30,410 --> 00:39:30,420
actually a directory with files in it
 

1563
00:39:30,420 --> 00:39:31,550
actually a directory with files in it
you can get a list of all the files that

1564
00:39:31,550 --> 00:39:31,560
you can get a list of all the files that
 

1565
00:39:31,560 --> 00:39:33,380
you can get a list of all the files that
are currently in that directory so we're

1566
00:39:33,380 --> 00:39:33,390
are currently in that directory so we're
 

1567
00:39:33,390 --> 00:39:35,930
are currently in that directory so we're
gonna list the files let's start with

1568
00:39:35,930 --> 00:39:35,940
gonna list the files let's start with
 

1569
00:39:35,940 --> 00:39:41,570
gonna list the files let's start with
that you know maybe list f star we get

1570
00:39:41,570 --> 00:39:41,580
that you know maybe list f star we get
 

1571
00:39:41,580 --> 00:39:47,030
that you know maybe list f star we get
some list back we create a file with the

1572
00:39:47,030 --> 00:39:47,040
some list back we create a file with the
 

1573
00:39:47,040 --> 00:39:48,710
some list back we create a file with the
system allocated us a number here we can

1574
00:39:48,710 --> 00:39:48,720
system allocated us a number here we can
 

1575
00:39:48,720 --> 00:39:51,530
system allocated us a number here we can
look at that number if there's no lower

1576
00:39:51,530 --> 00:39:51,540
look at that number if there's no lower
 

1577
00:39:51,540 --> 00:39:54,320
look at that number if there's no lower
numbered file in this list then we win

1578
00:39:54,320 --> 00:39:54,330
numbered file in this list then we win
 

1579
00:39:54,330 --> 00:39:55,430
numbered file in this list then we win
and we get the lock

1580
00:39:55,430 --> 00:39:55,440
and we get the lock
 

1581
00:39:55,440 --> 00:39:57,350
and we get the lock
so if our sequential file is the lowest

1582
00:39:57,350 --> 00:39:57,360
so if our sequential file is the lowest
 

1583
00:39:57,360 --> 00:40:00,860
so if our sequential file is the lowest
number file with that name prefix we win

1584
00:40:00,860 --> 00:40:00,870
number file with that name prefix we win
 

1585
00:40:00,870 --> 00:40:10,970
number file with that name prefix we win
so no lower number we've quired the lock

1586
00:40:10,970 --> 00:40:10,980
so no lower number we've quired the lock
 

1587
00:40:10,980 --> 00:40:18,410
so no lower number we've quired the lock
and we can return if there is one then

1588
00:40:18,410 --> 00:40:18,420
and we can return if there is one then
 

1589
00:40:18,420 --> 00:40:21,460
and we can return if there is one then
again what we want to wait for then

1590
00:40:21,460 --> 00:40:21,470
again what we want to wait for then
 

1591
00:40:21,470 --> 00:40:23,570
again what we want to wait for then
what's going on is that these

1592
00:40:23,570 --> 00:40:23,580
what's going on is that these
 

1593
00:40:23,580 --> 00:40:25,910
what's going on is that these
sequentially numbered files are setting

1594
00:40:25,910 --> 00:40:25,920
sequentially numbered files are setting
 

1595
00:40:25,920 --> 00:40:28,670
sequentially numbered files are setting
up the order in which the lock is going

1596
00:40:28,670 --> 00:40:28,680
up the order in which the lock is going
 

1597
00:40:28,680 --> 00:40:30,620
up the order in which the lock is going
to be granted to the different clients

1598
00:40:30,620 --> 00:40:30,630
to be granted to the different clients
 

1599
00:40:30,630 --> 00:40:33,130
to be granted to the different clients
so if we're not the winner of the lock

1600
00:40:33,130 --> 00:40:33,140
so if we're not the winner of the lock
 

1601
00:40:33,140 --> 00:40:35,560
so if we're not the winner of the lock
what we need to do is wait for the

1602
00:40:35,560 --> 00:40:35,570
what we need to do is wait for the
 

1603
00:40:35,570 --> 00:40:39,200
what we need to do is wait for the
previously numbered with the client who

1604
00:40:39,200 --> 00:40:39,210
previously numbered with the client who
 

1605
00:40:39,210 --> 00:40:41,540
previously numbered with the client who
created the previously numbered file to

1606
00:40:41,540 --> 00:40:41,550
created the previously numbered file to
 

1607
00:40:41,550 --> 00:40:43,280
created the previously numbered file to
release to acquire and then release the

1608
00:40:43,280 --> 00:40:43,290
release to acquire and then release the
 

1609
00:40:43,290 --> 00:40:45,610
release to acquire and then release the
lock and we're going to release the lock

1610
00:40:45,610 --> 00:40:45,620
lock and we're going to release the lock
 

1611
00:40:45,620 --> 00:40:47,960
lock and we're going to release the lock
the convention for releasing the locking

1612
00:40:47,960 --> 00:40:47,970
the convention for releasing the locking
 

1613
00:40:47,970 --> 00:40:49,870
the convention for releasing the locking
in this system is for

1614
00:40:49,870 --> 00:40:49,880
in this system is for
 

1615
00:40:49,880 --> 00:40:51,250
in this system is for
remove the file to remove your

1616
00:40:51,250 --> 00:40:51,260
remove the file to remove your
 

1617
00:40:51,260 --> 00:40:53,470
remove the file to remove your
sequential file so we want to wait for

1618
00:40:53,470 --> 00:40:53,480
sequential file so we want to wait for
 

1619
00:40:53,480 --> 00:40:56,320
sequential file so we want to wait for
the previously numbered sequential file

1620
00:40:56,320 --> 00:40:56,330
the previously numbered sequential file
 

1621
00:40:56,330 --> 00:40:59,110
the previously numbered sequential file
to be deleted and then it's our turn and

1622
00:40:59,110 --> 00:40:59,120
to be deleted and then it's our turn and
 

1623
00:40:59,120 --> 00:41:01,300
to be deleted and then it's our turn and
we get the lock so we need to call

1624
00:41:01,300 --> 00:41:01,310
we get the lock so we need to call
 

1625
00:41:01,310 --> 00:41:05,890
we get the lock so we need to call
exists so we're gonna say if the call

1626
00:41:05,890 --> 00:41:05,900
exists so we're gonna say if the call
 

1627
00:41:05,900 --> 00:41:09,210
exists so we're gonna say if the call
exists mostly to set a watch point

1628
00:41:09,210 --> 00:41:09,220
exists mostly to set a watch point
 

1629
00:41:09,220 --> 00:41:16,260
exists mostly to set a watch point
so it's you know next lower number file

1630
00:41:16,260 --> 00:41:16,270
so it's you know next lower number file
 

1631
00:41:16,270 --> 00:41:23,050
so it's you know next lower number file
and we want to have a watch get that

1632
00:41:23,050 --> 00:41:23,060
and we want to have a watch get that
 

1633
00:41:23,060 --> 00:41:25,680
and we want to have a watch get that
file still exist we're gonna wait and

1634
00:41:25,680 --> 00:41:25,690
file still exist we're gonna wait and
 

1635
00:41:25,690 --> 00:41:28,540
file still exist we're gonna wait and
then so that's step 5

1636
00:41:28,540 --> 00:41:28,550
then so that's step 5
 

1637
00:41:28,550 --> 00:41:32,040
then so that's step 5
and then finally we're gonna go back to

1638
00:41:32,040 --> 00:41:32,050
and then finally we're gonna go back to
 

1639
00:41:32,050 --> 00:41:33,970
and then finally we're gonna go back to
we're not going to create the file again

1640
00:41:33,970 --> 00:41:33,980
we're not going to create the file again
 

1641
00:41:33,980 --> 00:41:35,470
we're not going to create the file again
because it already exists we're gonna go

1642
00:41:35,470 --> 00:41:35,480
because it already exists we're gonna go
 

1643
00:41:35,480 --> 00:41:41,650
because it already exists we're gonna go
back to listing the yeah the files so

1644
00:41:41,650 --> 00:41:41,660
back to listing the yeah the files so
 

1645
00:41:41,660 --> 00:41:44,470
back to listing the yeah the files so
this is a choir releases just I delete

1646
00:41:44,470 --> 00:41:44,480
this is a choir releases just I delete
 

1647
00:41:44,480 --> 00:41:47,590
this is a choir releases just I delete
if I acquire the lock I delete my the

1648
00:41:47,590 --> 00:41:47,600
if I acquire the lock I delete my the
 

1649
00:41:47,600 --> 00:41:50,820
if I acquire the lock I delete my the
file I created complete with my number

1650
00:41:50,820 --> 00:41:50,830
file I created complete with my number
 

1651
00:41:50,830 --> 00:41:54,810
file I created complete with my number
yes

1652
00:41:54,810 --> 00:41:54,820

 

1653
00:41:54,820 --> 00:42:01,990

why do you need to list the files again

1654
00:42:01,990 --> 00:42:02,000

 

1655
00:42:02,000 --> 00:42:03,490

that's a good question so the question

1656
00:42:03,490 --> 00:42:03,500
that's a good question so the question
 

1657
00:42:03,500 --> 00:42:08,740
that's a good question so the question
is we got the list of files we know the

1658
00:42:08,740 --> 00:42:08,750
is we got the list of files we know the
 

1659
00:42:08,750 --> 00:42:11,260
is we got the list of files we know the
next lower number file there's a

1660
00:42:11,260 --> 00:42:11,270
next lower number file there's a
 

1661
00:42:11,270 --> 00:42:12,849
next lower number file there's a
guarantee of the sequential file

1662
00:42:12,849 --> 00:42:12,859
guarantee of the sequential file
 

1663
00:42:12,859 --> 00:42:15,760
guarantee of the sequential file
creation is that once filed 27 is

1664
00:42:15,760 --> 00:42:15,770
creation is that once filed 27 is
 

1665
00:42:15,770 --> 00:42:18,609
creation is that once filed 27 is
created no file with a lower number will

1666
00:42:18,609 --> 00:42:18,619
created no file with a lower number will
 

1667
00:42:18,619 --> 00:42:20,950
created no file with a lower number will
ever subsequently be created so we now

1668
00:42:20,950 --> 00:42:20,960
ever subsequently be created so we now
 

1669
00:42:20,960 --> 00:42:22,720
ever subsequently be created so we now
know nothing else could sneak in here so

1670
00:42:22,720 --> 00:42:22,730
know nothing else could sneak in here so
 

1671
00:42:22,730 --> 00:42:25,839
know nothing else could sneak in here so
how could the next lower number file you

1672
00:42:25,839 --> 00:42:25,849
how could the next lower number file you
 

1673
00:42:25,849 --> 00:42:27,430
how could the next lower number file you
know why why do we need to list again

1674
00:42:27,430 --> 00:42:27,440
know why why do we need to list again
 

1675
00:42:27,440 --> 00:42:29,020
know why why do we need to list again
why don't we just go back to waiting for

1676
00:42:29,020 --> 00:42:29,030
why don't we just go back to waiting for
 

1677
00:42:29,030 --> 00:42:34,510
why don't we just go back to waiting for
that same lower numbered file thing

1678
00:42:34,510 --> 00:42:34,520
that same lower numbered file thing
 

1679
00:42:34,520 --> 00:42:43,040
that same lower numbered file thing
Britney guess the answer

1680
00:42:43,040 --> 00:42:43,050

 

1681
00:42:43,050 --> 00:42:46,700

I mean the the the way this code works

1682
00:42:46,700 --> 00:42:46,710
I mean the the the way this code works
 

1683
00:42:46,710 --> 00:42:49,040
I mean the the the way this code works
the answer to the question is whoever

1684
00:42:49,040 --> 00:42:49,050
the answer to the question is whoever
 

1685
00:42:49,050 --> 00:42:51,080
the answer to the question is whoever
was the next lowered person might have

1686
00:42:51,080 --> 00:42:51,090
was the next lowered person might have
 

1687
00:42:51,090 --> 00:42:53,450
was the next lowered person might have
either acquired him at least the lock

1688
00:42:53,450 --> 00:42:53,460
either acquired him at least the lock
 

1689
00:42:53,460 --> 00:42:59,390
either acquired him at least the lock
before we noticed or have died and this

1690
00:42:59,390 --> 00:42:59,400
before we noticed or have died and this
 

1691
00:42:59,400 --> 00:43:04,000
before we noticed or have died and this
went and these are transient files sorry

1692
00:43:04,000 --> 00:43:04,010
went and these are transient files sorry
 

1693
00:43:04,010 --> 00:43:06,950
went and these are transient files sorry
or whatever they're called ephemeral

1694
00:43:06,950 --> 00:43:06,960
or whatever they're called ephemeral
 

1695
00:43:06,960 --> 00:43:13,340
or whatever they're called ephemeral
there's an ephemeral file you know even

1696
00:43:13,340 --> 00:43:13,350
there's an ephemeral file you know even
 

1697
00:43:13,350 --> 00:43:17,270
there's an ephemeral file you know even
if we're 27th in line number 26 may have

1698
00:43:17,270 --> 00:43:17,280
if we're 27th in line number 26 may have
 

1699
00:43:17,280 --> 00:43:19,850
if we're 27th in line number 26 may have
died before getting the lock if number

1700
00:43:19,850 --> 00:43:19,860
died before getting the lock if number
 

1701
00:43:19,860 --> 00:43:22,760
died before getting the lock if number
26 dies the system automatically deletes

1702
00:43:22,760 --> 00:43:22,770
26 dies the system automatically deletes
 

1703
00:43:22,770 --> 00:43:25,460
26 dies the system automatically deletes
their ephemeral files and so if that

1704
00:43:25,460 --> 00:43:25,470
their ephemeral files and so if that
 

1705
00:43:25,470 --> 00:43:27,200
their ephemeral files and so if that
happened now we need to wait for number

1706
00:43:27,200 --> 00:43:27,210
happened now we need to wait for number
 

1707
00:43:27,210 --> 00:43:31,670
happened now we need to wait for number
25 that is the next you know it if all

1708
00:43:31,670 --> 00:43:31,680
25 that is the next you know it if all
 

1709
00:43:31,680 --> 00:43:33,890
25 that is the next you know it if all
files you know 2 through 27 and and

1710
00:43:33,890 --> 00:43:33,900
files you know 2 through 27 and and
 

1711
00:43:33,900 --> 00:43:35,420
files you know 2 through 27 and and
we're 27 if they're all they are and

1712
00:43:35,420 --> 00:43:35,430
we're 27 if they're all they are and
 

1713
00:43:35,430 --> 00:43:37,640
we're 27 if they're all they are and
they're all waiting there's a lock if if

1714
00:43:37,640 --> 00:43:37,650
they're all waiting there's a lock if if
 

1715
00:43:37,650 --> 00:43:39,560
they're all waiting there's a lock if if
the one before is dies before getting

1716
00:43:39,560 --> 00:43:39,570
the one before is dies before getting
 

1717
00:43:39,570 --> 00:43:41,570
the one before is dies before getting
the lock now we need to wait for the

1718
00:43:41,570 --> 00:43:41,580
the lock now we need to wait for the
 

1719
00:43:41,580 --> 00:43:43,970
the lock now we need to wait for the
next next lower number file not because

1720
00:43:43,970 --> 00:43:43,980
next next lower number file not because
 

1721
00:43:43,980 --> 00:43:47,090
next next lower number file not because
the next lower one is has gone away so

1722
00:43:47,090 --> 00:43:47,100
the next lower one is has gone away so
 

1723
00:43:47,100 --> 00:43:48,440
the next lower one is has gone away so
that's why we have to go back and relist

1724
00:43:48,440 --> 00:43:48,450
that's why we have to go back and relist
 

1725
00:43:48,450 --> 00:43:50,660
that's why we have to go back and relist
the files in case our predecessor in the

1726
00:43:50,660 --> 00:43:50,670
the files in case our predecessor in the
 

1727
00:43:50,670 --> 00:43:53,570
the files in case our predecessor in the
list of waiting clients turned out to

1728
00:43:53,570 --> 00:43:53,580
list of waiting clients turned out to
 

1729
00:43:53,580 --> 00:44:02,200
list of waiting clients turned out to
die yes

1730
00:44:02,200 --> 00:44:02,210

 

1731
00:44:02,210 --> 00:44:04,490

if there's no lower numbered file than

1732
00:44:04,490 --> 00:44:04,500
if there's no lower numbered file than
 

1733
00:44:04,500 --> 00:44:09,700
if there's no lower numbered file than
you have acquired the lock absolutely

1734
00:44:09,700 --> 00:44:09,710
you have acquired the lock absolutely
 

1735
00:44:09,710 --> 00:44:15,500
you have acquired the lock absolutely
yes how does this not suffer from the

1736
00:44:15,500 --> 00:44:15,510
yes how does this not suffer from the
 

1737
00:44:15,510 --> 00:44:20,150
yes how does this not suffer from the
herd effect suppose we have a thousand

1738
00:44:20,150 --> 00:44:20,160
herd effect suppose we have a thousand
 

1739
00:44:20,160 --> 00:44:22,450
herd effect suppose we have a thousand
clients waiting and currently client

1740
00:44:22,450 --> 00:44:22,460
clients waiting and currently client
 

1741
00:44:22,460 --> 00:44:24,710
clients waiting and currently client
made through the first five hundred and

1742
00:44:24,710 --> 00:44:24,720
made through the first five hundred and
 

1743
00:44:24,720 --> 00:44:30,290
made through the first five hundred and
client five hundred holds the lock every

1744
00:44:30,290 --> 00:44:30,300
client five hundred holds the lock every
 

1745
00:44:30,300 --> 00:44:31,940
client five hundred holds the lock every
client waiting every client is sitting

1746
00:44:31,940 --> 00:44:31,950
client waiting every client is sitting
 

1747
00:44:31,950 --> 00:44:36,140
client waiting every client is sitting
here waiting for an event but only the

1748
00:44:36,140 --> 00:44:36,150
here waiting for an event but only the
 

1749
00:44:36,150 --> 00:44:38,570
here waiting for an event but only the
client that created file five hundred

1750
00:44:38,570 --> 00:44:38,580
client that created file five hundred
 

1751
00:44:38,580 --> 00:44:41,240
client that created file five hundred
and one he's waiting for the vision of

1752
00:44:41,240 --> 00:44:41,250
and one he's waiting for the vision of
 

1753
00:44:41,250 --> 00:44:44,120
and one he's waiting for the vision of
file five hundred so everybody's waiting

1754
00:44:44,120 --> 00:44:44,130
file five hundred so everybody's waiting
 

1755
00:44:44,130 --> 00:44:45,980
file five hundred so everybody's waiting
for the next lower number so five

1756
00:44:45,980 --> 00:44:45,990
for the next lower number so five
 

1757
00:44:45,990 --> 00:44:48,320
for the next lower number so five
hundred is waiting for 499 twenty nine

1758
00:44:48,320 --> 00:44:48,330
hundred is waiting for 499 twenty nine
 

1759
00:44:48,330 --> 00:44:51,830
hundred is waiting for 499 twenty nine
nine but everybody everybody's waiting

1760
00:44:51,830 --> 00:44:51,840
nine but everybody everybody's waiting
 

1761
00:44:51,840 --> 00:44:53,960
nine but everybody everybody's waiting
for just one file when I release the

1762
00:44:53,960 --> 00:44:53,970
for just one file when I release the
 

1763
00:44:53,970 --> 00:44:56,390
for just one file when I release the
lock there's only one other client the

1764
00:44:56,390 --> 00:44:56,400
lock there's only one other client the
 

1765
00:44:56,400 --> 00:44:57,830
lock there's only one other client the
next higher numbered client that's

1766
00:44:57,830 --> 00:44:57,840
next higher numbered client that's
 

1767
00:44:57,840 --> 00:44:59,780
next higher numbered client that's
waiting for my file so when I release

1768
00:44:59,780 --> 00:44:59,790
waiting for my file so when I release
 

1769
00:44:59,790 --> 00:45:02,620
waiting for my file so when I release
the lock one client gets a notification

1770
00:45:02,620 --> 00:45:02,630
the lock one client gets a notification
 

1771
00:45:02,630 --> 00:45:07,280
the lock one client gets a notification
one client goes back and lists the files

1772
00:45:07,280 --> 00:45:07,290
one client goes back and lists the files
 

1773
00:45:07,290 --> 00:45:10,640
one client goes back and lists the files
one client and one client now has the

1774
00:45:10,640 --> 00:45:10,650
one client and one client now has the
 

1775
00:45:10,650 --> 00:45:14,480
one client and one client now has the
lock so the sort of expense you know no

1776
00:45:14,480 --> 00:45:14,490
lock so the sort of expense you know no
 

1777
00:45:14,490 --> 00:45:15,530
lock so the sort of expense you know no
matter how many clients that are the

1778
00:45:15,530 --> 00:45:15,540
matter how many clients that are the
 

1779
00:45:15,540 --> 00:45:18,650
matter how many clients that are the
expense of one of each release and

1780
00:45:18,650 --> 00:45:18,660
expense of one of each release and
 

1781
00:45:18,660 --> 00:45:22,000
expense of one of each release and
acquire is a constant number of our PCs

1782
00:45:22,000 --> 00:45:22,010
acquire is a constant number of our PCs
 

1783
00:45:22,010 --> 00:45:26,690
acquire is a constant number of our PCs
where's the expense of a release and

1784
00:45:26,690 --> 00:45:26,700
where's the expense of a release and
 

1785
00:45:26,700 --> 00:45:28,550
where's the expense of a release and
acquire here is that every single

1786
00:45:28,550 --> 00:45:28,560
acquire here is that every single
 

1787
00:45:28,560 --> 00:45:31,550
acquire here is that every single
waiting client is notified and every

1788
00:45:31,550 --> 00:45:31,560
waiting client is notified and every
 

1789
00:45:31,560 --> 00:45:33,290
waiting client is notified and every
single one of them sends a write request

1790
00:45:33,290 --> 00:45:33,300
single one of them sends a write request
 

1791
00:45:33,300 --> 00:45:42,340
single one of them sends a write request
than the create request into zookeeper

1792
00:45:42,340 --> 00:45:42,350

 

1793
00:45:42,350 --> 00:45:54,720

oh you're free to get a cup of coffee

1794
00:45:54,720 --> 00:45:54,730
oh you're free to get a cup of coffee
 

1795
00:45:54,730 --> 00:45:57,910
oh you're free to get a cup of coffee
yeah I mean this is you know what the

1796
00:45:57,910 --> 00:45:57,920
yeah I mean this is you know what the
 

1797
00:45:57,920 --> 00:46:00,700
yeah I mean this is you know what the
programming interface looks like is not

1798
00:46:00,700 --> 00:46:00,710
programming interface looks like is not
 

1799
00:46:00,710 --> 00:46:03,490
programming interface looks like is not
our business but this is either and

1800
00:46:03,490 --> 00:46:03,500
our business but this is either and
 

1801
00:46:03,500 --> 00:46:04,990
our business but this is either and
there's there's two options for what

1802
00:46:04,990 --> 00:46:05,000
there's there's two options for what
 

1803
00:46:05,000 --> 00:46:07,150
there's there's two options for what
this actually means as far as what the

1804
00:46:07,150 --> 00:46:07,160
this actually means as far as what the
 

1805
00:46:07,160 --> 00:46:09,220
this actually means as far as what the
program looks like one is there's some

1806
00:46:09,220 --> 00:46:09,230
program looks like one is there's some
 

1807
00:46:09,230 --> 00:46:11,920
program looks like one is there's some
thread that's actually in a synchronous

1808
00:46:11,920 --> 00:46:11,930
thread that's actually in a synchronous
 

1809
00:46:11,930 --> 00:46:13,810
thread that's actually in a synchronous
wait it's made a function call saying

1810
00:46:13,810 --> 00:46:13,820
wait it's made a function call saying
 

1811
00:46:13,820 --> 00:46:14,860
wait it's made a function call saying
please acquire this lock and the

1812
00:46:14,860 --> 00:46:14,870
please acquire this lock and the
 

1813
00:46:14,870 --> 00:46:16,120
please acquire this lock and the
function hold doesn't return until the

1814
00:46:16,120 --> 00:46:16,130
function hold doesn't return until the
 

1815
00:46:16,130 --> 00:46:17,830
function hold doesn't return until the
locks finally acquired or the

1816
00:46:17,830 --> 00:46:17,840
locks finally acquired or the
 

1817
00:46:17,840 --> 00:46:20,320
locks finally acquired or the
notification comes back of much more

1818
00:46:20,320 --> 00:46:20,330
notification comes back of much more
 

1819
00:46:20,330 --> 00:46:22,060
notification comes back of much more
sophisticated interface would being one

1820
00:46:22,060 --> 00:46:22,070
sophisticated interface would being one
 

1821
00:46:22,070 --> 00:46:23,800
sophisticated interface would being one
in which you fire off requests a

1822
00:46:23,800 --> 00:46:23,810
in which you fire off requests a
 

1823
00:46:23,810 --> 00:46:25,840
in which you fire off requests a
zookeeper and don't wait and then

1824
00:46:25,840 --> 00:46:25,850
zookeeper and don't wait and then
 

1825
00:46:25,850 --> 00:46:28,270
zookeeper and don't wait and then
separately there's some way of seeing

1826
00:46:28,270 --> 00:46:28,280
separately there's some way of seeing
 

1827
00:46:28,280 --> 00:46:29,710
separately there's some way of seeing
well as you keep your said anything

1828
00:46:29,710 --> 00:46:29,720
well as you keep your said anything
 

1829
00:46:29,720 --> 00:46:32,950
well as you keep your said anything
recently or I have some go routine whose

1830
00:46:32,950 --> 00:46:32,960
recently or I have some go routine whose
 

1831
00:46:32,960 --> 00:46:34,410
recently or I have some go routine whose
job it is just wait for the next

1832
00:46:34,410 --> 00:46:34,420
job it is just wait for the next
 

1833
00:46:34,420 --> 00:46:36,970
job it is just wait for the next
whatever it is from zookeeper in the

1834
00:46:36,970 --> 00:46:36,980
whatever it is from zookeeper in the
 

1835
00:46:36,980 --> 00:46:39,070
whatever it is from zookeeper in the
same sense that you might read the apply

1836
00:46:39,070 --> 00:46:39,080
same sense that you might read the apply
 

1837
00:46:39,080 --> 00:46:40,360
same sense that you might read the apply
Channel and just all kinds of

1838
00:46:40,360 --> 00:46:40,370
Channel and just all kinds of
 

1839
00:46:40,370 --> 00:46:41,680
Channel and just all kinds of
interesting stuff comes up on the apply

1840
00:46:41,680 --> 00:46:41,690
interesting stuff comes up on the apply
 

1841
00:46:41,690 --> 00:46:44,290
interesting stuff comes up on the apply
channel so that's a more likely way to

1842
00:46:44,290 --> 00:46:44,300
channel so that's a more likely way to
 

1843
00:46:44,300 --> 00:46:45,670
channel so that's a more likely way to
structure this but yeah you're totally

1844
00:46:45,670 --> 00:46:45,680
structure this but yeah you're totally
 

1845
00:46:45,680 --> 00:46:48,970
structure this but yeah you're totally
either through threading or some sort of

1846
00:46:48,970 --> 00:46:48,980
either through threading or some sort of
 

1847
00:46:48,980 --> 00:46:51,040
either through threading or some sort of
event-driven thing you can do something

1848
00:46:51,040 --> 00:46:51,050
event-driven thing you can do something
 

1849
00:46:51,050 --> 00:47:06,490
event-driven thing you can do something
else while you're waiting yes yes or if

1850
00:47:06,490 --> 00:47:06,500
else while you're waiting yes yes or if
 

1851
00:47:06,500 --> 00:47:11,680
else while you're waiting yes yes or if
the person before me has neither died

1852
00:47:11,680 --> 00:47:11,690
the person before me has neither died
 

1853
00:47:11,690 --> 00:47:17,050
the person before me has neither died
nor released it's a file before me

1854
00:47:17,050 --> 00:47:17,060
nor released it's a file before me
 

1855
00:47:17,060 --> 00:47:20,860
nor released it's a file before me
exists that means either that client is

1856
00:47:20,860 --> 00:47:20,870
exists that means either that client is
 

1857
00:47:20,870 --> 00:47:22,630
exists that means either that client is
still alive and still waiting for the

1858
00:47:22,630 --> 00:47:22,640
still alive and still waiting for the
 

1859
00:47:22,640 --> 00:47:25,660
still alive and still waiting for the
lock or still alive and holds the lock

1860
00:47:25,660 --> 00:47:25,670
lock or still alive and holds the lock
 

1861
00:47:25,670 --> 00:47:35,500
lock or still alive and holds the lock
we don't really know

1862
00:47:35,500 --> 00:47:35,510

 

1863
00:47:35,510 --> 00:47:38,510

it does it as long as that client 500

1864
00:47:38,510 --> 00:47:38,520
it does it as long as that client 500
 

1865
00:47:38,520 --> 00:47:42,230
it does it as long as that client 500
still live if if this exists fails that

1866
00:47:42,230 --> 00:47:42,240
still live if if this exists fails that
 

1867
00:47:42,240 --> 00:47:43,730
still live if if this exists fails that
means one of two things either my

1868
00:47:43,730 --> 00:47:43,740
means one of two things either my
 

1869
00:47:43,740 --> 00:47:45,140
means one of two things either my
predecessor held the lock and is

1870
00:47:45,140 --> 00:47:45,150
predecessor held the lock and is
 

1871
00:47:45,150 --> 00:47:47,660
predecessor held the lock and is
released it and deleted their file or my

1872
00:47:47,660 --> 00:47:47,670
released it and deleted their file or my
 

1873
00:47:47,670 --> 00:47:49,610
released it and deleted their file or my
predecessor didn't hold the lock they

1874
00:47:49,610 --> 00:47:49,620
predecessor didn't hold the lock they
 

1875
00:47:49,620 --> 00:47:52,870
predecessor didn't hold the lock they
exited and zookeeper deleted their file

1876
00:47:52,870 --> 00:47:52,880
exited and zookeeper deleted their file
 

1877
00:47:52,880 --> 00:47:55,340
exited and zookeeper deleted their file
because it was an ephemeral file so

1878
00:47:55,340 --> 00:47:55,350
because it was an ephemeral file so
 

1879
00:47:55,350 --> 00:47:58,690
because it was an ephemeral file so
there's two reasons to come out of this

1880
00:47:58,690 --> 00:47:58,700
there's two reasons to come out of this
 

1881
00:47:58,700 --> 00:48:01,670
there's two reasons to come out of this
to come out of his weight or four they

1882
00:48:01,670 --> 00:48:01,680
to come out of his weight or four they
 

1883
00:48:01,680 --> 00:48:03,680
to come out of his weight or four they
exist to return false and that's why we

1884
00:48:03,680 --> 00:48:03,690
exist to return false and that's why we
 

1885
00:48:03,690 --> 00:48:08,510
exist to return false and that's why we
have to like we check everything you

1886
00:48:08,510 --> 00:48:08,520
have to like we check everything you
 

1887
00:48:08,520 --> 00:48:09,650
have to like we check everything you
know you really don't know what the

1888
00:48:09,650 --> 00:48:09,660
know you really don't know what the
 

1889
00:48:09,660 --> 00:48:30,220
know you really don't know what the
situation is after the exists completes

1890
00:48:30,220 --> 00:48:30,230

 

1891
00:48:30,230 --> 00:48:32,660

that might that yeah maybe maybe that

1892
00:48:32,660 --> 00:48:32,670
that might that yeah maybe maybe that
 

1893
00:48:32,670 --> 00:48:33,710
that might that yeah maybe maybe that
could need to work that sounds

1894
00:48:33,710 --> 00:48:33,720
could need to work that sounds
 

1895
00:48:33,720 --> 00:48:34,760
could need to work that sounds
reasonable

1896
00:48:34,760 --> 00:48:34,770
reasonable
 

1897
00:48:34,770 --> 00:48:38,000
reasonable
and it preserves the sort of scalable

1898
00:48:38,000 --> 00:48:38,010
and it preserves the sort of scalable
 

1899
00:48:38,010 --> 00:48:39,980
and it preserves the sort of scalable
nature of this and that each require

1900
00:48:39,980 --> 00:48:39,990
nature of this and that each require
 

1901
00:48:39,990 --> 00:48:43,760
nature of this and that each require
release only involves a few clients two

1902
00:48:43,760 --> 00:48:43,770
release only involves a few clients two
 

1903
00:48:43,770 --> 00:48:48,930
release only involves a few clients two
clients

1904
00:48:48,930 --> 00:48:48,940

 

1905
00:48:48,940 --> 00:48:52,750

alright this pattern to me actually

1906
00:48:52,750 --> 00:48:52,760
alright this pattern to me actually
 

1907
00:48:52,760 --> 00:48:54,340
alright this pattern to me actually
first saw this pattern a totally

1908
00:48:54,340 --> 00:48:54,350
first saw this pattern a totally
 

1909
00:48:54,350 --> 00:48:56,920
first saw this pattern a totally
different context and scalable locks for

1910
00:48:56,920 --> 00:48:56,930
different context and scalable locks for
 

1911
00:48:56,930 --> 00:49:01,090
different context and scalable locks for
threading systems I go this end in for

1912
00:49:01,090 --> 00:49:01,100
threading systems I go this end in for
 

1913
00:49:01,100 --> 00:49:02,440
threading systems I go this end in for
most of the world this is called a scale

1914
00:49:02,440 --> 00:49:02,450
most of the world this is called a scale
 

1915
00:49:02,450 --> 00:49:10,210
most of the world this is called a scale
of a lock

1916
00:49:10,210 --> 00:49:10,220

 

1917
00:49:10,220 --> 00:49:12,640

I find it one of those interesting

1918
00:49:12,640 --> 00:49:12,650
I find it one of those interesting
 

1919
00:49:12,650 --> 00:49:18,730
I find it one of those interesting
constructions I've ever seen now and so

1920
00:49:18,730 --> 00:49:18,740
constructions I've ever seen now and so
 

1921
00:49:18,740 --> 00:49:20,770
constructions I've ever seen now and so
like I'm impressed that zookeeper is

1922
00:49:20,770 --> 00:49:20,780
like I'm impressed that zookeeper is
 

1923
00:49:20,780 --> 00:49:22,960
like I'm impressed that zookeeper is
able to express it and it's a valuable

1924
00:49:22,960 --> 00:49:22,970
able to express it and it's a valuable
 

1925
00:49:22,970 --> 00:49:28,300
able to express it and it's a valuable
construct having said that I'm a little

1926
00:49:28,300 --> 00:49:28,310
construct having said that I'm a little
 

1927
00:49:28,310 --> 00:49:31,510
construct having said that I'm a little
bit at sea about why zookeeper about why

1928
00:49:31,510 --> 00:49:31,520
bit at sea about why zookeeper about why
 

1929
00:49:31,520 --> 00:49:33,090
bit at sea about why zookeeper about why
the paper talks about locks at all

1930
00:49:33,090 --> 00:49:33,100
the paper talks about locks at all
 

1931
00:49:33,100 --> 00:49:38,680
the paper talks about locks at all
because these locks these locks are not

1932
00:49:38,680 --> 00:49:38,690
because these locks these locks are not
 

1933
00:49:38,690 --> 00:49:41,890
because these locks these locks are not
like threading locks and go because in

1934
00:49:41,890 --> 00:49:41,900
like threading locks and go because in
 

1935
00:49:41,900 --> 00:49:43,420
like threading locks and go because in
threading there's no notion of threads

1936
00:49:43,420 --> 00:49:43,430
threading there's no notion of threads
 

1937
00:49:43,430 --> 00:49:45,220
threading there's no notion of threads
failing at least if you don't want them

1938
00:49:45,220 --> 00:49:45,230
failing at least if you don't want them
 

1939
00:49:45,230 --> 00:49:46,510
failing at least if you don't want them
there to be there's no notions of

1940
00:49:46,510 --> 00:49:46,520
there to be there's no notions of
 

1941
00:49:46,520 --> 00:49:48,160
there to be there's no notions of
threads just sort of randomly dying and

1942
00:49:48,160 --> 00:49:48,170
threads just sort of randomly dying and
 

1943
00:49:48,170 --> 00:49:49,990
threads just sort of randomly dying and
go and so really the only thing you're

1944
00:49:49,990 --> 00:49:50,000
go and so really the only thing you're
 

1945
00:49:50,000 --> 00:49:52,420
go and so really the only thing you're
getting out of a mutex it's really the

1946
00:49:52,420 --> 00:49:52,430
getting out of a mutex it's really the
 

1947
00:49:52,430 --> 00:49:54,670
getting out of a mutex it's really the
case and go that when you use it if

1948
00:49:54,670 --> 00:49:54,680
case and go that when you use it if
 

1949
00:49:54,680 --> 00:49:56,980
case and go that when you use it if
everybody uses mutexes correctly you are

1950
00:49:56,980 --> 00:49:56,990
everybody uses mutexes correctly you are
 

1951
00:49:56,990 --> 00:49:59,250
everybody uses mutexes correctly you are
getting atomicity for the sequence of

1952
00:49:59,250 --> 00:49:59,260
getting atomicity for the sequence of
 

1953
00:49:59,260 --> 00:50:02,200
getting atomicity for the sequence of
operations inside the mutex that you

1954
00:50:02,200 --> 00:50:02,210
operations inside the mutex that you
 

1955
00:50:02,210 --> 00:50:04,750
operations inside the mutex that you
know if you take out a lock and go and

1956
00:50:04,750 --> 00:50:04,760
know if you take out a lock and go and
 

1957
00:50:04,760 --> 00:50:06,580
know if you take out a lock and go and
you do 47 different read and write a lot

1958
00:50:06,580 --> 00:50:06,590
you do 47 different read and write a lot
 

1959
00:50:06,590 --> 00:50:07,810
you do 47 different read and write a lot
of variables and then release the lock

1960
00:50:07,810 --> 00:50:07,820
of variables and then release the lock
 

1961
00:50:07,820 --> 00:50:09,340
of variables and then release the lock
if everybody follows that locking

1962
00:50:09,340 --> 00:50:09,350
if everybody follows that locking
 

1963
00:50:09,350 --> 00:50:12,550
if everybody follows that locking
strategy nobody's ever going to see some

1964
00:50:12,550 --> 00:50:12,560
strategy nobody's ever going to see some
 

1965
00:50:12,560 --> 00:50:14,470
strategy nobody's ever going to see some
sort of weird intermediate version of

1966
00:50:14,470 --> 00:50:14,480
sort of weird intermediate version of
 

1967
00:50:14,480 --> 00:50:16,420
sort of weird intermediate version of
the data as of halfway through you're

1968
00:50:16,420 --> 00:50:16,430
the data as of halfway through you're
 

1969
00:50:16,430 --> 00:50:18,160
the data as of halfway through you're
updating it right just makes things

1970
00:50:18,160 --> 00:50:18,170
updating it right just makes things
 

1971
00:50:18,170 --> 00:50:20,890
updating it right just makes things
atomic no argument these locks aren't

1972
00:50:20,890 --> 00:50:20,900
atomic no argument these locks aren't
 

1973
00:50:20,900 --> 00:50:22,810
atomic no argument these locks aren't
really like that because if the client

1974
00:50:22,810 --> 00:50:22,820
really like that because if the client
 

1975
00:50:22,820 --> 00:50:25,540
really like that because if the client
that holds the lock fails it just

1976
00:50:25,540 --> 00:50:25,550
that holds the lock fails it just
 

1977
00:50:25,550 --> 00:50:28,300
that holds the lock fails it just
releases the lock and somebody else can

1978
00:50:28,300 --> 00:50:28,310
releases the lock and somebody else can
 

1979
00:50:28,310 --> 00:50:30,340
releases the lock and somebody else can
pick up the lock so it does not

1980
00:50:30,340 --> 00:50:30,350
pick up the lock so it does not
 

1981
00:50:30,350 --> 00:50:33,400
pick up the lock so it does not
guarantee atomicity because you can get

1982
00:50:33,400 --> 00:50:33,410
guarantee atomicity because you can get
 

1983
00:50:33,410 --> 00:50:35,290
guarantee atomicity because you can get
partial failures and distributed systems

1984
00:50:35,290 --> 00:50:35,300
partial failures and distributed systems
 

1985
00:50:35,300 --> 00:50:37,720
partial failures and distributed systems
where you don't really get partial

1986
00:50:37,720 --> 00:50:37,730
where you don't really get partial
 

1987
00:50:37,730 --> 00:50:41,500
where you don't really get partial
failures of ordinary threaded code so if

1988
00:50:41,500 --> 00:50:41,510
failures of ordinary threaded code so if
 

1989
00:50:41,510 --> 00:50:43,690
failures of ordinary threaded code so if
the current lock holder had the lock and

1990
00:50:43,690 --> 00:50:43,700
the current lock holder had the lock and
 

1991
00:50:43,700 --> 00:50:45,460
the current lock holder had the lock and
needed to update a whole bunch of things

1992
00:50:45,460 --> 00:50:45,470
needed to update a whole bunch of things
 

1993
00:50:45,470 --> 00:50:46,900
needed to update a whole bunch of things
that were protected by that lock before

1994
00:50:46,900 --> 00:50:46,910
that were protected by that lock before
 

1995
00:50:46,910 --> 00:50:48,850
that were protected by that lock before
releasing and only got halfway through

1996
00:50:48,850 --> 00:50:48,860
releasing and only got halfway through
 

1997
00:50:48,860 --> 00:50:51,240
releasing and only got halfway through
updating this stuff and then crashed

1998
00:50:51,240 --> 00:50:51,250
updating this stuff and then crashed
 

1999
00:50:51,250 --> 00:50:53,410
updating this stuff and then crashed
then the lock will get released you'll

2000
00:50:53,410 --> 00:50:53,420
then the lock will get released you'll
 

2001
00:50:53,420 --> 00:50:55,750
then the lock will get released you'll
get the lock and yet when you go to look

2002
00:50:55,750 --> 00:50:55,760
get the lock and yet when you go to look
 

2003
00:50:55,760 --> 00:50:58,750
get the lock and yet when you go to look
at the data it's garbage because it's

2004
00:50:58,750 --> 00:50:58,760
at the data it's garbage because it's
 

2005
00:50:58,760 --> 00:51:00,370
at the data it's garbage because it's
just whatever random seed it was in the

2006
00:51:00,370 --> 00:51:00,380
just whatever random seed it was in the
 

2007
00:51:00,380 --> 00:51:00,839
just whatever random seed it was in the
middle of

2008
00:51:00,839 --> 00:51:00,849
middle of
 

2009
00:51:00,849 --> 00:51:04,589
middle of
updated so there's these locks don't by

2010
00:51:04,589 --> 00:51:04,599
updated so there's these locks don't by
 

2011
00:51:04,599 --> 00:51:06,509
updated so there's these locks don't by
themselves provide the same atomicity

2012
00:51:06,509 --> 00:51:06,519
themselves provide the same atomicity
 

2013
00:51:06,519 --> 00:51:09,900
themselves provide the same atomicity
guarantee that threading locks do and so

2014
00:51:09,900 --> 00:51:09,910
guarantee that threading locks do and so
 

2015
00:51:09,910 --> 00:51:11,400
guarantee that threading locks do and so
we're sort of left to imagine for

2016
00:51:11,400 --> 00:51:11,410
we're sort of left to imagine for
 

2017
00:51:11,410 --> 00:51:13,259
we're sort of left to imagine for
ourselves by the paper or why you would

2018
00:51:13,259 --> 00:51:13,269
ourselves by the paper or why you would
 

2019
00:51:13,269 --> 00:51:15,059
ourselves by the paper or why you would
want to use them or why this is the sort

2020
00:51:15,059 --> 00:51:15,069
want to use them or why this is the sort
 

2021
00:51:15,069 --> 00:51:16,950
want to use them or why this is the sort
of some of the main examples in the

2022
00:51:16,950 --> 00:51:16,960
of some of the main examples in the
 

2023
00:51:16,960 --> 00:51:21,120
of some of the main examples in the
paper so I think if you use locks like

2024
00:51:21,120 --> 00:51:21,130
paper so I think if you use locks like
 

2025
00:51:21,130 --> 00:51:22,529
paper so I think if you use locks like
this then you sort in a distributed

2026
00:51:22,529 --> 00:51:22,539
this then you sort in a distributed
 

2027
00:51:22,539 --> 00:51:24,839
this then you sort in a distributed
system then you have two general options

2028
00:51:24,839 --> 00:51:24,849
system then you have two general options
 

2029
00:51:24,849 --> 00:51:28,229
system then you have two general options
one is everybody who acquires a lock has

2030
00:51:28,229 --> 00:51:28,239
one is everybody who acquires a lock has
 

2031
00:51:28,239 --> 00:51:30,839
one is everybody who acquires a lock has
to be prepared to clean up from some

2032
00:51:30,839 --> 00:51:30,849
to be prepared to clean up from some
 

2033
00:51:30,849 --> 00:51:33,329
to be prepared to clean up from some
previous disaster right so you acquire

2034
00:51:33,329 --> 00:51:33,339
previous disaster right so you acquire
 

2035
00:51:33,339 --> 00:51:35,430
previous disaster right so you acquire
this lock you look at the data you try

2036
00:51:35,430 --> 00:51:35,440
this lock you look at the data you try
 

2037
00:51:35,440 --> 00:51:37,620
this lock you look at the data you try
to figure out gosh if the previous owner

2038
00:51:37,620 --> 00:51:37,630
to figure out gosh if the previous owner
 

2039
00:51:37,630 --> 00:51:38,789
to figure out gosh if the previous owner
of a lot crashed

2040
00:51:38,789 --> 00:51:38,799
of a lot crashed
 

2041
00:51:38,799 --> 00:51:41,839
of a lot crashed
you know when I'm looking at the data

2042
00:51:41,839 --> 00:51:41,849
you know when I'm looking at the data
 

2043
00:51:41,849 --> 00:51:44,249
you know when I'm looking at the data
you know how can I fix the data to make

2044
00:51:44,249 --> 00:51:44,259
you know how can I fix the data to make
 

2045
00:51:44,259 --> 00:51:46,259
you know how can I fix the data to make
up how can I decide if the previous

2046
00:51:46,259 --> 00:51:46,269
up how can I decide if the previous
 

2047
00:51:46,269 --> 00:51:48,539
up how can I decide if the previous
owner crashed and what do I do to fix up

2048
00:51:48,539 --> 00:51:48,549
owner crashed and what do I do to fix up
 

2049
00:51:48,549 --> 00:51:51,960
owner crashed and what do I do to fix up
the data and you can play that game

2050
00:51:51,960 --> 00:51:51,970
the data and you can play that game
 

2051
00:51:51,970 --> 00:51:55,529
the data and you can play that game
especially if the convention is that you

2052
00:51:55,529 --> 00:51:55,539
especially if the convention is that you
 

2053
00:51:55,539 --> 00:51:57,089
especially if the convention is that you
always update in a particular sequence

2054
00:51:57,089 --> 00:51:57,099
always update in a particular sequence
 

2055
00:51:57,099 --> 00:51:58,890
always update in a particular sequence
you may be able to detect where in that

2056
00:51:58,890 --> 00:51:58,900
you may be able to detect where in that
 

2057
00:51:58,900 --> 00:52:00,539
you may be able to detect where in that
sequence the previous holder crashed

2058
00:52:00,539 --> 00:52:00,549
sequence the previous holder crashed
 

2059
00:52:00,549 --> 00:52:04,559
sequence the previous holder crashed
assuming they crashed but it's a you

2060
00:52:04,559 --> 00:52:04,569
assuming they crashed but it's a you
 

2061
00:52:04,569 --> 00:52:05,700
assuming they crashed but it's a you
know it's a tricky game the requires

2062
00:52:05,700 --> 00:52:05,710
know it's a tricky game the requires
 

2063
00:52:05,710 --> 00:52:07,859
know it's a tricky game the requires
thought of a kind you don't need for

2064
00:52:07,859 --> 00:52:07,869
thought of a kind you don't need for
 

2065
00:52:07,869 --> 00:52:10,680
thought of a kind you don't need for
like thread locking um the other reason

2066
00:52:10,680 --> 00:52:10,690
like thread locking um the other reason
 

2067
00:52:10,690 --> 00:52:12,650
like thread locking um the other reason
maybe these locks would make sense is if

2068
00:52:12,650 --> 00:52:12,660
maybe these locks would make sense is if
 

2069
00:52:12,660 --> 00:52:16,259
maybe these locks would make sense is if
there's sort of soft locks protecting

2070
00:52:16,259 --> 00:52:16,269
there's sort of soft locks protecting
 

2071
00:52:16,269 --> 00:52:17,700
there's sort of soft locks protecting
something that doesn't really matter

2072
00:52:17,700 --> 00:52:17,710
something that doesn't really matter
 

2073
00:52:17,710 --> 00:52:20,249
something that doesn't really matter
so for example if you're running

2074
00:52:20,249 --> 00:52:20,259
so for example if you're running
 

2075
00:52:20,259 --> 00:52:24,019
so for example if you're running
MapReduce jobs map tasks reduce tasks

2076
00:52:24,019 --> 00:52:24,029
MapReduce jobs map tasks reduce tasks
 

2077
00:52:24,029 --> 00:52:26,700
MapReduce jobs map tasks reduce tasks
you could use this kind of lock to make

2078
00:52:26,700 --> 00:52:26,710
you could use this kind of lock to make
 

2079
00:52:26,710 --> 00:52:30,630
you could use this kind of lock to make
sure only one task only one worker

2080
00:52:30,630 --> 00:52:30,640
sure only one task only one worker
 

2081
00:52:30,640 --> 00:52:33,150
sure only one task only one worker
executed each task so workers gonna run

2082
00:52:33,150 --> 00:52:33,160
executed each task so workers gonna run
 

2083
00:52:33,160 --> 00:52:36,079
executed each task so workers gonna run
test 37 it gets the lock for task 37

2084
00:52:36,079 --> 00:52:36,089
test 37 it gets the lock for task 37
 

2085
00:52:36,089 --> 00:52:38,430
test 37 it gets the lock for task 37
execute it marks it as executed and

2086
00:52:38,430 --> 00:52:38,440
execute it marks it as executed and
 

2087
00:52:38,440 --> 00:52:42,150
execute it marks it as executed and
releases it well the way not produce

2088
00:52:42,150 --> 00:52:42,160
releases it well the way not produce
 

2089
00:52:42,160 --> 00:52:44,459
releases it well the way not produce
works it's actually proof against

2090
00:52:44,459 --> 00:52:44,469
works it's actually proof against
 

2091
00:52:44,469 --> 00:52:49,799
works it's actually proof against
crashed workers anyway so if you grab a

2092
00:52:49,799 --> 00:52:49,809
crashed workers anyway so if you grab a
 

2093
00:52:49,809 --> 00:52:51,150
crashed workers anyway so if you grab a
lock and you crash halfway through your

2094
00:52:51,150 --> 00:52:51,160
lock and you crash halfway through your
 

2095
00:52:51,160 --> 00:52:53,430
lock and you crash halfway through your
MapReduce job so what the next person

2096
00:52:53,430 --> 00:52:53,440
MapReduce job so what the next person
 

2097
00:52:53,440 --> 00:52:55,229
MapReduce job so what the next person
who gets the lock you know because your

2098
00:52:55,229 --> 00:52:55,239
who gets the lock you know because your
 

2099
00:52:55,239 --> 00:52:56,579
who gets the lock you know because your
lock will be released when you crash the

2100
00:52:56,579 --> 00:52:56,589
lock will be released when you crash the
 

2101
00:52:56,589 --> 00:52:57,660
lock will be released when you crash the
next version who gets it will see you

2102
00:52:57,660 --> 00:52:57,670
next version who gets it will see you
 

2103
00:52:57,670 --> 00:52:59,519
next version who gets it will see you
didn't finish the task and just we

2104
00:52:59,519 --> 00:52:59,529
didn't finish the task and just we
 

2105
00:52:59,529 --> 00:53:01,529
didn't finish the task and just we
execute it and it's just not a problem

2106
00:53:01,529 --> 00:53:01,539
execute it and it's just not a problem
 

2107
00:53:01,539 --> 00:53:03,950
execute it and it's just not a problem
because of the way MapReduce is defined

2108
00:53:03,950 --> 00:53:03,960
because of the way MapReduce is defined
 

2109
00:53:03,960 --> 00:53:05,969
because of the way MapReduce is defined
so you could use these locks or some

2110
00:53:05,969 --> 00:53:05,979
so you could use these locks or some
 

2111
00:53:05,979 --> 00:53:09,120
so you could use these locks or some
kind of soft lock thing although anyway

2112
00:53:09,120 --> 00:53:09,130
kind of soft lock thing although anyway
 

2113
00:53:09,130 --> 00:53:11,249
kind of soft lock thing although anyway
and you know maybe the other thing which

2114
00:53:11,249 --> 00:53:11,259
and you know maybe the other thing which
 

2115
00:53:11,259 --> 00:53:13,140
and you know maybe the other thing which
we should be thinking about is that some

2116
00:53:13,140 --> 00:53:13,150
we should be thinking about is that some
 

2117
00:53:13,150 --> 00:53:14,160
we should be thinking about is that some
version of this

2118
00:53:14,160 --> 00:53:14,170
version of this
 

2119
00:53:14,170 --> 00:53:17,610
version of this
be used to do things like elect a master

2120
00:53:17,610 --> 00:53:17,620
be used to do things like elect a master
 

2121
00:53:17,620 --> 00:53:19,290
be used to do things like elect a master
but if what we're really doing here is

2122
00:53:19,290 --> 00:53:19,300
but if what we're really doing here is
 

2123
00:53:19,300 --> 00:53:22,500
but if what we're really doing here is
electing a master you know we could use

2124
00:53:22,500 --> 00:53:22,510
electing a master you know we could use
 

2125
00:53:22,510 --> 00:53:23,880
electing a master you know we could use
code much like this and that would

2126
00:53:23,880 --> 00:53:23,890
code much like this and that would
 

2127
00:53:23,890 --> 00:53:25,560
code much like this and that would
probably be a reasonable approach yeah

2128
00:53:25,560 --> 00:53:25,570
probably be a reasonable approach yeah
 

2129
00:53:25,570 --> 00:53:42,270
probably be a reasonable approach yeah
oh yeah yeah yeah so the picking of

2130
00:53:42,270 --> 00:53:42,280
oh yeah yeah yeah so the picking of
 

2131
00:53:42,280 --> 00:53:43,860
oh yeah yeah yeah so the picking of
paper talk that remember the text in the

2132
00:53:43,860 --> 00:53:43,870
paper talk that remember the text in the
 

2133
00:53:43,870 --> 00:53:45,780
paper talk that remember the text in the
paper were says it's going to delete the

2134
00:53:45,780 --> 00:53:45,790
paper were says it's going to delete the
 

2135
00:53:45,790 --> 00:53:47,790
paper were says it's going to delete the
ready file and then do a bunch of

2136
00:53:47,790 --> 00:53:47,800
ready file and then do a bunch of
 

2137
00:53:47,800 --> 00:53:49,950
ready file and then do a bunch of
updates to files and then recreate the

2138
00:53:49,950 --> 00:53:49,960
updates to files and then recreate the
 

2139
00:53:49,960 --> 00:53:51,770
updates to files and then recreate the
ready file that would that is a

2140
00:53:51,770 --> 00:53:51,780
ready file that would that is a
 

2141
00:53:51,780 --> 00:53:55,260
ready file that would that is a
fantastic way of sort of detecting and

2142
00:53:55,260 --> 00:53:55,270
fantastic way of sort of detecting and
 

2143
00:53:55,270 --> 00:53:57,240
fantastic way of sort of detecting and
coping with the possibility that the

2144
00:53:57,240 --> 00:53:57,250
coping with the possibility that the
 

2145
00:53:57,250 --> 00:53:58,920
coping with the possibility that the
previous lock held or the previous

2146
00:53:58,920 --> 00:53:58,930
previous lock held or the previous
 

2147
00:53:58,930 --> 00:54:00,990
previous lock held or the previous
master or whoever it is crashed halfway

2148
00:54:00,990 --> 00:54:01,000
master or whoever it is crashed halfway
 

2149
00:54:01,000 --> 00:54:02,610
master or whoever it is crashed halfway
through because gosh the ready file has

2150
00:54:02,610 --> 00:54:02,620
through because gosh the ready file has
 

2151
00:54:02,620 --> 00:54:18,390
through because gosh the ready file has
never be created

2152
00:54:18,390 --> 00:54:18,400

 

2153
00:54:18,400 --> 00:54:21,730

Inigo program yeah sadly that is

2154
00:54:21,730 --> 00:54:21,740
Inigo program yeah sadly that is
 

2155
00:54:21,740 --> 00:54:25,480
Inigo program yeah sadly that is
possible and you know either okay so the

2156
00:54:25,480 --> 00:54:25,490
possible and you know either okay so the
 

2157
00:54:25,490 --> 00:54:27,550
possible and you know either okay so the
question is nothing about zookeeper but

2158
00:54:27,550 --> 00:54:27,560
question is nothing about zookeeper but
 

2159
00:54:27,560 --> 00:54:29,320
question is nothing about zookeeper but
if you're writing threaded code and go a

2160
00:54:29,320 --> 00:54:29,330
if you're writing threaded code and go a
 

2161
00:54:29,330 --> 00:54:32,230
if you're writing threaded code and go a
thread acquires a lock could it crash

2162
00:54:32,230 --> 00:54:32,240
thread acquires a lock could it crash
 

2163
00:54:32,240 --> 00:54:34,480
thread acquires a lock could it crash
while holding the lock halfway through

2164
00:54:34,480 --> 00:54:34,490
while holding the lock halfway through
 

2165
00:54:34,490 --> 00:54:37,240
while holding the lock halfway through
whatever stuff it's supposed to be doing

2166
00:54:37,240 --> 00:54:37,250
whatever stuff it's supposed to be doing
 

2167
00:54:37,250 --> 00:54:38,410
whatever stuff it's supposed to be doing
while holding a lock and the answer is

2168
00:54:38,410 --> 00:54:38,420
while holding a lock and the answer is
 

2169
00:54:38,420 --> 00:54:40,090
while holding a lock and the answer is
yes actually there are there are ways

2170
00:54:40,090 --> 00:54:40,100
yes actually there are there are ways
 

2171
00:54:40,100 --> 00:54:42,820
yes actually there are there are ways
for an individual thread to crash and go

2172
00:54:42,820 --> 00:54:42,830
for an individual thread to crash and go
 

2173
00:54:42,830 --> 00:54:45,040
for an individual thread to crash and go
oh I forget where they are maybe divide

2174
00:54:45,040 --> 00:54:45,050
oh I forget where they are maybe divide
 

2175
00:54:45,050 --> 00:54:48,400
oh I forget where they are maybe divide
by zero certain panics anyway you can do

2176
00:54:48,400 --> 00:54:48,410
by zero certain panics anyway you can do
 

2177
00:54:48,410 --> 00:54:54,790
by zero certain panics anyway you can do
it and my advice about how to think

2178
00:54:54,790 --> 00:54:54,800
it and my advice about how to think
 

2179
00:54:54,800 --> 00:54:56,980
it and my advice about how to think
about that is that the program is now

2180
00:54:56,980 --> 00:54:56,990
about that is that the program is now
 

2181
00:54:56,990 --> 00:55:00,270
about that is that the program is now
broken and you've got to kill it because

2182
00:55:00,270 --> 00:55:00,280
broken and you've got to kill it because
 

2183
00:55:00,280 --> 00:55:02,920
broken and you've got to kill it because
in threaded code the way the thing about

2184
00:55:02,920 --> 00:55:02,930
in threaded code the way the thing about
 

2185
00:55:02,930 --> 00:55:06,760
in threaded code the way the thing about
locks is that while the lock is held the

2186
00:55:06,760 --> 00:55:06,770
locks is that while the lock is held the
 

2187
00:55:06,770 --> 00:55:09,840
locks is that while the lock is held the
invariants in the data don't hold so

2188
00:55:09,840 --> 00:55:09,850
invariants in the data don't hold so
 

2189
00:55:09,850 --> 00:55:12,880
invariants in the data don't hold so
there's no way to proceed if the lock

2190
00:55:12,880 --> 00:55:12,890
there's no way to proceed if the lock
 

2191
00:55:12,890 --> 00:55:15,340
there's no way to proceed if the lock
holder crashes there's no safe way to

2192
00:55:15,340 --> 00:55:15,350
holder crashes there's no safe way to
 

2193
00:55:15,350 --> 00:55:17,470
holder crashes there's no safe way to
proceed because all you know is whatever

2194
00:55:17,470 --> 00:55:17,480
proceed because all you know is whatever
 

2195
00:55:17,480 --> 00:55:18,850
proceed because all you know is whatever
the invariants were that the lock was

2196
00:55:18,850 --> 00:55:18,860
the invariants were that the lock was
 

2197
00:55:18,860 --> 00:55:23,650
the invariants were that the lock was
protecting no longer hold so and so and

2198
00:55:23,650 --> 00:55:23,660
protecting no longer hold so and so and
 

2199
00:55:23,660 --> 00:55:24,880
protecting no longer hold so and so and
if you do want to proceed you have to

2200
00:55:24,880 --> 00:55:24,890
if you do want to proceed you have to
 

2201
00:55:24,890 --> 00:55:27,400
if you do want to proceed you have to
leave the lock marked as held so that no

2202
00:55:27,400 --> 00:55:27,410
leave the lock marked as held so that no
 

2203
00:55:27,410 --> 00:55:29,160
leave the lock marked as held so that no
one else will ever be able to acquire it

2204
00:55:29,160 --> 00:55:29,170
one else will ever be able to acquire it
 

2205
00:55:29,170 --> 00:55:31,810
one else will ever be able to acquire it
and you know unless you have some clever

2206
00:55:31,810 --> 00:55:31,820
and you know unless you have some clever
 

2207
00:55:31,820 --> 00:55:33,340
and you know unless you have some clever
idea that's pretty much the way you have

2208
00:55:33,340 --> 00:55:33,350
idea that's pretty much the way you have
 

2209
00:55:33,350 --> 00:55:35,110
idea that's pretty much the way you have
to think about it in a threaded program

2210
00:55:35,110 --> 00:55:35,120
to think about it in a threaded program
 

2211
00:55:35,120 --> 00:55:37,120
to think about it in a threaded program
because that's kind of the style with

2212
00:55:37,120 --> 00:55:37,130
because that's kind of the style with
 

2213
00:55:37,130 --> 00:55:38,260
because that's kind of the style with
which people write threaded lock

2214
00:55:38,260 --> 00:55:38,270
which people write threaded lock
 

2215
00:55:38,270 --> 00:55:40,330
which people write threaded lock
programs if you're super clever you

2216
00:55:40,330 --> 00:55:40,340
programs if you're super clever you
 

2217
00:55:40,340 --> 00:55:44,770
programs if you're super clever you
could play the same kinds of tricks like

2218
00:55:44,770 --> 00:55:44,780
could play the same kinds of tricks like
 

2219
00:55:44,780 --> 00:55:49,300
could play the same kinds of tricks like
this ready flag trick now it's super

2220
00:55:49,300 --> 00:55:49,310
this ready flag trick now it's super
 

2221
00:55:49,310 --> 00:55:51,100
this ready flag trick now it's super
hard and go because the memory model

2222
00:55:51,100 --> 00:55:51,110
hard and go because the memory model
 

2223
00:55:51,110 --> 00:55:54,420
hard and go because the memory model
says there is nothing you can count on

2224
00:55:54,420 --> 00:55:54,430
says there is nothing you can count on
 

2225
00:55:54,430 --> 00:55:56,620
says there is nothing you can count on
except if there's a happens before

2226
00:55:56,620 --> 00:55:56,630
except if there's a happens before
 

2227
00:55:56,630 --> 00:55:59,110
except if there's a happens before
relationship so if you play this game of

2228
00:55:59,110 --> 00:55:59,120
relationship so if you play this game of
 

2229
00:55:59,120 --> 00:56:00,940
relationship so if you play this game of
writing changing some variables and then

2230
00:56:00,940 --> 00:56:00,950
writing changing some variables and then
 

2231
00:56:00,950 --> 00:56:04,750
writing changing some variables and then
setting a done flag that doesn't mean

2232
00:56:04,750 --> 00:56:04,760
setting a done flag that doesn't mean
 

2233
00:56:04,760 --> 00:56:07,990
setting a done flag that doesn't mean
anything unless you release a lock and

2234
00:56:07,990 --> 00:56:08,000
anything unless you release a lock and
 

2235
00:56:08,000 --> 00:56:10,570
anything unless you release a lock and
somebody else acquires a lock and only

2236
00:56:10,570 --> 00:56:10,580
somebody else acquires a lock and only
 

2237
00:56:10,580 --> 00:56:13,180
somebody else acquires a lock and only
then can anything be said about the

2238
00:56:13,180 --> 00:56:13,190
then can anything be said about the
 

2239
00:56:13,190 --> 00:56:15,520
then can anything be said about the
order in which or in even whether the

2240
00:56:15,520 --> 00:56:15,530
order in which or in even whether the
 

2241
00:56:15,530 --> 00:56:18,270
order in which or in even whether the
updates happen so this is very very hard

2242
00:56:18,270 --> 00:56:18,280
updates happen so this is very very hard
 

2243
00:56:18,280 --> 00:56:21,540
updates happen so this is very very hard
it rivairy hard and go to recover from a

2244
00:56:21,540 --> 00:56:21,550
it rivairy hard and go to recover from a
 

2245
00:56:21,550 --> 00:56:25,170
it rivairy hard and go to recover from a
crash of a thread that holds the lock

2246
00:56:25,170 --> 00:56:25,180
crash of a thread that holds the lock
 

2247
00:56:25,180 --> 00:56:31,160
crash of a thread that holds the lock
here is maybe a little more possible

2248
00:56:31,160 --> 00:56:31,170

 

2249
00:56:31,170 --> 00:56:42,030

okay okay okay that's all I want to talk

2250
00:56:42,030 --> 00:56:42,040
okay okay okay that's all I want to talk
 

2251
00:56:42,040 --> 00:56:44,329
okay okay okay that's all I want to talk
about with zoo keeper

2252
00:56:44,329 --> 00:56:44,339
about with zoo keeper
 

2253
00:56:44,339 --> 00:56:46,710
about with zoo keeper
it's just two pieces of high bid one is

2254
00:56:46,710 --> 00:56:46,720
it's just two pieces of high bid one is
 

2255
00:56:46,720 --> 00:56:48,390
it's just two pieces of high bid one is
at these clever ideas for high

2256
00:56:48,390 --> 00:56:48,400
at these clever ideas for high
 

2257
00:56:48,400 --> 00:56:50,069
at these clever ideas for high
performance by reading from any replica

2258
00:56:50,069 --> 00:56:50,079
performance by reading from any replica
 

2259
00:56:50,079 --> 00:56:52,620
performance by reading from any replica
but the they sacrifice a bit of

2260
00:56:52,620 --> 00:56:52,630
but the they sacrifice a bit of
 

2261
00:56:52,630 --> 00:56:55,710
but the they sacrifice a bit of
consistency and the other interesting

2262
00:56:55,710 --> 00:56:55,720
consistency and the other interesting
 

2263
00:56:55,720 --> 00:56:57,270
consistency and the other interesting
thing uninteresting take-home is that

2264
00:56:57,270 --> 00:56:57,280
thing uninteresting take-home is that
 

2265
00:56:57,280 --> 00:56:59,069
thing uninteresting take-home is that
they worked out this API that really

2266
00:56:59,069 --> 00:56:59,079
they worked out this API that really
 

2267
00:56:59,079 --> 00:57:02,549
they worked out this API that really
does let them be a general-purpose sort

2268
00:57:02,549 --> 00:57:02,559
does let them be a general-purpose sort
 

2269
00:57:02,559 --> 00:57:04,890
does let them be a general-purpose sort
of coordination service in a way that

2270
00:57:04,890 --> 00:57:04,900
of coordination service in a way that
 

2271
00:57:04,900 --> 00:57:06,809
of coordination service in a way that
simpler schemes like put get interfaces

2272
00:57:06,809 --> 00:57:06,819
simpler schemes like put get interfaces
 

2273
00:57:06,819 --> 00:57:09,210
simpler schemes like put get interfaces
just can't do so they worked out a set

2274
00:57:09,210 --> 00:57:09,220
just can't do so they worked out a set
 

2275
00:57:09,220 --> 00:57:11,549
just can't do so they worked out a set
of functions here that allows you to do

2276
00:57:11,549 --> 00:57:11,559
of functions here that allows you to do
 

2277
00:57:11,559 --> 00:57:13,620
of functions here that allows you to do
things like write mini transactions and

2278
00:57:13,620 --> 00:57:13,630
things like write mini transactions and
 

2279
00:57:13,630 --> 00:57:15,930
things like write mini transactions and
build your own locks and it all works

2280
00:57:15,930 --> 00:57:15,940
build your own locks and it all works
 

2281
00:57:15,940 --> 00:57:22,559
build your own locks and it all works
out although requires care okay now I

2282
00:57:22,559 --> 00:57:22,569
out although requires care okay now I
 

2283
00:57:22,569 --> 00:57:24,660
out although requires care okay now I
want to turn to today's paper which is

2284
00:57:24,660 --> 00:57:24,670
want to turn to today's paper which is
 

2285
00:57:24,670 --> 00:57:34,140
want to turn to today's paper which is
crack the the reason why we're reading a

2286
00:57:34,140 --> 00:57:34,150
crack the the reason why we're reading a
 

2287
00:57:34,150 --> 00:57:39,030
crack the the reason why we're reading a
crack paper it's a couple reasons one is

2288
00:57:39,030 --> 00:57:39,040
crack paper it's a couple reasons one is
 

2289
00:57:39,040 --> 00:57:41,309
crack paper it's a couple reasons one is
is that it's it does replication for

2290
00:57:41,309 --> 00:57:41,319
is that it's it does replication for
 

2291
00:57:41,319 --> 00:57:43,589
is that it's it does replication for
fault tolerance and as we'll see the

2292
00:57:43,589 --> 00:57:43,599
fault tolerance and as we'll see the
 

2293
00:57:43,599 --> 00:57:46,740
fault tolerance and as we'll see the
properties you get out of crack or its

2294
00:57:46,740 --> 00:57:46,750
properties you get out of crack or its
 

2295
00:57:46,750 --> 00:57:49,440
properties you get out of crack or its
predecessor chain replication are very

2296
00:57:49,440 --> 00:57:49,450
predecessor chain replication are very
 

2297
00:57:49,450 --> 00:57:52,740
predecessor chain replication are very
different in interesting ways from the

2298
00:57:52,740 --> 00:57:52,750
different in interesting ways from the
 

2299
00:57:52,750 --> 00:57:54,150
different in interesting ways from the
properties you get out of a system like

2300
00:57:54,150 --> 00:57:54,160
properties you get out of a system like
 

2301
00:57:54,160 --> 00:57:58,620
properties you get out of a system like
raft and so I'm actually going to talk

2302
00:57:58,620 --> 00:57:58,630
raft and so I'm actually going to talk
 

2303
00:57:58,630 --> 00:58:00,240
raft and so I'm actually going to talk
about so crack is sort of an

2304
00:58:00,240 --> 00:58:00,250
about so crack is sort of an
 

2305
00:58:00,250 --> 00:58:01,799
about so crack is sort of an
optimization to an older scheme called

2306
00:58:01,799 --> 00:58:01,809
optimization to an older scheme called
 

2307
00:58:01,809 --> 00:58:08,940
optimization to an older scheme called
chain replication chain replications

2308
00:58:08,940 --> 00:58:08,950
chain replication chain replications
 

2309
00:58:08,950 --> 00:58:11,069
chain replication chain replications
actually fairly frequently used in the

2310
00:58:11,069 --> 00:58:11,079
actually fairly frequently used in the
 

2311
00:58:11,079 --> 00:58:12,450
actually fairly frequently used in the
real world there's a bunch of systems

2312
00:58:12,450 --> 00:58:12,460
real world there's a bunch of systems
 

2313
00:58:12,460 --> 00:58:14,390
real world there's a bunch of systems
that use it

2314
00:58:14,390 --> 00:58:14,400
that use it
 

2315
00:58:14,400 --> 00:58:16,920
that use it
crack is an optimization to it that

2316
00:58:16,920 --> 00:58:16,930
crack is an optimization to it that
 

2317
00:58:16,930 --> 00:58:18,599
crack is an optimization to it that
actually does a similar trick -

2318
00:58:18,599 --> 00:58:18,609
actually does a similar trick -
 

2319
00:58:18,609 --> 00:58:20,099
actually does a similar trick -
zookeeper where it's trying to increase

2320
00:58:20,099 --> 00:58:20,109
zookeeper where it's trying to increase
 

2321
00:58:20,109 --> 00:58:24,900
zookeeper where it's trying to increase
weed throughput by allowing reads to two

2322
00:58:24,900 --> 00:58:24,910
weed throughput by allowing reads to two
 

2323
00:58:24,910 --> 00:58:26,760
weed throughput by allowing reads to two
replicas to any replicas so that you get

2324
00:58:26,760 --> 00:58:26,770
replicas to any replicas so that you get
 

2325
00:58:26,770 --> 00:58:29,579
replicas to any replicas so that you get
you know number of replicas factor of

2326
00:58:29,579 --> 00:58:29,589
you know number of replicas factor of
 

2327
00:58:29,589 --> 00:58:32,309
you know number of replicas factor of
increase in the read performance the

2328
00:58:32,309 --> 00:58:32,319
increase in the read performance the
 

2329
00:58:32,319 --> 00:58:34,620
increase in the read performance the
interesting thing about crack is that it

2330
00:58:34,620 --> 00:58:34,630
interesting thing about crack is that it
 

2331
00:58:34,630 --> 00:58:39,750
interesting thing about crack is that it
does that while preserving

2332
00:58:39,750 --> 00:58:39,760
does that while preserving
 

2333
00:58:39,760 --> 00:58:41,410
does that while preserving
linearise ability

2334
00:58:41,410 --> 00:58:41,420
linearise ability
 

2335
00:58:41,420 --> 00:58:43,510
linearise ability
unlike zookeeper which you know it

2336
00:58:43,510 --> 00:58:43,520
unlike zookeeper which you know it
 

2337
00:58:43,520 --> 00:58:44,710
unlike zookeeper which you know it
seemed like in order to be able to read

2338
00:58:44,710 --> 00:58:44,720
seemed like in order to be able to read
 

2339
00:58:44,720 --> 00:58:46,060
seemed like in order to be able to read
from any replica they had to sacrifice

2340
00:58:46,060 --> 00:58:46,070
from any replica they had to sacrifice
 

2341
00:58:46,070 --> 00:58:47,680
from any replica they had to sacrifice
freshness and therefore snot

2342
00:58:47,680 --> 00:58:47,690
freshness and therefore snot
 

2343
00:58:47,690 --> 00:58:50,580
freshness and therefore snot
linearizable crack actually manages to

2344
00:58:50,580 --> 00:58:50,590
linearizable crack actually manages to
 

2345
00:58:50,590 --> 00:58:53,860
linearizable crack actually manages to
do these reads from any replica while

2346
00:58:53,860 --> 00:58:53,870
do these reads from any replica while
 

2347
00:58:53,870 --> 00:58:56,140
do these reads from any replica while
preserving strong consistency I'm just

2348
00:58:56,140 --> 00:58:56,150
preserving strong consistency I'm just
 

2349
00:58:56,150 --> 00:59:00,280
preserving strong consistency I'm just
pretty interesting okay so first I want

2350
00:59:00,280 --> 00:59:00,290
pretty interesting okay so first I want
 

2351
00:59:00,290 --> 00:59:01,780
pretty interesting okay so first I want
to talk about the older system chain

2352
00:59:01,780 --> 00:59:01,790
to talk about the older system chain
 

2353
00:59:01,790 --> 00:59:10,000
to talk about the older system chain
replication teen replication is a it's

2354
00:59:10,000 --> 00:59:10,010
replication teen replication is a it's
 

2355
00:59:10,010 --> 00:59:11,980
replication teen replication is a it's
just a scheme for you have multiple

2356
00:59:11,980 --> 00:59:11,990
just a scheme for you have multiple
 

2357
00:59:11,990 --> 00:59:13,210
just a scheme for you have multiple
copies you want to make sure they all

2358
00:59:13,210 --> 00:59:13,220
copies you want to make sure they all
 

2359
00:59:13,220 --> 00:59:14,740
copies you want to make sure they all
seen the same sequence of right so it's

2360
00:59:14,740 --> 00:59:14,750
seen the same sequence of right so it's
 

2361
00:59:14,750 --> 00:59:17,680
seen the same sequence of right so it's
like a very familiar basic idea but it's

2362
00:59:17,680 --> 00:59:17,690
like a very familiar basic idea but it's
 

2363
00:59:17,690 --> 00:59:21,400
like a very familiar basic idea but it's
a different topology then raft so the

2364
00:59:21,400 --> 00:59:21,410
a different topology then raft so the
 

2365
00:59:21,410 --> 00:59:25,630
a different topology then raft so the
idea is that there's a chain of servers

2366
00:59:25,630 --> 00:59:25,640
idea is that there's a chain of servers
 

2367
00:59:25,640 --> 00:59:29,470
idea is that there's a chain of servers
and chain replication and the first one

2368
00:59:29,470 --> 00:59:29,480
and chain replication and the first one
 

2369
00:59:29,480 --> 00:59:32,890
and chain replication and the first one
is called the head last one's called the

2370
00:59:32,890 --> 00:59:32,900
is called the head last one's called the
 

2371
00:59:32,900 --> 00:59:36,880
is called the head last one's called the
tail when a right comes in when a client

2372
00:59:36,880 --> 00:59:36,890
tail when a right comes in when a client
 

2373
00:59:36,890 --> 00:59:39,420
tail when a right comes in when a client
wants to write something say some client

2374
00:59:39,420 --> 00:59:39,430
wants to write something say some client
 

2375
00:59:39,430 --> 00:59:42,370
wants to write something say some client
it sends always Albright's get sent to

2376
00:59:42,370 --> 00:59:42,380
it sends always Albright's get sent to
 

2377
00:59:42,380 --> 00:59:46,480
it sends always Albright's get sent to
the head the head updates its or

2378
00:59:46,480 --> 00:59:46,490
the head the head updates its or
 

2379
00:59:46,490 --> 00:59:48,400
the head the head updates its or
replaces its current copy of the data

2380
00:59:48,400 --> 00:59:48,410
replaces its current copy of the data
 

2381
00:59:48,410 --> 00:59:49,810
replaces its current copy of the data
that the clients writing so you can

2382
00:59:49,810 --> 00:59:49,820
that the clients writing so you can
 

2383
00:59:49,820 --> 00:59:54,640
that the clients writing so you can
imagine be go put key value store so you

2384
00:59:54,640 --> 00:59:54,650
imagine be go put key value store so you
 

2385
00:59:54,650 --> 00:59:56,590
imagine be go put key value store so you
know if everybody started out with you

2386
00:59:56,590 --> 00:59:56,600
know if everybody started out with you
 

2387
00:59:56,600 --> 00:59:58,930
know if everybody started out with you
know version a of the data and under

2388
00:59:58,930 --> 00:59:58,940
know version a of the data and under
 

2389
00:59:58,940 --> 01:00:01,210
know version a of the data and under
chain replication when the head process

2390
01:00:01,210 --> 01:00:01,220
chain replication when the head process
 

2391
01:00:01,220 --> 01:00:02,530
chain replication when the head process
is the right and maybe we're writing

2392
01:00:02,530 --> 01:00:02,540
is the right and maybe we're writing
 

2393
01:00:02,540 --> 01:00:04,540
is the right and maybe we're writing
value B you know the head just replaces

2394
01:00:04,540 --> 01:00:04,550
value B you know the head just replaces
 

2395
01:00:04,550 --> 01:00:07,750
value B you know the head just replaces
its a with a B and passes the right down

2396
01:00:07,750 --> 01:00:07,760
its a with a B and passes the right down
 

2397
01:00:07,760 --> 01:00:11,140
its a with a B and passes the right down
the chain as each node sees the right it

2398
01:00:11,140 --> 01:00:11,150
the chain as each node sees the right it
 

2399
01:00:11,150 --> 01:00:13,920
the chain as each node sees the right it
replaces over writes its copy the data

2400
01:00:13,920 --> 01:00:13,930
replaces over writes its copy the data
 

2401
01:00:13,930 --> 01:00:17,260
replaces over writes its copy the data
the new data when the right gets the

2402
01:00:17,260 --> 01:00:17,270
the new data when the right gets the
 

2403
01:00:17,270 --> 01:00:21,700
the new data when the right gets the
tail the tail sends the reply back to

2404
01:00:21,700 --> 01:00:21,710
tail the tail sends the reply back to
 

2405
01:00:21,710 --> 01:00:23,440
tail the tail sends the reply back to
the client saying we completed your

2406
01:00:23,440 --> 01:00:23,450
the client saying we completed your
 

2407
01:00:23,450 --> 01:00:25,260
the client saying we completed your
right

2408
01:00:25,260 --> 01:00:25,270
right
 

2409
01:00:25,270 --> 01:00:30,940
right
that's how rights work reads if a client

2410
01:00:30,940 --> 01:00:30,950
that's how rights work reads if a client
 

2411
01:00:30,950 --> 01:00:33,490
that's how rights work reads if a client
wants to do a read it sends the read to

2412
01:00:33,490 --> 01:00:33,500
wants to do a read it sends the read to
 

2413
01:00:33,500 --> 01:00:35,860
wants to do a read it sends the read to
the tail the read request of the tail

2414
01:00:35,860 --> 01:00:35,870
the tail the read request of the tail
 

2415
01:00:35,870 --> 01:00:38,140
the tail the read request of the tail
and the tail just answers out of its

2416
01:00:38,140 --> 01:00:38,150
and the tail just answers out of its
 

2417
01:00:38,150 --> 01:00:40,300
and the tail just answers out of its
current state so if we ask for this

2418
01:00:40,300 --> 01:00:40,310
current state so if we ask for this
 

2419
01:00:40,310 --> 01:00:42,250
current state so if we ask for this
whatever this object was the tail which

2420
01:00:42,250 --> 01:00:42,260
whatever this object was the tail which
 

2421
01:00:42,260 --> 01:00:45,490
whatever this object was the tail which
is I hope current values be weeds are a

2422
01:00:45,490 --> 01:00:45,500
is I hope current values be weeds are a
 

2423
01:00:45,500 --> 01:00:52,490
is I hope current values be weeds are a
good deal simpler

2424
01:00:52,490 --> 01:00:52,500

 

2425
01:00:52,500 --> 01:00:55,109

okay so it should think for a moment

2426
01:00:55,109 --> 01:00:55,119
okay so it should think for a moment
 

2427
01:00:55,119 --> 01:00:59,310
okay so it should think for a moment
like why to chain chain replication so

2428
01:00:59,310 --> 01:00:59,320
like why to chain chain replication so
 

2429
01:00:59,320 --> 01:01:01,170
like why to chain chain replication so
this is not crack just to be clear this

2430
01:01:01,170 --> 01:01:01,180
this is not crack just to be clear this
 

2431
01:01:01,180 --> 01:01:03,120
this is not crack just to be clear this
is chain replication chain replication

2432
01:01:03,120 --> 01:01:03,130
is chain replication chain replication
 

2433
01:01:03,130 --> 01:01:08,070
is chain replication chain replication
is linearizable you know in the absence

2434
01:01:08,070 --> 01:01:08,080
is linearizable you know in the absence
 

2435
01:01:08,080 --> 01:01:10,320
is linearizable you know in the absence
of failures what's going on is that we

2436
01:01:10,320 --> 01:01:10,330
of failures what's going on is that we
 

2437
01:01:10,330 --> 01:01:12,870
of failures what's going on is that we
can essentially view it as really than

2438
01:01:12,870 --> 01:01:12,880
can essentially view it as really than
 

2439
01:01:12,880 --> 01:01:14,480
can essentially view it as really than
the purposes of thinking about

2440
01:01:14,480 --> 01:01:14,490
the purposes of thinking about
 

2441
01:01:14,490 --> 01:01:16,800
the purposes of thinking about
consistency it's just this one server

2442
01:01:16,800 --> 01:01:16,810
consistency it's just this one server
 

2443
01:01:16,810 --> 01:01:19,200
consistency it's just this one server
the server sees all the rights and it

2444
01:01:19,200 --> 01:01:19,210
the server sees all the rights and it
 

2445
01:01:19,210 --> 01:01:21,120
the server sees all the rights and it
sees all the reads and process them one

2446
01:01:21,120 --> 01:01:21,130
sees all the reads and process them one
 

2447
01:01:21,130 --> 01:01:24,120
sees all the reads and process them one
at a time and you know a read will just

2448
01:01:24,120 --> 01:01:24,130
at a time and you know a read will just
 

2449
01:01:24,130 --> 01:01:25,770
at a time and you know a read will just
see the latest value that's written and

2450
01:01:25,770 --> 01:01:25,780
see the latest value that's written and
 

2451
01:01:25,780 --> 01:01:27,120
see the latest value that's written and
that's pretty much all there is to it

2452
01:01:27,120 --> 01:01:27,130
that's pretty much all there is to it
 

2453
01:01:27,130 --> 01:01:29,280
that's pretty much all there is to it
from the point of view look if there's

2454
01:01:29,280 --> 01:01:29,290
from the point of view look if there's
 

2455
01:01:29,290 --> 01:01:34,820
from the point of view look if there's
no crashes what the consistency is like

2456
01:01:34,820 --> 01:01:34,830

 

2457
01:01:34,830 --> 01:01:45,359

pretty simple the failure recovery the a

2458
01:01:45,359 --> 01:01:45,369
pretty simple the failure recovery the a
 

2459
01:01:45,369 --> 01:01:47,880
pretty simple the failure recovery the a
lot of the rationale behind chain

2460
01:01:47,880 --> 01:01:47,890
lot of the rationale behind chain
 

2461
01:01:47,890 --> 01:01:51,630
lot of the rationale behind chain
replication is that the set of states

2462
01:01:51,630 --> 01:01:51,640
replication is that the set of states
 

2463
01:01:51,640 --> 01:01:53,670
replication is that the set of states
you can see when after there's a failure

2464
01:01:53,670 --> 01:01:53,680
you can see when after there's a failure
 

2465
01:01:53,680 --> 01:01:56,070
you can see when after there's a failure
is relatively constrained because of

2466
01:01:56,070 --> 01:01:56,080
is relatively constrained because of
 

2467
01:01:56,080 --> 01:01:58,380
is relatively constrained because of
this very regular pattern with how the

2468
01:01:58,380 --> 01:01:58,390
this very regular pattern with how the
 

2469
01:01:58,390 --> 01:02:01,890
this very regular pattern with how the
writes get propagated and at a high

2470
01:02:01,890 --> 01:02:01,900
writes get propagated and at a high
 

2471
01:02:01,900 --> 01:02:03,420
writes get propagated and at a high
level what's going on is that any

2472
01:02:03,420 --> 01:02:03,430
level what's going on is that any
 

2473
01:02:03,430 --> 01:02:05,910
level what's going on is that any
committed write that is any rate that

2474
01:02:05,910 --> 01:02:05,920
committed write that is any rate that
 

2475
01:02:05,920 --> 01:02:07,680
committed write that is any rate that
could have been acknowledged to a client

2476
01:02:07,680 --> 01:02:07,690
could have been acknowledged to a client
 

2477
01:02:07,690 --> 01:02:09,900
could have been acknowledged to a client
to the writing client or any rate that

2478
01:02:09,900 --> 01:02:09,910
to the writing client or any rate that
 

2479
01:02:09,910 --> 01:02:12,560
to the writing client or any rate that
could have been exposed in a read

2480
01:02:12,560 --> 01:02:12,570
could have been exposed in a read
 

2481
01:02:12,570 --> 01:02:14,460
could have been exposed in a read
that'll neither of those will ever

2482
01:02:14,460 --> 01:02:14,470
that'll neither of those will ever
 

2483
01:02:14,470 --> 01:02:16,170
that'll neither of those will ever
happen unless that write reached the

2484
01:02:16,170 --> 01:02:16,180
happen unless that write reached the
 

2485
01:02:16,180 --> 01:02:17,760
happen unless that write reached the
tail in order for it to reach the tail

2486
01:02:17,760 --> 01:02:17,770
tail in order for it to reach the tail
 

2487
01:02:17,770 --> 01:02:19,740
tail in order for it to reach the tail
it had to a pass through them in process

2488
01:02:19,740 --> 01:02:19,750
it had to a pass through them in process
 

2489
01:02:19,750 --> 01:02:22,620
it had to a pass through them in process
by every single node in the chain so we

2490
01:02:22,620 --> 01:02:22,630
by every single node in the chain so we
 

2491
01:02:22,630 --> 01:02:24,210
by every single node in the chain so we
know that if we ever exposed to write

2492
01:02:24,210 --> 01:02:24,220
know that if we ever exposed to write
 

2493
01:02:24,220 --> 01:02:26,880
know that if we ever exposed to write
ever acknowledged write ever use it to a

2494
01:02:26,880 --> 01:02:26,890
ever acknowledged write ever use it to a
 

2495
01:02:26,890 --> 01:02:29,250
ever acknowledged write ever use it to a
read that means every single node in the

2496
01:02:29,250 --> 01:02:29,260
read that means every single node in the
 

2497
01:02:29,260 --> 01:02:33,480
read that means every single node in the
tail must know about that right we don't

2498
01:02:33,480 --> 01:02:33,490
tail must know about that right we don't
 

2499
01:02:33,490 --> 01:02:34,950
tail must know about that right we don't
get these situations like if you'll call

2500
01:02:34,950 --> 01:02:34,960
get these situations like if you'll call
 

2501
01:02:34,960 --> 01:02:37,920
get these situations like if you'll call
figure seven figure eight and RAF paper

2502
01:02:37,920 --> 01:02:37,930
figure seven figure eight and RAF paper
 

2503
01:02:37,930 --> 01:02:39,630
figure seven figure eight and RAF paper
where you can have just hair-raising

2504
01:02:39,630 --> 01:02:39,640
where you can have just hair-raising
 

2505
01:02:39,640 --> 01:02:41,609
where you can have just hair-raising
complexity and how the different

2506
01:02:41,609 --> 01:02:41,619
complexity and how the different
 

2507
01:02:41,619 --> 01:02:44,460
complexity and how the different
replicas differ if there's a crash here

2508
01:02:44,460 --> 01:02:44,470
replicas differ if there's a crash here
 

2509
01:02:44,470 --> 01:02:47,940
replicas differ if there's a crash here
you know either that it is committed or

2510
01:02:47,940 --> 01:02:47,950
you know either that it is committed or
 

2511
01:02:47,950 --> 01:02:49,920
you know either that it is committed or
it before the crash should reach some

2512
01:02:49,920 --> 01:02:49,930
it before the crash should reach some
 

2513
01:02:49,930 --> 01:02:52,530
it before the crash should reach some
point and nowhere after that point

2514
01:02:52,530 --> 01:02:52,540
point and nowhere after that point
 

2515
01:02:52,540 --> 01:02:53,940
point and nowhere after that point
because the progress of rights has

2516
01:02:53,940 --> 01:02:53,950
because the progress of rights has
 

2517
01:02:53,950 --> 01:02:55,680
because the progress of rights has
always menu so committed rights are

2518
01:02:55,680 --> 01:02:55,690
always menu so committed rights are
 

2519
01:02:55,690 --> 01:02:57,599
always menu so committed rights are
always known everywhere if a right isn't

2520
01:02:57,599 --> 01:02:57,609
always known everywhere if a right isn't
 

2521
01:02:57,609 --> 01:02:58,680
always known everywhere if a right isn't
committed that means that before

2522
01:02:58,680 --> 01:02:58,690
committed that means that before
 

2523
01:02:58,690 --> 01:03:00,540
committed that means that before
whatever crash it was that disturb the

2524
01:03:00,540 --> 01:03:00,550
whatever crash it was that disturb the
 

2525
01:03:00,550 --> 01:03:01,800
whatever crash it was that disturb the
system the rate of got into a certain

2526
01:03:01,800 --> 01:03:01,810
system the rate of got into a certain
 

2527
01:03:01,810 --> 01:03:04,050
system the rate of got into a certain
point everywhere before that point and

2528
01:03:04,050 --> 01:03:04,060
point everywhere before that point and
 

2529
01:03:04,060 --> 01:03:04,670
point everywhere before that point and
nowhere after

2530
01:03:04,670 --> 01:03:04,680
nowhere after
 

2531
01:03:04,680 --> 01:03:07,180
nowhere after
point there's really the only two setups

2532
01:03:07,180 --> 01:03:07,190
point there's really the only two setups
 

2533
01:03:07,190 --> 01:03:12,430
point there's really the only two setups
and at a high level failure recovery is

2534
01:03:12,430 --> 01:03:12,440
and at a high level failure recovery is
 

2535
01:03:12,440 --> 01:03:16,390
and at a high level failure recovery is
relatively simple also if the head fails

2536
01:03:16,390 --> 01:03:16,400
relatively simple also if the head fails
 

2537
01:03:16,400 --> 01:03:19,250
relatively simple also if the head fails
then to a first approximation the next

2538
01:03:19,250 --> 01:03:19,260
then to a first approximation the next
 

2539
01:03:19,260 --> 01:03:21,519
then to a first approximation the next
node can simply take over his head and

2540
01:03:21,519 --> 01:03:21,529
node can simply take over his head and
 

2541
01:03:21,529 --> 01:03:24,829
node can simply take over his head and
nothing else needs to get done because

2542
01:03:24,829 --> 01:03:24,839
nothing else needs to get done because
 

2543
01:03:24,839 --> 01:03:27,200
nothing else needs to get done because
any rate that made it as far as the

2544
01:03:27,200 --> 01:03:27,210
any rate that made it as far as the
 

2545
01:03:27,210 --> 01:03:28,609
any rate that made it as far as the
second node while it was the head that

2546
01:03:28,609 --> 01:03:28,619
second node while it was the head that
 

2547
01:03:28,619 --> 01:03:30,049
second node while it was the head that
failed so that right will keep on going

2548
01:03:30,049 --> 01:03:30,059
failed so that right will keep on going
 

2549
01:03:30,059 --> 01:03:32,510
failed so that right will keep on going
and we'll commit if there's a rate that

2550
01:03:32,510 --> 01:03:32,520
and we'll commit if there's a rate that
 

2551
01:03:32,520 --> 01:03:34,549
and we'll commit if there's a rate that
made it to the head before a crash but

2552
01:03:34,549 --> 01:03:34,559
made it to the head before a crash but
 

2553
01:03:34,559 --> 01:03:36,680
made it to the head before a crash but
the head didn't forward it well that's

2554
01:03:36,680 --> 01:03:36,690
the head didn't forward it well that's
 

2555
01:03:36,690 --> 01:03:38,029
the head didn't forward it well that's
definitely not committed nobody knows

2556
01:03:38,029 --> 01:03:38,039
definitely not committed nobody knows
 

2557
01:03:38,039 --> 01:03:39,859
definitely not committed nobody knows
about it and we definitely didn't send

2558
01:03:39,859 --> 01:03:39,869
about it and we definitely didn't send
 

2559
01:03:39,869 --> 01:03:41,359
about it and we definitely didn't send
it an acknowledgment to the writing

2560
01:03:41,359 --> 01:03:41,369
it an acknowledgment to the writing
 

2561
01:03:41,369 --> 01:03:43,190
it an acknowledgment to the writing
client because the write didn't get down

2562
01:03:43,190 --> 01:03:43,200
client because the write didn't get down
 

2563
01:03:43,200 --> 01:03:45,380
client because the write didn't get down
here so we're not obliged to do anything

2564
01:03:45,380 --> 01:03:45,390
here so we're not obliged to do anything
 

2565
01:03:45,390 --> 01:03:47,630
here so we're not obliged to do anything
about a write it only reached a crashed

2566
01:03:47,630 --> 01:03:47,640
about a write it only reached a crashed
 

2567
01:03:47,640 --> 01:03:50,299
about a write it only reached a crashed
head before it failed I may be the

2568
01:03:50,299 --> 01:03:50,309
head before it failed I may be the
 

2569
01:03:50,309 --> 01:03:52,730
head before it failed I may be the
client where we sinned but you know not

2570
01:03:52,730 --> 01:03:52,740
client where we sinned but you know not
 

2571
01:03:52,740 --> 01:03:56,089
client where we sinned but you know not
our problem if the tale fails it's

2572
01:03:56,089 --> 01:03:56,099
our problem if the tale fails it's
 

2573
01:03:56,099 --> 01:03:58,940
our problem if the tale fails it's
actually very similar the tale fails the

2574
01:03:58,940 --> 01:03:58,950
actually very similar the tale fails the
 

2575
01:03:58,950 --> 01:04:01,370
actually very similar the tale fails the
next node can directly take over because

2576
01:04:01,370 --> 01:04:01,380
next node can directly take over because
 

2577
01:04:01,380 --> 01:04:04,910
next node can directly take over because
everything the tale knew then next the

2578
01:04:04,910 --> 01:04:04,920
everything the tale knew then next the
 

2579
01:04:04,920 --> 01:04:06,620
everything the tale knew then next the
node just before it also knows because

2580
01:04:06,620 --> 01:04:06,630
node just before it also knows because
 

2581
01:04:06,630 --> 01:04:08,539
node just before it also knows because
the tale only hears things from the node

2582
01:04:08,539 --> 01:04:08,549
the tale only hears things from the node
 

2583
01:04:08,549 --> 01:04:14,690
the tale only hears things from the node
just before it and it's a little bit

2584
01:04:14,690 --> 01:04:14,700
just before it and it's a little bit
 

2585
01:04:14,700 --> 01:04:16,220
just before it and it's a little bit
complex of an intermediate node fails

2586
01:04:16,220 --> 01:04:16,230
complex of an intermediate node fails
 

2587
01:04:16,230 --> 01:04:18,799
complex of an intermediate node fails
but basically what needs to be done is

2588
01:04:18,799 --> 01:04:18,809
but basically what needs to be done is
 

2589
01:04:18,809 --> 01:04:20,359
but basically what needs to be done is
we need to drop it from the chain and

2590
01:04:20,359 --> 01:04:20,369
we need to drop it from the chain and
 

2591
01:04:20,369 --> 01:04:22,339
we need to drop it from the chain and
now there may be rights that it had

2592
01:04:22,339 --> 01:04:22,349
now there may be rights that it had
 

2593
01:04:22,349 --> 01:04:24,140
now there may be rights that it had
received that the next node hasn't

2594
01:04:24,140 --> 01:04:24,150
received that the next node hasn't
 

2595
01:04:24,150 --> 01:04:27,380
received that the next node hasn't
received yet and so if we drop a note

2596
01:04:27,380 --> 01:04:27,390
received yet and so if we drop a note
 

2597
01:04:27,390 --> 01:04:29,630
received yet and so if we drop a note
out of the chain the predecessor may

2598
01:04:29,630 --> 01:04:29,640
out of the chain the predecessor may
 

2599
01:04:29,640 --> 01:04:33,500
out of the chain the predecessor may
need to resend recent rights to the to

2600
01:04:33,500 --> 01:04:33,510
need to resend recent rights to the to
 

2601
01:04:33,510 --> 01:04:37,730
need to resend recent rights to the to
its new successor right that's the

2602
01:04:37,730 --> 01:04:37,740
its new successor right that's the
 

2603
01:04:37,740 --> 01:04:41,390
its new successor right that's the
recovery in a nutshell that's for why

2604
01:04:41,390 --> 01:04:41,400
recovery in a nutshell that's for why
 

2605
01:04:41,400 --> 01:04:45,500
recovery in a nutshell that's for why
this construction why this instead of

2606
01:04:45,500 --> 01:04:45,510
this construction why this instead of
 

2607
01:04:45,510 --> 01:04:47,539
this construction why this instead of
something else like why this verse is

2608
01:04:47,539 --> 01:04:47,549
something else like why this verse is
 

2609
01:04:47,549 --> 01:04:54,819
something else like why this verse is
wrapped for example the performance

2610
01:04:54,819 --> 01:04:54,829
wrapped for example the performance
 

2611
01:04:54,829 --> 01:04:59,059
wrapped for example the performance
reason is that in raft if you recall we

2612
01:04:59,059 --> 01:04:59,069
reason is that in raft if you recall we
 

2613
01:04:59,069 --> 01:05:01,579
reason is that in raft if you recall we
you know if we have a leader and a bunch

2614
01:05:01,579 --> 01:05:01,589
you know if we have a leader and a bunch
 

2615
01:05:01,589 --> 01:05:03,260
you know if we have a leader and a bunch
of you know some number of replicas

2616
01:05:03,260 --> 01:05:03,270
of you know some number of replicas
 

2617
01:05:03,270 --> 01:05:05,569
of you know some number of replicas
right with the leader it's not in a

2618
01:05:05,569 --> 01:05:05,579
right with the leader it's not in a
 

2619
01:05:05,579 --> 01:05:07,760
right with the leader it's not in a
chain we got these the replicas are all

2620
01:05:07,760 --> 01:05:07,770
chain we got these the replicas are all
 

2621
01:05:07,770 --> 01:05:09,980
chain we got these the replicas are all
directly fed by the leader so if a

2622
01:05:09,980 --> 01:05:09,990
directly fed by the leader so if a
 

2623
01:05:09,990 --> 01:05:11,960
directly fed by the leader so if a
client right comes in or a client read

2624
01:05:11,960 --> 01:05:11,970
client right comes in or a client read
 

2625
01:05:11,970 --> 01:05:15,589
client right comes in or a client read
for that matter the the leader has to

2626
01:05:15,589 --> 01:05:15,599
for that matter the the leader has to
 

2627
01:05:15,599 --> 01:05:18,309
for that matter the the leader has to
send it itself to each of the replicas

2628
01:05:18,309 --> 01:05:18,319
send it itself to each of the replicas
 

2629
01:05:18,319 --> 01:05:20,630
send it itself to each of the replicas
whereas in chain replication the leader

2630
01:05:20,630 --> 01:05:20,640
whereas in chain replication the leader
 

2631
01:05:20,640 --> 01:05:22,339
whereas in chain replication the leader
on the head only has to do once and

2632
01:05:22,339 --> 01:05:22,349
on the head only has to do once and
 

2633
01:05:22,349 --> 01:05:23,779
on the head only has to do once and
these cents on the network are actually

2634
01:05:23,779 --> 01:05:23,789
these cents on the network are actually
 

2635
01:05:23,789 --> 01:05:26,839
these cents on the network are actually
reasonably expensive and so that means

2636
01:05:26,839 --> 01:05:26,849
reasonably expensive and so that means
 

2637
01:05:26,849 --> 01:05:28,789
reasonably expensive and so that means
the load on a raft leader is going to be

2638
01:05:28,789 --> 01:05:28,799
the load on a raft leader is going to be
 

2639
01:05:28,799 --> 01:05:31,160
the load on a raft leader is going to be
higher than the load on a chain

2640
01:05:31,160 --> 01:05:31,170
higher than the load on a chain
 

2641
01:05:31,170 --> 01:05:33,529
higher than the load on a chain
replication leader and so that means

2642
01:05:33,529 --> 01:05:33,539
replication leader and so that means
 

2643
01:05:33,539 --> 01:05:37,339
replication leader and so that means
that you know as the number of client

2644
01:05:37,339 --> 01:05:37,349
that you know as the number of client
 

2645
01:05:37,349 --> 01:05:39,019
that you know as the number of client
requests per second that you're getting

2646
01:05:39,019 --> 01:05:39,029
requests per second that you're getting
 

2647
01:05:39,029 --> 01:05:41,420
requests per second that you're getting
from clients goes up a raft leader will

2648
01:05:41,420 --> 01:05:41,430
from clients goes up a raft leader will
 

2649
01:05:41,430 --> 01:05:44,059
from clients goes up a raft leader will
hit a limit and stop being able to get

2650
01:05:44,059 --> 01:05:44,069
hit a limit and stop being able to get
 

2651
01:05:44,069 --> 01:05:46,730
hit a limit and stop being able to get
faster sooner than a chain replication

2652
01:05:46,730 --> 01:05:46,740
faster sooner than a chain replication
 

2653
01:05:46,740 --> 01:05:49,010
faster sooner than a chain replication
head because it's doing more work than

2654
01:05:49,010 --> 01:05:49,020
head because it's doing more work than
 

2655
01:05:49,020 --> 01:05:51,319
head because it's doing more work than
the chain replication had another

2656
01:05:51,319 --> 01:05:51,329
the chain replication had another
 

2657
01:05:51,329 --> 01:05:53,539
the chain replication had another
interesting difference between chain

2658
01:05:53,539 --> 01:05:53,549
interesting difference between chain
 

2659
01:05:53,549 --> 01:05:55,789
interesting difference between chain
replication and raft is that the reeds

2660
01:05:55,789 --> 01:05:55,799
replication and raft is that the reeds
 

2661
01:05:55,799 --> 01:05:59,450
replication and raft is that the reeds
in raft are all also required to be

2662
01:05:59,450 --> 01:05:59,460
in raft are all also required to be
 

2663
01:05:59,460 --> 01:06:01,099
in raft are all also required to be
processed by the leaders the leader sees

2664
01:06:01,099 --> 01:06:01,109
processed by the leaders the leader sees
 

2665
01:06:01,109 --> 01:06:02,569
processed by the leaders the leader sees
every single request from clients

2666
01:06:02,569 --> 01:06:02,579
every single request from clients
 

2667
01:06:02,579 --> 01:06:04,819
every single request from clients
where's here the head sees everybody

2668
01:06:04,819 --> 01:06:04,829
where's here the head sees everybody
 

2669
01:06:04,829 --> 01:06:08,180
where's here the head sees everybody
sees all the rights but only a tail sees

2670
01:06:08,180 --> 01:06:08,190
sees all the rights but only a tail sees
 

2671
01:06:08,190 --> 01:06:11,120
sees all the rights but only a tail sees
the reed requests so there may be an

2672
01:06:11,120 --> 01:06:11,130
the reed requests so there may be an
 

2673
01:06:11,130 --> 01:06:12,529
the reed requests so there may be an
extent to which the load is sort of

2674
01:06:12,529 --> 01:06:12,539
extent to which the load is sort of
 

2675
01:06:12,539 --> 01:06:13,760
extent to which the load is sort of
split between the head and the tail

2676
01:06:13,760 --> 01:06:13,770
split between the head and the tail
 

2677
01:06:13,770 --> 01:06:17,589
split between the head and the tail
rather than concentrated in the leader

2678
01:06:17,589 --> 01:06:17,599
rather than concentrated in the leader
 

2679
01:06:17,599 --> 01:06:24,920
rather than concentrated in the leader
and and as I mentioned before the

2680
01:06:24,920 --> 01:06:24,930
and and as I mentioned before the
 

2681
01:06:24,930 --> 01:06:27,859
and and as I mentioned before the
failure different sort of analysis

2682
01:06:27,859 --> 01:06:27,869
failure different sort of analysis
 

2683
01:06:27,869 --> 01:06:28,670
failure different sort of analysis
required to think about different

2684
01:06:28,670 --> 01:06:28,680
required to think about different
 

2685
01:06:28,680 --> 01:06:30,890
required to think about different
failure scenarios is a good deal simpler

2686
01:06:30,890 --> 01:06:30,900
failure scenarios is a good deal simpler
 

2687
01:06:30,900 --> 01:06:32,680
failure scenarios is a good deal simpler
and chain replication than it is and

2688
01:06:32,680 --> 01:06:32,690
and chain replication than it is and
 

2689
01:06:32,690 --> 01:06:35,390
and chain replication than it is and
raft and as a big motivation because

2690
01:06:35,390 --> 01:06:35,400
raft and as a big motivation because
 

2691
01:06:35,400 --> 01:06:45,330
raft and as a big motivation because
it's hard to get this stuff correct yes

2692
01:06:45,330 --> 01:06:45,340

 

2693
01:06:45,340 --> 01:06:48,190

yeah so if the tale fails but its

2694
01:06:48,190 --> 01:06:48,200
yeah so if the tale fails but its
 

2695
01:06:48,200 --> 01:06:50,350
yeah so if the tale fails but its
predecessor had seen a right that the

2696
01:06:50,350 --> 01:06:50,360
predecessor had seen a right that the
 

2697
01:06:50,360 --> 01:06:52,450
predecessor had seen a right that the
tale hadn't seen then the failure of

2698
01:06:52,450 --> 01:06:52,460
tale hadn't seen then the failure of
 

2699
01:06:52,460 --> 01:06:54,070
tale hadn't seen then the failure of
that Hale basically commits that right

2700
01:06:54,070 --> 01:06:54,080
that Hale basically commits that right
 

2701
01:06:54,080 --> 01:06:56,140
that Hale basically commits that right
is now committed because it's reached

2702
01:06:56,140 --> 01:06:56,150
is now committed because it's reached
 

2703
01:06:56,150 --> 01:06:58,570
is now committed because it's reached
the new tale and so he could respond to

2704
01:06:58,570 --> 01:06:58,580
the new tale and so he could respond to
 

2705
01:06:58,580 --> 01:07:00,570
the new tale and so he could respond to
the client it probably won't because it

2706
01:07:00,570 --> 01:07:00,580
the client it probably won't because it
 

2707
01:07:00,580 --> 01:07:04,360
the client it probably won't because it
you know it wasn't a tail when it

2708
01:07:04,360 --> 01:07:04,370
you know it wasn't a tail when it
 

2709
01:07:04,370 --> 01:07:07,150
you know it wasn't a tail when it
received the right and so the client may

2710
01:07:07,150 --> 01:07:07,160
received the right and so the client may
 

2711
01:07:07,160 --> 01:07:08,920
received the right and so the client may
resend the right and that's too bad and

2712
01:07:08,920 --> 01:07:08,930
resend the right and that's too bad and
 

2713
01:07:08,930 --> 01:07:10,840
resend the right and that's too bad and
so we need duplicate suppression

2714
01:07:10,840 --> 01:07:10,850
so we need duplicate suppression
 

2715
01:07:10,850 --> 01:07:14,950
so we need duplicate suppression
probably at the head basically all the

2716
01:07:14,950 --> 01:07:14,960
probably at the head basically all the
 

2717
01:07:14,960 --> 01:07:16,930
probably at the head basically all the
systems were talking about require in

2718
01:07:16,930 --> 01:07:16,940
systems were talking about require in
 

2719
01:07:16,940 --> 01:07:19,090
systems were talking about require in
addition to everything else suppression

2720
01:07:19,090 --> 01:07:19,100
addition to everything else suppression
 

2721
01:07:19,100 --> 01:07:32,080
addition to everything else suppression
of duplicate client requests yes pink

2722
01:07:32,080 --> 01:07:32,090
of duplicate client requests yes pink
 

2723
01:07:32,090 --> 01:07:39,550
of duplicate client requests yes pink
psyche setting in you want to know who

2724
01:07:39,550 --> 01:07:39,560
psyche setting in you want to know who
 

2725
01:07:39,560 --> 01:07:42,280
psyche setting in you want to know who
makes the decisions about how to that's

2726
01:07:42,280 --> 01:07:42,290
makes the decisions about how to that's
 

2727
01:07:42,290 --> 01:07:45,870
makes the decisions about how to that's
a outstanding question the question is

2728
01:07:45,870 --> 01:07:45,880
a outstanding question the question is
 

2729
01:07:45,880 --> 01:07:48,160
a outstanding question the question is
or rephrase the question a bit if

2730
01:07:48,160 --> 01:07:48,170
or rephrase the question a bit if
 

2731
01:07:48,170 --> 01:07:51,670
or rephrase the question a bit if
there's a failure like or suppose the

2732
01:07:51,670 --> 01:07:51,680
there's a failure like or suppose the
 

2733
01:07:51,680 --> 01:07:54,220
there's a failure like or suppose the
second node stops being able to talk to

2734
01:07:54,220 --> 01:07:54,230
second node stops being able to talk to
 

2735
01:07:54,230 --> 01:07:58,390
second node stops being able to talk to
the head can this second node just take

2736
01:07:58,390 --> 01:07:58,400
the head can this second node just take
 

2737
01:07:58,400 --> 01:08:01,030
the head can this second node just take
over can it decide for itself gosh the

2738
01:08:01,030 --> 01:08:01,040
over can it decide for itself gosh the
 

2739
01:08:01,040 --> 01:08:02,500
over can it decide for itself gosh the
head seems to thought away I'm gonna

2740
01:08:02,500 --> 01:08:02,510
head seems to thought away I'm gonna
 

2741
01:08:02,510 --> 01:08:04,300
head seems to thought away I'm gonna
take over his head and tell clients to

2742
01:08:04,300 --> 01:08:04,310
take over his head and tell clients to
 

2743
01:08:04,310 --> 01:08:06,700
take over his head and tell clients to
talk to me instead of the old head but

2744
01:08:06,700 --> 01:08:06,710
talk to me instead of the old head but
 

2745
01:08:06,710 --> 01:08:15,130
talk to me instead of the old head but
what do you think that's not like a plan

2746
01:08:15,130 --> 01:08:15,140

 

2747
01:08:15,140 --> 01:08:17,780

with the usual assumptions we make about

2748
01:08:17,780 --> 01:08:17,790
with the usual assumptions we make about
 

2749
01:08:17,790 --> 01:08:20,510
with the usual assumptions we make about
how the network behaves that's a recipe

2750
01:08:20,510 --> 01:08:20,520
how the network behaves that's a recipe
 

2751
01:08:20,520 --> 01:08:24,500
how the network behaves that's a recipe
for split brain right if you do exactly

2752
01:08:24,500 --> 01:08:24,510
for split brain right if you do exactly
 

2753
01:08:24,510 --> 01:08:26,360
for split brain right if you do exactly
what I said because of course what

2754
01:08:26,360 --> 01:08:26,370
what I said because of course what
 

2755
01:08:26,370 --> 01:08:28,850
what I said because of course what
really happened was that look the

2756
01:08:28,850 --> 01:08:28,860
really happened was that look the
 

2757
01:08:28,860 --> 01:08:31,250
really happened was that look the
network failed here the head is totally

2758
01:08:31,250 --> 01:08:31,260
network failed here the head is totally
 

2759
01:08:31,260 --> 01:08:33,320
network failed here the head is totally
alive and the head thinks its successor

2760
01:08:33,320 --> 01:08:33,330
alive and the head thinks its successor
 

2761
01:08:33,330 --> 01:08:35,930
alive and the head thinks its successor
has died you know the successors

2762
01:08:35,930 --> 01:08:35,940
has died you know the successors
 

2763
01:08:35,940 --> 01:08:37,160
has died you know the successors
actually alive it thinks the head has

2764
01:08:37,160 --> 01:08:37,170
actually alive it thinks the head has
 

2765
01:08:37,170 --> 01:08:39,380
actually alive it thinks the head has
died and they both say well gosh that

2766
01:08:39,380 --> 01:08:39,390
died and they both say well gosh that
 

2767
01:08:39,390 --> 01:08:40,970
died and they both say well gosh that
other server seems to have died I'm

2768
01:08:40,970 --> 01:08:40,980
other server seems to have died I'm
 

2769
01:08:40,980 --> 01:08:42,950
other server seems to have died I'm
gonna take over and the head is gonna

2770
01:08:42,950 --> 01:08:42,960
gonna take over and the head is gonna
 

2771
01:08:42,960 --> 01:08:44,690
gonna take over and the head is gonna
say oh I'll just be a sole replica and I

2772
01:08:44,690 --> 01:08:44,700
say oh I'll just be a sole replica and I
 

2773
01:08:44,700 --> 01:08:47,480
say oh I'll just be a sole replica and I
you know act as the head and the tail

2774
01:08:47,480 --> 01:08:47,490
you know act as the head and the tail
 

2775
01:08:47,490 --> 01:08:49,190
you know act as the head and the tail
because the rest of the change seems to

2776
01:08:49,190 --> 01:08:49,200
because the rest of the change seems to
 

2777
01:08:49,200 --> 01:08:50,900
because the rest of the change seems to
have gone away and second I'll do the

2778
01:08:50,900 --> 01:08:50,910
have gone away and second I'll do the
 

2779
01:08:50,910 --> 01:08:51,800
have gone away and second I'll do the
same thing and now we have two

2780
01:08:51,800 --> 01:08:51,810
same thing and now we have two
 

2781
01:08:51,810 --> 01:08:55,910
same thing and now we have two
independent split brain versions of the

2782
01:08:55,910 --> 01:08:55,920
independent split brain versions of the
 

2783
01:08:55,920 --> 01:08:57,650
independent split brain versions of the
data which will gradually get out of

2784
01:08:57,650 --> 01:08:57,660
data which will gradually get out of
 

2785
01:08:57,660 --> 01:09:04,520
data which will gradually get out of
sync so this construction is not proof

2786
01:09:04,520 --> 01:09:04,530
sync so this construction is not proof
 

2787
01:09:04,530 --> 01:09:09,020
sync so this construction is not proof
against network partition and has not

2788
01:09:09,020 --> 01:09:09,030
against network partition and has not
 

2789
01:09:09,030 --> 01:09:10,910
against network partition and has not
does not have a defense against split

2790
01:09:10,910 --> 01:09:10,920
does not have a defense against split
 

2791
01:09:10,920 --> 01:09:13,430
does not have a defense against split
brain and what that means in practice is

2792
01:09:13,430 --> 01:09:13,440
brain and what that means in practice is
 

2793
01:09:13,440 --> 01:09:16,520
brain and what that means in practice is
if it cannot be used by itself it's like

2794
01:09:16,520 --> 01:09:16,530
if it cannot be used by itself it's like
 

2795
01:09:16,530 --> 01:09:18,080
if it cannot be used by itself it's like
a helpful thing to have in our back

2796
01:09:18,080 --> 01:09:18,090
a helpful thing to have in our back
 

2797
01:09:18,090 --> 01:09:19,930
a helpful thing to have in our back
pocket but it's not a complete

2798
01:09:19,930 --> 01:09:19,940
pocket but it's not a complete
 

2799
01:09:19,940 --> 01:09:24,140
pocket but it's not a complete
replication story so it's it's very

2800
01:09:24,140 --> 01:09:24,150
replication story so it's it's very
 

2801
01:09:24,150 --> 01:09:26,020
replication story so it's it's very
commonly used but it's used in this

2802
01:09:26,020 --> 01:09:26,030
commonly used but it's used in this
 

2803
01:09:26,030 --> 01:09:28,970
commonly used but it's used in this
stylized way in which there's always an

2804
01:09:28,970 --> 01:09:28,980
stylized way in which there's always an
 

2805
01:09:28,980 --> 01:09:32,990
stylized way in which there's always an
external Authority you know not not this

2806
01:09:32,990 --> 01:09:33,000
external Authority you know not not this
 

2807
01:09:33,000 --> 01:09:36,920
external Authority you know not not this
chain that decides who's that sort of

2808
01:09:36,920 --> 01:09:36,930
chain that decides who's that sort of
 

2809
01:09:36,930 --> 01:09:40,070
chain that decides who's that sort of
makes a call on who's alive and who's

2810
01:09:40,070 --> 01:09:40,080
makes a call on who's alive and who's
 

2811
01:09:40,080 --> 01:09:43,550
makes a call on who's alive and who's
dead and make sure everybody agrees on a

2812
01:09:43,550 --> 01:09:43,560
dead and make sure everybody agrees on a
 

2813
01:09:43,560 --> 01:09:46,490
dead and make sure everybody agrees on a
single story about who constitutes the

2814
01:09:46,490 --> 01:09:46,500
single story about who constitutes the
 

2815
01:09:46,500 --> 01:09:48,050
single story about who constitutes the
change there's never any disagreement

2816
01:09:48,050 --> 01:09:48,060
change there's never any disagreement
 

2817
01:09:48,060 --> 01:09:49,730
change there's never any disagreement
some people think the change is this no

2818
01:09:49,730 --> 01:09:49,740
some people think the change is this no
 

2819
01:09:49,740 --> 01:09:51,230
some people think the change is this no
and some people think the chain is this

2820
01:09:51,230 --> 01:09:51,240
and some people think the chain is this
 

2821
01:09:51,240 --> 01:09:53,570
and some people think the chain is this
other node so what's that's usually

2822
01:09:53,570 --> 01:09:53,580
other node so what's that's usually
 

2823
01:09:53,580 --> 01:10:00,230
other node so what's that's usually
called as a configuration manager and

2824
01:10:00,230 --> 01:10:00,240
called as a configuration manager and
 

2825
01:10:00,240 --> 01:10:02,960
called as a configuration manager and
its job is just a monitor aliveness and

2826
01:10:02,960 --> 01:10:02,970
its job is just a monitor aliveness and
 

2827
01:10:02,970 --> 01:10:05,360
its job is just a monitor aliveness and
every time it sees of all the servers

2828
01:10:05,360 --> 01:10:05,370
every time it sees of all the servers
 

2829
01:10:05,370 --> 01:10:06,770
every time it sees of all the servers
every time Isis every time the

2830
01:10:06,770 --> 01:10:06,780
every time Isis every time the
 

2831
01:10:06,780 --> 01:10:08,660
every time Isis every time the
configuration manager thinks the

2832
01:10:08,660 --> 01:10:08,670
configuration manager thinks the
 

2833
01:10:08,670 --> 01:10:10,850
configuration manager thinks the
server's dead it sends out a new

2834
01:10:10,850 --> 01:10:10,860
server's dead it sends out a new
 

2835
01:10:10,860 --> 01:10:13,670
server's dead it sends out a new
configuration in which you know that

2836
01:10:13,670 --> 01:10:13,680
configuration in which you know that
 

2837
01:10:13,680 --> 01:10:16,070
configuration in which you know that
this chain has a new definition had

2838
01:10:16,070 --> 01:10:16,080
this chain has a new definition had
 

2839
01:10:16,080 --> 01:10:19,970
this chain has a new definition had
whatever tail and that's server that the

2840
01:10:19,970 --> 01:10:19,980
whatever tail and that's server that the
 

2841
01:10:19,980 --> 01:10:21,560
whatever tail and that's server that the
configuration manager thinks is that may

2842
01:10:21,560 --> 01:10:21,570
configuration manager thinks is that may
 

2843
01:10:21,570 --> 01:10:22,790
configuration manager thinks is that may
or may not be dead but we don't care

2844
01:10:22,790 --> 01:10:22,800
or may not be dead but we don't care
 

2845
01:10:22,800 --> 01:10:25,610
or may not be dead but we don't care
because everybody is required to follow

2846
01:10:25,610 --> 01:10:25,620
because everybody is required to follow
 

2847
01:10:25,620 --> 01:10:26,950
because everybody is required to follow
then your configuration

2848
01:10:26,950 --> 01:10:26,960
then your configuration
 

2849
01:10:26,960 --> 01:10:29,479
then your configuration
and so there can't be any disagreement

2850
01:10:29,479 --> 01:10:29,489
and so there can't be any disagreement
 

2851
01:10:29,489 --> 01:10:31,880
and so there can't be any disagreement
because there's only one party making

2852
01:10:31,880 --> 01:10:31,890
because there's only one party making
 

2853
01:10:31,890 --> 01:10:33,350
because there's only one party making
these decisions not going to disagree

2854
01:10:33,350 --> 01:10:33,360
these decisions not going to disagree
 

2855
01:10:33,360 --> 01:10:35,420
these decisions not going to disagree
with itself of course how do you make a

2856
01:10:35,420 --> 01:10:35,430
with itself of course how do you make a
 

2857
01:10:35,430 --> 01:10:36,800
with itself of course how do you make a
service that's fault tolerant and

2858
01:10:36,800 --> 01:10:36,810
service that's fault tolerant and
 

2859
01:10:36,810 --> 01:10:38,360
service that's fault tolerant and
doesn't disagree with itself but doesn't

2860
01:10:38,360 --> 01:10:38,370
doesn't disagree with itself but doesn't
 

2861
01:10:38,370 --> 01:10:39,770
doesn't disagree with itself but doesn't
suffer from split brain if there's

2862
01:10:39,770 --> 01:10:39,780
suffer from split brain if there's
 

2863
01:10:39,780 --> 01:10:41,360
suffer from split brain if there's
network partitions and the answer to

2864
01:10:41,360 --> 01:10:41,370
network partitions and the answer to
 

2865
01:10:41,370 --> 01:10:43,370
network partitions and the answer to
that is that the configuration manager

2866
01:10:43,370 --> 01:10:43,380
that is that the configuration manager
 

2867
01:10:43,380 --> 01:10:49,100
that is that the configuration manager
usually uses wrath or paxos or in the

2868
01:10:49,100 --> 01:10:49,110
usually uses wrath or paxos or in the
 

2869
01:10:49,110 --> 01:10:52,250
usually uses wrath or paxos or in the
case of crack zookeeper which itself of

2870
01:10:52,250 --> 01:10:52,260
case of crack zookeeper which itself of
 

2871
01:10:52,260 --> 01:10:56,590
case of crack zookeeper which itself of
course is built on a raft like scheme so

2872
01:10:56,590 --> 01:10:56,600
course is built on a raft like scheme so
 

2873
01:10:56,600 --> 01:11:00,440
course is built on a raft like scheme so
so you to the usual complete set up in

2874
01:11:00,440 --> 01:11:00,450
so you to the usual complete set up in
 

2875
01:11:00,450 --> 01:11:01,790
so you to the usual complete set up in
your data center is it you have a

2876
01:11:01,790 --> 01:11:01,800
your data center is it you have a
 

2877
01:11:01,800 --> 01:11:04,420
your data center is it you have a
configuration manager it's it's based on

2878
01:11:04,420 --> 01:11:04,430
configuration manager it's it's based on
 

2879
01:11:04,430 --> 01:11:06,890
configuration manager it's it's based on
or after PACs or whatever so it's fault

2880
01:11:06,890 --> 01:11:06,900
or after PACs or whatever so it's fault
 

2881
01:11:06,900 --> 01:11:09,350
or after PACs or whatever so it's fault
tolerant and does not suffer from split

2882
01:11:09,350 --> 01:11:09,360
tolerant and does not suffer from split
 

2883
01:11:09,360 --> 01:11:11,390
tolerant and does not suffer from split
brain and then you split up your data

2884
01:11:11,390 --> 01:11:11,400
brain and then you split up your data
 

2885
01:11:11,400 --> 01:11:13,880
brain and then you split up your data
over a bunch of change if you know room

2886
01:11:13,880 --> 01:11:13,890
over a bunch of change if you know room
 

2887
01:11:13,890 --> 01:11:15,890
over a bunch of change if you know room
with a thousand servers in it and you

2888
01:11:15,890 --> 01:11:15,900
with a thousand servers in it and you
 

2889
01:11:15,900 --> 01:11:20,690
with a thousand servers in it and you
have you know chain a you know it's

2890
01:11:20,690 --> 01:11:20,700
have you know chain a you know it's
 

2891
01:11:20,700 --> 01:11:22,550
have you know chain a you know it's
these servers or the configuration

2892
01:11:22,550 --> 01:11:22,560
these servers or the configuration
 

2893
01:11:22,560 --> 01:11:25,670
these servers or the configuration
manager decides that the change should

2894
01:11:25,670 --> 01:11:25,680
manager decides that the change should
 

2895
01:11:25,680 --> 01:11:28,010
manager decides that the change should
look like chain a is made of server one

2896
01:11:28,010 --> 01:11:28,020
look like chain a is made of server one
 

2897
01:11:28,020 --> 01:11:32,210
look like chain a is made of server one
server to server three chain be you know

2898
01:11:32,210 --> 01:11:32,220
server to server three chain be you know
 

2899
01:11:32,220 --> 01:11:35,990
server to server three chain be you know
server for server 5 over 6 whatever and

2900
01:11:35,990 --> 01:11:36,000
server for server 5 over 6 whatever and
 

2901
01:11:36,000 --> 01:11:38,840
server for server 5 over 6 whatever and
it tells everybody this whole list it's

2902
01:11:38,840 --> 01:11:38,850
it tells everybody this whole list it's
 

2903
01:11:38,850 --> 01:11:40,220
it tells everybody this whole list it's
all the clients know all the servers

2904
01:11:40,220 --> 01:11:40,230
all the clients know all the servers
 

2905
01:11:40,230 --> 01:11:44,180
all the clients know all the servers
know and the individual servers opinions

2906
01:11:44,180 --> 01:11:44,190
know and the individual servers opinions
 

2907
01:11:44,190 --> 01:11:46,310
know and the individual servers opinions
about whether other servers are alive or

2908
01:11:46,310 --> 01:11:46,320
about whether other servers are alive or
 

2909
01:11:46,320 --> 01:11:48,410
about whether other servers are alive or
dead are totally neither here nor there

2910
01:11:48,410 --> 01:11:48,420
dead are totally neither here nor there
 

2911
01:11:48,420 --> 01:11:54,410
dead are totally neither here nor there
if this server really does die then then

2912
01:11:54,410 --> 01:11:54,420
if this server really does die then then
 

2913
01:11:54,420 --> 01:11:56,020
if this server really does die then then
the head is required to keep trying

2914
01:11:56,020 --> 01:11:56,030
the head is required to keep trying
 

2915
01:11:56,030 --> 01:11:58,430
the head is required to keep trying
indefinitely until I guess a new

2916
01:11:58,430 --> 01:11:58,440
indefinitely until I guess a new
 

2917
01:11:58,440 --> 01:12:00,320
indefinitely until I guess a new
configuration from the configuration

2918
01:12:00,320 --> 01:12:00,330
configuration from the configuration
 

2919
01:12:00,330 --> 01:12:02,660
configuration from the configuration
manager not allowed to make decisions

2920
01:12:02,660 --> 01:12:02,670
manager not allowed to make decisions
 

2921
01:12:02,670 --> 01:12:07,940
manager not allowed to make decisions
about who's alive and who's dead what's

2922
01:12:07,940 --> 01:12:07,950
about who's alive and who's dead what's
 

2923
01:12:07,950 --> 01:12:09,189
about who's alive and who's dead what's
that

2924
01:12:09,189 --> 01:12:09,199
that
 

2925
01:12:09,199 --> 01:12:12,280
that
oh boy you've got a serious problem so

2926
01:12:12,280 --> 01:12:12,290
oh boy you've got a serious problem so
 

2927
01:12:12,290 --> 01:12:13,990
oh boy you've got a serious problem so
that's why you replicated using raft

2928
01:12:13,990 --> 01:12:14,000
that's why you replicated using raft
 

2929
01:12:14,000 --> 01:12:15,910
that's why you replicated using raft
make sure the different replicas are on

2930
01:12:15,910 --> 01:12:15,920
make sure the different replicas are on
 

2931
01:12:15,920 --> 01:12:18,510
make sure the different replicas are on
different power supplies the whole works

2932
01:12:18,510 --> 01:12:18,520
different power supplies the whole works
 

2933
01:12:18,520 --> 01:12:22,810
different power supplies the whole works
but this this construction I've set up

2934
01:12:22,810 --> 01:12:22,820
but this this construction I've set up
 

2935
01:12:22,820 --> 01:12:24,970
but this this construction I've set up
here it's extremely common and it's how

2936
01:12:24,970 --> 01:12:24,980
here it's extremely common and it's how
 

2937
01:12:24,980 --> 01:12:26,830
here it's extremely common and it's how
chain replication is intended to be used

2938
01:12:26,830 --> 01:12:26,840
chain replication is intended to be used
 

2939
01:12:26,840 --> 01:12:29,860
chain replication is intended to be used
how cracks intend to be used and the

2940
01:12:29,860 --> 01:12:29,870
how cracks intend to be used and the
 

2941
01:12:29,870 --> 01:12:33,180
how cracks intend to be used and the
logic of it is that like chain require

2942
01:12:33,180 --> 01:12:33,190
logic of it is that like chain require
 

2943
01:12:33,190 --> 01:12:35,470
logic of it is that like chain require
replication if you don't have to worry

2944
01:12:35,470 --> 01:12:35,480
replication if you don't have to worry
 

2945
01:12:35,480 --> 01:12:37,900
replication if you don't have to worry
about partition and split brain you can

2946
01:12:37,900 --> 01:12:37,910
about partition and split brain you can
 

2947
01:12:37,910 --> 01:12:39,970
about partition and split brain you can
build very high speed efficient

2948
01:12:39,970 --> 01:12:39,980
build very high speed efficient
 

2949
01:12:39,980 --> 01:12:41,919
build very high speed efficient
replication systems using chain

2950
01:12:41,919 --> 01:12:41,929
replication systems using chain
 

2951
01:12:41,929 --> 01:12:43,600
replication systems using chain
replication for example so these

2952
01:12:43,600 --> 01:12:43,610
replication for example so these
 

2953
01:12:43,610 --> 01:12:48,700
replication for example so these
individual you know data replication and

2954
01:12:48,700 --> 01:12:48,710
individual you know data replication and
 

2955
01:12:48,710 --> 01:12:50,590
individual you know data replication and
we're sharding the data over many chains

2956
01:12:50,590 --> 01:12:50,600
we're sharding the data over many chains
 

2957
01:12:50,600 --> 01:12:52,180
we're sharding the data over many chains
individually this these chains can be

2958
01:12:52,180 --> 01:12:52,190
individually this these chains can be
 

2959
01:12:52,190 --> 01:12:54,850
individually this these chains can be
built to be just the most efficient

2960
01:12:54,850 --> 01:12:54,860
built to be just the most efficient
 

2961
01:12:54,860 --> 01:12:56,560
built to be just the most efficient
scheme for the particular kind of thing

2962
01:12:56,560 --> 01:12:56,570
scheme for the particular kind of thing
 

2963
01:12:56,570 --> 01:12:58,270
scheme for the particular kind of thing
that you're replicating you may read

2964
01:12:58,270 --> 01:12:58,280
that you're replicating you may read
 

2965
01:12:58,280 --> 01:13:00,400
that you're replicating you may read
heavy right heavy whatever but we don't

2966
01:13:00,400 --> 01:13:00,410
heavy right heavy whatever but we don't
 

2967
01:13:00,410 --> 01:13:01,689
heavy right heavy whatever but we don't
have to worry too much about partitions

2968
01:13:01,689 --> 01:13:01,699
have to worry too much about partitions
 

2969
01:13:01,699 --> 01:13:04,419
have to worry too much about partitions
and then all that worry is concentrated

2970
01:13:04,419 --> 01:13:04,429
and then all that worry is concentrated
 

2971
01:13:04,429 --> 01:13:07,050
and then all that worry is concentrated
in the reliable non split-brain

2972
01:13:07,050 --> 01:13:07,060
in the reliable non split-brain
 

2973
01:13:07,060 --> 01:13:17,959
in the reliable non split-brain
configuration manager

2974
01:13:17,959 --> 01:13:17,969

 

2975
01:13:17,969 --> 01:13:23,520

okay so your question is why are we

2976
01:13:23,520 --> 01:13:23,530
okay so your question is why are we
 

2977
01:13:23,530 --> 01:13:25,680
okay so your question is why are we
using chain replication here instead of

2978
01:13:25,680 --> 01:13:25,690
using chain replication here instead of
 

2979
01:13:25,690 --> 01:13:33,090
using chain replication here instead of
raft okay so it's like a totally

2980
01:13:33,090 --> 01:13:33,100
raft okay so it's like a totally
 

2981
01:13:33,100 --> 01:13:39,030
raft okay so it's like a totally
reasonable question um the the it

2982
01:13:39,030 --> 01:13:39,040
reasonable question um the the it
 

2983
01:13:39,040 --> 01:13:40,770
reasonable question um the the it
doesn't really matter for this

2984
01:13:40,770 --> 01:13:40,780
doesn't really matter for this
 

2985
01:13:40,780 --> 01:13:42,570
doesn't really matter for this
construction because even if we're using

2986
01:13:42,570 --> 01:13:42,580
construction because even if we're using
 

2987
01:13:42,580 --> 01:13:48,500
construction because even if we're using
raft here we still need one party to

2988
01:13:48,500 --> 01:13:48,510
raft here we still need one party to
 

2989
01:13:48,510 --> 01:13:51,060
raft here we still need one party to
make a decision with which there can be

2990
01:13:51,060 --> 01:13:51,070
make a decision with which there can be
 

2991
01:13:51,070 --> 01:13:53,399
make a decision with which there can be
no disagreement about how the data is

2992
01:13:53,399 --> 01:13:53,409
no disagreement about how the data is
 

2993
01:13:53,409 --> 01:13:57,080
no disagreement about how the data is
divided over our hundred different

2994
01:13:57,080 --> 01:13:57,090
divided over our hundred different
 

2995
01:13:57,090 --> 01:13:59,910
divided over our hundred different
replication groups right so all you know

2996
01:13:59,910 --> 01:13:59,920
replication groups right so all you know
 

2997
01:13:59,920 --> 01:14:01,050
replication groups right so all you know
and I need kind of big system you're

2998
01:14:01,050 --> 01:14:01,060
and I need kind of big system you're
 

2999
01:14:01,060 --> 01:14:02,640
and I need kind of big system you're
splitting your sharding or splitting up

3000
01:14:02,640 --> 01:14:02,650
splitting your sharding or splitting up
 

3001
01:14:02,650 --> 01:14:03,209
splitting your sharding or splitting up
the data

3002
01:14:03,209 --> 01:14:03,219
the data
 

3003
01:14:03,219 --> 01:14:04,979
the data
somebody needs to decide how the data is

3004
01:14:04,979 --> 01:14:04,989
somebody needs to decide how the data is
 

3005
01:14:04,989 --> 01:14:07,200
somebody needs to decide how the data is
assigned to the different replication

3006
01:14:07,200 --> 01:14:07,210
assigned to the different replication
 

3007
01:14:07,210 --> 01:14:08,820
assigned to the different replication
groups this has to change over time as

3008
01:14:08,820 --> 01:14:08,830
groups this has to change over time as
 

3009
01:14:08,830 --> 01:14:10,470
groups this has to change over time as
you get more or less Hardware more data

3010
01:14:10,470 --> 01:14:10,480
you get more or less Hardware more data
 

3011
01:14:10,480 --> 01:14:12,629
you get more or less Hardware more data
or whatever so if nothing else the

3012
01:14:12,629 --> 01:14:12,639
or whatever so if nothing else the
 

3013
01:14:12,639 --> 01:14:14,550
or whatever so if nothing else the
configuration manager is saying well

3014
01:14:14,550 --> 01:14:14,560
configuration manager is saying well
 

3015
01:14:14,560 --> 01:14:16,320
configuration manager is saying well
look you know the keys start with a or B

3016
01:14:16,320 --> 01:14:16,330
look you know the keys start with a or B
 

3017
01:14:16,330 --> 01:14:20,100
look you know the keys start with a or B
goes here or then C or D goes here even

3018
01:14:20,100 --> 01:14:20,110
goes here or then C or D goes here even
 

3019
01:14:20,110 --> 01:14:22,020
goes here or then C or D goes here even
if you use Paxos here now there's also

3020
01:14:22,020 --> 01:14:22,030
if you use Paxos here now there's also
 

3021
01:14:22,030 --> 01:14:23,910
if you use Paxos here now there's also
this smaller question if we didn't eat

3022
01:14:23,910 --> 01:14:23,920
this smaller question if we didn't eat
 

3023
01:14:23,920 --> 01:14:24,750
this smaller question if we didn't eat
you know what should we use for

3024
01:14:24,750 --> 01:14:24,760
you know what should we use for
 

3025
01:14:24,760 --> 01:14:26,970
you know what should we use for
replication should be chain replication

3026
01:14:26,970 --> 01:14:26,980
replication should be chain replication
 

3027
01:14:26,980 --> 01:14:33,959
replication should be chain replication
or paxos or raft or whatever and people

3028
01:14:33,959 --> 01:14:33,969
or paxos or raft or whatever and people
 

3029
01:14:33,969 --> 01:14:36,540
or paxos or raft or whatever and people
do different things some people do

3030
01:14:36,540 --> 01:14:36,550
do different things some people do
 

3031
01:14:36,550 --> 01:14:38,729
do different things some people do
actually use Paxos based replication

3032
01:14:38,729 --> 01:14:38,739
actually use Paxos based replication
 

3033
01:14:38,739 --> 01:14:40,140
actually use Paxos based replication
like spanner which I think we're gonna

3034
01:14:40,140 --> 01:14:40,150
like spanner which I think we're gonna
 

3035
01:14:40,150 --> 01:14:43,200
like spanner which I think we're gonna
look at later in the semester has this

3036
01:14:43,200 --> 01:14:43,210
look at later in the semester has this
 

3037
01:14:43,210 --> 01:14:45,660
look at later in the semester has this
structure but it actually uses Paxos to

3038
01:14:45,660 --> 01:14:45,670
structure but it actually uses Paxos to
 

3039
01:14:45,670 --> 01:14:49,200
structure but it actually uses Paxos to
replicate rights for the data you know

3040
01:14:49,200 --> 01:14:49,210
replicate rights for the data you know
 

3041
01:14:49,210 --> 01:14:50,700
replicate rights for the data you know
the reason why you might not want to use

3042
01:14:50,700 --> 01:14:50,710
the reason why you might not want to use
 

3043
01:14:50,710 --> 01:14:55,709
the reason why you might not want to use
PAC so so raft is that it's arguably

3044
01:14:55,709 --> 01:14:55,719
PAC so so raft is that it's arguably
 

3045
01:14:55,719 --> 01:14:57,419
PAC so so raft is that it's arguably
more efficient to use this chain

3046
01:14:57,419 --> 01:14:57,429
more efficient to use this chain
 

3047
01:14:57,429 --> 01:14:59,280
more efficient to use this chain
construction because it reduces the load

3048
01:14:59,280 --> 01:14:59,290
construction because it reduces the load
 

3049
01:14:59,290 --> 01:15:01,649
construction because it reduces the load
on the leader and that may or may not be

3050
01:15:01,649 --> 01:15:01,659
on the leader and that may or may not be
 

3051
01:15:01,659 --> 01:15:07,250
on the leader and that may or may not be
a critical issue the a reason to favor

3052
01:15:07,250 --> 01:15:07,260
a critical issue the a reason to favor
 

3053
01:15:07,260 --> 01:15:11,580
a critical issue the a reason to favor
rafter Paxos is that they do not have to

3054
01:15:11,580 --> 01:15:11,590
rafter Paxos is that they do not have to
 

3055
01:15:11,590 --> 01:15:14,160
rafter Paxos is that they do not have to
wait for a lagging replica this chain

3056
01:15:14,160 --> 01:15:14,170
wait for a lagging replica this chain
 

3057
01:15:14,170 --> 01:15:15,959
wait for a lagging replica this chain
replication has a performance problem

3058
01:15:15,959 --> 01:15:15,969
replication has a performance problem
 

3059
01:15:15,969 --> 01:15:18,000
replication has a performance problem
that if one of these replicas is slow

3060
01:15:18,000 --> 01:15:18,010
that if one of these replicas is slow
 

3061
01:15:18,010 --> 01:15:20,340
that if one of these replicas is slow
because even for a moment

3062
01:15:20,340 --> 01:15:20,350
because even for a moment
 

3063
01:15:20,350 --> 01:15:22,470
because even for a moment
you know because every rate has to go

3064
01:15:22,470 --> 01:15:22,480
you know because every rate has to go
 

3065
01:15:22,480 --> 01:15:24,540
you know because every rate has to go
through every replica even a single slow

3066
01:15:24,540 --> 01:15:24,550
through every replica even a single slow
 

3067
01:15:24,550 --> 01:15:27,270
through every replica even a single slow
replica slows down all offer all right

3068
01:15:27,270 --> 01:15:27,280
replica slows down all offer all right
 

3069
01:15:27,280 --> 01:15:29,210
replica slows down all offer all right
operations and I can be very damaging

3070
01:15:29,210 --> 01:15:29,220
operations and I can be very damaging
 

3071
01:15:29,220 --> 01:15:30,830
operations and I can be very damaging
you know if you have thousands of

3072
01:15:30,830 --> 01:15:30,840
you know if you have thousands of
 

3073
01:15:30,840 --> 01:15:32,960
you know if you have thousands of
servers probably did any given time you

3074
01:15:32,960 --> 01:15:32,970
servers probably did any given time you
 

3075
01:15:32,970 --> 01:15:37,460
servers probably did any given time you
know seven of them are out to lunch or

3076
01:15:37,460 --> 01:15:37,470
know seven of them are out to lunch or
 

3077
01:15:37,470 --> 01:15:39,590
know seven of them are out to lunch or
unreliable or slow because somebody's

3078
01:15:39,590 --> 01:15:39,600
unreliable or slow because somebody's
 

3079
01:15:39,600 --> 01:15:41,120
unreliable or slow because somebody's
installing new software who knows what

3080
01:15:41,120 --> 01:15:41,130
installing new software who knows what
 

3081
01:15:41,130 --> 01:15:46,610
installing new software who knows what
and that so it's a bit damaging to have

3082
01:15:46,610 --> 01:15:46,620
and that so it's a bit damaging to have
 

3083
01:15:46,620 --> 01:15:48,890
and that so it's a bit damaging to have
every request be sort of limited by the

3084
01:15:48,890 --> 01:15:48,900
every request be sort of limited by the
 

3085
01:15:48,900 --> 01:15:52,360
every request be sort of limited by the
slowest server whereas brafton paxos

3086
01:15:52,360 --> 01:15:52,370
slowest server whereas brafton paxos
 

3087
01:15:52,370 --> 01:15:54,920
slowest server whereas brafton paxos
well it's so rad for example if one of

3088
01:15:54,920 --> 01:15:54,930
well it's so rad for example if one of
 

3089
01:15:54,930 --> 01:15:56,390
well it's so rad for example if one of
the followers is so it doesn't matter

3090
01:15:56,390 --> 01:15:56,400
the followers is so it doesn't matter
 

3091
01:15:56,400 --> 01:15:57,680
the followers is so it doesn't matter
because that leader only has to wait for

3092
01:15:57,680 --> 01:15:57,690
because that leader only has to wait for
 

3093
01:15:57,690 --> 01:15:59,330
because that leader only has to wait for
a majority it doesn't have to wait for

3094
01:15:59,330 --> 01:15:59,340
a majority it doesn't have to wait for
 

3095
01:15:59,340 --> 01:16:01,520
a majority it doesn't have to wait for
all of them you know ultimately they all

3096
01:16:01,520 --> 01:16:01,530
all of them you know ultimately they all
 

3097
01:16:01,530 --> 01:16:04,900
all of them you know ultimately they all
have to catch up but raft is much better

3098
01:16:04,900 --> 01:16:04,910
have to catch up but raft is much better
 

3099
01:16:04,910 --> 01:16:07,880
have to catch up but raft is much better
resisting transient slowdown and some

3100
01:16:07,880 --> 01:16:07,890
resisting transient slowdown and some
 

3101
01:16:07,890 --> 01:16:09,380
resisting transient slowdown and some
Paxos based systems although not really

3102
01:16:09,380 --> 01:16:09,390
Paxos based systems although not really
 

3103
01:16:09,390 --> 01:16:12,860
Paxos based systems although not really
raft are also good at dealing with the

3104
01:16:12,860 --> 01:16:12,870
raft are also good at dealing with the
 

3105
01:16:12,870 --> 01:16:14,360
raft are also good at dealing with the
possibility that the replicas are in

3106
01:16:14,360 --> 01:16:14,370
possibility that the replicas are in
 

3107
01:16:14,370 --> 01:16:16,070
possibility that the replicas are in
different data centers and maybe far

3108
01:16:16,070 --> 01:16:16,080
different data centers and maybe far
 

3109
01:16:16,080 --> 01:16:17,480
different data centers and maybe far
from each other and because you only

3110
01:16:17,480 --> 01:16:17,490
from each other and because you only
 

3111
01:16:17,490 --> 01:16:19,130
from each other and because you only
need a majority you don't have to

3112
01:16:19,130 --> 01:16:19,140
need a majority you don't have to
 

3113
01:16:19,140 --> 01:16:21,290
need a majority you don't have to
necessarily wait for acknowledgments

3114
01:16:21,290 --> 01:16:21,300
necessarily wait for acknowledgments
 

3115
01:16:21,300 --> 01:16:23,240
necessarily wait for acknowledgments
from a distant data center and so that

3116
01:16:23,240 --> 01:16:23,250
from a distant data center and so that
 

3117
01:16:23,250 --> 01:16:25,670
from a distant data center and so that
can also leads people to use paxos raft

3118
01:16:25,670 --> 01:16:25,680
can also leads people to use paxos raft
 

3119
01:16:25,680 --> 01:16:28,640
can also leads people to use paxos raft
like majority schemes rather than chain

3120
01:16:28,640 --> 01:16:28,650
like majority schemes rather than chain
 

3121
01:16:28,650 --> 01:16:31,850
like majority schemes rather than chain
replication but this is sort of a it

3122
01:16:31,850 --> 01:16:31,860
replication but this is sort of a it
 

3123
01:16:31,860 --> 01:16:34,010
replication but this is sort of a it
depends very much on your workload and

3124
01:16:34,010 --> 01:16:34,020
depends very much on your workload and
 

3125
01:16:34,020 --> 01:16:35,420
depends very much on your workload and
what you're trying to achieve but this

3126
01:16:35,420 --> 01:16:35,430
what you're trying to achieve but this
 

3127
01:16:35,430 --> 01:16:41,390
what you're trying to achieve but this
overall architecture is in I don't know

3128
01:16:41,390 --> 01:16:41,400
overall architecture is in I don't know
 

3129
01:16:41,400 --> 01:16:42,650
overall architecture is in I don't know
if it's Universal but it's extremely

3130
01:16:42,650 --> 01:16:42,660
if it's Universal but it's extremely
 

3131
01:16:42,660 --> 01:17:02,340
if it's Universal but it's extremely
common

3132
01:17:02,340 --> 01:17:02,350

 

3133
01:17:02,350 --> 01:17:07,750

like intentional topologies okay the for

3134
01:17:07,750 --> 01:17:07,760
like intentional topologies okay the for
 

3135
01:17:07,760 --> 01:17:10,390
like intentional topologies okay the for
a for a network that's not broken the

3136
01:17:10,390 --> 01:17:10,400
a for a network that's not broken the
 

3137
01:17:10,400 --> 01:17:12,820
a for a network that's not broken the
usual assumption is that all the

3138
01:17:12,820 --> 01:17:12,830
usual assumption is that all the
 

3139
01:17:12,830 --> 01:17:14,260
usual assumption is that all the
computers can talk to each other through

3140
01:17:14,260 --> 01:17:14,270
computers can talk to each other through
 

3141
01:17:14,270 --> 01:17:16,210
computers can talk to each other through
the network for networks that are broken

3142
01:17:16,210 --> 01:17:16,220
the network for networks that are broken
 

3143
01:17:16,220 --> 01:17:18,610
the network for networks that are broken
because somebody stepped on a cable or

3144
01:17:18,610 --> 01:17:18,620
because somebody stepped on a cable or
 

3145
01:17:18,620 --> 01:17:22,570
because somebody stepped on a cable or
some routers misconfigured any crazy

3146
01:17:22,570 --> 01:17:22,580
some routers misconfigured any crazy
 

3147
01:17:22,580 --> 01:17:23,890
some routers misconfigured any crazy
thing can happen

3148
01:17:23,890 --> 01:17:23,900
thing can happen
 

3149
01:17:23,900 --> 01:17:27,610
thing can happen
so absolutely due to miss configuration

3150
01:17:27,610 --> 01:17:27,620
so absolutely due to miss configuration
 

3151
01:17:27,620 --> 01:17:30,070
so absolutely due to miss configuration
you can get a situation where you know

3152
01:17:30,070 --> 01:17:30,080
you can get a situation where you know
 

3153
01:17:30,080 --> 01:17:31,960
you can get a situation where you know
these two nodes can talk to the

3154
01:17:31,960 --> 01:17:31,970
these two nodes can talk to the
 

3155
01:17:31,970 --> 01:17:33,070
these two nodes can talk to the
configuration manager and the

3156
01:17:33,070 --> 01:17:33,080
configuration manager and the
 

3157
01:17:33,080 --> 01:17:34,570
configuration manager and the
configuration managers think sir they're

3158
01:17:34,570 --> 01:17:34,580
configuration managers think sir they're
 

3159
01:17:34,580 --> 01:17:38,520
configuration managers think sir they're
up but they can't talk to each other so

3160
01:17:38,520 --> 01:17:38,530
up but they can't talk to each other so
 

3161
01:17:38,530 --> 01:17:41,530
up but they can't talk to each other so
yes and and that's a killer for this

3162
01:17:41,530 --> 01:17:41,540
yes and and that's a killer for this
 

3163
01:17:41,540 --> 01:17:42,640
yes and and that's a killer for this
right because other configuration

3164
01:17:42,640 --> 01:17:42,650
right because other configuration
 

3165
01:17:42,650 --> 01:17:44,170
right because other configuration
manager thinks that are up they can't

3166
01:17:44,170 --> 01:17:44,180
manager thinks that are up they can't
 

3167
01:17:44,180 --> 01:17:46,210
manager thinks that are up they can't
talk to each other boy it's just like

3168
01:17:46,210 --> 01:17:46,220
talk to each other boy it's just like
 

3169
01:17:46,220 --> 01:17:50,440
talk to each other boy it's just like
it's a disaster and if you need your

3170
01:17:50,440 --> 01:17:50,450
it's a disaster and if you need your
 

3171
01:17:50,450 --> 01:17:52,930
it's a disaster and if you need your
system to be resistant to that then you

3172
01:17:52,930 --> 01:17:52,940
system to be resistant to that then you
 

3173
01:17:52,940 --> 01:17:53,920
system to be resistant to that then you
need to have a more careful

3174
01:17:53,920 --> 01:17:53,930
need to have a more careful
 

3175
01:17:53,930 --> 01:17:56,080
need to have a more careful
configuration manager you need logic in

3176
01:17:56,080 --> 01:17:56,090
configuration manager you need logic in
 

3177
01:17:56,090 --> 01:17:57,970
configuration manager you need logic in
the configuration manager that says gosh

3178
01:17:57,970 --> 01:17:57,980
the configuration manager that says gosh
 

3179
01:17:57,980 --> 01:17:59,230
the configuration manager that says gosh
I'm only gonna form a chain out of these

3180
01:17:59,230 --> 01:17:59,240
I'm only gonna form a chain out of these
 

3181
01:17:59,240 --> 01:18:01,690
I'm only gonna form a chain out of these
services not only I can talk to that but

3182
01:18:01,690 --> 01:18:01,700
services not only I can talk to that but
 

3183
01:18:01,700 --> 01:18:03,430
services not only I can talk to that but
they can talk to each other and sort of

3184
01:18:03,430 --> 01:18:03,440
they can talk to each other and sort of
 

3185
01:18:03,440 --> 01:18:05,740
they can talk to each other and sort of
explicitly check and I don't know if

3186
01:18:05,740 --> 01:18:05,750
explicitly check and I don't know if
 

3187
01:18:05,750 --> 01:18:07,920
explicitly check and I don't know if
that's common I mean I'm gonna guess not

3188
01:18:07,920 --> 01:18:07,930
that's common I mean I'm gonna guess not
 

3189
01:18:07,930 --> 01:18:10,060
that's common I mean I'm gonna guess not
but if you were super careful you'd want

3190
01:18:10,060 --> 01:18:10,070
but if you were super careful you'd want
 

3191
01:18:10,070 --> 01:18:11,260
but if you were super careful you'd want
to because even though we talked about

3192
01:18:11,260 --> 01:18:11,270
to because even though we talked about
 

3193
01:18:11,270 --> 01:18:13,470
to because even though we talked about
network partition that's like a

3194
01:18:13,470 --> 01:18:13,480
network partition that's like a
 

3195
01:18:13,480 --> 01:18:16,510
network partition that's like a
abstraction and in reality you can get

3196
01:18:16,510 --> 01:18:16,520
abstraction and in reality you can get
 

3197
01:18:16,520 --> 01:18:19,120
abstraction and in reality you can get
any combination of who can talk to who

3198
01:18:19,120 --> 01:18:19,130
any combination of who can talk to who
 

3199
01:18:19,130 --> 01:18:24,300
any combination of who can talk to who
else and some are may be very damaging

3200
01:18:24,300 --> 01:18:24,310

 

3201
01:18:24,310 --> 01:18:28,840

okay I'm gonna wrap up and see you next

3202
01:18:28,840 --> 01:18:28,850
okay I'm gonna wrap up and see you next
 

3203
01:18:28,850 --> 01:18:31,000
okay I'm gonna wrap up and see you next
week

