1
00:00:02,500 --> 00:00:07,360

today I'd like to talk about NGO which

2
00:00:07,360 --> 00:00:07,370
today I'd like to talk about NGO which
 

3
00:00:07,370 --> 00:00:08,980
today I'd like to talk about NGO which
is interesting especially interesting

4
00:00:08,980 --> 00:00:08,990
is interesting especially interesting
 

5
00:00:08,990 --> 00:00:10,839
is interesting especially interesting
for us in this course because course NGO

6
00:00:10,839 --> 00:00:10,849
for us in this course because course NGO
 

7
00:00:10,849 --> 00:00:12,699
for us in this course because course NGO
is the language at the labs you're all

8
00:00:12,699 --> 00:00:12,709
is the language at the labs you're all
 

9
00:00:12,709 --> 00:00:14,440
is the language at the labs you're all
going to do the labs in and so I want to

10
00:00:14,440 --> 00:00:14,450
going to do the labs in and so I want to
 

11
00:00:14,450 --> 00:00:17,080
going to do the labs in and so I want to
focus today particularly on some of the

12
00:00:17,080 --> 00:00:17,090
focus today particularly on some of the
 

13
00:00:17,090 --> 00:00:19,270
focus today particularly on some of the
machinery that sort of most useful in

14
00:00:19,270 --> 00:00:19,280
machinery that sort of most useful in
 

15
00:00:19,280 --> 00:00:22,930
machinery that sort of most useful in
the labs and in most particular to

16
00:00:22,930 --> 00:00:22,940
the labs and in most particular to
 

17
00:00:22,940 --> 00:00:26,160
the labs and in most particular to
distributed programming um first of all

18
00:00:26,160 --> 00:00:26,170
distributed programming um first of all
 

19
00:00:26,170 --> 00:00:29,590
distributed programming um first of all
you know it's worth asking why we use go

20
00:00:29,590 --> 00:00:29,600
you know it's worth asking why we use go
 

21
00:00:29,600 --> 00:00:32,170
you know it's worth asking why we use go
in this class in fact we could have used

22
00:00:32,170 --> 00:00:32,180
in this class in fact we could have used
 

23
00:00:32,180 --> 00:00:33,880
in this class in fact we could have used
any one of a number of other system

24
00:00:33,880 --> 00:00:33,890
any one of a number of other system
 

25
00:00:33,890 --> 00:00:35,889
any one of a number of other system
style languages plenty languages like

26
00:00:35,889 --> 00:00:35,899
style languages plenty languages like
 

27
00:00:35,899 --> 00:00:38,200
style languages plenty languages like
Java or C sharp or even Python that

28
00:00:38,200 --> 00:00:38,210
Java or C sharp or even Python that
 

29
00:00:38,210 --> 00:00:40,720
Java or C sharp or even Python that
provide the kind of facilities we need

30
00:00:40,720 --> 00:00:40,730
provide the kind of facilities we need
 

31
00:00:40,730 --> 00:00:42,849
provide the kind of facilities we need
and indeed we used to use C++ in this

32
00:00:42,849 --> 00:00:42,859
and indeed we used to use C++ in this
 

33
00:00:42,859 --> 00:00:47,069
and indeed we used to use C++ in this
class and it worked out fine it'll go

34
00:00:47,069 --> 00:00:47,079
class and it worked out fine it'll go
 

35
00:00:47,079 --> 00:00:49,000
class and it worked out fine it'll go
indeed like many other languages

36
00:00:49,000 --> 00:00:49,010
indeed like many other languages
 

37
00:00:49,010 --> 00:00:50,709
indeed like many other languages
provides a bunch of features which are

38
00:00:50,709 --> 00:00:50,719
provides a bunch of features which are
 

39
00:00:50,719 --> 00:00:51,639
provides a bunch of features which are
particularly convenient

40
00:00:51,639 --> 00:00:51,649
particularly convenient
 

41
00:00:51,649 --> 00:00:53,399
particularly convenient
that's good support for threads and

42
00:00:53,399 --> 00:00:53,409
that's good support for threads and
 

43
00:00:53,409 --> 00:00:56,649
that's good support for threads and
locking and synchronization between

44
00:00:56,649 --> 00:00:56,659
locking and synchronization between
 

45
00:00:56,659 --> 00:00:59,229
locking and synchronization between
threads which we use a lot it is a

46
00:00:59,229 --> 00:00:59,239
threads which we use a lot it is a
 

47
00:00:59,239 --> 00:01:01,779
threads which we use a lot it is a
convenient remote procedure call package

48
00:01:01,779 --> 00:01:01,789
convenient remote procedure call package
 

49
00:01:01,789 --> 00:01:04,869
convenient remote procedure call package
which doesn't sound like much but it

50
00:01:04,869 --> 00:01:04,879
which doesn't sound like much but it
 

51
00:01:04,879 --> 00:01:06,370
which doesn't sound like much but it
actually turns out to be a significant

52
00:01:06,370 --> 00:01:06,380
actually turns out to be a significant
 

53
00:01:06,380 --> 00:01:09,940
actually turns out to be a significant
constraint from in languages like C++

54
00:01:09,940 --> 00:01:09,950
constraint from in languages like C++
 

55
00:01:09,950 --> 00:01:11,200
constraint from in languages like C++
for example it's actually a bit hard to

56
00:01:11,200 --> 00:01:11,210
for example it's actually a bit hard to
 

57
00:01:11,210 --> 00:01:13,569
for example it's actually a bit hard to
find a convenient easy to use remote

58
00:01:13,569 --> 00:01:13,579
find a convenient easy to use remote
 

59
00:01:13,579 --> 00:01:14,920
find a convenient easy to use remote
procedure call package and of course we

60
00:01:14,920 --> 00:01:14,930
procedure call package and of course we
 

61
00:01:14,930 --> 00:01:16,560
procedure call package and of course we
use it all the time in this course or

62
00:01:16,560 --> 00:01:16,570
use it all the time in this course or
 

63
00:01:16,570 --> 00:01:18,399
use it all the time in this course or
programs and different machines to talk

64
00:01:18,399 --> 00:01:18,409
programs and different machines to talk
 

65
00:01:18,409 --> 00:01:22,600
programs and different machines to talk
to each other unlike C++ go is type safe

66
00:01:22,600 --> 00:01:22,610
to each other unlike C++ go is type safe
 

67
00:01:22,610 --> 00:01:25,090
to each other unlike C++ go is type safe
and memory safe that is it's pretty hard

68
00:01:25,090 --> 00:01:25,100
and memory safe that is it's pretty hard
 

69
00:01:25,100 --> 00:01:27,609
and memory safe that is it's pretty hard
to write a program that due to a bug

70
00:01:27,609 --> 00:01:27,619
to write a program that due to a bug
 

71
00:01:27,619 --> 00:01:29,170
to write a program that due to a bug
scribbles over some random piece of

72
00:01:29,170 --> 00:01:29,180
scribbles over some random piece of
 

73
00:01:29,180 --> 00:01:31,330
scribbles over some random piece of
memory and then causes the program to do

74
00:01:31,330 --> 00:01:31,340
memory and then causes the program to do
 

75
00:01:31,340 --> 00:01:34,779
memory and then causes the program to do
mysterious things and that just

76
00:01:34,779 --> 00:01:34,789
mysterious things and that just
 

77
00:01:34,789 --> 00:01:36,310
mysterious things and that just
eliminates a big class of bugs similarly

78
00:01:36,310 --> 00:01:36,320
eliminates a big class of bugs similarly
 

79
00:01:36,320 --> 00:01:39,670
eliminates a big class of bugs similarly
it's garbage collected which means you

80
00:01:39,670 --> 00:01:39,680
it's garbage collected which means you
 

81
00:01:39,680 --> 00:01:41,859
it's garbage collected which means you
never in danger of priam the same memory

82
00:01:41,859 --> 00:01:41,869
never in danger of priam the same memory
 

83
00:01:41,869 --> 00:01:44,499
never in danger of priam the same memory
twice or free memory that's still in use

84
00:01:44,499 --> 00:01:44,509
twice or free memory that's still in use
 

85
00:01:44,509 --> 00:01:46,330
twice or free memory that's still in use
or something the garbage vector just

86
00:01:46,330 --> 00:01:46,340
or something the garbage vector just
 

87
00:01:46,340 --> 00:01:48,849
or something the garbage vector just
frees things when they stop being used

88
00:01:48,849 --> 00:01:48,859
frees things when they stop being used
 

89
00:01:48,859 --> 00:01:51,910
frees things when they stop being used
and one thing it's maybe not obvious

90
00:01:51,910 --> 00:01:51,920
and one thing it's maybe not obvious
 

91
00:01:51,920 --> 00:01:54,819
and one thing it's maybe not obvious
until you played around with just this

92
00:01:54,819 --> 00:01:54,829
until you played around with just this
 

93
00:01:54,829 --> 00:01:56,709
until you played around with just this
kind of programming before but the

94
00:01:56,709 --> 00:01:56,719
kind of programming before but the
 

95
00:01:56,719 --> 00:01:58,630
kind of programming before but the
combination of threads and garbage

96
00:01:58,630 --> 00:01:58,640
combination of threads and garbage
 

97
00:01:58,640 --> 00:02:01,870
combination of threads and garbage
collection is particularly important one

98
00:02:01,870 --> 00:02:01,880
collection is particularly important one
 

99
00:02:01,880 --> 00:02:03,190
collection is particularly important one
of the things that goes wrong in a non

100
00:02:03,190 --> 00:02:03,200
of the things that goes wrong in a non
 

101
00:02:03,200 --> 00:02:06,099
of the things that goes wrong in a non
garbage collected language like C++ if

102
00:02:06,099 --> 00:02:06,109
garbage collected language like C++ if
 

103
00:02:06,109 --> 00:02:08,889
garbage collected language like C++ if
you use threads is that it's always a

104
00:02:08,889 --> 00:02:08,899
you use threads is that it's always a
 

105
00:02:08,899 --> 00:02:10,680
you use threads is that it's always a
bit of a puzzle and requires a bunch of

106
00:02:10,680 --> 00:02:10,690
bit of a puzzle and requires a bunch of
 

107
00:02:10,690 --> 00:02:13,420
bit of a puzzle and requires a bunch of
bookkeeping to figure out when the last

108
00:02:13,420 --> 00:02:13,430
bookkeeping to figure out when the last
 

109
00:02:13,430 --> 00:02:14,180
bookkeeping to figure out when the last
thread

110
00:02:14,180 --> 00:02:14,190
thread
 

111
00:02:14,190 --> 00:02:15,650
thread
that's using a shared object has

112
00:02:15,650 --> 00:02:15,660
that's using a shared object has
 

113
00:02:15,660 --> 00:02:17,330
that's using a shared object has
finished using that object because only

114
00:02:17,330 --> 00:02:17,340
finished using that object because only
 

115
00:02:17,340 --> 00:02:19,520
finished using that object because only
then can you free the object as you end

116
00:02:19,520 --> 00:02:19,530
then can you free the object as you end
 

117
00:02:19,530 --> 00:02:20,900
then can you free the object as you end
up writing quite a bit of coat it's like

118
00:02:20,900 --> 00:02:20,910
up writing quite a bit of coat it's like
 

119
00:02:20,910 --> 00:02:22,610
up writing quite a bit of coat it's like
manually the programmer it's about a

120
00:02:22,610 --> 00:02:22,620
manually the programmer it's about a
 

121
00:02:22,620 --> 00:02:24,470
manually the programmer it's about a
bunch of code to manually you know do

122
00:02:24,470 --> 00:02:24,480
bunch of code to manually you know do
 

123
00:02:24,480 --> 00:02:26,570
bunch of code to manually you know do
reference counting or something in order

124
00:02:26,570 --> 00:02:26,580
reference counting or something in order
 

125
00:02:26,580 --> 00:02:28,460
reference counting or something in order
to figure out you know when the last

126
00:02:28,460 --> 00:02:28,470
to figure out you know when the last
 

127
00:02:28,470 --> 00:02:30,020
to figure out you know when the last
thread stopped using an object and

128
00:02:30,020 --> 00:02:30,030
thread stopped using an object and
 

129
00:02:30,030 --> 00:02:32,450
thread stopped using an object and
that's just a pain and that problem

130
00:02:32,450 --> 00:02:32,460
that's just a pain and that problem
 

131
00:02:32,460 --> 00:02:34,700
that's just a pain and that problem
completely goes away if you use garbage

132
00:02:34,700 --> 00:02:34,710
completely goes away if you use garbage
 

133
00:02:34,710 --> 00:02:36,550
completely goes away if you use garbage
collection like we haven't go

134
00:02:36,550 --> 00:02:36,560
collection like we haven't go
 

135
00:02:36,560 --> 00:02:39,380
collection like we haven't go
and finally the language is simple much

136
00:02:39,380 --> 00:02:39,390
and finally the language is simple much
 

137
00:02:39,390 --> 00:02:41,450
and finally the language is simple much
simpler than C++ one of the problems

138
00:02:41,450 --> 00:02:41,460
simpler than C++ one of the problems
 

139
00:02:41,460 --> 00:02:44,630
simpler than C++ one of the problems
with using C++ is that often if you made

140
00:02:44,630 --> 00:02:44,640
with using C++ is that often if you made
 

141
00:02:44,640 --> 00:02:47,240
with using C++ is that often if you made
an error you know maybe even just a typo

142
00:02:47,240 --> 00:02:47,250
an error you know maybe even just a typo
 

143
00:02:47,250 --> 00:02:51,410
an error you know maybe even just a typo
the the error message you get back from

144
00:02:51,410 --> 00:02:51,420
the the error message you get back from
 

145
00:02:51,420 --> 00:02:53,720
the the error message you get back from
the compiler is so complicated that in

146
00:02:53,720 --> 00:02:53,730
the compiler is so complicated that in
 

147
00:02:53,730 --> 00:02:56,150
the compiler is so complicated that in
C++ it's usually not worth trying to

148
00:02:56,150 --> 00:02:56,160
C++ it's usually not worth trying to
 

149
00:02:56,160 --> 00:02:57,500
C++ it's usually not worth trying to
figure out what the error message meant

150
00:02:57,500 --> 00:02:57,510
figure out what the error message meant
 

151
00:02:57,510 --> 00:02:59,510
figure out what the error message meant
and I find it's always just much quicker

152
00:02:59,510 --> 00:02:59,520
and I find it's always just much quicker
 

153
00:02:59,520 --> 00:03:01,460
and I find it's always just much quicker
to go look at the line number and try to

154
00:03:01,460 --> 00:03:01,470
to go look at the line number and try to
 

155
00:03:01,470 --> 00:03:02,660
to go look at the line number and try to
guess what the error must have been

156
00:03:02,660 --> 00:03:02,670
guess what the error must have been
 

157
00:03:02,670 --> 00:03:04,160
guess what the error must have been
because the language is far too

158
00:03:04,160 --> 00:03:04,170
because the language is far too
 

159
00:03:04,170 --> 00:03:04,790
because the language is far too
complicated

160
00:03:04,790 --> 00:03:04,800
complicated
 

161
00:03:04,800 --> 00:03:07,130
complicated
whereas go is you know probably doesn't

162
00:03:07,130 --> 00:03:07,140
whereas go is you know probably doesn't
 

163
00:03:07,140 --> 00:03:09,700
whereas go is you know probably doesn't
have a lot of people's favorite features

164
00:03:09,700 --> 00:03:09,710
have a lot of people's favorite features
 

165
00:03:09,710 --> 00:03:11,570
have a lot of people's favorite features
but it's relatively straightforward

166
00:03:11,570 --> 00:03:11,580
but it's relatively straightforward
 

167
00:03:11,580 --> 00:03:14,930
but it's relatively straightforward
language okay so at this point you're

168
00:03:14,930 --> 00:03:14,940
language okay so at this point you're
 

169
00:03:14,940 --> 00:03:17,240
language okay so at this point you're
both on the tutorial if you're looking

170
00:03:17,240 --> 00:03:17,250
both on the tutorial if you're looking
 

171
00:03:17,250 --> 00:03:19,280
both on the tutorial if you're looking
for sort of you know what to look at

172
00:03:19,280 --> 00:03:19,290
for sort of you know what to look at
 

173
00:03:19,290 --> 00:03:21,620
for sort of you know what to look at
next to learn about the language a good

174
00:03:21,620 --> 00:03:21,630
next to learn about the language a good
 

175
00:03:21,630 --> 00:03:23,180
next to learn about the language a good
place to look is the document titled

176
00:03:23,180 --> 00:03:23,190
place to look is the document titled
 

177
00:03:23,190 --> 00:03:25,580
place to look is the document titled
effective go which you know you can find

178
00:03:25,580 --> 00:03:25,590
effective go which you know you can find
 

179
00:03:25,590 --> 00:03:30,380
effective go which you know you can find
by searching the web all right the first

180
00:03:30,380 --> 00:03:30,390
by searching the web all right the first
 

181
00:03:30,390 --> 00:03:33,100
by searching the web all right the first
thing I want to talk about is threads

182
00:03:33,100 --> 00:03:33,110
thing I want to talk about is threads
 

183
00:03:33,110 --> 00:03:35,930
thing I want to talk about is threads
the reason why we care a lot about

184
00:03:35,930 --> 00:03:35,940
the reason why we care a lot about
 

185
00:03:35,940 --> 00:03:38,990
the reason why we care a lot about
threads in this course is that threads

186
00:03:38,990 --> 00:03:39,000
threads in this course is that threads
 

187
00:03:39,000 --> 00:03:41,449
threads in this course is that threads
are the sort of main tool we're going to

188
00:03:41,449 --> 00:03:41,459
are the sort of main tool we're going to
 

189
00:03:41,459 --> 00:03:44,360
are the sort of main tool we're going to
be using to manage concurrency in

190
00:03:44,360 --> 00:03:44,370
be using to manage concurrency in
 

191
00:03:44,370 --> 00:03:47,330
be using to manage concurrency in
programs and concurrency is a particular

192
00:03:47,330 --> 00:03:47,340
programs and concurrency is a particular
 

193
00:03:47,340 --> 00:03:49,910
programs and concurrency is a particular
interest in distributed programming

194
00:03:49,910 --> 00:03:49,920
interest in distributed programming
 

195
00:03:49,920 --> 00:03:52,430
interest in distributed programming
because it's often the case that one

196
00:03:52,430 --> 00:03:52,440
because it's often the case that one
 

197
00:03:52,440 --> 00:03:53,810
because it's often the case that one
program actually needs to talk to a

198
00:03:53,810 --> 00:03:53,820
program actually needs to talk to a
 

199
00:03:53,820 --> 00:03:55,880
program actually needs to talk to a
bunch of other computers you know client

200
00:03:55,880 --> 00:03:55,890
bunch of other computers you know client
 

201
00:03:55,890 --> 00:03:58,220
bunch of other computers you know client
may talk to many servers or a server may

202
00:03:58,220 --> 00:03:58,230
may talk to many servers or a server may
 

203
00:03:58,230 --> 00:04:00,290
may talk to many servers or a server may
be serving requests at the same time on

204
00:04:00,290 --> 00:04:00,300
be serving requests at the same time on
 

205
00:04:00,300 --> 00:04:02,420
be serving requests at the same time on
behalf of many different clients and so

206
00:04:02,420 --> 00:04:02,430
behalf of many different clients and so
 

207
00:04:02,430 --> 00:04:04,820
behalf of many different clients and so
we need a way to say oh you know I'm my

208
00:04:04,820 --> 00:04:04,830
we need a way to say oh you know I'm my
 

209
00:04:04,830 --> 00:04:06,020
we need a way to say oh you know I'm my
program really has seven different

210
00:04:06,020 --> 00:04:06,030
program really has seven different
 

211
00:04:06,030 --> 00:04:07,400
program really has seven different
things going on because it's talking to

212
00:04:07,400 --> 00:04:07,410
things going on because it's talking to
 

213
00:04:07,410 --> 00:04:10,100
things going on because it's talking to
seven different clients and I want a

214
00:04:10,100 --> 00:04:10,110
seven different clients and I want a
 

215
00:04:10,110 --> 00:04:12,440
seven different clients and I want a
simple way to allow it to do these seven

216
00:04:12,440 --> 00:04:12,450
simple way to allow it to do these seven
 

217
00:04:12,450 --> 00:04:14,449
simple way to allow it to do these seven
different things you know without too

218
00:04:14,449 --> 00:04:14,459
different things you know without too
 

219
00:04:14,459 --> 00:04:16,849
different things you know without too
much complex programming I mean sort of

220
00:04:16,849 --> 00:04:16,859
much complex programming I mean sort of
 

221
00:04:16,859 --> 00:04:19,580
much complex programming I mean sort of
thrust threads are the answer so these

222
00:04:19,580 --> 00:04:19,590
thrust threads are the answer so these
 

223
00:04:19,590 --> 00:04:21,620
thrust threads are the answer so these
are the things that the go documentation

224
00:04:21,620 --> 00:04:21,630
are the things that the go documentation
 

225
00:04:21,630 --> 00:04:24,409
are the things that the go documentation
calls go routines which I call threads

226
00:04:24,409 --> 00:04:24,419
calls go routines which I call threads
 

227
00:04:24,419 --> 00:04:26,779
calls go routines which I call threads
they're go routines are really this same

228
00:04:26,779 --> 00:04:26,789
they're go routines are really this same
 

229
00:04:26,789 --> 00:04:27,870
they're go routines are really this same
as what everybody else calls

230
00:04:27,870 --> 00:04:27,880
as what everybody else calls
 

231
00:04:27,880 --> 00:04:32,550
as what everybody else calls
Red's so the way to think of threads is

232
00:04:32,550 --> 00:04:32,560
Red's so the way to think of threads is
 

233
00:04:32,560 --> 00:04:36,590
Red's so the way to think of threads is
that you have a program of one program

234
00:04:36,590 --> 00:04:36,600
that you have a program of one program
 

235
00:04:36,600 --> 00:04:43,110
that you have a program of one program
and one address space I'm gonna draw a

236
00:04:43,110 --> 00:04:43,120
and one address space I'm gonna draw a
 

237
00:04:43,120 --> 00:04:46,050
and one address space I'm gonna draw a
box to sort of denote an address space

238
00:04:46,050 --> 00:04:46,060
box to sort of denote an address space
 

239
00:04:46,060 --> 00:04:48,240
box to sort of denote an address space
and within that address space in a

240
00:04:48,240 --> 00:04:48,250
and within that address space in a
 

241
00:04:48,250 --> 00:04:51,510
and within that address space in a
serial program without threads you just

242
00:04:51,510 --> 00:04:51,520
serial program without threads you just
 

243
00:04:51,520 --> 00:04:54,540
serial program without threads you just
have one thread of execution executing

244
00:04:54,540 --> 00:04:54,550
have one thread of execution executing
 

245
00:04:54,550 --> 00:04:57,030
have one thread of execution executing
code in that address space one program

246
00:04:57,030 --> 00:04:57,040
code in that address space one program
 

247
00:04:57,040 --> 00:05:00,090
code in that address space one program
counter one set of registers one stack

248
00:05:00,090 --> 00:05:00,100
counter one set of registers one stack
 

249
00:05:00,100 --> 00:05:02,070
counter one set of registers one stack
that are sort of describing the current

250
00:05:02,070 --> 00:05:02,080
that are sort of describing the current
 

251
00:05:02,080 --> 00:05:04,170
that are sort of describing the current
state of the execution in a threaded

252
00:05:04,170 --> 00:05:04,180
state of the execution in a threaded
 

253
00:05:04,180 --> 00:05:06,150
state of the execution in a threaded
program like a go program you could have

254
00:05:06,150 --> 00:05:06,160
program like a go program you could have
 

255
00:05:06,160 --> 00:05:09,180
program like a go program you could have
multiple threads and you know I got raw

256
00:05:09,180 --> 00:05:09,190
multiple threads and you know I got raw
 

257
00:05:09,190 --> 00:05:10,860
multiple threads and you know I got raw
it as multiple squiggly lines and when

258
00:05:10,860 --> 00:05:10,870
it as multiple squiggly lines and when
 

259
00:05:10,870 --> 00:05:13,470
it as multiple squiggly lines and when
each line represents really is a

260
00:05:13,470 --> 00:05:13,480
each line represents really is a
 

261
00:05:13,480 --> 00:05:16,110
each line represents really is a
separate if the especially if the

262
00:05:16,110 --> 00:05:16,120
separate if the especially if the
 

263
00:05:16,120 --> 00:05:17,430
separate if the especially if the
threads are executing at the same time

264
00:05:17,430 --> 00:05:17,440
threads are executing at the same time
 

265
00:05:17,440 --> 00:05:19,620
threads are executing at the same time
but a separate program counter a

266
00:05:19,620 --> 00:05:19,630
but a separate program counter a
 

267
00:05:19,630 --> 00:05:21,540
but a separate program counter a
separate set of registers and a separate

268
00:05:21,540 --> 00:05:21,550
separate set of registers and a separate
 

269
00:05:21,550 --> 00:05:24,210
separate set of registers and a separate
stack for each of the threads so that

270
00:05:24,210 --> 00:05:24,220
stack for each of the threads so that
 

271
00:05:24,220 --> 00:05:26,220
stack for each of the threads so that
they can have a sort of their own thread

272
00:05:26,220 --> 00:05:26,230
they can have a sort of their own thread
 

273
00:05:26,230 --> 00:05:28,320
they can have a sort of their own thread
of control and be executing each thread

274
00:05:28,320 --> 00:05:28,330
of control and be executing each thread
 

275
00:05:28,330 --> 00:05:31,800
of control and be executing each thread
in a different part of the program and

276
00:05:31,800 --> 00:05:31,810
in a different part of the program and
 

277
00:05:31,810 --> 00:05:33,300
in a different part of the program and
so hidden here is that for every stack

278
00:05:33,300 --> 00:05:33,310
so hidden here is that for every stack
 

279
00:05:33,310 --> 00:05:35,520
so hidden here is that for every stack
now there's a syrupy thread there's a

280
00:05:35,520 --> 00:05:35,530
now there's a syrupy thread there's a
 

281
00:05:35,530 --> 00:05:41,160
now there's a syrupy thread there's a
stack that it's executing on the stacks

282
00:05:41,160 --> 00:05:41,170
stack that it's executing on the stacks
 

283
00:05:41,170 --> 00:05:44,520
stack that it's executing on the stacks
are actually in in the one address space

284
00:05:44,520 --> 00:05:44,530
are actually in in the one address space
 

285
00:05:44,530 --> 00:05:46,710
are actually in in the one address space
of the program so even though each stack

286
00:05:46,710 --> 00:05:46,720
of the program so even though each stack
 

287
00:05:46,720 --> 00:05:47,850
of the program so even though each stack
each thread has its own stack

288
00:05:47,850 --> 00:05:47,860
each thread has its own stack
 

289
00:05:47,860 --> 00:05:51,210
each thread has its own stack
technically the they're all in the same

290
00:05:51,210 --> 00:05:51,220
technically the they're all in the same
 

291
00:05:51,220 --> 00:05:52,230
technically the they're all in the same
address space and different threads

292
00:05:52,230 --> 00:05:52,240
address space and different threads
 

293
00:05:52,240 --> 00:05:53,790
address space and different threads
could refer to each other stacks if they

294
00:05:53,790 --> 00:05:53,800
could refer to each other stacks if they
 

295
00:05:53,800 --> 00:05:55,950
could refer to each other stacks if they
knew the right addresses although you

296
00:05:55,950 --> 00:05:55,960
knew the right addresses although you
 

297
00:05:55,960 --> 00:05:59,040
knew the right addresses although you
typically don't do that and then go when

298
00:05:59,040 --> 00:05:59,050
typically don't do that and then go when
 

299
00:05:59,050 --> 00:06:01,500
typically don't do that and then go when
you even the main program you know when

300
00:06:01,500 --> 00:06:01,510
you even the main program you know when
 

301
00:06:01,510 --> 00:06:02,880
you even the main program you know when
you first start up the program and it

302
00:06:02,880 --> 00:06:02,890
you first start up the program and it
 

303
00:06:02,890 --> 00:06:05,100
you first start up the program and it
runs in main that's also it's just a go

304
00:06:05,100 --> 00:06:05,110
runs in main that's also it's just a go
 

305
00:06:05,110 --> 00:06:06,480
runs in main that's also it's just a go
routine and can do all the things that

306
00:06:06,480 --> 00:06:06,490
routine and can do all the things that
 

307
00:06:06,490 --> 00:06:14,430
routine and can do all the things that
go teens can do all right so as I

308
00:06:14,430 --> 00:06:14,440
go teens can do all right so as I
 

309
00:06:14,440 --> 00:06:17,840
go teens can do all right so as I
mentioned one of the big reasons is to

310
00:06:17,840 --> 00:06:17,850
mentioned one of the big reasons is to
 

311
00:06:17,850 --> 00:06:21,720
mentioned one of the big reasons is to
allow different parts of the program to

312
00:06:21,720 --> 00:06:21,730
allow different parts of the program to
 

313
00:06:21,730 --> 00:06:25,020
allow different parts of the program to
sort of be in its own point in in a

314
00:06:25,020 --> 00:06:25,030
sort of be in its own point in in a
 

315
00:06:25,030 --> 00:06:27,540
sort of be in its own point in in a
different activity so I usually refer to

316
00:06:27,540 --> 00:06:27,550
different activity so I usually refer to
 

317
00:06:27,550 --> 00:06:31,500
different activity so I usually refer to
that as IO concurrency for historical

318
00:06:31,500 --> 00:06:31,510
that as IO concurrency for historical
 

319
00:06:31,510 --> 00:06:36,570
that as IO concurrency for historical
reasons and the reason I call it IO

320
00:06:36,570 --> 00:06:36,580
reasons and the reason I call it IO
 

321
00:06:36,580 --> 00:06:38,040
reasons and the reason I call it IO
concurrency is that in the old days

322
00:06:38,040 --> 00:06:38,050
concurrency is that in the old days
 

323
00:06:38,050 --> 00:06:39,570
concurrency is that in the old days
where this first came up is that oh you

324
00:06:39,570 --> 00:06:39,580
where this first came up is that oh you
 

325
00:06:39,580 --> 00:06:41,250
where this first came up is that oh you
might have one thread that's waiting to

326
00:06:41,250 --> 00:06:41,260
might have one thread that's waiting to
 

327
00:06:41,260 --> 00:06:41,460
might have one thread that's waiting to
read

328
00:06:41,460 --> 00:06:41,470
read
 

329
00:06:41,470 --> 00:06:43,230
read
from the disk and while it's waiting to

330
00:06:43,230 --> 00:06:43,240
from the disk and while it's waiting to
 

331
00:06:43,240 --> 00:06:44,400
from the disk and while it's waiting to
reach from the disk you'd like to have a

332
00:06:44,400 --> 00:06:44,410
reach from the disk you'd like to have a
 

333
00:06:44,410 --> 00:06:46,320
reach from the disk you'd like to have a
second thread that maybe can compute or

334
00:06:46,320 --> 00:06:46,330
second thread that maybe can compute or
 

335
00:06:46,330 --> 00:06:48,990
second thread that maybe can compute or
read somewhere else in the disk or send

336
00:06:48,990 --> 00:06:49,000
read somewhere else in the disk or send
 

337
00:06:49,000 --> 00:06:50,550
read somewhere else in the disk or send
a message in the network and wait for

338
00:06:50,550 --> 00:06:50,560
a message in the network and wait for
 

339
00:06:50,560 --> 00:06:54,480
a message in the network and wait for
reply so and so I open currencies one of

340
00:06:54,480 --> 00:06:54,490
reply so and so I open currencies one of
 

341
00:06:54,490 --> 00:06:57,240
reply so and so I open currencies one of
the things that threads by you for us it

342
00:06:57,240 --> 00:06:57,250
the things that threads by you for us it
 

343
00:06:57,250 --> 00:07:00,180
the things that threads by you for us it
would usually mean I can I open currency

344
00:07:00,180 --> 00:07:00,190
would usually mean I can I open currency
 

345
00:07:00,190 --> 00:07:01,680
would usually mean I can I open currency
we usually mean I can have one program

346
00:07:01,680 --> 00:07:01,690
we usually mean I can have one program
 

347
00:07:01,690 --> 00:07:04,080
we usually mean I can have one program
that has launched or removed procedure

348
00:07:04,080 --> 00:07:04,090
that has launched or removed procedure
 

349
00:07:04,090 --> 00:07:06,000
that has launched or removed procedure
calls requests to different servers on

350
00:07:06,000 --> 00:07:06,010
calls requests to different servers on
 

351
00:07:06,010 --> 00:07:08,130
calls requests to different servers on
the network and is waiting for many

352
00:07:08,130 --> 00:07:08,140
the network and is waiting for many
 

353
00:07:08,140 --> 00:07:10,560
the network and is waiting for many
replies at the same time that's how

354
00:07:10,560 --> 00:07:10,570
replies at the same time that's how
 

355
00:07:10,570 --> 00:07:13,170
replies at the same time that's how
it'll come up for us and you know the

356
00:07:13,170 --> 00:07:13,180
it'll come up for us and you know the
 

357
00:07:13,180 --> 00:07:15,030
it'll come up for us and you know the
way you would do that with threads is

358
00:07:15,030 --> 00:07:15,040
way you would do that with threads is
 

359
00:07:15,040 --> 00:07:17,100
way you would do that with threads is
that you would create one thread for

360
00:07:17,100 --> 00:07:17,110
that you would create one thread for
 

361
00:07:17,110 --> 00:07:18,780
that you would create one thread for
each of the remote procedure calls that

362
00:07:18,780 --> 00:07:18,790
each of the remote procedure calls that
 

363
00:07:18,790 --> 00:07:21,180
each of the remote procedure calls that
you wanted to launch that thread would

364
00:07:21,180 --> 00:07:21,190
you wanted to launch that thread would
 

365
00:07:21,190 --> 00:07:23,520
you wanted to launch that thread would
have code that you know sent the remote

366
00:07:23,520 --> 00:07:23,530
have code that you know sent the remote
 

367
00:07:23,530 --> 00:07:26,370
have code that you know sent the remote
procedure call request message and sort

368
00:07:26,370 --> 00:07:26,380
procedure call request message and sort
 

369
00:07:26,380 --> 00:07:27,810
procedure call request message and sort
of waited at this point in the thread

370
00:07:27,810 --> 00:07:27,820
of waited at this point in the thread
 

371
00:07:27,820 --> 00:07:29,310
of waited at this point in the thread
and then finally when the reply came

372
00:07:29,310 --> 00:07:29,320
and then finally when the reply came
 

373
00:07:29,320 --> 00:07:31,320
and then finally when the reply came
back the thread would continue executing

374
00:07:31,320 --> 00:07:31,330
back the thread would continue executing
 

375
00:07:31,330 --> 00:07:33,210
back the thread would continue executing
and using threads allows us to have

376
00:07:33,210 --> 00:07:33,220
and using threads allows us to have
 

377
00:07:33,220 --> 00:07:34,980
and using threads allows us to have
multiple threads that all launch

378
00:07:34,980 --> 00:07:34,990
multiple threads that all launch
 

379
00:07:34,990 --> 00:07:36,240
multiple threads that all launch
requests into the network at the same

380
00:07:36,240 --> 00:07:36,250
requests into the network at the same
 

381
00:07:36,250 --> 00:07:38,430
requests into the network at the same
time they all wait or they don't have to

382
00:07:38,430 --> 00:07:38,440
time they all wait or they don't have to
 

383
00:07:38,440 --> 00:07:40,680
time they all wait or they don't have to
do it at the same time they can you know

384
00:07:40,680 --> 00:07:40,690
do it at the same time they can you know
 

385
00:07:40,690 --> 00:07:41,880
do it at the same time they can you know
execute the different parts of this

386
00:07:41,880 --> 00:07:41,890
execute the different parts of this
 

387
00:07:41,890 --> 00:07:43,080
execute the different parts of this
whenever they feel like it

388
00:07:43,080 --> 00:07:43,090
whenever they feel like it
 

389
00:07:43,090 --> 00:07:45,360
whenever they feel like it
so that's i/o concurrency sort of

390
00:07:45,360 --> 00:07:45,370
so that's i/o concurrency sort of
 

391
00:07:45,370 --> 00:07:49,710
so that's i/o concurrency sort of
overlapping of the progress of different

392
00:07:49,710 --> 00:07:49,720
overlapping of the progress of different
 

393
00:07:49,720 --> 00:07:53,940
overlapping of the progress of different
activities and allowing one activity is

394
00:07:53,940 --> 00:07:53,950
activities and allowing one activity is
 

395
00:07:53,950 --> 00:07:57,050
activities and allowing one activity is
waiting other activities can proceed

396
00:07:57,050 --> 00:07:57,060
waiting other activities can proceed
 

397
00:07:57,060 --> 00:08:00,320
waiting other activities can proceed
another big reason to use threads is

398
00:08:00,320 --> 00:08:00,330
another big reason to use threads is
 

399
00:08:00,330 --> 00:08:02,730
another big reason to use threads is
multi-core parallelism which I'll just

400
00:08:02,730 --> 00:08:02,740
multi-core parallelism which I'll just
 

401
00:08:02,740 --> 00:08:08,670
multi-core parallelism which I'll just
call parallelism and here the thing

402
00:08:08,670 --> 00:08:08,680
call parallelism and here the thing
 

403
00:08:08,680 --> 00:08:10,260
call parallelism and here the thing
where we'd be trying to achieve with

404
00:08:10,260 --> 00:08:10,270
where we'd be trying to achieve with
 

405
00:08:10,270 --> 00:08:11,880
where we'd be trying to achieve with
threads is if you have a multi-core

406
00:08:11,880 --> 00:08:11,890
threads is if you have a multi-core
 

407
00:08:11,890 --> 00:08:13,530
threads is if you have a multi-core
machine like I'm sure all of you do in

408
00:08:13,530 --> 00:08:13,540
machine like I'm sure all of you do in
 

409
00:08:13,540 --> 00:08:15,750
machine like I'm sure all of you do in
your laptops if you have a sort of

410
00:08:15,750 --> 00:08:15,760
your laptops if you have a sort of
 

411
00:08:15,760 --> 00:08:17,460
your laptops if you have a sort of
compute heavy job that needs a lot of

412
00:08:17,460 --> 00:08:17,470
compute heavy job that needs a lot of
 

413
00:08:17,470 --> 00:08:19,140
compute heavy job that needs a lot of
CPU cycles wouldn't it be nice if you

414
00:08:19,140 --> 00:08:19,150
CPU cycles wouldn't it be nice if you
 

415
00:08:19,150 --> 00:08:21,050
CPU cycles wouldn't it be nice if you
could have one program that could use

416
00:08:21,050 --> 00:08:21,060
could have one program that could use
 

417
00:08:21,060 --> 00:08:23,850
could have one program that could use
CPU cycles on all of the cores of the

418
00:08:23,850 --> 00:08:23,860
CPU cycles on all of the cores of the
 

419
00:08:23,860 --> 00:08:25,620
CPU cycles on all of the cores of the
machine and indeed if you write a

420
00:08:25,620 --> 00:08:25,630
machine and indeed if you write a
 

421
00:08:25,630 --> 00:08:27,570
machine and indeed if you write a
multi-threaded go if you launch multiple

422
00:08:27,570 --> 00:08:27,580
multi-threaded go if you launch multiple
 

423
00:08:27,580 --> 00:08:30,030
multi-threaded go if you launch multiple
go routines and go and they do something

424
00:08:30,030 --> 00:08:30,040
go routines and go and they do something
 

425
00:08:30,040 --> 00:08:31,560
go routines and go and they do something
computer intensive like sit there in a

426
00:08:31,560 --> 00:08:31,570
computer intensive like sit there in a
 

427
00:08:31,570 --> 00:08:33,930
computer intensive like sit there in a
loop and you know compute digits of pi

428
00:08:33,930 --> 00:08:33,940
loop and you know compute digits of pi
 

429
00:08:33,940 --> 00:08:36,659
loop and you know compute digits of pi
or something then up to the limit of the

430
00:08:36,659 --> 00:08:36,669
or something then up to the limit of the
 

431
00:08:36,669 --> 00:08:38,510
or something then up to the limit of the
number of cores in the physical machine

432
00:08:38,510 --> 00:08:38,520
number of cores in the physical machine
 

433
00:08:38,520 --> 00:08:41,250
number of cores in the physical machine
your threads will run truly in parallel

434
00:08:41,250 --> 00:08:41,260
your threads will run truly in parallel
 

435
00:08:41,260 --> 00:08:43,680
your threads will run truly in parallel
and if you launch you know two threads

436
00:08:43,680 --> 00:08:43,690
and if you launch you know two threads
 

437
00:08:43,690 --> 00:08:45,740
and if you launch you know two threads
instead of one you'll get twice as many

438
00:08:45,740 --> 00:08:45,750
instead of one you'll get twice as many
 

439
00:08:45,750 --> 00:08:48,360
instead of one you'll get twice as many
you'll be able to use twice as many CPU

440
00:08:48,360 --> 00:08:48,370
you'll be able to use twice as many CPU
 

441
00:08:48,370 --> 00:08:51,060
you'll be able to use twice as many CPU
cycles per second so this is very

442
00:08:51,060 --> 00:08:51,070
cycles per second so this is very
 

443
00:08:51,070 --> 00:08:53,160
cycles per second so this is very
important to some people it's not a big

444
00:08:53,160 --> 00:08:53,170
important to some people it's not a big
 

445
00:08:53,170 --> 00:08:54,730
important to some people it's not a big
deal on this course

446
00:08:54,730 --> 00:08:54,740
deal on this course
 

447
00:08:54,740 --> 00:08:57,430
deal on this course
be it's rare that we'll sort of think

448
00:08:57,430 --> 00:08:57,440
be it's rare that we'll sort of think
 

449
00:08:57,440 --> 00:08:59,470
be it's rare that we'll sort of think
specifically about this kind of

450
00:08:59,470 --> 00:08:59,480
specifically about this kind of
 

451
00:08:59,480 --> 00:09:01,630
specifically about this kind of
parallelism in the real world though of

452
00:09:01,630 --> 00:09:01,640
parallelism in the real world though of
 

453
00:09:01,640 --> 00:09:05,380
parallelism in the real world though of
building things like servers to form

454
00:09:05,380 --> 00:09:05,390
building things like servers to form
 

455
00:09:05,390 --> 00:09:06,880
building things like servers to form
parts of the distributed systems it can

456
00:09:06,880 --> 00:09:06,890
parts of the distributed systems it can
 

457
00:09:06,890 --> 00:09:09,760
parts of the distributed systems it can
sometimes be extremely important to be

458
00:09:09,760 --> 00:09:09,770
sometimes be extremely important to be
 

459
00:09:09,770 --> 00:09:11,770
sometimes be extremely important to be
able to have the server be able to run

460
00:09:11,770 --> 00:09:11,780
able to have the server be able to run
 

461
00:09:11,780 --> 00:09:13,540
able to have the server be able to run
threads and harness the CPU power of a

462
00:09:13,540 --> 00:09:13,550
threads and harness the CPU power of a
 

463
00:09:13,550 --> 00:09:15,130
threads and harness the CPU power of a
lot of cores just because the load from

464
00:09:15,130 --> 00:09:15,140
lot of cores just because the load from
 

465
00:09:15,140 --> 00:09:18,730
lot of cores just because the load from
clients can often be pretty high okay so

466
00:09:18,730 --> 00:09:18,740
clients can often be pretty high okay so
 

467
00:09:18,740 --> 00:09:22,840
clients can often be pretty high okay so
parallelism is a second reason why

468
00:09:22,840 --> 00:09:22,850
parallelism is a second reason why
 

469
00:09:22,850 --> 00:09:25,300
parallelism is a second reason why
threads are quite a bit interested in

470
00:09:25,300 --> 00:09:25,310
threads are quite a bit interested in
 

471
00:09:25,310 --> 00:09:27,160
threads are quite a bit interested in
distributed systems and a third reason

472
00:09:27,160 --> 00:09:27,170
distributed systems and a third reason
 

473
00:09:27,170 --> 00:09:29,530
distributed systems and a third reason
which is maybe a little bit less

474
00:09:29,530 --> 00:09:29,540
which is maybe a little bit less
 

475
00:09:29,540 --> 00:09:32,770
which is maybe a little bit less
important is there's some there's times

476
00:09:32,770 --> 00:09:32,780
important is there's some there's times
 

477
00:09:32,780 --> 00:09:35,500
important is there's some there's times
when you really just want to be able to

478
00:09:35,500 --> 00:09:35,510
when you really just want to be able to
 

479
00:09:35,510 --> 00:09:38,620
when you really just want to be able to
do something in the background or you

480
00:09:38,620 --> 00:09:38,630
do something in the background or you
 

481
00:09:38,630 --> 00:09:39,790
do something in the background or you
know there's just something you need to

482
00:09:39,790 --> 00:09:39,800
know there's just something you need to
 

483
00:09:39,800 --> 00:09:42,760
know there's just something you need to
do periodically and you don't want to

484
00:09:42,760 --> 00:09:42,770
do periodically and you don't want to
 

485
00:09:42,770 --> 00:09:45,250
do periodically and you don't want to
have to sort of in the main part of your

486
00:09:45,250 --> 00:09:45,260
have to sort of in the main part of your
 

487
00:09:45,260 --> 00:09:47,410
have to sort of in the main part of your
program sort of insert checks to say

488
00:09:47,410 --> 00:09:47,420
program sort of insert checks to say
 

489
00:09:47,420 --> 00:09:49,180
program sort of insert checks to say
well should I be doing this things that

490
00:09:49,180 --> 00:09:49,190
well should I be doing this things that
 

491
00:09:49,190 --> 00:09:51,070
well should I be doing this things that
should happen every second or so you

492
00:09:51,070 --> 00:09:51,080
should happen every second or so you
 

493
00:09:51,080 --> 00:09:52,360
should happen every second or so you
just like to be able to fire something

494
00:09:52,360 --> 00:09:52,370
just like to be able to fire something
 

495
00:09:52,370 --> 00:09:54,370
just like to be able to fire something
up that every second does whatever the

496
00:09:54,370 --> 00:09:54,380
up that every second does whatever the
 

497
00:09:54,380 --> 00:09:56,050
up that every second does whatever the
periodic thing is so there's some

498
00:09:56,050 --> 00:09:56,060
periodic thing is so there's some
 

499
00:09:56,060 --> 00:10:00,490
periodic thing is so there's some
convenience reasons and an example which

500
00:10:00,490 --> 00:10:00,500
convenience reasons and an example which
 

501
00:10:00,500 --> 00:10:03,370
convenience reasons and an example which
will come up for you is it's often the

502
00:10:03,370 --> 00:10:03,380
will come up for you is it's often the
 

503
00:10:03,380 --> 00:10:05,200
will come up for you is it's often the
case that some you know a master server

504
00:10:05,200 --> 00:10:05,210
case that some you know a master server
 

505
00:10:05,210 --> 00:10:07,240
case that some you know a master server
may want to check periodically whether

506
00:10:07,240 --> 00:10:07,250
may want to check periodically whether
 

507
00:10:07,250 --> 00:10:09,340
may want to check periodically whether
its workers are still alive because one

508
00:10:09,340 --> 00:10:09,350
its workers are still alive because one
 

509
00:10:09,350 --> 00:10:10,570
its workers are still alive because one
of them is died you know you want to

510
00:10:10,570 --> 00:10:10,580
of them is died you know you want to
 

511
00:10:10,580 --> 00:10:12,160
of them is died you know you want to
launch that work on another machine like

512
00:10:12,160 --> 00:10:12,170
launch that work on another machine like
 

513
00:10:12,170 --> 00:10:14,530
launch that work on another machine like
MapReduce might do that and one way to

514
00:10:14,530 --> 00:10:14,540
MapReduce might do that and one way to
 

515
00:10:14,540 --> 00:10:17,410
MapReduce might do that and one way to
arrange sort of oh do this check every

516
00:10:17,410 --> 00:10:17,420
arrange sort of oh do this check every
 

517
00:10:17,420 --> 00:10:19,090
arrange sort of oh do this check every
second every minute you know send a

518
00:10:19,090 --> 00:10:19,100
second every minute you know send a
 

519
00:10:19,100 --> 00:10:21,670
second every minute you know send a
message to the worker are you alive is

520
00:10:21,670 --> 00:10:21,680
message to the worker are you alive is
 

521
00:10:21,680 --> 00:10:24,160
message to the worker are you alive is
to fire off a go routine that just sits

522
00:10:24,160 --> 00:10:24,170
to fire off a go routine that just sits
 

523
00:10:24,170 --> 00:10:25,690
to fire off a go routine that just sits
in a loop that sleeps for a second and

524
00:10:25,690 --> 00:10:25,700
in a loop that sleeps for a second and
 

525
00:10:25,700 --> 00:10:26,980
in a loop that sleeps for a second and
then does the periodic thing and then

526
00:10:26,980 --> 00:10:26,990
then does the periodic thing and then
 

527
00:10:26,990 --> 00:10:28,690
then does the periodic thing and then
sleeps for a second again and so in the

528
00:10:28,690 --> 00:10:28,700
sleeps for a second again and so in the
 

529
00:10:28,700 --> 00:10:31,390
sleeps for a second again and so in the
labs you'll end up firing off these kind

530
00:10:31,390 --> 00:10:31,400
labs you'll end up firing off these kind
 

531
00:10:31,400 --> 00:10:36,550
labs you'll end up firing off these kind
of threads quite a bit yes is the

532
00:10:36,550 --> 00:10:36,560
of threads quite a bit yes is the
 

533
00:10:36,560 --> 00:10:42,460
of threads quite a bit yes is the
overhead worth it yes the overhead is

534
00:10:42,460 --> 00:10:42,470
overhead worth it yes the overhead is
 

535
00:10:42,470 --> 00:10:44,830
overhead worth it yes the overhead is
really pretty small for this stuff I

536
00:10:44,830 --> 00:10:44,840
really pretty small for this stuff I
 

537
00:10:44,840 --> 00:10:46,690
really pretty small for this stuff I
mean you know it depends on how many you

538
00:10:46,690 --> 00:10:46,700
mean you know it depends on how many you
 

539
00:10:46,700 --> 00:10:50,140
mean you know it depends on how many you
create a million threads that he sit in

540
00:10:50,140 --> 00:10:50,150
create a million threads that he sit in
 

541
00:10:50,150 --> 00:10:52,030
create a million threads that he sit in
a loop waiting for a millisecond and

542
00:10:52,030 --> 00:10:52,040
a loop waiting for a millisecond and
 

543
00:10:52,040 --> 00:10:53,950
a loop waiting for a millisecond and
then send a network message that's

544
00:10:53,950 --> 00:10:53,960
then send a network message that's
 

545
00:10:53,960 --> 00:10:56,320
then send a network message that's
probably a huge load on your machine but

546
00:10:56,320 --> 00:10:56,330
probably a huge load on your machine but
 

547
00:10:56,330 --> 00:10:59,190
probably a huge load on your machine but
if you create you know ten threads that

548
00:10:59,190 --> 00:10:59,200
if you create you know ten threads that
 

549
00:10:59,200 --> 00:11:01,390
if you create you know ten threads that
sleep for a second and do a little bit

550
00:11:01,390 --> 00:11:01,400
sleep for a second and do a little bit
 

551
00:11:01,400 --> 00:11:04,840
sleep for a second and do a little bit
of work it's probably not a big deal at

552
00:11:04,840 --> 00:11:04,850
of work it's probably not a big deal at
 

553
00:11:04,850 --> 00:11:06,680
of work it's probably not a big deal at
all and it's

554
00:11:06,680 --> 00:11:06,690
all and it's
 

555
00:11:06,690 --> 00:11:10,009
all and it's
I guarantee you the programmer time you

556
00:11:10,009 --> 00:11:10,019
I guarantee you the programmer time you
 

557
00:11:10,019 --> 00:11:13,970
I guarantee you the programmer time you
say by not having to sort of mush

558
00:11:13,970 --> 00:11:13,980
say by not having to sort of mush
 

559
00:11:13,980 --> 00:11:16,189
say by not having to sort of mush
together they're different different

560
00:11:16,189 --> 00:11:16,199
together they're different different
 

561
00:11:16,199 --> 00:11:19,309
together they're different different
activities into one line of code it's

562
00:11:19,309 --> 00:11:19,319
activities into one line of code it's
 

563
00:11:19,319 --> 00:11:21,439
activities into one line of code it's
it's worth the small amount of CPU cost

564
00:11:21,439 --> 00:11:21,449
it's worth the small amount of CPU cost
 

565
00:11:21,449 --> 00:11:26,150
it's worth the small amount of CPU cost
almost always still you know you will if

566
00:11:26,150 --> 00:11:26,160
almost always still you know you will if
 

567
00:11:26,160 --> 00:11:27,590
almost always still you know you will if
you're unlucky you'll discover in the

568
00:11:27,590 --> 00:11:27,600
you're unlucky you'll discover in the
 

569
00:11:27,600 --> 00:11:30,439
you're unlucky you'll discover in the
labs that some loop of yours is not

570
00:11:30,439 --> 00:11:30,449
labs that some loop of yours is not
 

571
00:11:30,449 --> 00:11:32,509
labs that some loop of yours is not
sleeping long enough or are you fired

572
00:11:32,509 --> 00:11:32,519
sleeping long enough or are you fired
 

573
00:11:32,519 --> 00:11:35,720
sleeping long enough or are you fired
off a bunch of these and never made them

574
00:11:35,720 --> 00:11:35,730
off a bunch of these and never made them
 

575
00:11:35,730 --> 00:11:37,579
off a bunch of these and never made them
exit for example and they just

576
00:11:37,579 --> 00:11:37,589
exit for example and they just
 

577
00:11:37,589 --> 00:11:41,319
exit for example and they just
accumulate so you can push it too far

578
00:11:41,319 --> 00:11:41,329
accumulate so you can push it too far
 

579
00:11:41,329 --> 00:11:43,670
accumulate so you can push it too far
okay so these are the reasons that the

580
00:11:43,670 --> 00:11:43,680
okay so these are the reasons that the
 

581
00:11:43,680 --> 00:11:46,400
okay so these are the reasons that the
main reasons that people like threads a

582
00:11:46,400 --> 00:11:46,410
main reasons that people like threads a
 

583
00:11:46,410 --> 00:11:47,720
main reasons that people like threads a
lot and that will use threads in this

584
00:11:47,720 --> 00:11:47,730
lot and that will use threads in this
 

585
00:11:47,730 --> 00:11:50,360
lot and that will use threads in this
class any other questions about threads

586
00:11:50,360 --> 00:11:50,370
class any other questions about threads
 

587
00:11:50,370 --> 00:12:01,850
class any other questions about threads
in general by asynchronous program you

588
00:12:01,850 --> 00:12:01,860
in general by asynchronous program you
 

589
00:12:01,860 --> 00:12:03,559
in general by asynchronous program you
mean like a single thread of control

590
00:12:03,559 --> 00:12:03,569
mean like a single thread of control
 

591
00:12:03,569 --> 00:12:06,769
mean like a single thread of control
that keeps state about many different

592
00:12:06,769 --> 00:12:06,779
that keeps state about many different
 

593
00:12:06,779 --> 00:12:09,499
that keeps state about many different
activities yeah so this is a good

594
00:12:09,499 --> 00:12:09,509
activities yeah so this is a good
 

595
00:12:09,509 --> 00:12:12,199
activities yeah so this is a good
question actually there is you know what

596
00:12:12,199 --> 00:12:12,209
question actually there is you know what
 

597
00:12:12,209 --> 00:12:13,429
question actually there is you know what
would happen if we didn't have threads

598
00:12:13,429 --> 00:12:13,439
would happen if we didn't have threads
 

599
00:12:13,439 --> 00:12:15,079
would happen if we didn't have threads
or we'd for some reason we didn't want

600
00:12:15,079 --> 00:12:15,089
or we'd for some reason we didn't want
 

601
00:12:15,089 --> 00:12:16,790
or we'd for some reason we didn't want
to use threats like how would we be able

602
00:12:16,790 --> 00:12:16,800
to use threats like how would we be able
 

603
00:12:16,800 --> 00:12:18,889
to use threats like how would we be able
to write a program that could you know a

604
00:12:18,889 --> 00:12:18,899
to write a program that could you know a
 

605
00:12:18,899 --> 00:12:21,199
to write a program that could you know a
server that could talk to many different

606
00:12:21,199 --> 00:12:21,209
server that could talk to many different
 

607
00:12:21,209 --> 00:12:23,329
server that could talk to many different
clients at the same time or a client

608
00:12:23,329 --> 00:12:23,339
clients at the same time or a client
 

609
00:12:23,339 --> 00:12:24,499
clients at the same time or a client
that could talk to him any servers right

610
00:12:24,499 --> 00:12:24,509
that could talk to him any servers right
 

611
00:12:24,509 --> 00:12:26,090
that could talk to him any servers right
what what tools could be used and it

612
00:12:26,090 --> 00:12:26,100
what what tools could be used and it
 

613
00:12:26,100 --> 00:12:29,059
what what tools could be used and it
turns out there is sort of another line

614
00:12:29,059 --> 00:12:29,069
turns out there is sort of another line
 

615
00:12:29,069 --> 00:12:36,410
turns out there is sort of another line
of another kind of another major style

616
00:12:36,410 --> 00:12:36,420
of another kind of another major style
 

617
00:12:36,420 --> 00:12:37,970
of another kind of another major style
of how do you structure these programs

618
00:12:37,970 --> 00:12:37,980
of how do you structure these programs
 

619
00:12:37,980 --> 00:12:38,329
of how do you structure these programs
called

620
00:12:38,329 --> 00:12:38,339
called
 

621
00:12:38,339 --> 00:12:40,009
called
you call the asynchronous program I

622
00:12:40,009 --> 00:12:40,019
you call the asynchronous program I
 

623
00:12:40,019 --> 00:12:42,519
you call the asynchronous program I
might call it a vent driven programming

624
00:12:42,519 --> 00:12:42,529
might call it a vent driven programming
 

625
00:12:42,529 --> 00:12:45,889
might call it a vent driven programming
so sort of or you could use a vent

626
00:12:45,889 --> 00:12:45,899
so sort of or you could use a vent
 

627
00:12:45,899 --> 00:12:50,840
so sort of or you could use a vent
prevent programming and the the general

628
00:12:50,840 --> 00:12:50,850
prevent programming and the the general
 

629
00:12:50,850 --> 00:12:52,699
prevent programming and the the general
structure of an event-driven program is

630
00:12:52,699 --> 00:12:52,709
structure of an event-driven program is
 

631
00:12:52,709 --> 00:12:54,410
structure of an event-driven program is
usually that it has a single thread and

632
00:12:54,410 --> 00:12:54,420
usually that it has a single thread and
 

633
00:12:54,420 --> 00:12:57,370
usually that it has a single thread and
a single loop and what that loop does is

634
00:12:57,370 --> 00:12:57,380
a single loop and what that loop does is
 

635
00:12:57,380 --> 00:13:01,370
a single loop and what that loop does is
sits there and waits for any input or

636
00:13:01,370 --> 00:13:01,380
sits there and waits for any input or
 

637
00:13:01,380 --> 00:13:03,769
sits there and waits for any input or
sort of any event that might trigger

638
00:13:03,769 --> 00:13:03,779
sort of any event that might trigger
 

639
00:13:03,779 --> 00:13:05,689
sort of any event that might trigger
processing so an event might be the

640
00:13:05,689 --> 00:13:05,699
processing so an event might be the
 

641
00:13:05,699 --> 00:13:07,790
processing so an event might be the
arrival of a request from a client or a

642
00:13:07,790 --> 00:13:07,800
arrival of a request from a client or a
 

643
00:13:07,800 --> 00:13:10,879
arrival of a request from a client or a
timer going off or if you're building a

644
00:13:10,879 --> 00:13:10,889
timer going off or if you're building a
 

645
00:13:10,889 --> 00:13:12,619
timer going off or if you're building a
Window System protect many Windows

646
00:13:12,619 --> 00:13:12,629
Window System protect many Windows
 

647
00:13:12,629 --> 00:13:14,179
Window System protect many Windows
systems on your laptops I've driven

648
00:13:14,179 --> 00:13:14,189
systems on your laptops I've driven
 

649
00:13:14,189 --> 00:13:16,009
systems on your laptops I've driven
written an event-driven style where what

650
00:13:16,009 --> 00:13:16,019
written an event-driven style where what
 

651
00:13:16,019 --> 00:13:17,629
written an event-driven style where what
they're waiting for is like key clicks

652
00:13:17,629 --> 00:13:17,639
they're waiting for is like key clicks
 

653
00:13:17,639 --> 00:13:18,329
they're waiting for is like key clicks
or Mouse move

654
00:13:18,329 --> 00:13:18,339
or Mouse move
 

655
00:13:18,339 --> 00:13:20,249
or Mouse move
or something so you might have a single

656
00:13:20,249 --> 00:13:20,259
or something so you might have a single
 

657
00:13:20,259 --> 00:13:21,540
or something so you might have a single
in an event-driven program it of a

658
00:13:21,540 --> 00:13:21,550
in an event-driven program it of a
 

659
00:13:21,550 --> 00:13:23,340
in an event-driven program it of a
single threat of control sits an aloof

660
00:13:23,340 --> 00:13:23,350
single threat of control sits an aloof
 

661
00:13:23,350 --> 00:13:25,259
single threat of control sits an aloof
waits for input and whenever it gets an

662
00:13:25,259 --> 00:13:25,269
waits for input and whenever it gets an
 

663
00:13:25,269 --> 00:13:27,150
waits for input and whenever it gets an
input like a packet it figures out oh

664
00:13:27,150 --> 00:13:27,160
input like a packet it figures out oh
 

665
00:13:27,160 --> 00:13:28,739
input like a packet it figures out oh
you know which client did this packet

666
00:13:28,739 --> 00:13:28,749
you know which client did this packet
 

667
00:13:28,749 --> 00:13:31,530
you know which client did this packet
come from and then it'll have a table of

668
00:13:31,530 --> 00:13:31,540
come from and then it'll have a table of
 

669
00:13:31,540 --> 00:13:34,829
come from and then it'll have a table of
sort of what the state is of whatever

670
00:13:34,829 --> 00:13:34,839
sort of what the state is of whatever
 

671
00:13:34,839 --> 00:13:38,189
sort of what the state is of whatever
activity its managing for that client

672
00:13:38,189 --> 00:13:38,199
activity its managing for that client
 

673
00:13:38,199 --> 00:13:40,499
activity its managing for that client
and it'll say oh gosh I was in the

674
00:13:40,499 --> 00:13:40,509
and it'll say oh gosh I was in the
 

675
00:13:40,509 --> 00:13:42,210
and it'll say oh gosh I was in the
middle of reading such-and-such a file

676
00:13:42,210 --> 00:13:42,220
middle of reading such-and-such a file
 

677
00:13:42,220 --> 00:13:44,100
middle of reading such-and-such a file
you know now it's asked me to read the

678
00:13:44,100 --> 00:13:44,110
you know now it's asked me to read the
 

679
00:13:44,110 --> 00:13:45,840
you know now it's asked me to read the
next block I'll go and be the next block

680
00:13:45,840 --> 00:13:45,850
next block I'll go and be the next block
 

681
00:13:45,850 --> 00:13:55,470
next block I'll go and be the next block
and return it and threats are generally

682
00:13:55,470 --> 00:13:55,480
and return it and threats are generally
 

683
00:13:55,480 --> 00:13:57,239
and return it and threats are generally
more convenient because they allow you

684
00:13:57,239 --> 00:13:57,249
more convenient because they allow you
 

685
00:13:57,249 --> 00:14:00,059
more convenient because they allow you
to really you know it's much easier to

686
00:14:00,059 --> 00:14:00,069
to really you know it's much easier to
 

687
00:14:00,069 --> 00:14:01,679
to really you know it's much easier to
write sequential just like straight

688
00:14:01,679 --> 00:14:01,689
write sequential just like straight
 

689
00:14:01,689 --> 00:14:03,600
write sequential just like straight
lines of control code that does you know

690
00:14:03,600 --> 00:14:03,610
lines of control code that does you know
 

691
00:14:03,610 --> 00:14:05,639
lines of control code that does you know
computes sends a message waits for

692
00:14:05,639 --> 00:14:05,649
computes sends a message waits for
 

693
00:14:05,649 --> 00:14:07,199
computes sends a message waits for
response whatever it's much easier to

694
00:14:07,199 --> 00:14:07,209
response whatever it's much easier to
 

695
00:14:07,209 --> 00:14:08,999
response whatever it's much easier to
write that kind of code in a thread than

696
00:14:08,999 --> 00:14:09,009
write that kind of code in a thread than
 

697
00:14:09,009 --> 00:14:13,499
write that kind of code in a thread than
it is to chop up whatever the activity

698
00:14:13,499 --> 00:14:13,509
it is to chop up whatever the activity
 

699
00:14:13,509 --> 00:14:16,259
it is to chop up whatever the activity
is into a bunch of little pieces that

700
00:14:16,259 --> 00:14:16,269
is into a bunch of little pieces that
 

701
00:14:16,269 --> 00:14:19,079
is into a bunch of little pieces that
can sort of be activated one at a time

702
00:14:19,079 --> 00:14:19,089
can sort of be activated one at a time
 

703
00:14:19,089 --> 00:14:23,369
can sort of be activated one at a time
by one of these event-driven loops that

704
00:14:23,369 --> 00:14:23,379
by one of these event-driven loops that
 

705
00:14:23,379 --> 00:14:29,100
by one of these event-driven loops that
said the well and so one problem with

706
00:14:29,100 --> 00:14:29,110
said the well and so one problem with
 

707
00:14:29,110 --> 00:14:31,079
said the well and so one problem with
the scheme is that it's it's a little

708
00:14:31,079 --> 00:14:31,089
the scheme is that it's it's a little
 

709
00:14:31,089 --> 00:14:32,879
the scheme is that it's it's a little
bit of a pain to program another

710
00:14:32,879 --> 00:14:32,889
bit of a pain to program another
 

711
00:14:32,889 --> 00:14:34,650
bit of a pain to program another
potential defect is that while you get

712
00:14:34,650 --> 00:14:34,660
potential defect is that while you get
 

713
00:14:34,660 --> 00:14:36,629
potential defect is that while you get
io concurrency from this approach you

714
00:14:36,629 --> 00:14:36,639
io concurrency from this approach you
 

715
00:14:36,639 --> 00:14:38,759
io concurrency from this approach you
don't get CPU parallelism so if you're

716
00:14:38,759 --> 00:14:38,769
don't get CPU parallelism so if you're
 

717
00:14:38,769 --> 00:14:39,900
don't get CPU parallelism so if you're
writing a busy server that would really

718
00:14:39,900 --> 00:14:39,910
writing a busy server that would really
 

719
00:14:39,910 --> 00:14:42,720
writing a busy server that would really
like to keep you know 32 cores busy on a

720
00:14:42,720 --> 00:14:42,730
like to keep you know 32 cores busy on a
 

721
00:14:42,730 --> 00:14:45,600
like to keep you know 32 cores busy on a
big server machine you know a single

722
00:14:45,600 --> 00:14:45,610
big server machine you know a single
 

723
00:14:45,610 --> 00:14:49,139
big server machine you know a single
loop is you know it's it's not a very

724
00:14:49,139 --> 00:14:49,149
loop is you know it's it's not a very
 

725
00:14:49,149 --> 00:14:50,610
loop is you know it's it's not a very
natural way to harness more than one

726
00:14:50,610 --> 00:14:50,620
natural way to harness more than one
 

727
00:14:50,620 --> 00:14:55,019
natural way to harness more than one
core on the other hand the overheads of

728
00:14:55,019 --> 00:14:55,029
core on the other hand the overheads of
 

729
00:14:55,029 --> 00:14:56,610
core on the other hand the overheads of
adventure and programming are generally

730
00:14:56,610 --> 00:14:56,620
adventure and programming are generally
 

731
00:14:56,620 --> 00:14:59,249
adventure and programming are generally
quite a bit less than threads you know

732
00:14:59,249 --> 00:14:59,259
quite a bit less than threads you know
 

733
00:14:59,259 --> 00:15:01,650
quite a bit less than threads you know
Ed's are pretty cheap but each one of

734
00:15:01,650 --> 00:15:01,660
Ed's are pretty cheap but each one of
 

735
00:15:01,660 --> 00:15:05,369
Ed's are pretty cheap but each one of
these threads is sitting on a stack you

736
00:15:05,369 --> 00:15:05,379
these threads is sitting on a stack you
 

737
00:15:05,379 --> 00:15:07,319
these threads is sitting on a stack you
know stack is a kilobyte or a kilobytes

738
00:15:07,319 --> 00:15:07,329
know stack is a kilobyte or a kilobytes
 

739
00:15:07,329 --> 00:15:09,449
know stack is a kilobyte or a kilobytes
or something you know if you have 20 of

740
00:15:09,449 --> 00:15:09,459
or something you know if you have 20 of
 

741
00:15:09,459 --> 00:15:10,949
or something you know if you have 20 of
these threads who cares if you have a

742
00:15:10,949 --> 00:15:10,959
these threads who cares if you have a
 

743
00:15:10,959 --> 00:15:12,960
these threads who cares if you have a
million of these threads then it's

744
00:15:12,960 --> 00:15:12,970
million of these threads then it's
 

745
00:15:12,970 --> 00:15:13,999
million of these threads then it's
starting to be a huge amount of memory

746
00:15:13,999 --> 00:15:14,009
starting to be a huge amount of memory
 

747
00:15:14,009 --> 00:15:17,759
starting to be a huge amount of memory
and you know maybe the scheduling

748
00:15:17,759 --> 00:15:17,769
and you know maybe the scheduling
 

749
00:15:17,769 --> 00:15:19,379
and you know maybe the scheduling
bookkeeping for deciding what the thread

750
00:15:19,379 --> 00:15:19,389
bookkeeping for deciding what the thread
 

751
00:15:19,389 --> 00:15:20,970
bookkeeping for deciding what the thread
to run next might also start you know

752
00:15:20,970 --> 00:15:20,980
to run next might also start you know
 

753
00:15:20,980 --> 00:15:23,249
to run next might also start you know
you now have list scheduling lists with

754
00:15:23,249 --> 00:15:23,259
you now have list scheduling lists with
 

755
00:15:23,259 --> 00:15:25,889
you now have list scheduling lists with
a thousand threads in them the threads

756
00:15:25,889 --> 00:15:25,899
a thousand threads in them the threads
 

757
00:15:25,899 --> 00:15:28,410
a thousand threads in them the threads
can start to get quite expensive so if

758
00:15:28,410 --> 00:15:28,420
can start to get quite expensive so if
 

759
00:15:28,420 --> 00:15:30,509
can start to get quite expensive so if
you are in a position where you need to

760
00:15:30,509 --> 00:15:30,519
you are in a position where you need to
 

761
00:15:30,519 --> 00:15:31,950
you are in a position where you need to
have a single server that sir

762
00:15:31,950 --> 00:15:31,960
have a single server that sir
 

763
00:15:31,960 --> 00:15:33,510
have a single server that sir
you know a million clients and has to

764
00:15:33,510 --> 00:15:33,520
you know a million clients and has to
 

765
00:15:33,520 --> 00:15:35,040
you know a million clients and has to
sort of keep a little bit of state for

766
00:15:35,040 --> 00:15:35,050
sort of keep a little bit of state for
 

767
00:15:35,050 --> 00:15:37,910
sort of keep a little bit of state for
each of a million clients this could be

768
00:15:37,910 --> 00:15:37,920
each of a million clients this could be
 

769
00:15:37,920 --> 00:15:39,360
each of a million clients this could be
expensive

770
00:15:39,360 --> 00:15:39,370
expensive
 

771
00:15:39,370 --> 00:15:43,890
expensive
and it's easier to write a very you know

772
00:15:43,890 --> 00:15:43,900
and it's easier to write a very you know
 

773
00:15:43,900 --> 00:15:46,050
and it's easier to write a very you know
at some expense in programmer time it's

774
00:15:46,050 --> 00:15:46,060
at some expense in programmer time it's
 

775
00:15:46,060 --> 00:15:47,430
at some expense in programmer time it's
easier to write a really stripped-down

776
00:15:47,430 --> 00:15:47,440
easier to write a really stripped-down
 

777
00:15:47,440 --> 00:15:50,550
easier to write a really stripped-down
efficient low overhead service in a

778
00:15:50,550 --> 00:15:50,560
efficient low overhead service in a
 

779
00:15:50,560 --> 00:15:51,930
efficient low overhead service in a
venture than programming just a lot more

780
00:15:51,930 --> 00:15:51,940
venture than programming just a lot more
 

781
00:15:51,940 --> 00:16:15,380
venture than programming just a lot more
work are you asking my JavaScript I

782
00:16:15,380 --> 00:16:15,390
work are you asking my JavaScript I
 

783
00:16:15,390 --> 00:16:18,030
work are you asking my JavaScript I
don't know the question is whether

784
00:16:18,030 --> 00:16:18,040
don't know the question is whether
 

785
00:16:18,040 --> 00:16:20,940
don't know the question is whether
JavaScript has multiple cores executing

786
00:16:20,940 --> 00:16:20,950
JavaScript has multiple cores executing
 

787
00:16:20,950 --> 00:16:25,860
JavaScript has multiple cores executing
your does anybody know depends on the

788
00:16:25,860 --> 00:16:25,870
your does anybody know depends on the
 

789
00:16:25,870 --> 00:16:27,240
your does anybody know depends on the
implementation yeah so I don't know I

790
00:16:27,240 --> 00:16:27,250
implementation yeah so I don't know I
 

791
00:16:27,250 --> 00:16:29,220
implementation yeah so I don't know I
mean it's a natural thought though even

792
00:16:29,220 --> 00:16:29,230
mean it's a natural thought though even
 

793
00:16:29,230 --> 00:16:31,560
mean it's a natural thought though even
in you know even an NGO you might well

794
00:16:31,560 --> 00:16:31,570
in you know even an NGO you might well
 

795
00:16:31,570 --> 00:16:33,390
in you know even an NGO you might well
want to have if you knew your machine

796
00:16:33,390 --> 00:16:33,400
want to have if you knew your machine
 

797
00:16:33,400 --> 00:16:35,160
want to have if you knew your machine
had eight cores if you wanted to write

798
00:16:35,160 --> 00:16:35,170
had eight cores if you wanted to write
 

799
00:16:35,170 --> 00:16:36,990
had eight cores if you wanted to write
the world's most efficient whatever

800
00:16:36,990 --> 00:16:37,000
the world's most efficient whatever
 

801
00:16:37,000 --> 00:16:39,480
the world's most efficient whatever
server you could fire up eight threads

802
00:16:39,480 --> 00:16:39,490
server you could fire up eight threads
 

803
00:16:39,490 --> 00:16:42,840
server you could fire up eight threads
and on each of the threads run sort of

804
00:16:42,840 --> 00:16:42,850
and on each of the threads run sort of
 

805
00:16:42,850 --> 00:16:47,340
and on each of the threads run sort of
stripped-down event-driven loop just you

806
00:16:47,340 --> 00:16:47,350
stripped-down event-driven loop just you
 

807
00:16:47,350 --> 00:16:49,650
stripped-down event-driven loop just you
know sort of one event loop Recor and

808
00:16:49,650 --> 00:16:49,660
know sort of one event loop Recor and
 

809
00:16:49,660 --> 00:16:51,150
know sort of one event loop Recor and
that you know that would be a way to get

810
00:16:51,150 --> 00:16:51,160
that you know that would be a way to get
 

811
00:16:51,160 --> 00:16:54,690
that you know that would be a way to get
both parallelism and to the bio

812
00:16:54,690 --> 00:16:54,700
both parallelism and to the bio
 

813
00:16:54,700 --> 00:17:05,050
both parallelism and to the bio
concurrency yes

814
00:17:05,050 --> 00:17:05,060

 

815
00:17:05,060 --> 00:17:06,860

okay so the question is what's the

816
00:17:06,860 --> 00:17:06,870
okay so the question is what's the
 

817
00:17:06,870 --> 00:17:07,940
okay so the question is what's the
difference between threads and processes

818
00:17:07,940 --> 00:17:07,950
difference between threads and processes
 

819
00:17:07,950 --> 00:17:11,180
difference between threads and processes
so usually on a like a UNIX machine a

820
00:17:11,180 --> 00:17:11,190
so usually on a like a UNIX machine a
 

821
00:17:11,190 --> 00:17:14,870
so usually on a like a UNIX machine a
process is a single program that you're

822
00:17:14,870 --> 00:17:14,880
process is a single program that you're
 

823
00:17:14,880 --> 00:17:16,640
process is a single program that you're
running and a sort of single address

824
00:17:16,640 --> 00:17:16,650
running and a sort of single address
 

825
00:17:16,650 --> 00:17:18,680
running and a sort of single address
space a single bunch of memory for the

826
00:17:18,680 --> 00:17:18,690
space a single bunch of memory for the
 

827
00:17:18,690 --> 00:17:22,100
space a single bunch of memory for the
process and inside a process you might

828
00:17:22,100 --> 00:17:22,110
process and inside a process you might
 

829
00:17:22,110 --> 00:17:23,630
process and inside a process you might
have multiple threads and when you ready

830
00:17:23,630 --> 00:17:23,640
have multiple threads and when you ready
 

831
00:17:23,640 --> 00:17:25,280
have multiple threads and when you ready
to go program and you run the go program

832
00:17:25,280 --> 00:17:25,290
to go program and you run the go program
 

833
00:17:25,290 --> 00:17:28,340
to go program and you run the go program
running the go program creates one unix

834
00:17:28,340 --> 00:17:28,350
running the go program creates one unix
 

835
00:17:28,350 --> 00:17:31,880
running the go program creates one unix
process and one sort of memory area and

836
00:17:31,880 --> 00:17:31,890
process and one sort of memory area and
 

837
00:17:31,890 --> 00:17:35,870
process and one sort of memory area and
then when your go process creates go

838
00:17:35,870 --> 00:17:35,880
then when your go process creates go
 

839
00:17:35,880 --> 00:17:37,370
then when your go process creates go
routines those are so sitting inside

840
00:17:37,370 --> 00:17:37,380
routines those are so sitting inside
 

841
00:17:37,380 --> 00:17:40,940
routines those are so sitting inside
that one process so I'm not sure that's

842
00:17:40,940 --> 00:17:40,950
that one process so I'm not sure that's
 

843
00:17:40,950 --> 00:17:42,980
that one process so I'm not sure that's
really an answer but just historically

844
00:17:42,980 --> 00:17:42,990
really an answer but just historically
 

845
00:17:42,990 --> 00:17:45,350
really an answer but just historically
the operating systems have provided like

846
00:17:45,350 --> 00:17:45,360
the operating systems have provided like
 

847
00:17:45,360 --> 00:17:47,480
the operating systems have provided like
this big box is the process that's

848
00:17:47,480 --> 00:17:47,490
this big box is the process that's
 

849
00:17:47,490 --> 00:17:49,570
this big box is the process that's
implemented by the operating system and

850
00:17:49,570 --> 00:17:49,580
implemented by the operating system and
 

851
00:17:49,580 --> 00:17:52,040
implemented by the operating system and
the individual and some of the operating

852
00:17:52,040 --> 00:17:52,050
the individual and some of the operating
 

853
00:17:52,050 --> 00:17:53,930
the individual and some of the operating
system does not care what happens inside

854
00:17:53,930 --> 00:17:53,940
system does not care what happens inside
 

855
00:17:53,940 --> 00:17:56,540
system does not care what happens inside
your process what language you use none

856
00:17:56,540 --> 00:17:56,550
your process what language you use none
 

857
00:17:56,550 --> 00:17:59,120
your process what language you use none
of the operating systems business but

858
00:17:59,120 --> 00:17:59,130
of the operating systems business but
 

859
00:17:59,130 --> 00:18:00,800
of the operating systems business but
inside that process you can run lots of

860
00:18:00,800 --> 00:18:00,810
inside that process you can run lots of
 

861
00:18:00,810 --> 00:18:03,500
inside that process you can run lots of
threads now you know if you run more

862
00:18:03,500 --> 00:18:03,510
threads now you know if you run more
 

863
00:18:03,510 --> 00:18:05,210
threads now you know if you run more
than one process in your machine you

864
00:18:05,210 --> 00:18:05,220
than one process in your machine you
 

865
00:18:05,220 --> 00:18:06,620
than one process in your machine you
know you run more than one program I can

866
00:18:06,620 --> 00:18:06,630
know you run more than one program I can
 

867
00:18:06,630 --> 00:18:09,560
know you run more than one program I can
edit or compiler the operating system

868
00:18:09,560 --> 00:18:09,570
edit or compiler the operating system
 

869
00:18:09,570 --> 00:18:12,350
edit or compiler the operating system
keep quite separate right you're your

870
00:18:12,350 --> 00:18:12,360
keep quite separate right you're your
 

871
00:18:12,360 --> 00:18:13,610
keep quite separate right you're your
editor and your compiler each have

872
00:18:13,610 --> 00:18:13,620
editor and your compiler each have
 

873
00:18:13,620 --> 00:18:15,680
editor and your compiler each have
memory but it's not the same memory that

874
00:18:15,680 --> 00:18:15,690
memory but it's not the same memory that
 

875
00:18:15,690 --> 00:18:16,820
memory but it's not the same memory that
are not allowed to look at each other

876
00:18:16,820 --> 00:18:16,830
are not allowed to look at each other
 

877
00:18:16,830 --> 00:18:18,800
are not allowed to look at each other
memory there's not much interaction

878
00:18:18,800 --> 00:18:18,810
memory there's not much interaction
 

879
00:18:18,810 --> 00:18:20,030
memory there's not much interaction
between different processes so you

880
00:18:20,030 --> 00:18:20,040
between different processes so you
 

881
00:18:20,040 --> 00:18:22,460
between different processes so you
redditor may have threads and your

882
00:18:22,460 --> 00:18:22,470
redditor may have threads and your
 

883
00:18:22,470 --> 00:18:24,020
redditor may have threads and your
compiler may have threads but they're

884
00:18:24,020 --> 00:18:24,030
compiler may have threads but they're
 

885
00:18:24,030 --> 00:18:27,470
compiler may have threads but they're
just in different worlds so within any

886
00:18:27,470 --> 00:18:27,480
just in different worlds so within any
 

887
00:18:27,480 --> 00:18:29,180
just in different worlds so within any
one program the threads can share memory

888
00:18:29,180 --> 00:18:29,190
one program the threads can share memory
 

889
00:18:29,190 --> 00:18:31,880
one program the threads can share memory
and can synchronize with channels and

890
00:18:31,880 --> 00:18:31,890
and can synchronize with channels and
 

891
00:18:31,890 --> 00:18:33,710
and can synchronize with channels and
use mutexes and stuff but between

892
00:18:33,710 --> 00:18:33,720
use mutexes and stuff but between
 

893
00:18:33,720 --> 00:18:38,230
use mutexes and stuff but between
processes there's just no no interaction

894
00:18:38,230 --> 00:18:38,240
processes there's just no no interaction
 

895
00:18:38,240 --> 00:18:41,300
processes there's just no no interaction
that's just a traditional structure of

896
00:18:41,300 --> 00:18:41,310
that's just a traditional structure of
 

897
00:18:41,310 --> 00:18:45,499
that's just a traditional structure of
these this kind of software

898
00:18:45,499 --> 00:18:45,509

 

899
00:18:45,509 --> 00:18:53,360

yeah

900
00:18:53,360 --> 00:18:53,370

 

901
00:18:53,370 --> 00:18:55,470

so the question is when a context switch

902
00:18:55,470 --> 00:18:55,480
so the question is when a context switch
 

903
00:18:55,480 --> 00:19:08,000
so the question is when a context switch
happens does it happened for all threads

904
00:19:08,000 --> 00:19:08,010

 

905
00:19:08,010 --> 00:19:10,410

okay so let's let's imagine you have a

906
00:19:10,410 --> 00:19:10,420
okay so let's let's imagine you have a
 

907
00:19:10,420 --> 00:19:12,570
okay so let's let's imagine you have a
single core machine that's really only

908
00:19:12,570 --> 00:19:12,580
single core machine that's really only
 

909
00:19:12,580 --> 00:19:14,520
single core machine that's really only
running and as just doing one thing at a

910
00:19:14,520 --> 00:19:14,530
running and as just doing one thing at a
 

911
00:19:14,530 --> 00:19:19,890
running and as just doing one thing at a
time maybe the right way to think about

912
00:19:19,890 --> 00:19:19,900
time maybe the right way to think about
 

913
00:19:19,900 --> 00:19:21,570
time maybe the right way to think about
it is that you're going to be you're

914
00:19:21,570 --> 00:19:21,580
it is that you're going to be you're
 

915
00:19:21,580 --> 00:19:22,950
it is that you're going to be you're
running multiple processes on your

916
00:19:22,950 --> 00:19:22,960
running multiple processes on your
 

917
00:19:22,960 --> 00:19:27,510
running multiple processes on your
machine the operating system will give

918
00:19:27,510 --> 00:19:27,520
machine the operating system will give
 

919
00:19:27,520 --> 00:19:31,170
machine the operating system will give
the CPU sort of time slicing back and

920
00:19:31,170 --> 00:19:31,180
the CPU sort of time slicing back and
 

921
00:19:31,180 --> 00:19:33,420
the CPU sort of time slicing back and
forth between these two programs so when

922
00:19:33,420 --> 00:19:33,430
forth between these two programs so when
 

923
00:19:33,430 --> 00:19:35,940
forth between these two programs so when
the hardware timer ticks and the

924
00:19:35,940 --> 00:19:35,950
the hardware timer ticks and the
 

925
00:19:35,950 --> 00:19:37,290
the hardware timer ticks and the
operating systems decides it's time to

926
00:19:37,290 --> 00:19:37,300
operating systems decides it's time to
 

927
00:19:37,300 --> 00:19:38,940
operating systems decides it's time to
take away the CPU from the currently

928
00:19:38,940 --> 00:19:38,950
take away the CPU from the currently
 

929
00:19:38,950 --> 00:19:40,470
take away the CPU from the currently
running process and give it to another

930
00:19:40,470 --> 00:19:40,480
running process and give it to another
 

931
00:19:40,480 --> 00:19:48,590
running process and give it to another
process that's done at a process level

932
00:19:48,590 --> 00:19:48,600

 

933
00:19:48,600 --> 00:19:52,320

it's complicated all right let me let me

934
00:19:52,320 --> 00:19:52,330
it's complicated all right let me let me
 

935
00:19:52,330 --> 00:19:55,230
it's complicated all right let me let me
let me restart this these the threads

936
00:19:55,230 --> 00:19:55,240
let me restart this these the threads
 

937
00:19:55,240 --> 00:19:57,720
let me restart this these the threads
that we use are based on threads that

938
00:19:57,720 --> 00:19:57,730
that we use are based on threads that
 

939
00:19:57,730 --> 00:20:00,060
that we use are based on threads that
are provided by the operating system in

940
00:20:00,060 --> 00:20:00,070
are provided by the operating system in
 

941
00:20:00,070 --> 00:20:02,070
are provided by the operating system in
the end and when the outer needs to some

942
00:20:02,070 --> 00:20:02,080
the end and when the outer needs to some
 

943
00:20:02,080 --> 00:20:03,900
the end and when the outer needs to some
context switches its switching between

944
00:20:03,900 --> 00:20:03,910
context switches its switching between
 

945
00:20:03,910 --> 00:20:06,510
context switches its switching between
the threads that it knows about so in a

946
00:20:06,510 --> 00:20:06,520
the threads that it knows about so in a
 

947
00:20:06,520 --> 00:20:08,610
the threads that it knows about so in a
situation like this the operating system

948
00:20:08,610 --> 00:20:08,620
situation like this the operating system
 

949
00:20:08,620 --> 00:20:09,810
situation like this the operating system
might know that there are two threads

950
00:20:09,810 --> 00:20:09,820
might know that there are two threads
 

951
00:20:09,820 --> 00:20:11,550
might know that there are two threads
here in this process and three threads

952
00:20:11,550 --> 00:20:11,560
here in this process and three threads
 

953
00:20:11,560 --> 00:20:13,590
here in this process and three threads
in this process and when the timer ticks

954
00:20:13,590 --> 00:20:13,600
in this process and when the timer ticks
 

955
00:20:13,600 --> 00:20:15,180
in this process and when the timer ticks
the operating system will based on some

956
00:20:15,180 --> 00:20:15,190
the operating system will based on some
 

957
00:20:15,190 --> 00:20:16,860
the operating system will based on some
scheduling algorithm pick a different

958
00:20:16,860 --> 00:20:16,870
scheduling algorithm pick a different
 

959
00:20:16,870 --> 00:20:18,720
scheduling algorithm pick a different
thread to run it might be a different

960
00:20:18,720 --> 00:20:18,730
thread to run it might be a different
 

961
00:20:18,730 --> 00:20:21,120
thread to run it might be a different
thread in this process or one of the

962
00:20:21,120 --> 00:20:21,130
thread in this process or one of the
 

963
00:20:21,130 --> 00:20:22,260
thread in this process or one of the
threads in this process

964
00:20:22,260 --> 00:20:22,270
threads in this process
 

965
00:20:22,270 --> 00:20:25,680
threads in this process
in addition go cleverly multiplex as

966
00:20:25,680 --> 00:20:25,690
in addition go cleverly multiplex as
 

967
00:20:25,690 --> 00:20:27,770
in addition go cleverly multiplex as
many go routines on top of single

968
00:20:27,770 --> 00:20:27,780
many go routines on top of single
 

969
00:20:27,780 --> 00:20:29,850
many go routines on top of single
operating system threads to reduce

970
00:20:29,850 --> 00:20:29,860
operating system threads to reduce
 

971
00:20:29,860 --> 00:20:32,580
operating system threads to reduce
overhead so it's really probably a two

972
00:20:32,580 --> 00:20:32,590
overhead so it's really probably a two
 

973
00:20:32,590 --> 00:20:34,470
overhead so it's really probably a two
stages of scheduling the operating

974
00:20:34,470 --> 00:20:34,480
stages of scheduling the operating
 

975
00:20:34,480 --> 00:20:37,320
stages of scheduling the operating
system picks which big thread to run and

976
00:20:37,320 --> 00:20:37,330
system picks which big thread to run and
 

977
00:20:37,330 --> 00:20:40,020
system picks which big thread to run and
then within that process go may have a

978
00:20:40,020 --> 00:20:40,030
then within that process go may have a
 

979
00:20:40,030 --> 00:20:45,810
then within that process go may have a
choice of go routines to run

980
00:20:45,810 --> 00:20:45,820

 

981
00:20:45,820 --> 00:20:53,399

all right okay so threads are convenient

982
00:20:53,399 --> 00:20:53,409
all right okay so threads are convenient
 

983
00:20:53,409 --> 00:20:55,529
all right okay so threads are convenient
because a lot of times they allow you to

984
00:20:55,529 --> 00:20:55,539
because a lot of times they allow you to
 

985
00:20:55,539 --> 00:20:57,539
because a lot of times they allow you to
write the code for each thread just as

986
00:20:57,539 --> 00:20:57,549
write the code for each thread just as
 

987
00:20:57,549 --> 00:20:59,909
write the code for each thread just as
if it were a pretty ordinary sequential

988
00:20:59,909 --> 00:20:59,919
if it were a pretty ordinary sequential
 

989
00:20:59,919 --> 00:21:04,529
if it were a pretty ordinary sequential
program however there are in fact some

990
00:21:04,529 --> 00:21:04,539
program however there are in fact some
 

991
00:21:04,539 --> 00:21:15,139
program however there are in fact some
challenges with writing threaded code

992
00:21:15,139 --> 00:21:15,149

 

993
00:21:15,149 --> 00:21:17,669

one is what to do about shared data one

994
00:21:17,669 --> 00:21:17,679
one is what to do about shared data one
 

995
00:21:17,679 --> 00:21:18,989
one is what to do about shared data one
of the really cool things about the

996
00:21:18,989 --> 00:21:18,999
of the really cool things about the
 

997
00:21:18,999 --> 00:21:20,639
of the really cool things about the
threading model is that these threads

998
00:21:20,639 --> 00:21:20,649
threading model is that these threads
 

999
00:21:20,649 --> 00:21:22,349
threading model is that these threads
share the same address space they share

1000
00:21:22,349 --> 00:21:22,359
share the same address space they share
 

1001
00:21:22,359 --> 00:21:24,299
share the same address space they share
memory if one thread creates an object

1002
00:21:24,299 --> 00:21:24,309
memory if one thread creates an object
 

1003
00:21:24,309 --> 00:21:26,909
memory if one thread creates an object
in memory you can let other threads use

1004
00:21:26,909 --> 00:21:26,919
in memory you can let other threads use
 

1005
00:21:26,919 --> 00:21:29,129
in memory you can let other threads use
it right you can have a array or

1006
00:21:29,129 --> 00:21:29,139
it right you can have a array or
 

1007
00:21:29,139 --> 00:21:30,479
it right you can have a array or
something that all the different threads

1008
00:21:30,479 --> 00:21:30,489
something that all the different threads
 

1009
00:21:30,489 --> 00:21:31,409
something that all the different threads
are reading and writing and that

1010
00:21:31,409 --> 00:21:31,419
are reading and writing and that
 

1011
00:21:31,419 --> 00:21:33,869
are reading and writing and that
sometimes critical right if you you know

1012
00:21:33,869 --> 00:21:33,879
sometimes critical right if you you know
 

1013
00:21:33,879 --> 00:21:35,070
sometimes critical right if you you know
if you're keeping some interesting state

1014
00:21:35,070 --> 00:21:35,080
if you're keeping some interesting state
 

1015
00:21:35,080 --> 00:21:36,299
if you're keeping some interesting state
you know maybe you have a cache of

1016
00:21:36,299 --> 00:21:36,309
you know maybe you have a cache of
 

1017
00:21:36,309 --> 00:21:39,089
you know maybe you have a cache of
things that your server your cache and

1018
00:21:39,089 --> 00:21:39,099
things that your server your cache and
 

1019
00:21:39,099 --> 00:21:40,830
things that your server your cache and
memory when a thread is handling a

1020
00:21:40,830 --> 00:21:40,840
memory when a thread is handling a
 

1021
00:21:40,840 --> 00:21:42,299
memory when a thread is handling a
client request it's gonna first look in

1022
00:21:42,299 --> 00:21:42,309
client request it's gonna first look in
 

1023
00:21:42,309 --> 00:21:43,799
client request it's gonna first look in
that cache but the shared cache and each

1024
00:21:43,799 --> 00:21:43,809
that cache but the shared cache and each
 

1025
00:21:43,809 --> 00:21:45,389
that cache but the shared cache and each
thread reads it and the threads may

1026
00:21:45,389 --> 00:21:45,399
thread reads it and the threads may
 

1027
00:21:45,399 --> 00:21:47,999
thread reads it and the threads may
write the cache to update it when they

1028
00:21:47,999 --> 00:21:48,009
write the cache to update it when they
 

1029
00:21:48,009 --> 00:21:49,169
write the cache to update it when they
have new information to stick in the

1030
00:21:49,169 --> 00:21:49,179
have new information to stick in the
 

1031
00:21:49,179 --> 00:21:51,210
have new information to stick in the
cache so it's really cool you can share

1032
00:21:51,210 --> 00:21:51,220
cache so it's really cool you can share
 

1033
00:21:51,220 --> 00:21:55,200
cache so it's really cool you can share
that memory but it turns out that it's

1034
00:21:55,200 --> 00:21:55,210
that memory but it turns out that it's
 

1035
00:21:55,210 --> 00:21:57,960
that memory but it turns out that it's
very very easy to get bugs if you're not

1036
00:21:57,960 --> 00:21:57,970
very very easy to get bugs if you're not
 

1037
00:21:57,970 --> 00:21:59,729
very very easy to get bugs if you're not
careful and you're sharing memory

1038
00:21:59,729 --> 00:21:59,739
careful and you're sharing memory
 

1039
00:21:59,739 --> 00:22:02,580
careful and you're sharing memory
between threads so a totally classic

1040
00:22:02,580 --> 00:22:02,590
between threads so a totally classic
 

1041
00:22:02,590 --> 00:22:05,519
between threads so a totally classic
example is you know supposing your

1042
00:22:05,519 --> 00:22:05,529
example is you know supposing your
 

1043
00:22:05,529 --> 00:22:07,619
example is you know supposing your
thread so you have a global variable N

1044
00:22:07,619 --> 00:22:07,629
thread so you have a global variable N
 

1045
00:22:07,629 --> 00:22:09,659
thread so you have a global variable N
and that's shared among the different

1046
00:22:09,659 --> 00:22:09,669
and that's shared among the different
 

1047
00:22:09,669 --> 00:22:11,430
and that's shared among the different
threads and a thread just wants to

1048
00:22:11,430 --> 00:22:11,440
threads and a thread just wants to
 

1049
00:22:11,440 --> 00:22:17,549
threads and a thread just wants to
increment n right but itself this is

1050
00:22:17,549 --> 00:22:17,559
increment n right but itself this is
 

1051
00:22:17,559 --> 00:22:20,700
increment n right but itself this is
likely to be an invitation to bugs right

1052
00:22:20,700 --> 00:22:20,710
likely to be an invitation to bugs right
 

1053
00:22:20,710 --> 00:22:22,229
likely to be an invitation to bugs right
if you don't do anything special around

1054
00:22:22,229 --> 00:22:22,239
if you don't do anything special around
 

1055
00:22:22,239 --> 00:22:25,109
if you don't do anything special around
this code and the reason is that you

1056
00:22:25,109 --> 00:22:25,119
this code and the reason is that you
 

1057
00:22:25,119 --> 00:22:27,509
this code and the reason is that you
know whenever you write code in a thread

1058
00:22:27,509 --> 00:22:27,519
know whenever you write code in a thread
 

1059
00:22:27,519 --> 00:22:29,909
know whenever you write code in a thread
that you you know is accessing reading

1060
00:22:29,909 --> 00:22:29,919
that you you know is accessing reading
 

1061
00:22:29,919 --> 00:22:31,889
that you you know is accessing reading
or writing data that's shared with other

1062
00:22:31,889 --> 00:22:31,899
or writing data that's shared with other
 

1063
00:22:31,899 --> 00:22:33,659
or writing data that's shared with other
threads you know there's always the

1064
00:22:33,659 --> 00:22:33,669
threads you know there's always the
 

1065
00:22:33,669 --> 00:22:35,249
threads you know there's always the
possibility and you got to keep in mind

1066
00:22:35,249 --> 00:22:35,259
possibility and you got to keep in mind
 

1067
00:22:35,259 --> 00:22:36,989
possibility and you got to keep in mind
that some other thread may be looking at

1068
00:22:36,989 --> 00:22:36,999
that some other thread may be looking at
 

1069
00:22:36,999 --> 00:22:39,539
that some other thread may be looking at
the data or modifying the data at the

1070
00:22:39,539 --> 00:22:39,549
the data or modifying the data at the
 

1071
00:22:39,549 --> 00:22:41,729
the data or modifying the data at the
same time so the obvious problem with

1072
00:22:41,729 --> 00:22:41,739
same time so the obvious problem with
 

1073
00:22:41,739 --> 00:22:43,889
same time so the obvious problem with
this is that maybe thread 1 is executing

1074
00:22:43,889 --> 00:22:43,899
this is that maybe thread 1 is executing
 

1075
00:22:43,899 --> 00:22:46,109
this is that maybe thread 1 is executing
this code and thread 2 is actually in

1076
00:22:46,109 --> 00:22:46,119
this code and thread 2 is actually in
 

1077
00:22:46,119 --> 00:22:47,849
this code and thread 2 is actually in
the same function in a different thread

1078
00:22:47,849 --> 00:22:47,859
the same function in a different thread
 

1079
00:22:47,859 --> 00:22:50,789
the same function in a different thread
executing the very same code right and

1080
00:22:50,789 --> 00:22:50,799
executing the very same code right and
 

1081
00:22:50,799 --> 00:22:53,039
executing the very same code right and
remember I'm imagining the N is a global

1082
00:22:53,039 --> 00:22:53,049
remember I'm imagining the N is a global
 

1083
00:22:53,049 --> 00:22:54,359
remember I'm imagining the N is a global
variable so they're talking about the

1084
00:22:54,359 --> 00:22:54,369
variable so they're talking about the
 

1085
00:22:54,369 --> 00:22:57,029
variable so they're talking about the
same n so what this boils down to you

1086
00:22:57,029 --> 00:22:57,039
same n so what this boils down to you
 

1087
00:22:57,039 --> 00:22:58,259
same n so what this boils down to you
know you're not actually running this

1088
00:22:58,259 --> 00:22:58,269
know you're not actually running this
 

1089
00:22:58,269 --> 00:22:59,039
know you're not actually running this
code you're running

1090
00:22:59,039 --> 00:22:59,049
code you're running
 

1091
00:22:59,049 --> 00:23:01,739
code you're running
machine code the compiler produced and

1092
00:23:01,739 --> 00:23:01,749
machine code the compiler produced and
 

1093
00:23:01,749 --> 00:23:03,869
machine code the compiler produced and
what that machine code does is it you

1094
00:23:03,869 --> 00:23:03,879
what that machine code does is it you
 

1095
00:23:03,879 --> 00:23:06,710
what that machine code does is it you
know it loads X into a register

1096
00:23:06,710 --> 00:23:06,720
know it loads X into a register
 

1097
00:23:06,720 --> 00:23:13,200
know it loads X into a register
you know adds one to the register and

1098
00:23:13,200 --> 00:23:13,210
you know adds one to the register and
 

1099
00:23:13,210 --> 00:23:18,119
you know adds one to the register and
then stores that register into X with

1100
00:23:18,119 --> 00:23:18,129
then stores that register into X with
 

1101
00:23:18,129 --> 00:23:20,999
then stores that register into X with
where X is a address of some location

1102
00:23:20,999 --> 00:23:21,009
where X is a address of some location
 

1103
00:23:21,009 --> 00:23:23,070
where X is a address of some location
and ran so you know you can count on

1104
00:23:23,070 --> 00:23:23,080
and ran so you know you can count on
 

1105
00:23:23,080 --> 00:23:24,330
and ran so you know you can count on
both of the threads

1106
00:23:24,330 --> 00:23:24,340
both of the threads
 

1107
00:23:24,340 --> 00:23:25,919
both of the threads
they're both executing this line of code

1108
00:23:25,919 --> 00:23:25,929
they're both executing this line of code
 

1109
00:23:25,929 --> 00:23:28,710
they're both executing this line of code
you know they both load the variable X

1110
00:23:28,710 --> 00:23:28,720
you know they both load the variable X
 

1111
00:23:28,720 --> 00:23:31,080
you know they both load the variable X
into a register effect starts out at 0

1112
00:23:31,080 --> 00:23:31,090
into a register effect starts out at 0
 

1113
00:23:31,090 --> 00:23:32,460
into a register effect starts out at 0
that means they both load at 0

1114
00:23:32,460 --> 00:23:32,470
that means they both load at 0
 

1115
00:23:32,470 --> 00:23:33,960
that means they both load at 0
they both increment that register so

1116
00:23:33,960 --> 00:23:33,970
they both increment that register so
 

1117
00:23:33,970 --> 00:23:35,609
they both increment that register so
they get one and they both store one

1118
00:23:35,609 --> 00:23:35,619
they get one and they both store one
 

1119
00:23:35,619 --> 00:23:37,799
they get one and they both store one
back to memory and now two threads of

1120
00:23:37,799 --> 00:23:37,809
back to memory and now two threads of
 

1121
00:23:37,809 --> 00:23:39,989
back to memory and now two threads of
incremented n and the resulting value is

1122
00:23:39,989 --> 00:23:39,999
incremented n and the resulting value is
 

1123
00:23:39,999 --> 00:23:44,009
incremented n and the resulting value is
1 which well who knows what the

1124
00:23:44,009 --> 00:23:44,019
1 which well who knows what the
 

1125
00:23:44,019 --> 00:23:45,479
1 which well who knows what the
programmer intended maybe that's what

1126
00:23:45,479 --> 00:23:45,489
programmer intended maybe that's what
 

1127
00:23:45,489 --> 00:23:47,279
programmer intended maybe that's what
the programmer wanted but chances are

1128
00:23:47,279 --> 00:23:47,289
the programmer wanted but chances are
 

1129
00:23:47,289 --> 00:23:49,139
the programmer wanted but chances are
not right chances are the programmer

1130
00:23:49,139 --> 00:23:49,149
not right chances are the programmer
 

1131
00:23:49,149 --> 00:24:02,700
not right chances are the programmer
wanted to not 1 some some instructions

1132
00:24:02,700 --> 00:24:02,710
wanted to not 1 some some instructions
 

1133
00:24:02,710 --> 00:24:04,229
wanted to not 1 some some instructions
are atomic so the question is a very

1134
00:24:04,229 --> 00:24:04,239
are atomic so the question is a very
 

1135
00:24:04,239 --> 00:24:09,629
are atomic so the question is a very
good question which it's whether

1136
00:24:09,629 --> 00:24:09,639
good question which it's whether
 

1137
00:24:09,639 --> 00:24:11,249
good question which it's whether
individual instructions are atomic so

1138
00:24:11,249 --> 00:24:11,259
individual instructions are atomic so
 

1139
00:24:11,259 --> 00:24:13,259
individual instructions are atomic so
the answer is some are and some aren't

1140
00:24:13,259 --> 00:24:13,269
the answer is some are and some aren't
 

1141
00:24:13,269 --> 00:24:20,549
the answer is some are and some aren't
so a store a 32-bit store is likely the

1142
00:24:20,549 --> 00:24:20,559
so a store a 32-bit store is likely the
 

1143
00:24:20,559 --> 00:24:23,430
so a store a 32-bit store is likely the
extremely likely to be atomic in the

1144
00:24:23,430 --> 00:24:23,440
extremely likely to be atomic in the
 

1145
00:24:23,440 --> 00:24:25,739
extremely likely to be atomic in the
sense that if 2 processors store at the

1146
00:24:25,739 --> 00:24:25,749
sense that if 2 processors store at the
 

1147
00:24:25,749 --> 00:24:27,950
sense that if 2 processors store at the
same time to the same memory address

1148
00:24:27,950 --> 00:24:27,960
same time to the same memory address
 

1149
00:24:27,960 --> 00:24:30,720
same time to the same memory address
32-bit values well you'll end up with is

1150
00:24:30,720 --> 00:24:30,730
32-bit values well you'll end up with is
 

1151
00:24:30,730 --> 00:24:33,149
32-bit values well you'll end up with is
either the 32 bits from one processor or

1152
00:24:33,149 --> 00:24:33,159
either the 32 bits from one processor or
 

1153
00:24:33,159 --> 00:24:35,159
either the 32 bits from one processor or
the 32 bits from the other processor but

1154
00:24:35,159 --> 00:24:35,169
the 32 bits from the other processor but
 

1155
00:24:35,169 --> 00:24:38,190
the 32 bits from the other processor but
not a mixture other sizes it's not so

1156
00:24:38,190 --> 00:24:38,200
not a mixture other sizes it's not so
 

1157
00:24:38,200 --> 00:24:40,440
not a mixture other sizes it's not so
clear like one byte stores it depends on

1158
00:24:40,440 --> 00:24:40,450
clear like one byte stores it depends on
 

1159
00:24:40,450 --> 00:24:41,970
clear like one byte stores it depends on
the CPU you using because a one byte

1160
00:24:41,970 --> 00:24:41,980
the CPU you using because a one byte
 

1161
00:24:41,980 --> 00:24:44,430
the CPU you using because a one byte
store is really almost certainly a 32

1162
00:24:44,430 --> 00:24:44,440
store is really almost certainly a 32
 

1163
00:24:44,440 --> 00:24:47,909
store is really almost certainly a 32
byte load and then a modification of 8

1164
00:24:47,909 --> 00:24:47,919
byte load and then a modification of 8
 

1165
00:24:47,919 --> 00:24:50,340
byte load and then a modification of 8
bits and a 32 byte store but it depends

1166
00:24:50,340 --> 00:24:50,350
bits and a 32 byte store but it depends
 

1167
00:24:50,350 --> 00:24:51,810
bits and a 32 byte store but it depends
on the processor and more complicated

1168
00:24:51,810 --> 00:24:51,820
on the processor and more complicated
 

1169
00:24:51,820 --> 00:24:54,599
on the processor and more complicated
instructions like increment your

1170
00:24:54,599 --> 00:24:54,609
instructions like increment your
 

1171
00:24:54,609 --> 00:24:55,889
instructions like increment your
microprocessor may well have an

1172
00:24:55,889 --> 00:24:55,899
microprocessor may well have an
 

1173
00:24:55,899 --> 00:24:57,749
microprocessor may well have an
increment instruction that can directly

1174
00:24:57,749 --> 00:24:57,759
increment instruction that can directly
 

1175
00:24:57,759 --> 00:25:00,210
increment instruction that can directly
increment some memory location like

1176
00:25:00,210 --> 00:25:00,220
increment some memory location like
 

1177
00:25:00,220 --> 00:25:04,229
increment some memory location like
pretty unlikely to be atomic although

1178
00:25:04,229 --> 00:25:04,239
pretty unlikely to be atomic although
 

1179
00:25:04,239 --> 00:25:05,609
pretty unlikely to be atomic although
there's atomic versions of some of these

1180
00:25:05,609 --> 00:25:05,619
there's atomic versions of some of these
 

1181
00:25:05,619 --> 00:25:07,880
there's atomic versions of some of these
instructions

1182
00:25:07,880 --> 00:25:07,890
instructions
 

1183
00:25:07,890 --> 00:25:12,730
instructions
so there's no way all right so this is

1184
00:25:12,730 --> 00:25:12,740
so there's no way all right so this is
 

1185
00:25:12,740 --> 00:25:16,669
so there's no way all right so this is
this is a just classic danger and it's

1186
00:25:16,669 --> 00:25:16,679
this is a just classic danger and it's
 

1187
00:25:16,679 --> 00:25:20,480
this is a just classic danger and it's
usually called a race I'm gonna come up

1188
00:25:20,480 --> 00:25:20,490
usually called a race I'm gonna come up
 

1189
00:25:20,490 --> 00:25:22,669
usually called a race I'm gonna come up
a lot is you're gonna do a lot of

1190
00:25:22,669 --> 00:25:22,679
a lot is you're gonna do a lot of
 

1191
00:25:22,679 --> 00:25:25,270
a lot is you're gonna do a lot of
threaded programming with shared state

1192
00:25:25,270 --> 00:25:25,280
threaded programming with shared state
 

1193
00:25:25,280 --> 00:25:27,740
threaded programming with shared state
race I think refers to as some ancient

1194
00:25:27,740 --> 00:25:27,750
race I think refers to as some ancient
 

1195
00:25:27,750 --> 00:25:30,560
race I think refers to as some ancient
class of bugs involving electronic

1196
00:25:30,560 --> 00:25:30,570
class of bugs involving electronic
 

1197
00:25:30,570 --> 00:25:33,650
class of bugs involving electronic
circuits but for us that you know the

1198
00:25:33,650 --> 00:25:33,660
circuits but for us that you know the
 

1199
00:25:33,660 --> 00:25:35,030
circuits but for us that you know the
reason why it's called a race is because

1200
00:25:35,030 --> 00:25:35,040
reason why it's called a race is because
 

1201
00:25:35,040 --> 00:25:37,760
reason why it's called a race is because
if one of the CPUs have started

1202
00:25:37,760 --> 00:25:37,770
if one of the CPUs have started
 

1203
00:25:37,770 --> 00:25:43,100
if one of the CPUs have started
executing this code and the other one

1204
00:25:43,100 --> 00:25:43,110
executing this code and the other one
 

1205
00:25:43,110 --> 00:25:44,780
executing this code and the other one
the others thread is sort of getting

1206
00:25:44,780 --> 00:25:44,790
the others thread is sort of getting
 

1207
00:25:44,790 --> 00:25:46,310
the others thread is sort of getting
close to this code it's sort of a race

1208
00:25:46,310 --> 00:25:46,320
close to this code it's sort of a race
 

1209
00:25:46,320 --> 00:25:48,080
close to this code it's sort of a race
as to whether the first processor can

1210
00:25:48,080 --> 00:25:48,090
as to whether the first processor can
 

1211
00:25:48,090 --> 00:25:50,299
as to whether the first processor can
finish and get to the store before the

1212
00:25:50,299 --> 00:25:50,309
finish and get to the store before the
 

1213
00:25:50,309 --> 00:25:53,360
finish and get to the store before the
second processor start status execute

1214
00:25:53,360 --> 00:25:53,370
second processor start status execute
 

1215
00:25:53,370 --> 00:25:54,799
second processor start status execute
the load if the first processor actually

1216
00:25:54,799 --> 00:25:54,809
the load if the first processor actually
 

1217
00:25:54,809 --> 00:25:57,200
the load if the first processor actually
manages it to do the store before the

1218
00:25:57,200 --> 00:25:57,210
manages it to do the store before the
 

1219
00:25:57,210 --> 00:25:59,060
manages it to do the store before the
second processor gets to the load then

1220
00:25:59,060 --> 00:25:59,070
second processor gets to the load then
 

1221
00:25:59,070 --> 00:26:00,740
second processor gets to the load then
the second processor will see the stored

1222
00:26:00,740 --> 00:26:00,750
the second processor will see the stored
 

1223
00:26:00,750 --> 00:26:03,440
the second processor will see the stored
value and the second processor will load

1224
00:26:03,440 --> 00:26:03,450
value and the second processor will load
 

1225
00:26:03,450 --> 00:26:07,360
value and the second processor will load
one and add one to it in store two

1226
00:26:07,360 --> 00:26:07,370

 

1227
00:26:07,370 --> 00:26:10,190

that's how you can justify this

1228
00:26:10,190 --> 00:26:10,200
that's how you can justify this
 

1229
00:26:10,200 --> 00:26:13,669
that's how you can justify this
terminology okay and so the way you

1230
00:26:13,669 --> 00:26:13,679
terminology okay and so the way you
 

1231
00:26:13,679 --> 00:26:15,260
terminology okay and so the way you
solve this certainly something this

1232
00:26:15,260 --> 00:26:15,270
solve this certainly something this
 

1233
00:26:15,270 --> 00:26:16,880
solve this certainly something this
simple is you insert locks

1234
00:26:16,880 --> 00:26:16,890
simple is you insert locks
 

1235
00:26:16,890 --> 00:26:19,460
simple is you insert locks
you know you as a programmer you have

1236
00:26:19,460 --> 00:26:19,470
you know you as a programmer you have
 

1237
00:26:19,470 --> 00:26:23,900
you know you as a programmer you have
some strategy in mind for locking the

1238
00:26:23,900 --> 00:26:23,910
some strategy in mind for locking the
 

1239
00:26:23,910 --> 00:26:26,260
some strategy in mind for locking the
data you can say well you know this

1240
00:26:26,260 --> 00:26:26,270
data you can say well you know this
 

1241
00:26:26,270 --> 00:26:28,820
data you can say well you know this
piece of shared data can only be used

1242
00:26:28,820 --> 00:26:28,830
piece of shared data can only be used
 

1243
00:26:28,830 --> 00:26:31,490
piece of shared data can only be used
when such-and-such a lock is held and

1244
00:26:31,490 --> 00:26:31,500
when such-and-such a lock is held and
 

1245
00:26:31,500 --> 00:26:33,080
when such-and-such a lock is held and
you'll see this and you may have used

1246
00:26:33,080 --> 00:26:33,090
you'll see this and you may have used
 

1247
00:26:33,090 --> 00:26:36,650
you'll see this and you may have used
this in the tutorial the go calls locks

1248
00:26:36,650 --> 00:26:36,660
this in the tutorial the go calls locks
 

1249
00:26:36,660 --> 00:26:39,789
this in the tutorial the go calls locks
mutexes so what you'll see is a mule Ock

1250
00:26:39,789 --> 00:26:39,799
mutexes so what you'll see is a mule Ock
 

1251
00:26:39,799 --> 00:26:44,120
mutexes so what you'll see is a mule Ock
before a sequence of code that uses

1252
00:26:44,120 --> 00:26:44,130
before a sequence of code that uses
 

1253
00:26:44,130 --> 00:26:48,310
before a sequence of code that uses
shared data and you unlock afterwards

1254
00:26:48,310 --> 00:26:48,320
shared data and you unlock afterwards
 

1255
00:26:48,320 --> 00:26:52,010
shared data and you unlock afterwards
and then whichever two threads execute

1256
00:26:52,010 --> 00:26:52,020
and then whichever two threads execute
 

1257
00:26:52,020 --> 00:26:53,330
and then whichever two threads execute
this when it to everyone is lucky enough

1258
00:26:53,330 --> 00:26:53,340
this when it to everyone is lucky enough
 

1259
00:26:53,340 --> 00:26:56,210
this when it to everyone is lucky enough
to get the lock first gets to do all

1260
00:26:56,210 --> 00:26:56,220
to get the lock first gets to do all
 

1261
00:26:56,220 --> 00:26:57,590
to get the lock first gets to do all
this stuff and finish before the other

1262
00:26:57,590 --> 00:26:57,600
this stuff and finish before the other
 

1263
00:26:57,600 --> 00:26:59,840
this stuff and finish before the other
one is allowed to proceed and so you can

1264
00:26:59,840 --> 00:26:59,850
one is allowed to proceed and so you can
 

1265
00:26:59,850 --> 00:27:02,330
one is allowed to proceed and so you can
think of wrapping a some code in a lock

1266
00:27:02,330 --> 00:27:02,340
think of wrapping a some code in a lock
 

1267
00:27:02,340 --> 00:27:05,450
think of wrapping a some code in a lock
as making a bunch of you know remember

1268
00:27:05,450 --> 00:27:05,460
as making a bunch of you know remember
 

1269
00:27:05,460 --> 00:27:07,010
as making a bunch of you know remember
this even though it's one line it's

1270
00:27:07,010 --> 00:27:07,020
this even though it's one line it's
 

1271
00:27:07,020 --> 00:27:10,370
this even though it's one line it's
really three distinct operations you can

1272
00:27:10,370 --> 00:27:10,380
really three distinct operations you can
 

1273
00:27:10,380 --> 00:27:13,659
really three distinct operations you can
think of a lock as causing this sort of

1274
00:27:13,659 --> 00:27:13,669
think of a lock as causing this sort of
 

1275
00:27:13,669 --> 00:27:16,030
think of a lock as causing this sort of
multi-step code sequence to be atomic

1276
00:27:16,030 --> 00:27:16,040
multi-step code sequence to be atomic
 

1277
00:27:16,040 --> 00:27:18,230
multi-step code sequence to be atomic
with respect to other people who have to

1278
00:27:18,230 --> 00:27:18,240
with respect to other people who have to
 

1279
00:27:18,240 --> 00:27:26,360
with respect to other people who have to
lock yes

1280
00:27:26,360 --> 00:27:26,370

 

1281
00:27:26,370 --> 00:27:30,570

should you can you repeat the

1282
00:27:30,570 --> 00:27:30,580
should you can you repeat the
 

1283
00:27:30,580 --> 00:27:30,960
should you can you repeat the
question

1284
00:27:30,960 --> 00:27:30,970
question
 

1285
00:27:30,970 --> 00:27:37,080
question
oh that's a great question the question

1286
00:27:37,080 --> 00:27:37,090
oh that's a great question the question
 

1287
00:27:37,090 --> 00:27:39,030
oh that's a great question the question
was how does go know which variable

1288
00:27:39,030 --> 00:27:39,040
was how does go know which variable
 

1289
00:27:39,040 --> 00:27:41,340
was how does go know which variable
we're walking right here of course is

1290
00:27:41,340 --> 00:27:41,350
we're walking right here of course is
 

1291
00:27:41,350 --> 00:27:43,080
we're walking right here of course is
only one variable but maybe we're saying

1292
00:27:43,080 --> 00:27:43,090
only one variable but maybe we're saying
 

1293
00:27:43,090 --> 00:27:45,900
only one variable but maybe we're saying
an equals x plus y really threes few

1294
00:27:45,900 --> 00:27:45,910
an equals x plus y really threes few
 

1295
00:27:45,910 --> 00:27:47,430
an equals x plus y really threes few
different variables and the answer is

1296
00:27:47,430 --> 00:27:47,440
different variables and the answer is
 

1297
00:27:47,440 --> 00:27:52,880
different variables and the answer is
that go has no idea it's not there's no

1298
00:27:52,880 --> 00:27:52,890
that go has no idea it's not there's no
 

1299
00:27:52,890 --> 00:27:55,020
that go has no idea it's not there's no
Association at all

1300
00:27:55,020 --> 00:27:55,030
Association at all
 

1301
00:27:55,030 --> 00:27:58,020
Association at all
anywhere between this lock so this new

1302
00:27:58,020 --> 00:27:58,030
anywhere between this lock so this new
 

1303
00:27:58,030 --> 00:28:00,630
anywhere between this lock so this new
thing is a variable which is a tight

1304
00:28:00,630 --> 00:28:00,640
thing is a variable which is a tight
 

1305
00:28:00,640 --> 00:28:04,590
thing is a variable which is a tight
mutex there's just there's no

1306
00:28:04,590 --> 00:28:04,600
mutex there's just there's no
 

1307
00:28:04,600 --> 00:28:07,620
mutex there's just there's no
association in the language between the

1308
00:28:07,620 --> 00:28:07,630
association in the language between the
 

1309
00:28:07,630 --> 00:28:10,710
association in the language between the
lock and any variables the associations

1310
00:28:10,710 --> 00:28:10,720
lock and any variables the associations
 

1311
00:28:10,720 --> 00:28:12,330
lock and any variables the associations
in the programmers head so as a

1312
00:28:12,330 --> 00:28:12,340
in the programmers head so as a
 

1313
00:28:12,340 --> 00:28:14,460
in the programmers head so as a
programmer you need to say oh here's a

1314
00:28:14,460 --> 00:28:14,470
programmer you need to say oh here's a
 

1315
00:28:14,470 --> 00:28:18,660
programmer you need to say oh here's a
bunch of shared data and any time you

1316
00:28:18,660 --> 00:28:18,670
bunch of shared data and any time you
 

1317
00:28:18,670 --> 00:28:20,760
bunch of shared data and any time you
modify any of it you know here's a

1318
00:28:20,760 --> 00:28:20,770
modify any of it you know here's a
 

1319
00:28:20,770 --> 00:28:22,800
modify any of it you know here's a
complex data structure say a tree or an

1320
00:28:22,800 --> 00:28:22,810
complex data structure say a tree or an
 

1321
00:28:22,810 --> 00:28:24,270
complex data structure say a tree or an
expandable hash table or something

1322
00:28:24,270 --> 00:28:24,280
expandable hash table or something
 

1323
00:28:24,280 --> 00:28:26,550
expandable hash table or something
anytime you're going to modify it and of

1324
00:28:26,550 --> 00:28:26,560
anytime you're going to modify it and of
 

1325
00:28:26,560 --> 00:28:27,810
anytime you're going to modify it and of
course a tree is composed many many

1326
00:28:27,810 --> 00:28:27,820
course a tree is composed many many
 

1327
00:28:27,820 --> 00:28:29,700
course a tree is composed many many
objects anytime you got to modify

1328
00:28:29,700 --> 00:28:29,710
objects anytime you got to modify
 

1329
00:28:29,710 --> 00:28:30,870
objects anytime you got to modify
anything that's associated with this

1330
00:28:30,870 --> 00:28:30,880
anything that's associated with this
 

1331
00:28:30,880 --> 00:28:32,280
anything that's associated with this
data structure you have to hold such and

1332
00:28:32,280 --> 00:28:32,290
data structure you have to hold such and
 

1333
00:28:32,290 --> 00:28:34,530
data structure you have to hold such and
such a lock right and of course is many

1334
00:28:34,530 --> 00:28:34,540
such a lock right and of course is many
 

1335
00:28:34,540 --> 00:28:36,570
such a lock right and of course is many
objects and instead of objects changes

1336
00:28:36,570 --> 00:28:36,580
objects and instead of objects changes
 

1337
00:28:36,580 --> 00:28:37,620
objects and instead of objects changes
because you might allocate new tree

1338
00:28:37,620 --> 00:28:37,630
because you might allocate new tree
 

1339
00:28:37,630 --> 00:28:40,110
because you might allocate new tree
nodes but it's really the programmer who

1340
00:28:40,110 --> 00:28:40,120
nodes but it's really the programmer who
 

1341
00:28:40,120 --> 00:28:41,970
nodes but it's really the programmer who
sort of works out a strategy for

1342
00:28:41,970 --> 00:28:41,980
sort of works out a strategy for
 

1343
00:28:41,980 --> 00:28:44,700
sort of works out a strategy for
ensuring that the data structure is used

1344
00:28:44,700 --> 00:28:44,710
ensuring that the data structure is used
 

1345
00:28:44,710 --> 00:28:47,460
ensuring that the data structure is used
by only one core at a time and so it

1346
00:28:47,460 --> 00:28:47,470
by only one core at a time and so it
 

1347
00:28:47,470 --> 00:28:50,250
by only one core at a time and so it
creates the one or maybe more locks and

1348
00:28:50,250 --> 00:28:50,260
creates the one or maybe more locks and
 

1349
00:28:50,260 --> 00:28:51,660
creates the one or maybe more locks and
there's many many locking strategies you

1350
00:28:51,660 --> 00:28:51,670
there's many many locking strategies you
 

1351
00:28:51,670 --> 00:28:53,010
there's many many locking strategies you
could apply to a tree you can imagine a

1352
00:28:53,010 --> 00:28:53,020
could apply to a tree you can imagine a
 

1353
00:28:53,020 --> 00:28:57,570
could apply to a tree you can imagine a
tree with a lock for every tree node the

1354
00:28:57,570 --> 00:28:57,580
tree with a lock for every tree node the
 

1355
00:28:57,580 --> 00:28:58,770
tree with a lock for every tree node the
programmer works out the strategy

1356
00:28:58,770 --> 00:28:58,780
programmer works out the strategy
 

1357
00:28:58,780 --> 00:29:00,660
programmer works out the strategy
allocates the locks and keeps in the

1358
00:29:00,660 --> 00:29:00,670
allocates the locks and keeps in the
 

1359
00:29:00,670 --> 00:29:02,220
allocates the locks and keeps in the
programmers head the relationship to the

1360
00:29:02,220 --> 00:29:02,230
programmers head the relationship to the
 

1361
00:29:02,230 --> 00:29:04,950
programmers head the relationship to the
data but go for go it's this is this

1362
00:29:04,950 --> 00:29:04,960
data but go for go it's this is this
 

1363
00:29:04,960 --> 00:29:07,680
data but go for go it's this is this
lock it's just like a very simple thing

1364
00:29:07,680 --> 00:29:07,690
lock it's just like a very simple thing
 

1365
00:29:07,690 --> 00:29:10,920
lock it's just like a very simple thing
there's a lock object the first thread

1366
00:29:10,920 --> 00:29:10,930
there's a lock object the first thread
 

1367
00:29:10,930 --> 00:29:12,960
there's a lock object the first thread
that calls lock gets the lock other

1368
00:29:12,960 --> 00:29:12,970
that calls lock gets the lock other
 

1369
00:29:12,970 --> 00:29:14,760
that calls lock gets the lock other
threads have to wait until none locks

1370
00:29:14,760 --> 00:29:14,770
threads have to wait until none locks
 

1371
00:29:14,770 --> 00:29:18,790
threads have to wait until none locks
and that's all go knows

1372
00:29:18,790 --> 00:29:18,800

 

1373
00:29:18,800 --> 00:29:23,980

yeah

1374
00:29:23,980 --> 00:29:23,990

 

1375
00:29:23,990 --> 00:29:26,720

does it not lock all variables that are

1376
00:29:26,720 --> 00:29:26,730
does it not lock all variables that are
 

1377
00:29:26,730 --> 00:29:29,030
does it not lock all variables that are
part of the object go doesn't know

1378
00:29:29,030 --> 00:29:29,040
part of the object go doesn't know
 

1379
00:29:29,040 --> 00:29:30,680
part of the object go doesn't know
anything about the relationship between

1380
00:29:30,680 --> 00:29:30,690
anything about the relationship between
 

1381
00:29:30,690 --> 00:29:33,710
anything about the relationship between
variables and locks so when you acquire

1382
00:29:33,710 --> 00:29:33,720
variables and locks so when you acquire
 

1383
00:29:33,720 --> 00:29:37,700
variables and locks so when you acquire
that lock when you have code that calls

1384
00:29:37,700 --> 00:29:37,710
that lock when you have code that calls
 

1385
00:29:37,710 --> 00:29:41,270
that lock when you have code that calls
lock exactly what it is doing it is

1386
00:29:41,270 --> 00:29:41,280
lock exactly what it is doing it is
 

1387
00:29:41,280 --> 00:29:44,210
lock exactly what it is doing it is
acquiring this lock and that's all this

1388
00:29:44,210 --> 00:29:44,220
acquiring this lock and that's all this
 

1389
00:29:44,220 --> 00:29:47,270
acquiring this lock and that's all this
does and anybody else who tries to lock

1390
00:29:47,270 --> 00:29:47,280
does and anybody else who tries to lock
 

1391
00:29:47,280 --> 00:29:49,250
does and anybody else who tries to lock
objects so somewhere else who would have

1392
00:29:49,250 --> 00:29:49,260
objects so somewhere else who would have
 

1393
00:29:49,260 --> 00:29:55,160
objects so somewhere else who would have
declared you know mutex knew all right

1394
00:29:55,160 --> 00:29:55,170
declared you know mutex knew all right
 

1395
00:29:55,170 --> 00:29:56,570
declared you know mutex knew all right
and this mu refers to some particular

1396
00:29:56,570 --> 00:29:56,580
and this mu refers to some particular
 

1397
00:29:56,580 --> 00:29:58,400
and this mu refers to some particular
lock object no and there me many many

1398
00:29:58,400 --> 00:29:58,410
lock object no and there me many many
 

1399
00:29:58,410 --> 00:30:01,340
lock object no and there me many many
locks right all this does is acquires

1400
00:30:01,340 --> 00:30:01,350
locks right all this does is acquires
 

1401
00:30:01,350 --> 00:30:04,610
locks right all this does is acquires
this lock and anybody else who wants to

1402
00:30:04,610 --> 00:30:04,620
this lock and anybody else who wants to
 

1403
00:30:04,620 --> 00:30:05,990
this lock and anybody else who wants to
acquire it has to wait until we unlock

1404
00:30:05,990 --> 00:30:06,000
acquire it has to wait until we unlock
 

1405
00:30:06,000 --> 00:30:09,110
acquire it has to wait until we unlock
this lock that's totally up to us as

1406
00:30:09,110 --> 00:30:09,120
this lock that's totally up to us as
 

1407
00:30:09,120 --> 00:30:11,960
this lock that's totally up to us as
programmers what we were protecting with

1408
00:30:11,960 --> 00:30:11,970
programmers what we were protecting with
 

1409
00:30:11,970 --> 00:30:33,560
programmers what we were protecting with
that lock so the question is is it

1410
00:30:33,560 --> 00:30:33,570
that lock so the question is is it
 

1411
00:30:33,570 --> 00:30:38,090
that lock so the question is is it
better to have the lock be a private the

1412
00:30:38,090 --> 00:30:38,100
better to have the lock be a private the
 

1413
00:30:38,100 --> 00:30:39,650
better to have the lock be a private the
private business of the data structure

1414
00:30:39,650 --> 00:30:39,660
private business of the data structure
 

1415
00:30:39,660 --> 00:30:42,880
private business of the data structure
like supposing it a zoning map yeah and

1416
00:30:42,880 --> 00:30:42,890
like supposing it a zoning map yeah and
 

1417
00:30:42,890 --> 00:30:44,810
like supposing it a zoning map yeah and
you know you would hope although it's

1418
00:30:44,810 --> 00:30:44,820
you know you would hope although it's
 

1419
00:30:44,820 --> 00:30:46,850
you know you would hope although it's
not true that map internally would have

1420
00:30:46,850 --> 00:30:46,860
not true that map internally would have
 

1421
00:30:46,860 --> 00:30:49,850
not true that map internally would have
a lock protecting it and that's a

1422
00:30:49,850 --> 00:30:49,860
a lock protecting it and that's a
 

1423
00:30:49,860 --> 00:30:54,230
a lock protecting it and that's a
reasonable strategy would be to have I

1424
00:30:54,230 --> 00:30:54,240
reasonable strategy would be to have I
 

1425
00:30:54,240 --> 00:30:56,330
reasonable strategy would be to have I
mean what would be to have it if you

1426
00:30:56,330 --> 00:30:56,340
mean what would be to have it if you
 

1427
00:30:56,340 --> 00:30:58,340
mean what would be to have it if you
define a data structure that needs to be

1428
00:30:58,340 --> 00:30:58,350
define a data structure that needs to be
 

1429
00:30:58,350 --> 00:30:59,810
define a data structure that needs to be
locked to have the lock be sort of

1430
00:30:59,810 --> 00:30:59,820
locked to have the lock be sort of
 

1431
00:30:59,820 --> 00:31:01,640
locked to have the lock be sort of
interior that have each of the data

1432
00:31:01,640 --> 00:31:01,650
interior that have each of the data
 

1433
00:31:01,650 --> 00:31:03,200
interior that have each of the data
structures methods be responsible for

1434
00:31:03,200 --> 00:31:03,210
structures methods be responsible for
 

1435
00:31:03,210 --> 00:31:04,850
structures methods be responsible for
acquiring that lock and the user the

1436
00:31:04,850 --> 00:31:04,860
acquiring that lock and the user the
 

1437
00:31:04,860 --> 00:31:06,830
acquiring that lock and the user the
data structure may never know that

1438
00:31:06,830 --> 00:31:06,840
data structure may never know that
 

1439
00:31:06,840 --> 00:31:09,200
data structure may never know that
that's pretty reasonable and the only

1440
00:31:09,200 --> 00:31:09,210
that's pretty reasonable and the only
 

1441
00:31:09,210 --> 00:31:10,820
that's pretty reasonable and the only
point at which that breaks down is that

1442
00:31:10,820 --> 00:31:10,830
point at which that breaks down is that
 

1443
00:31:10,830 --> 00:31:15,920
point at which that breaks down is that
um well it's a couple things one is if

1444
00:31:15,920 --> 00:31:15,930
um well it's a couple things one is if
 

1445
00:31:15,930 --> 00:31:18,080
um well it's a couple things one is if
the programmer knew that the data was

1446
00:31:18,080 --> 00:31:18,090
the programmer knew that the data was
 

1447
00:31:18,090 --> 00:31:20,900
the programmer knew that the data was
never shared they might be bummed that

1448
00:31:20,900 --> 00:31:20,910
never shared they might be bummed that
 

1449
00:31:20,910 --> 00:31:22,190
never shared they might be bummed that
they were paying the lock overhead for

1450
00:31:22,190 --> 00:31:22,200
they were paying the lock overhead for
 

1451
00:31:22,200 --> 00:31:23,390
they were paying the lock overhead for
something they knew didn't need to be

1452
00:31:23,390 --> 00:31:23,400
something they knew didn't need to be
 

1453
00:31:23,400 --> 00:31:25,810
something they knew didn't need to be
locked so that's one potential problem

1454
00:31:25,810 --> 00:31:25,820
locked so that's one potential problem
 

1455
00:31:25,820 --> 00:31:31,130
locked so that's one potential problem
the other is that if you if there's any

1456
00:31:31,130 --> 00:31:31,140
the other is that if you if there's any
 

1457
00:31:31,140 --> 00:31:33,050
the other is that if you if there's any
inter data structure of dependencies so

1458
00:31:33,050 --> 00:31:33,060
inter data structure of dependencies so
 

1459
00:31:33,060 --> 00:31:35,030
inter data structure of dependencies so
we have two data structures each with

1460
00:31:35,030 --> 00:31:35,040
we have two data structures each with
 

1461
00:31:35,040 --> 00:31:36,010
we have two data structures each with
locks and

1462
00:31:36,010 --> 00:31:36,020
locks and
 

1463
00:31:36,020 --> 00:31:38,700
locks and
and they maybe use each other then

1464
00:31:38,700 --> 00:31:38,710
and they maybe use each other then
 

1465
00:31:38,710 --> 00:31:41,070
and they maybe use each other then
there's a risk of cycles and deadlocks

1466
00:31:41,070 --> 00:31:41,080
there's a risk of cycles and deadlocks
 

1467
00:31:41,080 --> 00:31:45,150
there's a risk of cycles and deadlocks
right and the deadlocks can be solved

1468
00:31:45,150 --> 00:31:45,160
right and the deadlocks can be solved
 

1469
00:31:45,160 --> 00:31:47,590
right and the deadlocks can be solved
but the usual solutions to deadlocks

1470
00:31:47,590 --> 00:31:47,600
but the usual solutions to deadlocks
 

1471
00:31:47,600 --> 00:31:52,360
but the usual solutions to deadlocks
requires lifting the locks out of out of

1472
00:31:52,360 --> 00:31:52,370
requires lifting the locks out of out of
 

1473
00:31:52,370 --> 00:31:54,280
requires lifting the locks out of out of
the implementations up into the calling

1474
00:31:54,280 --> 00:31:54,290
the implementations up into the calling
 

1475
00:31:54,290 --> 00:31:55,990
the implementations up into the calling
code I will talk about that some point

1476
00:31:55,990 --> 00:31:56,000
code I will talk about that some point
 

1477
00:31:56,000 --> 00:31:59,170
code I will talk about that some point
but it's not a it's a good idea to hide

1478
00:31:59,170 --> 00:31:59,180
but it's not a it's a good idea to hide
 

1479
00:31:59,180 --> 00:32:00,700
but it's not a it's a good idea to hide
the locks but it's not always a good

1480
00:32:00,700 --> 00:32:00,710
the locks but it's not always a good
 

1481
00:32:00,710 --> 00:32:11,590
the locks but it's not always a good
idea all right okay so one problem you

1482
00:32:11,590 --> 00:32:11,600
idea all right okay so one problem you
 

1483
00:32:11,600 --> 00:32:14,050
idea all right okay so one problem you
run into with threads is these races and

1484
00:32:14,050 --> 00:32:14,060
run into with threads is these races and
 

1485
00:32:14,060 --> 00:32:16,360
run into with threads is these races and
generally you solve them with locks okay

1486
00:32:16,360 --> 00:32:16,370
generally you solve them with locks okay
 

1487
00:32:16,370 --> 00:32:18,010
generally you solve them with locks okay
or actually there's two big strategies

1488
00:32:18,010 --> 00:32:18,020
or actually there's two big strategies
 

1489
00:32:18,020 --> 00:32:19,420
or actually there's two big strategies
one is you figure out some locking

1490
00:32:19,420 --> 00:32:19,430
one is you figure out some locking
 

1491
00:32:19,430 --> 00:32:22,320
one is you figure out some locking
strategy for making access to the data

1492
00:32:22,320 --> 00:32:22,330
strategy for making access to the data
 

1493
00:32:22,330 --> 00:32:25,170
strategy for making access to the data
single thread one thread at a time or

1494
00:32:25,170 --> 00:32:25,180
single thread one thread at a time or
 

1495
00:32:25,180 --> 00:32:29,160
single thread one thread at a time or
yury you fix your code to not share data

1496
00:32:29,160 --> 00:32:29,170
yury you fix your code to not share data
 

1497
00:32:29,170 --> 00:32:32,410
yury you fix your code to not share data
if you can do that it's that's probably

1498
00:32:32,410 --> 00:32:32,420
if you can do that it's that's probably
 

1499
00:32:32,420 --> 00:32:35,530
if you can do that it's that's probably
better because it's less complex all

1500
00:32:35,530 --> 00:32:35,540
better because it's less complex all
 

1501
00:32:35,540 --> 00:32:38,320
better because it's less complex all
right so another issue that shows up

1502
00:32:38,320 --> 00:32:38,330
right so another issue that shows up
 

1503
00:32:38,330 --> 00:32:40,090
right so another issue that shows up
with leads threads is called

1504
00:32:40,090 --> 00:32:40,100
with leads threads is called
 

1505
00:32:40,100 --> 00:32:44,770
with leads threads is called
coordination when we're doing locking

1506
00:32:44,770 --> 00:32:44,780
coordination when we're doing locking
 

1507
00:32:44,780 --> 00:32:46,660
coordination when we're doing locking
the different threads involved probably

1508
00:32:46,660 --> 00:32:46,670
the different threads involved probably
 

1509
00:32:46,670 --> 00:32:48,520
the different threads involved probably
have no idea that the other ones exist

1510
00:32:48,520 --> 00:32:48,530
have no idea that the other ones exist
 

1511
00:32:48,530 --> 00:32:49,810
have no idea that the other ones exist
they just want to like be able to get

1512
00:32:49,810 --> 00:32:49,820
they just want to like be able to get
 

1513
00:32:49,820 --> 00:32:51,640
they just want to like be able to get
out the data without anybody else

1514
00:32:51,640 --> 00:32:51,650
out the data without anybody else
 

1515
00:32:51,650 --> 00:32:53,950
out the data without anybody else
interfering but there are also cases

1516
00:32:53,950 --> 00:32:53,960
interfering but there are also cases
 

1517
00:32:53,960 --> 00:32:55,210
interfering but there are also cases
where you need where you do

1518
00:32:55,210 --> 00:32:55,220
where you need where you do
 

1519
00:32:55,220 --> 00:32:56,860
where you need where you do
intentionally want different threads to

1520
00:32:56,860 --> 00:32:56,870
intentionally want different threads to
 

1521
00:32:56,870 --> 00:32:58,360
intentionally want different threads to
interact I want to wait for you

1522
00:32:58,360 --> 00:32:58,370
interact I want to wait for you
 

1523
00:32:58,370 --> 00:32:59,920
interact I want to wait for you
maybe you're producing some data you

1524
00:32:59,920 --> 00:32:59,930
maybe you're producing some data you
 

1525
00:32:59,930 --> 00:33:01,540
maybe you're producing some data you
know you're a different thread than me

1526
00:33:01,540 --> 00:33:01,550
know you're a different thread than me
 

1527
00:33:01,550 --> 00:33:03,130
know you're a different thread than me
you're you're producing data I'm gonna

1528
00:33:03,130 --> 00:33:03,140
you're you're producing data I'm gonna
 

1529
00:33:03,140 --> 00:33:05,890
you're you're producing data I'm gonna
wait until you've generated the data

1530
00:33:05,890 --> 00:33:05,900
wait until you've generated the data
 

1531
00:33:05,900 --> 00:33:09,970
wait until you've generated the data
before I read it right or you launch a

1532
00:33:09,970 --> 00:33:09,980
before I read it right or you launch a
 

1533
00:33:09,980 --> 00:33:11,170
before I read it right or you launch a
bunch of threads to say you crawl the

1534
00:33:11,170 --> 00:33:11,180
bunch of threads to say you crawl the
 

1535
00:33:11,180 --> 00:33:12,430
bunch of threads to say you crawl the
web and you want to wait for all those

1536
00:33:12,430 --> 00:33:12,440
web and you want to wait for all those
 

1537
00:33:12,440 --> 00:33:14,170
web and you want to wait for all those
fits to finish so there's times when we

1538
00:33:14,170 --> 00:33:14,180
fits to finish so there's times when we
 

1539
00:33:14,180 --> 00:33:16,960
fits to finish so there's times when we
intentionally want different to us to

1540
00:33:16,960 --> 00:33:16,970
intentionally want different to us to
 

1541
00:33:16,970 --> 00:33:18,250
intentionally want different to us to
interact with each other to wait for

1542
00:33:18,250 --> 00:33:18,260
interact with each other to wait for
 

1543
00:33:18,260 --> 00:33:18,760
interact with each other to wait for
each other

1544
00:33:18,760 --> 00:33:18,770
each other
 

1545
00:33:18,770 --> 00:33:23,430
each other
and that's usually called coordination

1546
00:33:23,430 --> 00:33:23,440

 

1547
00:33:23,440 --> 00:33:26,620

and there's a bunch of as you probably

1548
00:33:26,620 --> 00:33:26,630
and there's a bunch of as you probably
 

1549
00:33:26,630 --> 00:33:28,240
and there's a bunch of as you probably
know from having done the tutorial

1550
00:33:28,240 --> 00:33:28,250
know from having done the tutorial
 

1551
00:33:28,250 --> 00:33:31,210
know from having done the tutorial
there's a bunch of techniques in go for

1552
00:33:31,210 --> 00:33:31,220
there's a bunch of techniques in go for
 

1553
00:33:31,220 --> 00:33:34,289
there's a bunch of techniques in go for
doing this like channels

1554
00:33:34,289 --> 00:33:34,299
doing this like channels
 

1555
00:33:34,299 --> 00:33:37,019
doing this like channels
which are really about sending data from

1556
00:33:37,019 --> 00:33:37,029
which are really about sending data from
 

1557
00:33:37,029 --> 00:33:38,940
which are really about sending data from
one threat to another and breeding but

1558
00:33:38,940 --> 00:33:38,950
one threat to another and breeding but
 

1559
00:33:38,950 --> 00:33:42,029
one threat to another and breeding but
they did to be sent there's also other

1560
00:33:42,029 --> 00:33:42,039
they did to be sent there's also other
 

1561
00:33:42,039 --> 00:33:45,229
they did to be sent there's also other
stuff that more special purpose things

1562
00:33:45,229 --> 00:33:45,239
stuff that more special purpose things
 

1563
00:33:45,239 --> 00:33:48,930
stuff that more special purpose things
like there's a idea called condition

1564
00:33:48,930 --> 00:33:48,940
like there's a idea called condition
 

1565
00:33:48,940 --> 00:33:51,539
like there's a idea called condition
variables which is great if there's some

1566
00:33:51,539 --> 00:33:51,549
variables which is great if there's some
 

1567
00:33:51,549 --> 00:33:53,219
variables which is great if there's some
thread out there and you want to kick it

1568
00:33:53,219 --> 00:33:53,229
thread out there and you want to kick it
 

1569
00:33:53,229 --> 00:33:54,479
thread out there and you want to kick it
period you're not sure if the other

1570
00:33:54,479 --> 00:33:54,489
period you're not sure if the other
 

1571
00:33:54,489 --> 00:33:55,829
period you're not sure if the other
threads even waiting for you but if it

1572
00:33:55,829 --> 00:33:55,839
threads even waiting for you but if it
 

1573
00:33:55,839 --> 00:33:57,449
threads even waiting for you but if it
is waiting for you you just like to give

1574
00:33:57,449 --> 00:33:57,459
is waiting for you you just like to give
 

1575
00:33:57,459 --> 00:33:59,489
is waiting for you you just like to give
it a kick so it can well know that it

1576
00:33:59,489 --> 00:33:59,499
it a kick so it can well know that it
 

1577
00:33:59,499 --> 00:34:01,499
it a kick so it can well know that it
should continue whatever it's doing and

1578
00:34:01,499 --> 00:34:01,509
should continue whatever it's doing and
 

1579
00:34:01,509 --> 00:34:06,269
should continue whatever it's doing and
then there's wait group which is

1580
00:34:06,269 --> 00:34:06,279
then there's wait group which is
 

1581
00:34:06,279 --> 00:34:08,250
then there's wait group which is
particularly good for launching a a

1582
00:34:08,250 --> 00:34:08,260
particularly good for launching a a
 

1583
00:34:08,260 --> 00:34:10,440
particularly good for launching a a
known number of go routines and then

1584
00:34:10,440 --> 00:34:10,450
known number of go routines and then
 

1585
00:34:10,450 --> 00:34:14,460
known number of go routines and then
waiting for them Dolph to finish and a

1586
00:34:14,460 --> 00:34:14,470
waiting for them Dolph to finish and a
 

1587
00:34:14,470 --> 00:34:16,049
waiting for them Dolph to finish and a
final piece of damage that comes up with

1588
00:34:16,049 --> 00:34:16,059
final piece of damage that comes up with
 

1589
00:34:16,059 --> 00:34:23,609
final piece of damage that comes up with
threads deadlock the deadlock refers to

1590
00:34:23,609 --> 00:34:23,619
threads deadlock the deadlock refers to
 

1591
00:34:23,619 --> 00:34:25,919
threads deadlock the deadlock refers to
the general problem that you sometimes

1592
00:34:25,919 --> 00:34:25,929
the general problem that you sometimes
 

1593
00:34:25,929 --> 00:34:29,210
the general problem that you sometimes
run into where one thread

1594
00:34:29,210 --> 00:34:29,220
run into where one thread
 

1595
00:34:29,220 --> 00:34:32,819
run into where one thread
you know thread this thread is waiting

1596
00:34:32,819 --> 00:34:32,829
you know thread this thread is waiting
 

1597
00:34:32,829 --> 00:34:35,849
you know thread this thread is waiting
for thread two to produce something so

1598
00:34:35,849 --> 00:34:35,859
for thread two to produce something so
 

1599
00:34:35,859 --> 00:34:37,740
for thread two to produce something so
you know it's draw an arrow to say

1600
00:34:37,740 --> 00:34:37,750
you know it's draw an arrow to say
 

1601
00:34:37,750 --> 00:34:41,159
you know it's draw an arrow to say
thread one is waiting for thread two you

1602
00:34:41,159 --> 00:34:41,169
thread one is waiting for thread two you
 

1603
00:34:41,169 --> 00:34:42,269
thread one is waiting for thread two you
know for example thread one may be

1604
00:34:42,269 --> 00:34:42,279
know for example thread one may be
 

1605
00:34:42,279 --> 00:34:43,980
know for example thread one may be
waiting for thread two to release a lock

1606
00:34:43,980 --> 00:34:43,990
waiting for thread two to release a lock
 

1607
00:34:43,990 --> 00:34:46,680
waiting for thread two to release a lock
or to send something on the channel or

1608
00:34:46,680 --> 00:34:46,690
or to send something on the channel or
 

1609
00:34:46,690 --> 00:34:48,269
or to send something on the channel or
to you know decrement something in a

1610
00:34:48,269 --> 00:34:48,279
to you know decrement something in a
 

1611
00:34:48,279 --> 00:34:51,569
to you know decrement something in a
wait group however unfortunately maybe T

1612
00:34:51,569 --> 00:34:51,579
wait group however unfortunately maybe T
 

1613
00:34:51,579 --> 00:34:55,200
wait group however unfortunately maybe T
two is waiting for thread thread one to

1614
00:34:55,200 --> 00:34:55,210
two is waiting for thread thread one to
 

1615
00:34:55,210 --> 00:34:57,890
two is waiting for thread thread one to
do something and this is particularly

1616
00:34:57,890 --> 00:34:57,900
do something and this is particularly
 

1617
00:34:57,900 --> 00:35:00,059
do something and this is particularly
common in the case of locks its thread

1618
00:35:00,059 --> 00:35:00,069
common in the case of locks its thread
 

1619
00:35:00,069 --> 00:35:01,829
common in the case of locks its thread
one acquires lock a and thread to

1620
00:35:01,829 --> 00:35:01,839
one acquires lock a and thread to
 

1621
00:35:01,839 --> 00:35:05,730
one acquires lock a and thread to
acquire lock be so thread one is

1622
00:35:05,730 --> 00:35:05,740
acquire lock be so thread one is
 

1623
00:35:05,740 --> 00:35:07,680
acquire lock be so thread one is
acquired lock a throw two is required

1624
00:35:07,680 --> 00:35:07,690
acquired lock a throw two is required
 

1625
00:35:07,690 --> 00:35:11,220
acquired lock a throw two is required
lot B and then next thread one needs to

1626
00:35:11,220 --> 00:35:11,230
lot B and then next thread one needs to
 

1627
00:35:11,230 --> 00:35:14,579
lot B and then next thread one needs to
lock B also that is hold two locks which

1628
00:35:14,579 --> 00:35:14,589
lock B also that is hold two locks which
 

1629
00:35:14,589 --> 00:35:15,900
lock B also that is hold two locks which
sometimes shows up and it just so

1630
00:35:15,900 --> 00:35:15,910
sometimes shows up and it just so
 

1631
00:35:15,910 --> 00:35:17,279
sometimes shows up and it just so
happens that thread two needs to hold

1632
00:35:17,279 --> 00:35:17,289
happens that thread two needs to hold
 

1633
00:35:17,289 --> 00:35:19,980
happens that thread two needs to hold
block hey that's a deadlock all right at

1634
00:35:19,980 --> 00:35:19,990
block hey that's a deadlock all right at
 

1635
00:35:19,990 --> 00:35:21,480
block hey that's a deadlock all right at
least grab their first lock and then

1636
00:35:21,480 --> 00:35:21,490
least grab their first lock and then
 

1637
00:35:21,490 --> 00:35:23,400
least grab their first lock and then
proceed down to where they need their

1638
00:35:23,400 --> 00:35:23,410
proceed down to where they need their
 

1639
00:35:23,410 --> 00:35:24,510
proceed down to where they need their
second lock and now they're waiting for

1640
00:35:24,510 --> 00:35:24,520
second lock and now they're waiting for
 

1641
00:35:24,520 --> 00:35:26,730
second lock and now they're waiting for
each other forever right neither can

1642
00:35:26,730 --> 00:35:26,740
each other forever right neither can
 

1643
00:35:26,740 --> 00:35:28,769
each other forever right neither can
proceed neither then can release the

1644
00:35:28,769 --> 00:35:28,779
proceed neither then can release the
 

1645
00:35:28,779 --> 00:35:33,559
proceed neither then can release the
lock and usually just nothing happens so

1646
00:35:33,559 --> 00:35:33,569
lock and usually just nothing happens so
 

1647
00:35:33,569 --> 00:35:36,180
lock and usually just nothing happens so
if your program just kind of grinds to a

1648
00:35:36,180 --> 00:35:36,190
if your program just kind of grinds to a
 

1649
00:35:36,190 --> 00:35:37,410
if your program just kind of grinds to a
halt and doesn't seem to be doing

1650
00:35:37,410 --> 00:35:37,420
halt and doesn't seem to be doing
 

1651
00:35:37,420 --> 00:35:39,990
halt and doesn't seem to be doing
anything but didn't crash deadlock is

1652
00:35:39,990 --> 00:35:40,000
anything but didn't crash deadlock is
 

1653
00:35:40,000 --> 00:35:43,789
anything but didn't crash deadlock is
it's one thing to check

1654
00:35:43,789 --> 00:35:43,799

 

1655
00:35:43,799 --> 00:35:48,329

okay all right let's look at the web

1656
00:35:48,329 --> 00:35:48,339
okay all right let's look at the web
 

1657
00:35:48,339 --> 00:35:53,849
okay all right let's look at the web
crawler from the tutorial as an example

1658
00:35:53,849 --> 00:35:53,859
crawler from the tutorial as an example
 

1659
00:35:53,859 --> 00:36:00,420
crawler from the tutorial as an example
of some of this threading stuff I have a

1660
00:36:00,420 --> 00:36:00,430
of some of this threading stuff I have a
 

1661
00:36:00,430 --> 00:36:03,720
of some of this threading stuff I have a
couple of two solutions and different

1662
00:36:03,720 --> 00:36:03,730
couple of two solutions and different
 

1663
00:36:03,730 --> 00:36:07,620
couple of two solutions and different
styles are really three solutions in

1664
00:36:07,620 --> 00:36:07,630
styles are really three solutions in
 

1665
00:36:07,630 --> 00:36:09,420
styles are really three solutions in
different styles to allow us to talk a

1666
00:36:09,420 --> 00:36:09,430
different styles to allow us to talk a
 

1667
00:36:09,430 --> 00:36:10,769
different styles to allow us to talk a
bit about the details of some of this

1668
00:36:10,769 --> 00:36:10,779
bit about the details of some of this
 

1669
00:36:10,779 --> 00:36:13,529
bit about the details of some of this
thread programming so first of all you

1670
00:36:13,529 --> 00:36:13,539
thread programming so first of all you
 

1671
00:36:13,539 --> 00:36:16,109
thread programming so first of all you
all probably know web crawler its job is

1672
00:36:16,109 --> 00:36:16,119
all probably know web crawler its job is
 

1673
00:36:16,119 --> 00:36:18,480
all probably know web crawler its job is
you give it the URL of a page that it

1674
00:36:18,480 --> 00:36:18,490
you give it the URL of a page that it
 

1675
00:36:18,490 --> 00:36:20,460
you give it the URL of a page that it
starts at and you know many web pages

1676
00:36:20,460 --> 00:36:20,470
starts at and you know many web pages
 

1677
00:36:20,470 --> 00:36:23,099
starts at and you know many web pages
have links to other pages so what a web

1678
00:36:23,099 --> 00:36:23,109
have links to other pages so what a web
 

1679
00:36:23,109 --> 00:36:24,839
have links to other pages so what a web
crawler is trying to do is if that's the

1680
00:36:24,839 --> 00:36:24,849
crawler is trying to do is if that's the
 

1681
00:36:24,849 --> 00:36:27,599
crawler is trying to do is if that's the
first page extract all the URLs that

1682
00:36:27,599 --> 00:36:27,609
first page extract all the URLs that
 

1683
00:36:27,609 --> 00:36:29,519
first page extract all the URLs that
were mentioned that pages links you know

1684
00:36:29,519 --> 00:36:29,529
were mentioned that pages links you know
 

1685
00:36:29,529 --> 00:36:32,039
were mentioned that pages links you know
fetch the pages they point to look at

1686
00:36:32,039 --> 00:36:32,049
fetch the pages they point to look at
 

1687
00:36:32,049 --> 00:36:33,720
fetch the pages they point to look at
all those pages for the ules are all

1688
00:36:33,720 --> 00:36:33,730
all those pages for the ules are all
 

1689
00:36:33,730 --> 00:36:35,730
all those pages for the ules are all
those but all urls that they refer to

1690
00:36:35,730 --> 00:36:35,740
those but all urls that they refer to
 

1691
00:36:35,740 --> 00:36:38,370
those but all urls that they refer to
and keep on going until it's fetched all

1692
00:36:38,370 --> 00:36:38,380
and keep on going until it's fetched all
 

1693
00:36:38,380 --> 00:36:41,220
and keep on going until it's fetched all
the pages in the web let's just say and

1694
00:36:41,220 --> 00:36:41,230
the pages in the web let's just say and
 

1695
00:36:41,230 --> 00:36:45,480
the pages in the web let's just say and
then it should stop in addition the the

1696
00:36:45,480 --> 00:36:45,490
then it should stop in addition the the
 

1697
00:36:45,490 --> 00:36:52,140
then it should stop in addition the the
graph of pages and URLs is cyclic that

1698
00:36:52,140 --> 00:36:52,150
graph of pages and URLs is cyclic that
 

1699
00:36:52,150 --> 00:36:53,370
graph of pages and URLs is cyclic that
is if you're not careful

1700
00:36:53,370 --> 00:36:53,380
is if you're not careful
 

1701
00:36:53,380 --> 00:36:55,410
is if you're not careful
um you may end up following if you don't

1702
00:36:55,410 --> 00:36:55,420
um you may end up following if you don't
 

1703
00:36:55,420 --> 00:36:57,089
um you may end up following if you don't
remember oh I've already fetched this

1704
00:36:57,089 --> 00:36:57,099
remember oh I've already fetched this
 

1705
00:36:57,099 --> 00:36:59,009
remember oh I've already fetched this
web page already you may end up

1706
00:36:59,009 --> 00:36:59,019
web page already you may end up
 

1707
00:36:59,019 --> 00:37:01,440
web page already you may end up
following cycles forever and you know

1708
00:37:01,440 --> 00:37:01,450
following cycles forever and you know
 

1709
00:37:01,450 --> 00:37:03,569
following cycles forever and you know
your crawler will never finish so one of

1710
00:37:03,569 --> 00:37:03,579
your crawler will never finish so one of
 

1711
00:37:03,579 --> 00:37:05,549
your crawler will never finish so one of
the jobs of the crawler is to remember

1712
00:37:05,549 --> 00:37:05,559
the jobs of the crawler is to remember
 

1713
00:37:05,559 --> 00:37:08,130
the jobs of the crawler is to remember
the set of pages that is already crawled

1714
00:37:08,130 --> 00:37:08,140
the set of pages that is already crawled
 

1715
00:37:08,140 --> 00:37:10,769
the set of pages that is already crawled
or already even started a fetch for and

1716
00:37:10,769 --> 00:37:10,779
or already even started a fetch for and
 

1717
00:37:10,779 --> 00:37:15,809
or already even started a fetch for and
to not start a second fetch for any page

1718
00:37:15,809 --> 00:37:15,819
to not start a second fetch for any page
 

1719
00:37:15,819 --> 00:37:17,190
to not start a second fetch for any page
that it's already started fetching on

1720
00:37:17,190 --> 00:37:17,200
that it's already started fetching on
 

1721
00:37:17,200 --> 00:37:18,839
that it's already started fetching on
and you can think of that as sort of

1722
00:37:18,839 --> 00:37:18,849
and you can think of that as sort of
 

1723
00:37:18,849 --> 00:37:21,749
and you can think of that as sort of
imposing a tree structure finding a sort

1724
00:37:21,749 --> 00:37:21,759
imposing a tree structure finding a sort
 

1725
00:37:21,759 --> 00:37:25,259
imposing a tree structure finding a sort
of tree shaped subset of the cyclic

1726
00:37:25,259 --> 00:37:25,269
of tree shaped subset of the cyclic
 

1727
00:37:25,269 --> 00:37:31,799
of tree shaped subset of the cyclic
graph of actual web pages okay so we

1728
00:37:31,799 --> 00:37:31,809
graph of actual web pages okay so we
 

1729
00:37:31,809 --> 00:37:33,420
graph of actual web pages okay so we
want to avoid cycles we want to be able

1730
00:37:33,420 --> 00:37:33,430
want to avoid cycles we want to be able
 

1731
00:37:33,430 --> 00:37:37,049
want to avoid cycles we want to be able
to not fetch a page twice it also it

1732
00:37:37,049 --> 00:37:37,059
to not fetch a page twice it also it
 

1733
00:37:37,059 --> 00:37:38,279
to not fetch a page twice it also it
turns out that it just takes a long time

1734
00:37:38,279 --> 00:37:38,289
turns out that it just takes a long time
 

1735
00:37:38,289 --> 00:37:40,079
turns out that it just takes a long time
to fetch a web page but it's good

1736
00:37:40,079 --> 00:37:40,089
to fetch a web page but it's good
 

1737
00:37:40,089 --> 00:37:42,150
to fetch a web page but it's good
servers are slow and because the network

1738
00:37:42,150 --> 00:37:42,160
servers are slow and because the network
 

1739
00:37:42,160 --> 00:37:46,950
servers are slow and because the network
has a long speed of light latency and so

1740
00:37:46,950 --> 00:37:46,960
has a long speed of light latency and so
 

1741
00:37:46,960 --> 00:37:48,660
has a long speed of light latency and so
you definitely don't want to fetch pages

1742
00:37:48,660 --> 00:37:48,670
you definitely don't want to fetch pages
 

1743
00:37:48,670 --> 00:37:50,279
you definitely don't want to fetch pages
one at a time unless you want to crawl

1744
00:37:50,279 --> 00:37:50,289
one at a time unless you want to crawl
 

1745
00:37:50,289 --> 00:37:54,180
one at a time unless you want to crawl
to take many years so it pays enormous

1746
00:37:54,180 --> 00:37:54,190
to take many years so it pays enormous
 

1747
00:37:54,190 --> 00:37:56,020
to take many years so it pays enormous
lead to fetch many pages that same

1748
00:37:56,020 --> 00:37:56,030
lead to fetch many pages that same
 

1749
00:37:56,030 --> 00:37:57,970
lead to fetch many pages that same
I'm up to some limit right you want to

1750
00:37:57,970 --> 00:37:57,980
I'm up to some limit right you want to
 

1751
00:37:57,980 --> 00:37:59,470
I'm up to some limit right you want to
keep on increasing the number of pages

1752
00:37:59,470 --> 00:37:59,480
keep on increasing the number of pages
 

1753
00:37:59,480 --> 00:38:01,480
keep on increasing the number of pages
you fetch in parallel until the

1754
00:38:01,480 --> 00:38:01,490
you fetch in parallel until the
 

1755
00:38:01,490 --> 00:38:03,130
you fetch in parallel until the
throughput you're getting in pages per

1756
00:38:03,130 --> 00:38:03,140
throughput you're getting in pages per
 

1757
00:38:03,140 --> 00:38:05,680
throughput you're getting in pages per
second stops increasing that is running

1758
00:38:05,680 --> 00:38:05,690
second stops increasing that is running
 

1759
00:38:05,690 --> 00:38:07,900
second stops increasing that is running
increase the concurrency until you run

1760
00:38:07,900 --> 00:38:07,910
increase the concurrency until you run
 

1761
00:38:07,910 --> 00:38:11,290
increase the concurrency until you run
out of network capacity so we want to be

1762
00:38:11,290 --> 00:38:11,300
out of network capacity so we want to be
 

1763
00:38:11,300 --> 00:38:12,490
out of network capacity so we want to be
able to launch multiple fetches in

1764
00:38:12,490 --> 00:38:12,500
able to launch multiple fetches in
 

1765
00:38:12,500 --> 00:38:15,970
able to launch multiple fetches in
parallel and a final challenge which is

1766
00:38:15,970 --> 00:38:15,980
parallel and a final challenge which is
 

1767
00:38:15,980 --> 00:38:17,890
parallel and a final challenge which is
sometimes the hardest thing to solve is

1768
00:38:17,890 --> 00:38:17,900
sometimes the hardest thing to solve is
 

1769
00:38:17,900 --> 00:38:19,390
sometimes the hardest thing to solve is
to know when the crawl is finished

1770
00:38:19,390 --> 00:38:19,400
to know when the crawl is finished
 

1771
00:38:19,400 --> 00:38:21,610
to know when the crawl is finished
and once we've crawled all the pages we

1772
00:38:21,610 --> 00:38:21,620
and once we've crawled all the pages we
 

1773
00:38:21,620 --> 00:38:24,100
and once we've crawled all the pages we
want to stop and say we're done but we

1774
00:38:24,100 --> 00:38:24,110
want to stop and say we're done but we
 

1775
00:38:24,110 --> 00:38:25,360
want to stop and say we're done but we
actually need to write the code to

1776
00:38:25,360 --> 00:38:25,370
actually need to write the code to
 

1777
00:38:25,370 --> 00:38:27,100
actually need to write the code to
realize aha

1778
00:38:27,100 --> 00:38:27,110
realize aha
 

1779
00:38:27,110 --> 00:38:29,830
realize aha
we've crawled every single page and for

1780
00:38:29,830 --> 00:38:29,840
we've crawled every single page and for
 

1781
00:38:29,840 --> 00:38:32,470
we've crawled every single page and for
some solutions I've tried figuring out

1782
00:38:32,470 --> 00:38:32,480
some solutions I've tried figuring out
 

1783
00:38:32,480 --> 00:38:33,880
some solutions I've tried figuring out
when you're done has turned out to be

1784
00:38:33,880 --> 00:38:33,890
when you're done has turned out to be
 

1785
00:38:33,890 --> 00:38:38,410
when you're done has turned out to be
the hardest part all right so my first

1786
00:38:38,410 --> 00:38:38,420
the hardest part all right so my first
 

1787
00:38:38,420 --> 00:38:40,720
the hardest part all right so my first
crawler is this serial crawler here and

1788
00:38:40,720 --> 00:38:40,730
crawler is this serial crawler here and
 

1789
00:38:40,730 --> 00:38:43,390
crawler is this serial crawler here and
by the way this code is available on the

1790
00:38:43,390 --> 00:38:43,400
by the way this code is available on the
 

1791
00:38:43,400 --> 00:38:45,970
by the way this code is available on the
website under crawler go on the schedule

1792
00:38:45,970 --> 00:38:45,980
website under crawler go on the schedule
 

1793
00:38:45,980 --> 00:38:48,490
website under crawler go on the schedule
you won't look at it this wrist calls a

1794
00:38:48,490 --> 00:38:48,500
you won't look at it this wrist calls a
 

1795
00:38:48,500 --> 00:38:53,230
you won't look at it this wrist calls a
serial crawler it effectively performs a

1796
00:38:53,230 --> 00:38:53,240
serial crawler it effectively performs a
 

1797
00:38:53,240 --> 00:38:58,110
serial crawler it effectively performs a
depth-first search into the web graph

1798
00:38:58,110 --> 00:38:58,120
depth-first search into the web graph
 

1799
00:38:58,120 --> 00:39:02,860
depth-first search into the web graph
and there is sort of one moderately

1800
00:39:02,860 --> 00:39:02,870
and there is sort of one moderately
 

1801
00:39:02,870 --> 00:39:04,480
and there is sort of one moderately
interesting thing about it it keeps this

1802
00:39:04,480 --> 00:39:04,490
interesting thing about it it keeps this
 

1803
00:39:04,490 --> 00:39:06,640
interesting thing about it it keeps this
map called fetched which is basically

1804
00:39:06,640 --> 00:39:06,650
map called fetched which is basically
 

1805
00:39:06,650 --> 00:39:08,620
map called fetched which is basically
using as a set in order to remember

1806
00:39:08,620 --> 00:39:08,630
using as a set in order to remember
 

1807
00:39:08,630 --> 00:39:11,200
using as a set in order to remember
which pages it's crawled and that's like

1808
00:39:11,200 --> 00:39:11,210
which pages it's crawled and that's like
 

1809
00:39:11,210 --> 00:39:12,820
which pages it's crawled and that's like
the only interesting part of this you

1810
00:39:12,820 --> 00:39:12,830
the only interesting part of this you
 

1811
00:39:12,830 --> 00:39:16,240
the only interesting part of this you
give it a URL that at line 18 if it's

1812
00:39:16,240 --> 00:39:16,250
give it a URL that at line 18 if it's
 

1813
00:39:16,250 --> 00:39:17,910
give it a URL that at line 18 if it's
already fetched the URL it just returns

1814
00:39:17,910 --> 00:39:17,920
already fetched the URL it just returns
 

1815
00:39:17,920 --> 00:39:20,200
already fetched the URL it just returns
if it doesn't fetch the URL it first

1816
00:39:20,200 --> 00:39:20,210
if it doesn't fetch the URL it first
 

1817
00:39:20,210 --> 00:39:22,410
if it doesn't fetch the URL it first
remembers that it is now fetched it

1818
00:39:22,410 --> 00:39:22,420
remembers that it is now fetched it
 

1819
00:39:22,420 --> 00:39:26,050
remembers that it is now fetched it
actually gets fetches that page and

1820
00:39:26,050 --> 00:39:26,060
actually gets fetches that page and
 

1821
00:39:26,060 --> 00:39:27,640
actually gets fetches that page and
extracts the URLs that are in the page

1822
00:39:27,640 --> 00:39:27,650
extracts the URLs that are in the page
 

1823
00:39:27,650 --> 00:39:29,530
extracts the URLs that are in the page
with the fetcher and then iterates over

1824
00:39:29,530 --> 00:39:29,540
with the fetcher and then iterates over
 

1825
00:39:29,540 --> 00:39:33,420
with the fetcher and then iterates over
the URLs in that page and calls itself

1826
00:39:33,420 --> 00:39:33,430
the URLs in that page and calls itself
 

1827
00:39:33,430 --> 00:39:35,650
the URLs in that page and calls itself
for every one of those pages and it

1828
00:39:35,650 --> 00:39:35,660
for every one of those pages and it
 

1829
00:39:35,660 --> 00:39:38,050
for every one of those pages and it
passes to itself the way it it really

1830
00:39:38,050 --> 00:39:38,060
passes to itself the way it it really
 

1831
00:39:38,060 --> 00:39:40,000
passes to itself the way it it really
has just a one table there's only one

1832
00:39:40,000 --> 00:39:40,010
has just a one table there's only one
 

1833
00:39:40,010 --> 00:39:43,060
has just a one table there's only one
fetched map of course because you know

1834
00:39:43,060 --> 00:39:43,070
fetched map of course because you know
 

1835
00:39:43,070 --> 00:39:45,760
fetched map of course because you know
when I call recursive crawl and it

1836
00:39:45,760 --> 00:39:45,770
when I call recursive crawl and it
 

1837
00:39:45,770 --> 00:39:47,320
when I call recursive crawl and it
fetches a bunch of pages after it

1838
00:39:47,320 --> 00:39:47,330
fetches a bunch of pages after it
 

1839
00:39:47,330 --> 00:39:49,960
fetches a bunch of pages after it
returns I want to be where you know the

1840
00:39:49,960 --> 00:39:49,970
returns I want to be where you know the
 

1841
00:39:49,970 --> 00:39:52,330
returns I want to be where you know the
outer crawl instance needs to be aware

1842
00:39:52,330 --> 00:39:52,340
outer crawl instance needs to be aware
 

1843
00:39:52,340 --> 00:39:53,950
outer crawl instance needs to be aware
that certain pages are already fetched

1844
00:39:53,950 --> 00:39:53,960
that certain pages are already fetched
 

1845
00:39:53,960 --> 00:39:56,320
that certain pages are already fetched
so we depend very much on the fetched

1846
00:39:56,320 --> 00:39:56,330
so we depend very much on the fetched
 

1847
00:39:56,330 --> 00:39:58,240
so we depend very much on the fetched
map being passed between the functions

1848
00:39:58,240 --> 00:39:58,250
map being passed between the functions
 

1849
00:39:58,250 --> 00:40:01,960
map being passed between the functions
by reference instead of by copying so it

1850
00:40:01,960 --> 00:40:01,970
by reference instead of by copying so it
 

1851
00:40:01,970 --> 00:40:03,760
by reference instead of by copying so it
so under the hood what must really be

1852
00:40:03,760 --> 00:40:03,770
so under the hood what must really be
 

1853
00:40:03,770 --> 00:40:05,320
so under the hood what must really be
going on here is that go is passing a

1854
00:40:05,320 --> 00:40:05,330
going on here is that go is passing a
 

1855
00:40:05,330 --> 00:40:08,470
going on here is that go is passing a
pointer to the map object

1856
00:40:08,470 --> 00:40:08,480
pointer to the map object
 

1857
00:40:08,480 --> 00:40:10,060
pointer to the map object
to each of the calls of crawl so they

1858
00:40:10,060 --> 00:40:10,070
to each of the calls of crawl so they
 

1859
00:40:10,070 --> 00:40:12,820
to each of the calls of crawl so they
all share the pointer to the same object

1860
00:40:12,820 --> 00:40:12,830
all share the pointer to the same object
 

1861
00:40:12,830 --> 00:40:15,730
all share the pointer to the same object
and memory rather than copying rather

1862
00:40:15,730 --> 00:40:15,740
and memory rather than copying rather
 

1863
00:40:15,740 --> 00:40:22,750
and memory rather than copying rather
than copying than that any questions so

1864
00:40:22,750 --> 00:40:22,760
than copying than that any questions so
 

1865
00:40:22,760 --> 00:40:24,130
than copying than that any questions so
this code definitely does not solve the

1866
00:40:24,130 --> 00:40:24,140
this code definitely does not solve the
 

1867
00:40:24,140 --> 00:40:25,750
this code definitely does not solve the
problem that was posed right because it

1868
00:40:25,750 --> 00:40:25,760
problem that was posed right because it
 

1869
00:40:25,760 --> 00:40:30,640
problem that was posed right because it
doesn't launch parallel parallel fetches

1870
00:40:30,640 --> 00:40:30,650
doesn't launch parallel parallel fetches
 

1871
00:40:30,650 --> 00:40:33,190
doesn't launch parallel parallel fetches
now so clue we need to insert goroutines

1872
00:40:33,190 --> 00:40:33,200
now so clue we need to insert goroutines
 

1873
00:40:33,200 --> 00:40:35,140
now so clue we need to insert goroutines
somewhere in this code right to get

1874
00:40:35,140 --> 00:40:35,150
somewhere in this code right to get
 

1875
00:40:35,150 --> 00:40:37,870
somewhere in this code right to get
parallel fetches so let's suppose just

1876
00:40:37,870 --> 00:40:37,880
parallel fetches so let's suppose just
 

1877
00:40:37,880 --> 00:40:41,470
parallel fetches so let's suppose just
for chuckles dad we just start with the

1878
00:40:41,470 --> 00:40:41,480
for chuckles dad we just start with the
 

1879
00:40:41,480 --> 00:40:51,430
for chuckles dad we just start with the
most lazy thing because why so I'm gonna

1880
00:40:51,430 --> 00:40:51,440
most lazy thing because why so I'm gonna
 

1881
00:40:51,440 --> 00:40:54,940
most lazy thing because why so I'm gonna
just modify the code to run the

1882
00:40:54,940 --> 00:40:54,950
just modify the code to run the
 

1883
00:40:54,950 --> 00:40:57,460
just modify the code to run the
subsidiary crawls each in its own go

1884
00:40:57,460 --> 00:40:57,470
subsidiary crawls each in its own go
 

1885
00:40:57,470 --> 00:41:00,460
subsidiary crawls each in its own go
routine actually before I do that why

1886
00:41:00,460 --> 00:41:00,470
routine actually before I do that why
 

1887
00:41:00,470 --> 00:41:01,570
routine actually before I do that why
don't I run the code just to show you

1888
00:41:01,570 --> 00:41:01,580
don't I run the code just to show you
 

1889
00:41:01,580 --> 00:41:04,060
don't I run the code just to show you
what correct output looks like so hoping

1890
00:41:04,060 --> 00:41:04,070
what correct output looks like so hoping
 

1891
00:41:04,070 --> 00:41:07,660
what correct output looks like so hoping
this other window Emad run the crawler

1892
00:41:07,660 --> 00:41:07,670
this other window Emad run the crawler
 

1893
00:41:07,670 --> 00:41:09,370
this other window Emad run the crawler
it actually runs all three copies of the

1894
00:41:09,370 --> 00:41:09,380
it actually runs all three copies of the
 

1895
00:41:09,380 --> 00:41:10,960
it actually runs all three copies of the
crawler and they all find exactly the

1896
00:41:10,960 --> 00:41:10,970
crawler and they all find exactly the
 

1897
00:41:10,970 --> 00:41:14,320
crawler and they all find exactly the
same set of webpages so this is the

1898
00:41:14,320 --> 00:41:14,330
same set of webpages so this is the
 

1899
00:41:14,330 --> 00:41:16,090
same set of webpages so this is the
output that we're hoping to see five

1900
00:41:16,090 --> 00:41:16,100
output that we're hoping to see five
 

1901
00:41:16,100 --> 00:41:19,210
output that we're hoping to see five
lines five different web pages are are

1902
00:41:19,210 --> 00:41:19,220
lines five different web pages are are
 

1903
00:41:19,220 --> 00:41:20,740
lines five different web pages are are
fetched prints a line for each one so

1904
00:41:20,740 --> 00:41:20,750
fetched prints a line for each one so
 

1905
00:41:20,750 --> 00:41:26,110
fetched prints a line for each one so
let me now run the subsidiary crawls in

1906
00:41:26,110 --> 00:41:26,120
let me now run the subsidiary crawls in
 

1907
00:41:26,120 --> 00:41:28,120
let me now run the subsidiary crawls in
their own go routines and run that code

1908
00:41:28,120 --> 00:41:28,130
their own go routines and run that code
 

1909
00:41:28,130 --> 00:41:35,530
their own go routines and run that code
so what am I going to see the hope is to

1910
00:41:35,530 --> 00:41:35,540
so what am I going to see the hope is to
 

1911
00:41:35,540 --> 00:41:37,870
so what am I going to see the hope is to
fetch these webpages in parallel for

1912
00:41:37,870 --> 00:41:37,880
fetch these webpages in parallel for
 

1913
00:41:37,880 --> 00:41:42,790
fetch these webpages in parallel for
higher performance so okay so you're

1914
00:41:42,790 --> 00:41:42,800
higher performance so okay so you're
 

1915
00:41:42,800 --> 00:41:45,100
higher performance so okay so you're
voting for only seeing one URL and why

1916
00:41:45,100 --> 00:41:45,110
voting for only seeing one URL and why
 

1917
00:41:45,110 --> 00:41:50,970
voting for only seeing one URL and why
so why is that

1918
00:41:50,970 --> 00:41:50,980

 

1919
00:41:50,980 --> 00:41:55,210

yeah yes that's exactly right you know

1920
00:41:55,210 --> 00:41:55,220
yeah yes that's exactly right you know
 

1921
00:41:55,220 --> 00:41:58,990
yeah yes that's exactly right you know
after the after it's not gonna wait in

1922
00:41:58,990 --> 00:41:59,000
after the after it's not gonna wait in
 

1923
00:41:59,000 --> 00:42:00,549
after the after it's not gonna wait in
this loop at line 26 it's gonna zip

1924
00:42:00,549 --> 00:42:00,559
this loop at line 26 it's gonna zip
 

1925
00:42:00,559 --> 00:42:02,440
this loop at line 26 it's gonna zip
right through that loop I was gonna

1926
00:42:02,440 --> 00:42:02,450
right through that loop I was gonna
 

1927
00:42:02,450 --> 00:42:04,839
right through that loop I was gonna
fetch 1p when the ferry first webpage at

1928
00:42:04,839 --> 00:42:04,849
fetch 1p when the ferry first webpage at
 

1929
00:42:04,849 --> 00:42:07,029
fetch 1p when the ferry first webpage at
line 22 and then a loop it's gonna fly

1930
00:42:07,029 --> 00:42:07,039
line 22 and then a loop it's gonna fly
 

1931
00:42:07,039 --> 00:42:08,380
line 22 and then a loop it's gonna fly
off the girl routines and immediately

1932
00:42:08,380 --> 00:42:08,390
off the girl routines and immediately
 

1933
00:42:08,390 --> 00:42:10,210
off the girl routines and immediately
the scroll function is gonna return and

1934
00:42:10,210 --> 00:42:10,220
the scroll function is gonna return and
 

1935
00:42:10,220 --> 00:42:11,980
the scroll function is gonna return and
if it was called from main main what was

1936
00:42:11,980 --> 00:42:11,990
if it was called from main main what was
 

1937
00:42:11,990 --> 00:42:13,779
if it was called from main main what was
exit almost certainly before any of the

1938
00:42:13,779 --> 00:42:13,789
exit almost certainly before any of the
 

1939
00:42:13,789 --> 00:42:15,190
exit almost certainly before any of the
routines was able to do any work at all

1940
00:42:15,190 --> 00:42:15,200
routines was able to do any work at all
 

1941
00:42:15,200 --> 00:42:16,870
routines was able to do any work at all
so we'll probably just see the first web

1942
00:42:16,870 --> 00:42:16,880
so we'll probably just see the first web
 

1943
00:42:16,880 --> 00:42:19,680
so we'll probably just see the first web
page and I'm gonna do when I run it

1944
00:42:19,680 --> 00:42:19,690
page and I'm gonna do when I run it
 

1945
00:42:19,690 --> 00:42:23,910
page and I'm gonna do when I run it
you'll see here under serial that only

1946
00:42:23,910 --> 00:42:23,920
you'll see here under serial that only
 

1947
00:42:23,920 --> 00:42:26,650
you'll see here under serial that only
the one web page was found now in fact

1948
00:42:26,650 --> 00:42:26,660
the one web page was found now in fact
 

1949
00:42:26,660 --> 00:42:28,720
the one web page was found now in fact
since this program doesn't exit after

1950
00:42:28,720 --> 00:42:28,730
since this program doesn't exit after
 

1951
00:42:28,730 --> 00:42:30,789
since this program doesn't exit after
the serial crawler those Guru T's are

1952
00:42:30,789 --> 00:42:30,799
the serial crawler those Guru T's are
 

1953
00:42:30,799 --> 00:42:32,259
the serial crawler those Guru T's are
still running and they actually print

1954
00:42:32,259 --> 00:42:32,269
still running and they actually print
 

1955
00:42:32,269 --> 00:42:35,380
still running and they actually print
their output down here interleaved with

1956
00:42:35,380 --> 00:42:35,390
their output down here interleaved with
 

1957
00:42:35,390 --> 00:42:37,809
their output down here interleaved with
the next crawler example but

1958
00:42:37,809 --> 00:42:37,819
the next crawler example but
 

1959
00:42:37,819 --> 00:42:42,819
the next crawler example but
nevertheless the codes just adding a go

1960
00:42:42,819 --> 00:42:42,829
nevertheless the codes just adding a go
 

1961
00:42:42,829 --> 00:42:45,819
nevertheless the codes just adding a go
here absolutely doesn't work so let's

1962
00:42:45,819 --> 00:42:45,829
here absolutely doesn't work so let's
 

1963
00:42:45,829 --> 00:42:49,569
here absolutely doesn't work so let's
get rid of that okay so now I want to

1964
00:42:49,569 --> 00:42:49,579
get rid of that okay so now I want to
 

1965
00:42:49,579 --> 00:42:52,180
get rid of that okay so now I want to
show you a one style of concurrent

1966
00:42:52,180 --> 00:42:52,190
show you a one style of concurrent
 

1967
00:42:52,190 --> 00:42:55,779
show you a one style of concurrent
crawler and I'm presenting to one of

1968
00:42:55,779 --> 00:42:55,789
crawler and I'm presenting to one of
 

1969
00:42:55,789 --> 00:42:59,740
crawler and I'm presenting to one of
them written with shared data shared

1970
00:42:59,740 --> 00:42:59,750
them written with shared data shared
 

1971
00:42:59,750 --> 00:43:02,799
them written with shared data shared
objects and locks it's the first one and

1972
00:43:02,799 --> 00:43:02,809
objects and locks it's the first one and
 

1973
00:43:02,809 --> 00:43:05,049
objects and locks it's the first one and
another one written without shared data

1974
00:43:05,049 --> 00:43:05,059
another one written without shared data
 

1975
00:43:05,059 --> 00:43:08,980
another one written without shared data
but with passing information along

1976
00:43:08,980 --> 00:43:08,990
but with passing information along
 

1977
00:43:08,990 --> 00:43:11,349
but with passing information along
channels in order to coordinate the

1978
00:43:11,349 --> 00:43:11,359
channels in order to coordinate the
 

1979
00:43:11,359 --> 00:43:12,910
channels in order to coordinate the
different threads so this is the shared

1980
00:43:12,910 --> 00:43:12,920
different threads so this is the shared
 

1981
00:43:12,920 --> 00:43:16,990
different threads so this is the shared
data one or this is just one of many

1982
00:43:16,990 --> 00:43:17,000
data one or this is just one of many
 

1983
00:43:17,000 --> 00:43:18,970
data one or this is just one of many
ways of building a web crawler using

1984
00:43:18,970 --> 00:43:18,980
ways of building a web crawler using
 

1985
00:43:18,980 --> 00:43:22,450
ways of building a web crawler using
shared data so this code significantly

1986
00:43:22,450 --> 00:43:22,460
shared data so this code significantly
 

1987
00:43:22,460 --> 00:43:26,069
shared data so this code significantly
more complicated than a serial crawler

1988
00:43:26,069 --> 00:43:26,079
more complicated than a serial crawler
 

1989
00:43:26,079 --> 00:43:31,120
more complicated than a serial crawler
it creates a thread for each fetch it

1990
00:43:31,120 --> 00:43:31,130
it creates a thread for each fetch it
 

1991
00:43:31,130 --> 00:43:33,730
it creates a thread for each fetch it
does alright but the huge difference is

1992
00:43:33,730 --> 00:43:33,740
does alright but the huge difference is
 

1993
00:43:33,740 --> 00:43:38,380
does alright but the huge difference is
that it does with two things one it does

1994
00:43:38,380 --> 00:43:38,390
that it does with two things one it does
 

1995
00:43:38,390 --> 00:43:40,690
that it does with two things one it does
the bookkeeping required to notice when

1996
00:43:40,690 --> 00:43:40,700
the bookkeeping required to notice when
 

1997
00:43:40,700 --> 00:43:44,680
the bookkeeping required to notice when
all of the crawls have finished and it

1998
00:43:44,680 --> 00:43:44,690
all of the crawls have finished and it
 

1999
00:43:44,690 --> 00:43:47,890
all of the crawls have finished and it
handles the shared table of which URLs

2000
00:43:47,890 --> 00:43:47,900
handles the shared table of which URLs
 

2001
00:43:47,900 --> 00:43:49,839
handles the shared table of which URLs
have been crawled correctly so this code

2002
00:43:49,839 --> 00:43:49,849
have been crawled correctly so this code
 

2003
00:43:49,849 --> 00:43:53,799
have been crawled correctly so this code
still has this table of URLs and that's

2004
00:43:53,799 --> 00:43:53,809
still has this table of URLs and that's
 

2005
00:43:53,809 --> 00:43:59,339
still has this table of URLs and that's
this F dot fetched this F dot fetch

2006
00:43:59,339 --> 00:43:59,349
this F dot fetched this F dot fetch
 

2007
00:43:59,349 --> 00:44:06,120
this F dot fetched this F dot fetch
map at line 43 but this this table is

2008
00:44:06,120 --> 00:44:06,130
map at line 43 but this this table is
 

2009
00:44:06,130 --> 00:44:10,650
map at line 43 but this this table is
actually shared by all of the all of the

2010
00:44:10,650 --> 00:44:10,660
actually shared by all of the all of the
 

2011
00:44:10,660 --> 00:44:12,180
actually shared by all of the all of the
crawler threads and all the collar

2012
00:44:12,180 --> 00:44:12,190
crawler threads and all the collar
 

2013
00:44:12,190 --> 00:44:14,880
crawler threads and all the collar
threads are making or executing inside

2014
00:44:14,880 --> 00:44:14,890
threads are making or executing inside
 

2015
00:44:14,890 --> 00:44:16,890
threads are making or executing inside
concurrent mutex and so we still have

2016
00:44:16,890 --> 00:44:16,900
concurrent mutex and so we still have
 

2017
00:44:16,900 --> 00:44:18,599
concurrent mutex and so we still have
this sort of tree up in current mutexes

2018
00:44:18,599 --> 00:44:18,609
this sort of tree up in current mutexes
 

2019
00:44:18,609 --> 00:44:20,609
this sort of tree up in current mutexes
that's exploring different parts of the

2020
00:44:20,609 --> 00:44:20,619
that's exploring different parts of the
 

2021
00:44:20,619 --> 00:44:22,589
that's exploring different parts of the
web graph but each one of them was

2022
00:44:22,589 --> 00:44:22,599
web graph but each one of them was
 

2023
00:44:22,599 --> 00:44:25,650
web graph but each one of them was
launched as a as his own go routine

2024
00:44:25,650 --> 00:44:25,660
launched as a as his own go routine
 

2025
00:44:25,660 --> 00:44:28,710
launched as a as his own go routine
instead of as a function call but

2026
00:44:28,710 --> 00:44:28,720
instead of as a function call but
 

2027
00:44:28,720 --> 00:44:30,390
instead of as a function call but
they're all sharing this table of state

2028
00:44:30,390 --> 00:44:30,400
they're all sharing this table of state
 

2029
00:44:30,400 --> 00:44:32,849
they're all sharing this table of state
this table of test URLs because if one

2030
00:44:32,849 --> 00:44:32,859
this table of test URLs because if one
 

2031
00:44:32,859 --> 00:44:34,980
this table of test URLs because if one
go routine fetches a URL we don't want

2032
00:44:34,980 --> 00:44:34,990
go routine fetches a URL we don't want
 

2033
00:44:34,990 --> 00:44:36,960
go routine fetches a URL we don't want
another girl routine to accidentally

2034
00:44:36,960 --> 00:44:36,970
another girl routine to accidentally
 

2035
00:44:36,970 --> 00:44:40,410
another girl routine to accidentally
fetch the same URL and as you can see

2036
00:44:40,410 --> 00:44:40,420
fetch the same URL and as you can see
 

2037
00:44:40,420 --> 00:44:43,140
fetch the same URL and as you can see
here line 42 and 45 I've surrounded them

2038
00:44:43,140 --> 00:44:43,150
here line 42 and 45 I've surrounded them
 

2039
00:44:43,150 --> 00:44:48,240
here line 42 and 45 I've surrounded them
by the new taxes that are required to to

2040
00:44:48,240 --> 00:44:48,250
by the new taxes that are required to to
 

2041
00:44:48,250 --> 00:44:51,089
by the new taxes that are required to to
prevent a race that would occur if I

2042
00:44:51,089 --> 00:44:51,099
prevent a race that would occur if I
 

2043
00:44:51,099 --> 00:44:52,890
prevent a race that would occur if I
didn't add them new Texas so the danger

2044
00:44:52,890 --> 00:44:52,900
didn't add them new Texas so the danger
 

2045
00:44:52,900 --> 00:44:57,720
didn't add them new Texas so the danger
here is that at line 43 a thread is

2046
00:44:57,720 --> 00:44:57,730
here is that at line 43 a thread is
 

2047
00:44:57,730 --> 00:44:59,970
here is that at line 43 a thread is
checking of URLs already been fetched so

2048
00:44:59,970 --> 00:44:59,980
checking of URLs already been fetched so
 

2049
00:44:59,980 --> 00:45:02,670
checking of URLs already been fetched so
two threads happen to be following the

2050
00:45:02,670 --> 00:45:02,680
two threads happen to be following the
 

2051
00:45:02,680 --> 00:45:06,809
two threads happen to be following the
same URL now two calls to concurrent

2052
00:45:06,809 --> 00:45:06,819
same URL now two calls to concurrent
 

2053
00:45:06,819 --> 00:45:09,480
same URL now two calls to concurrent
mutex end up looking at the same URL

2054
00:45:09,480 --> 00:45:09,490
mutex end up looking at the same URL
 

2055
00:45:09,490 --> 00:45:11,130
mutex end up looking at the same URL
maybe because that URL was mentioned in

2056
00:45:11,130 --> 00:45:11,140
maybe because that URL was mentioned in
 

2057
00:45:11,140 --> 00:45:13,920
maybe because that URL was mentioned in
two different web pages if we didn't

2058
00:45:13,920 --> 00:45:13,930
two different web pages if we didn't
 

2059
00:45:13,930 --> 00:45:17,549
two different web pages if we didn't
have the lock they'd both access the

2060
00:45:17,549 --> 00:45:17,559
have the lock they'd both access the
 

2061
00:45:17,559 --> 00:45:18,809
have the lock they'd both access the
math table to see if the threaded and

2062
00:45:18,809 --> 00:45:18,819
math table to see if the threaded and
 

2063
00:45:18,819 --> 00:45:20,819
math table to see if the threaded and
then already if the URL had been already

2064
00:45:20,819 --> 00:45:20,829
then already if the URL had been already
 

2065
00:45:20,829 --> 00:45:23,640
then already if the URL had been already
fetched and they both get false at line

2066
00:45:23,640 --> 00:45:23,650
fetched and they both get false at line
 

2067
00:45:23,650 --> 00:45:27,059
fetched and they both get false at line
43 they both set the URLs entering the

2068
00:45:27,059 --> 00:45:27,069
43 they both set the URLs entering the
 

2069
00:45:27,069 --> 00:45:30,870
43 they both set the URLs entering the
table to true at line 44 and at 47 they

2070
00:45:30,870 --> 00:45:30,880
table to true at line 44 and at 47 they
 

2071
00:45:30,880 --> 00:45:32,370
table to true at line 44 and at 47 they
will both see that I already was false

2072
00:45:32,370 --> 00:45:32,380
will both see that I already was false
 

2073
00:45:32,380 --> 00:45:33,870
will both see that I already was false
and then they both go on to patch the

2074
00:45:33,870 --> 00:45:33,880
and then they both go on to patch the
 

2075
00:45:33,880 --> 00:45:37,020
and then they both go on to patch the
web page so we need the lock there and

2076
00:45:37,020 --> 00:45:37,030
web page so we need the lock there and
 

2077
00:45:37,030 --> 00:45:38,730
web page so we need the lock there and
the way to think about it I think is

2078
00:45:38,730 --> 00:45:38,740
the way to think about it I think is
 

2079
00:45:38,740 --> 00:45:41,400
the way to think about it I think is
that we want lines 43 and 44 to be

2080
00:45:41,400 --> 00:45:41,410
that we want lines 43 and 44 to be
 

2081
00:45:41,410 --> 00:45:44,010
that we want lines 43 and 44 to be
atomic that is we don't want some other

2082
00:45:44,010 --> 00:45:44,020
atomic that is we don't want some other
 

2083
00:45:44,020 --> 00:45:45,900
atomic that is we don't want some other
thread to to get in and be using the

2084
00:45:45,900 --> 00:45:45,910
thread to to get in and be using the
 

2085
00:45:45,910 --> 00:45:48,450
thread to to get in and be using the
table between 43 and 44 we we want to

2086
00:45:48,450 --> 00:45:48,460
table between 43 and 44 we we want to
 

2087
00:45:48,460 --> 00:45:50,339
table between 43 and 44 we we want to
read the current content each thread

2088
00:45:50,339 --> 00:45:50,349
read the current content each thread
 

2089
00:45:50,349 --> 00:45:52,680
read the current content each thread
wants to read the current table contents

2090
00:45:52,680 --> 00:45:52,690
wants to read the current table contents
 

2091
00:45:52,690 --> 00:45:55,770
wants to read the current table contents
and update it without any other thread

2092
00:45:55,770 --> 00:45:55,780
and update it without any other thread
 

2093
00:45:55,780 --> 00:45:57,299
and update it without any other thread
interfering and so that's what the locks

2094
00:45:57,299 --> 00:45:57,309
interfering and so that's what the locks
 

2095
00:45:57,309 --> 00:46:01,140
interfering and so that's what the locks
are doing for us okay so so actually any

2096
00:46:01,140 --> 00:46:01,150
are doing for us okay so so actually any
 

2097
00:46:01,150 --> 00:46:03,270
are doing for us okay so so actually any
questions about the about the locking

2098
00:46:03,270 --> 00:46:03,280
questions about the about the locking
 

2099
00:46:03,280 --> 00:46:07,740
questions about the about the locking
strategy here

2100
00:46:07,740 --> 00:46:07,750

 

2101
00:46:07,750 --> 00:46:10,750

all right once we check the URLs entry

2102
00:46:10,750 --> 00:46:10,760
all right once we check the URLs entry
 

2103
00:46:10,760 --> 00:46:13,660
all right once we check the URLs entry
in the table alliant 51 it just crawls

2104
00:46:13,660 --> 00:46:13,670
in the table alliant 51 it just crawls
 

2105
00:46:13,670 --> 00:46:15,310
in the table alliant 51 it just crawls
it just fetches that page in the usual

2106
00:46:15,310 --> 00:46:15,320
it just fetches that page in the usual
 

2107
00:46:15,320 --> 00:46:18,940
it just fetches that page in the usual
way and then the other thing interesting

2108
00:46:18,940 --> 00:46:18,950
way and then the other thing interesting
 

2109
00:46:18,950 --> 00:46:20,590
way and then the other thing interesting
thing that's going on is the launching

2110
00:46:20,590 --> 00:46:20,600
thing that's going on is the launching
 

2111
00:46:20,600 --> 00:46:35,440
thing that's going on is the launching
of the threads yes so the question is

2112
00:46:35,440 --> 00:46:35,450
of the threads yes so the question is
 

2113
00:46:35,450 --> 00:46:43,960
of the threads yes so the question is
what's with the F dot no no the MU it is

2114
00:46:43,960 --> 00:46:43,970
what's with the F dot no no the MU it is
 

2115
00:46:43,970 --> 00:46:47,110
what's with the F dot no no the MU it is
okay so there's a structure to find out

2116
00:46:47,110 --> 00:46:47,120
okay so there's a structure to find out
 

2117
00:46:47,120 --> 00:46:50,320
okay so there's a structure to find out
line 36 that sort of collects together

2118
00:46:50,320 --> 00:46:50,330
line 36 that sort of collects together
 

2119
00:46:50,330 --> 00:46:53,920
line 36 that sort of collects together
all the different stuff that all the

2120
00:46:53,920 --> 00:46:53,930
all the different stuff that all the
 

2121
00:46:53,930 --> 00:46:55,270
all the different stuff that all the
different state that we need to run this

2122
00:46:55,270 --> 00:46:55,280
different state that we need to run this
 

2123
00:46:55,280 --> 00:46:57,370
different state that we need to run this
crawl and here it's only two objects but

2124
00:46:57,370 --> 00:46:57,380
crawl and here it's only two objects but
 

2125
00:46:57,380 --> 00:46:58,810
crawl and here it's only two objects but
you know it could be a lot more and

2126
00:46:58,810 --> 00:46:58,820
you know it could be a lot more and
 

2127
00:46:58,820 --> 00:47:00,610
you know it could be a lot more and
they're only grouped together for

2128
00:47:00,610 --> 00:47:00,620
they're only grouped together for
 

2129
00:47:00,620 --> 00:47:02,020
they're only grouped together for
convenience there's no other

2130
00:47:02,020 --> 00:47:02,030
convenience there's no other
 

2131
00:47:02,030 --> 00:47:05,380
convenience there's no other
significance to the fact there's no deep

2132
00:47:05,380 --> 00:47:05,390
significance to the fact there's no deep
 

2133
00:47:05,390 --> 00:47:07,480
significance to the fact there's no deep
significance the fact that mu and fetch

2134
00:47:07,480 --> 00:47:07,490
significance the fact that mu and fetch
 

2135
00:47:07,490 --> 00:47:11,740
significance the fact that mu and fetch
store it inside the same structure and

2136
00:47:11,740 --> 00:47:11,750
store it inside the same structure and
 

2137
00:47:11,750 --> 00:47:14,680
store it inside the same structure and
that F dot is just sort of the syntax

2138
00:47:14,680 --> 00:47:14,690
that F dot is just sort of the syntax
 

2139
00:47:14,690 --> 00:47:15,880
that F dot is just sort of the syntax
are getting out one of the elements in

2140
00:47:15,880 --> 00:47:15,890
are getting out one of the elements in
 

2141
00:47:15,890 --> 00:47:17,170
are getting out one of the elements in
the structure so I just happened to put

2142
00:47:17,170 --> 00:47:17,180
the structure so I just happened to put
 

2143
00:47:17,180 --> 00:47:19,060
the structure so I just happened to put
them you in the structure because it

2144
00:47:19,060 --> 00:47:19,070
them you in the structure because it
 

2145
00:47:19,070 --> 00:47:21,070
them you in the structure because it
allows me to group together all the

2146
00:47:21,070 --> 00:47:21,080
allows me to group together all the
 

2147
00:47:21,080 --> 00:47:22,780
allows me to group together all the
stuff related to a crawl but that

2148
00:47:22,780 --> 00:47:22,790
stuff related to a crawl but that
 

2149
00:47:22,790 --> 00:47:25,590
stuff related to a crawl but that
absolutely does not mean that go

2150
00:47:25,590 --> 00:47:25,600
absolutely does not mean that go
 

2151
00:47:25,600 --> 00:47:28,870
absolutely does not mean that go
associates the MU with that structure or

2152
00:47:28,870 --> 00:47:28,880
associates the MU with that structure or
 

2153
00:47:28,880 --> 00:47:30,940
associates the MU with that structure or
with the fetch map or anything it's just

2154
00:47:30,940 --> 00:47:30,950
with the fetch map or anything it's just
 

2155
00:47:30,950 --> 00:47:33,700
with the fetch map or anything it's just
a lock objects and just has a lock

2156
00:47:33,700 --> 00:47:33,710
a lock objects and just has a lock
 

2157
00:47:33,710 --> 00:47:35,080
a lock objects and just has a lock
function you can call and that's all

2158
00:47:35,080 --> 00:47:35,090
function you can call and that's all
 

2159
00:47:35,090 --> 00:47:53,780
function you can call and that's all
that's going on

2160
00:47:53,780 --> 00:47:53,790

 

2161
00:47:53,790 --> 00:47:58,740

so the question is how come in order to

2162
00:47:58,740 --> 00:47:58,750
so the question is how come in order to
 

2163
00:47:58,750 --> 00:48:00,510
so the question is how come in order to
pass something by reference I had to use

2164
00:48:00,510 --> 00:48:00,520
pass something by reference I had to use
 

2165
00:48:00,520 --> 00:48:02,430
pass something by reference I had to use
star here where it is when a in the

2166
00:48:02,430 --> 00:48:02,440
star here where it is when a in the
 

2167
00:48:02,440 --> 00:48:03,930
star here where it is when a in the
previous example when we were passing a

2168
00:48:03,930 --> 00:48:03,940
previous example when we were passing a
 

2169
00:48:03,940 --> 00:48:06,030
previous example when we were passing a
map we didn't have to use star that is

2170
00:48:06,030 --> 00:48:06,040
map we didn't have to use star that is
 

2171
00:48:06,040 --> 00:48:07,559
map we didn't have to use star that is
didn't have to pass a pointer I mean

2172
00:48:07,559 --> 00:48:07,569
didn't have to pass a pointer I mean
 

2173
00:48:07,569 --> 00:48:09,059
didn't have to pass a pointer I mean
that star notation you're seeing there

2174
00:48:09,059 --> 00:48:09,069
that star notation you're seeing there
 

2175
00:48:09,069 --> 00:48:15,329
that star notation you're seeing there
in mine 41 basically and he's saying

2176
00:48:15,329 --> 00:48:15,339
in mine 41 basically and he's saying
 

2177
00:48:15,339 --> 00:48:16,799
in mine 41 basically and he's saying
that we're passing a pointer to this

2178
00:48:16,799 --> 00:48:16,809
that we're passing a pointer to this
 

2179
00:48:16,809 --> 00:48:19,200
that we're passing a pointer to this
fetch state object and we want it to be

2180
00:48:19,200 --> 00:48:19,210
fetch state object and we want it to be
 

2181
00:48:19,210 --> 00:48:20,549
fetch state object and we want it to be
a pointer because we want there to be

2182
00:48:20,549 --> 00:48:20,559
a pointer because we want there to be
 

2183
00:48:20,559 --> 00:48:21,990
a pointer because we want there to be
one object in memory and all the

2184
00:48:21,990 --> 00:48:22,000
one object in memory and all the
 

2185
00:48:22,000 --> 00:48:23,700
one object in memory and all the
different go routines I want to use that

2186
00:48:23,700 --> 00:48:23,710
different go routines I want to use that
 

2187
00:48:23,710 --> 00:48:25,230
different go routines I want to use that
same object so they all need a pointer

2188
00:48:25,230 --> 00:48:25,240
same object so they all need a pointer
 

2189
00:48:25,240 --> 00:48:27,990
same object so they all need a pointer
to that same object so so we need to

2190
00:48:27,990 --> 00:48:28,000
to that same object so so we need to
 

2191
00:48:28,000 --> 00:48:29,400
to that same object so so we need to
find your own structure that's sort of

2192
00:48:29,400 --> 00:48:29,410
find your own structure that's sort of
 

2193
00:48:29,410 --> 00:48:30,930
find your own structure that's sort of
the syntax you use for passing a pointer

2194
00:48:30,930 --> 00:48:30,940
the syntax you use for passing a pointer
 

2195
00:48:30,940 --> 00:48:32,520
the syntax you use for passing a pointer
the reason why we didn't have to do it

2196
00:48:32,520 --> 00:48:32,530
the reason why we didn't have to do it
 

2197
00:48:32,530 --> 00:48:35,910
the reason why we didn't have to do it
with map is because although it's not

2198
00:48:35,910 --> 00:48:35,920
with map is because although it's not
 

2199
00:48:35,920 --> 00:48:38,990
with map is because although it's not
clear from the syntax a map is a pointer

2200
00:48:38,990 --> 00:48:39,000
clear from the syntax a map is a pointer
 

2201
00:48:39,000 --> 00:48:42,569
clear from the syntax a map is a pointer
it's just because it's built into the

2202
00:48:42,569 --> 00:48:42,579
it's just because it's built into the
 

2203
00:48:42,579 --> 00:48:45,059
it's just because it's built into the
language they don't make you put a star

2204
00:48:45,059 --> 00:48:45,069
language they don't make you put a star
 

2205
00:48:45,069 --> 00:48:50,520
language they don't make you put a star
there but what a map is is if you

2206
00:48:50,520 --> 00:48:50,530
there but what a map is is if you
 

2207
00:48:50,530 --> 00:48:52,410
there but what a map is is if you
declare a variable type map what that is

2208
00:48:52,410 --> 00:48:52,420
declare a variable type map what that is
 

2209
00:48:52,420 --> 00:48:55,309
declare a variable type map what that is
is a pointer to some data in the heap so

2210
00:48:55,309 --> 00:48:55,319
is a pointer to some data in the heap so
 

2211
00:48:55,319 --> 00:48:57,569
is a pointer to some data in the heap so
it was a pointer anyway and it's always

2212
00:48:57,569 --> 00:48:57,579
it was a pointer anyway and it's always
 

2213
00:48:57,579 --> 00:48:59,250
it was a pointer anyway and it's always
passed by reference do they you just

2214
00:48:59,250 --> 00:48:59,260
passed by reference do they you just
 

2215
00:48:59,260 --> 00:49:00,599
passed by reference do they you just
don't have to put the star and it does

2216
00:49:00,599 --> 00:49:00,609
don't have to put the star and it does
 

2217
00:49:00,609 --> 00:49:01,200
don't have to put the star and it does
it for you

2218
00:49:01,200 --> 00:49:01,210
it for you
 

2219
00:49:01,210 --> 00:49:03,599
it for you
so there's they're definitely map is

2220
00:49:03,599 --> 00:49:03,609
so there's they're definitely map is
 

2221
00:49:03,609 --> 00:49:06,120
so there's they're definitely map is
special you cannot define map in the

2222
00:49:06,120 --> 00:49:06,130
special you cannot define map in the
 

2223
00:49:06,130 --> 00:49:07,890
special you cannot define map in the
language it's it has to be built in

2224
00:49:07,890 --> 00:49:07,900
language it's it has to be built in
 

2225
00:49:07,900 --> 00:49:09,420
language it's it has to be built in
because there's some curious things

2226
00:49:09,420 --> 00:49:09,430
because there's some curious things
 

2227
00:49:09,430 --> 00:49:15,809
because there's some curious things
about it okay good okay so we fetch the

2228
00:49:15,809 --> 00:49:15,819
about it okay good okay so we fetch the
 

2229
00:49:15,819 --> 00:49:18,839
about it okay good okay so we fetch the
page now we want to fire off a crawl go

2230
00:49:18,839 --> 00:49:18,849
page now we want to fire off a crawl go
 

2231
00:49:18,849 --> 00:49:20,789
page now we want to fire off a crawl go
routine for each URL mentioned in the

2232
00:49:20,789 --> 00:49:20,799
routine for each URL mentioned in the
 

2233
00:49:20,799 --> 00:49:23,160
routine for each URL mentioned in the
page we just fetch so that's done in

2234
00:49:23,160 --> 00:49:23,170
page we just fetch so that's done in
 

2235
00:49:23,170 --> 00:49:26,430
page we just fetch so that's done in
line 56 on line 50 sisters loops over

2236
00:49:26,430 --> 00:49:26,440
line 56 on line 50 sisters loops over
 

2237
00:49:26,440 --> 00:49:29,880
line 56 on line 50 sisters loops over
the URLs that the fetch function

2238
00:49:29,880 --> 00:49:29,890
the URLs that the fetch function
 

2239
00:49:29,890 --> 00:49:32,940
the URLs that the fetch function
returned and for each one fires off a go

2240
00:49:32,940 --> 00:49:32,950
returned and for each one fires off a go
 

2241
00:49:32,950 --> 00:49:35,730
returned and for each one fires off a go
routine at line 58 and that lines that

2242
00:49:35,730 --> 00:49:35,740
routine at line 58 and that lines that
 

2243
00:49:35,740 --> 00:49:41,520
routine at line 58 and that lines that
func syntax in line 58 is a closure or a

2244
00:49:41,520 --> 00:49:41,530
func syntax in line 58 is a closure or a
 

2245
00:49:41,530 --> 00:49:43,980
func syntax in line 58 is a closure or a
sort of immediate function but that func

2246
00:49:43,980 --> 00:49:43,990
sort of immediate function but that func
 

2247
00:49:43,990 --> 00:49:46,589
sort of immediate function but that func
thing keyword is doing is to clearing a

2248
00:49:46,589 --> 00:49:46,599
thing keyword is doing is to clearing a
 

2249
00:49:46,599 --> 00:49:49,130
thing keyword is doing is to clearing a
function right there that we then call

2250
00:49:49,130 --> 00:49:49,140
function right there that we then call
 

2251
00:49:49,140 --> 00:49:53,730
function right there that we then call
so the way to read it maybe is

2252
00:49:53,730 --> 00:49:53,740

 

2253
00:49:53,740 --> 00:49:56,770

that if you can declare a function as a

2254
00:49:56,770 --> 00:49:56,780
that if you can declare a function as a
 

2255
00:49:56,780 --> 00:50:00,220
that if you can declare a function as a
piece of data as just func you know and

2256
00:50:00,220 --> 00:50:00,230
piece of data as just func you know and
 

2257
00:50:00,230 --> 00:50:03,339
piece of data as just func you know and
then you give the arguments and then you

2258
00:50:03,339 --> 00:50:03,349
then you give the arguments and then you
 

2259
00:50:03,349 --> 00:50:08,920
then you give the arguments and then you
give the body and that's a clears and so

2260
00:50:08,920 --> 00:50:08,930
give the body and that's a clears and so
 

2261
00:50:08,930 --> 00:50:12,490
give the body and that's a clears and so
this is an object now this is like it's

2262
00:50:12,490 --> 00:50:12,500
this is an object now this is like it's
 

2263
00:50:12,500 --> 00:50:13,990
this is an object now this is like it's
like when you type one when you have a

2264
00:50:13,990 --> 00:50:14,000
like when you type one when you have a
 

2265
00:50:14,000 --> 00:50:18,339
like when you type one when you have a
one or 23 or something you're declaring

2266
00:50:18,339 --> 00:50:18,349
one or 23 or something you're declaring
 

2267
00:50:18,349 --> 00:50:19,809
one or 23 or something you're declaring
a sort of constant object and this is

2268
00:50:19,809 --> 00:50:19,819
a sort of constant object and this is
 

2269
00:50:19,819 --> 00:50:21,069
a sort of constant object and this is
the way to define a constant function

2270
00:50:21,069 --> 00:50:21,079
the way to define a constant function
 

2271
00:50:21,079 --> 00:50:24,069
the way to define a constant function
and we do it here because we want to

2272
00:50:24,069 --> 00:50:24,079
and we do it here because we want to
 

2273
00:50:24,079 --> 00:50:25,720
and we do it here because we want to
launch a go routine that's gonna run

2274
00:50:25,720 --> 00:50:25,730
launch a go routine that's gonna run
 

2275
00:50:25,730 --> 00:50:27,280
launch a go routine that's gonna run
this function that we declared right

2276
00:50:27,280 --> 00:50:27,290
this function that we declared right
 

2277
00:50:27,290 --> 00:50:29,109
this function that we declared right
here and so we in order to make the go

2278
00:50:29,109 --> 00:50:29,119
here and so we in order to make the go
 

2279
00:50:29,119 --> 00:50:31,059
here and so we in order to make the go
routine we have to add a go in front to

2280
00:50:31,059 --> 00:50:31,069
routine we have to add a go in front to
 

2281
00:50:31,069 --> 00:50:33,130
routine we have to add a go in front to
say we want to go routine and then we

2282
00:50:33,130 --> 00:50:33,140
say we want to go routine and then we
 

2283
00:50:33,140 --> 00:50:35,049
say we want to go routine and then we
have to call the function because the go

2284
00:50:35,049 --> 00:50:35,059
have to call the function because the go
 

2285
00:50:35,059 --> 00:50:37,510
have to call the function because the go
syntax says the syntax of the go

2286
00:50:37,510 --> 00:50:37,520
syntax says the syntax of the go
 

2287
00:50:37,520 --> 00:50:39,130
syntax says the syntax of the go
keywords as you follow it by a function

2288
00:50:39,130 --> 00:50:39,140
keywords as you follow it by a function
 

2289
00:50:39,140 --> 00:50:40,900
keywords as you follow it by a function
name and arguments you want to pass that

2290
00:50:40,900 --> 00:50:40,910
name and arguments you want to pass that
 

2291
00:50:40,910 --> 00:50:43,450
name and arguments you want to pass that
function and so we're gonna pass some

2292
00:50:43,450 --> 00:50:43,460
function and so we're gonna pass some
 

2293
00:50:43,460 --> 00:50:50,890
function and so we're gonna pass some
arguments here and there's two reasons

2294
00:50:50,890 --> 00:50:50,900
arguments here and there's two reasons
 

2295
00:50:50,900 --> 00:50:52,660
arguments here and there's two reasons
we're doing this well really this one

2296
00:50:52,660 --> 00:50:52,670
we're doing this well really this one
 

2297
00:50:52,670 --> 00:50:55,059
we're doing this well really this one
reason we you know in some other

2298
00:50:55,059 --> 00:50:55,069
reason we you know in some other
 

2299
00:50:55,069 --> 00:50:57,780
reason we you know in some other
circumstance we could have just said go

2300
00:50:57,780 --> 00:50:57,790
circumstance we could have just said go
 

2301
00:50:57,790 --> 00:51:00,220
circumstance we could have just said go
concurrent mutex oh I concur mutex is

2302
00:51:00,220 --> 00:51:00,230
concurrent mutex oh I concur mutex is
 

2303
00:51:00,230 --> 00:51:01,390
concurrent mutex oh I concur mutex is
the name of the function we actually

2304
00:51:01,390 --> 00:51:01,400
the name of the function we actually
 

2305
00:51:01,400 --> 00:51:06,609
the name of the function we actually
want to call with this URL but we want

2306
00:51:06,609 --> 00:51:06,619
want to call with this URL but we want
 

2307
00:51:06,619 --> 00:51:08,109
want to call with this URL but we want
to do a few other things as well so we

2308
00:51:08,109 --> 00:51:08,119
to do a few other things as well so we
 

2309
00:51:08,119 --> 00:51:10,150
to do a few other things as well so we
define this little helper function that

2310
00:51:10,150 --> 00:51:10,160
define this little helper function that
 

2311
00:51:10,160 --> 00:51:12,160
define this little helper function that
first calls concurrent mutex for us with

2312
00:51:12,160 --> 00:51:12,170
first calls concurrent mutex for us with
 

2313
00:51:12,170 --> 00:51:15,730
first calls concurrent mutex for us with
the URL and then after them current

2314
00:51:15,730 --> 00:51:15,740
the URL and then after them current
 

2315
00:51:15,740 --> 00:51:17,109
the URL and then after them current
mutex is finished we do something

2316
00:51:17,109 --> 00:51:17,119
mutex is finished we do something
 

2317
00:51:17,119 --> 00:51:19,510
mutex is finished we do something
special in order to help us wait for all

2318
00:51:19,510 --> 00:51:19,520
special in order to help us wait for all
 

2319
00:51:19,520 --> 00:51:22,059
special in order to help us wait for all
the crawls to be done before the outer

2320
00:51:22,059 --> 00:51:22,069
the crawls to be done before the outer
 

2321
00:51:22,069 --> 00:51:24,910
the crawls to be done before the outer
function returns so that brings us to

2322
00:51:24,910 --> 00:51:24,920
function returns so that brings us to
 

2323
00:51:24,920 --> 00:51:27,370
function returns so that brings us to
the the weight group the weight group at

2324
00:51:27,370 --> 00:51:27,380
the the weight group the weight group at
 

2325
00:51:27,380 --> 00:51:29,559
the the weight group the weight group at
line 55 it's a just a data structure to

2326
00:51:29,559 --> 00:51:29,569
line 55 it's a just a data structure to
 

2327
00:51:29,569 --> 00:51:33,609
line 55 it's a just a data structure to
find by go to help with coordination and

2328
00:51:33,609 --> 00:51:33,619
find by go to help with coordination and
 

2329
00:51:33,619 --> 00:51:35,020
find by go to help with coordination and
the game with weight group is that

2330
00:51:35,020 --> 00:51:35,030
the game with weight group is that
 

2331
00:51:35,030 --> 00:51:39,280
the game with weight group is that
internally it has a counter and you call

2332
00:51:39,280 --> 00:51:39,290
internally it has a counter and you call
 

2333
00:51:39,290 --> 00:51:43,630
internally it has a counter and you call
weight group dot add like a line 57 to

2334
00:51:43,630 --> 00:51:43,640
weight group dot add like a line 57 to
 

2335
00:51:43,640 --> 00:51:46,539
weight group dot add like a line 57 to
increment the counter and we group done

2336
00:51:46,539 --> 00:51:46,549
increment the counter and we group done
 

2337
00:51:46,549 --> 00:51:48,609
increment the counter and we group done
to decrement it and then this weight

2338
00:51:48,609 --> 00:51:48,619
to decrement it and then this weight
 

2339
00:51:48,619 --> 00:51:50,890
to decrement it and then this weight
what this weight method called line 63

2340
00:51:50,890 --> 00:51:50,900
what this weight method called line 63
 

2341
00:51:50,900 --> 00:51:53,109
what this weight method called line 63
waits for the counter to get down to

2342
00:51:53,109 --> 00:51:53,119
waits for the counter to get down to
 

2343
00:51:53,119 --> 00:51:56,500
waits for the counter to get down to
zero so a weight group is a way to wait

2344
00:51:56,500 --> 00:51:56,510
zero so a weight group is a way to wait
 

2345
00:51:56,510 --> 00:51:59,319
zero so a weight group is a way to wait
for a specific number of things to

2346
00:51:59,319 --> 00:51:59,329
for a specific number of things to
 

2347
00:51:59,329 --> 00:52:02,530
for a specific number of things to
finish and it's useful in a bunch of

2348
00:52:02,530 --> 00:52:02,540
finish and it's useful in a bunch of
 

2349
00:52:02,540 --> 00:52:04,000
finish and it's useful in a bunch of
different situations here we're using it

2350
00:52:04,000 --> 00:52:04,010
different situations here we're using it
 

2351
00:52:04,010 --> 00:52:05,349
different situations here we're using it
to wait for the last go routine to

2352
00:52:05,349 --> 00:52:05,359
to wait for the last go routine to
 

2353
00:52:05,359 --> 00:52:05,910
to wait for the last go routine to
finish

2354
00:52:05,910 --> 00:52:05,920
finish
 

2355
00:52:05,920 --> 00:52:07,829
finish
because we add one to the weight group

2356
00:52:07,829 --> 00:52:07,839
because we add one to the weight group
 

2357
00:52:07,839 --> 00:52:11,190
because we add one to the weight group
for every go routine we create line 60

2358
00:52:11,190 --> 00:52:11,200
for every go routine we create line 60
 

2359
00:52:11,200 --> 00:52:13,109
for every go routine we create line 60
at the end of this function we've

2360
00:52:13,109 --> 00:52:13,119
at the end of this function we've
 

2361
00:52:13,119 --> 00:52:15,300
at the end of this function we've
declared decrement the counter in the

2362
00:52:15,300 --> 00:52:15,310
declared decrement the counter in the
 

2363
00:52:15,310 --> 00:52:18,120
declared decrement the counter in the
weight group and then line three weights

2364
00:52:18,120 --> 00:52:18,130
weight group and then line three weights
 

2365
00:52:18,130 --> 00:52:20,240
weight group and then line three weights
until all the decrements have finished

2366
00:52:20,240 --> 00:52:20,250
until all the decrements have finished
 

2367
00:52:20,250 --> 00:52:22,290
until all the decrements have finished
and so the reason why we declared this

2368
00:52:22,290 --> 00:52:22,300
and so the reason why we declared this
 

2369
00:52:22,300 --> 00:52:23,910
and so the reason why we declared this
little function was basically to be able

2370
00:52:23,910 --> 00:52:23,920
little function was basically to be able
 

2371
00:52:23,920 --> 00:52:26,520
little function was basically to be able
to both call concurrently text and call

2372
00:52:26,520 --> 00:52:26,530
to both call concurrently text and call
 

2373
00:52:26,530 --> 00:52:28,620
to both call concurrently text and call
dot that's really why we needed that

2374
00:52:28,620 --> 00:52:28,630
dot that's really why we needed that
 

2375
00:52:28,630 --> 00:52:39,750
dot that's really why we needed that
function so the question is what if one

2376
00:52:39,750 --> 00:52:39,760
function so the question is what if one
 

2377
00:52:39,760 --> 00:52:43,230
function so the question is what if one
of the subroutines fails and doesn't

2378
00:52:43,230 --> 00:52:43,240
of the subroutines fails and doesn't
 

2379
00:52:43,240 --> 00:52:45,810
of the subroutines fails and doesn't
reach the done line that's a darn good

2380
00:52:45,810 --> 00:52:45,820
reach the done line that's a darn good
 

2381
00:52:45,820 --> 00:52:49,200
reach the done line that's a darn good
question there is you know if I forget

2382
00:52:49,200 --> 00:52:49,210
question there is you know if I forget
 

2383
00:52:49,210 --> 00:52:51,060
question there is you know if I forget
the exact range of errors that will

2384
00:52:51,060 --> 00:52:51,070
the exact range of errors that will
 

2385
00:52:51,070 --> 00:52:53,430
the exact range of errors that will
cause the go routine to fail without

2386
00:52:53,430 --> 00:52:53,440
cause the go routine to fail without
 

2387
00:52:53,440 --> 00:52:55,140
cause the go routine to fail without
causing the program to feel maybe

2388
00:52:55,140 --> 00:52:55,150
causing the program to feel maybe
 

2389
00:52:55,150 --> 00:52:56,579
causing the program to feel maybe
divides by zero I don't know where

2390
00:52:56,579 --> 00:52:56,589
divides by zero I don't know where
 

2391
00:52:56,589 --> 00:52:57,780
divides by zero I don't know where
dereference is a nil pointer

2392
00:52:57,780 --> 00:52:57,790
dereference is a nil pointer
 

2393
00:52:57,790 --> 00:52:59,130
dereference is a nil pointer
not sure but there are certainly ways

2394
00:52:59,130 --> 00:52:59,140
not sure but there are certainly ways
 

2395
00:52:59,140 --> 00:53:04,560
not sure but there are certainly ways
for a function to fail and I have the go

2396
00:53:04,560 --> 00:53:04,570
for a function to fail and I have the go
 

2397
00:53:04,570 --> 00:53:06,900
for a function to fail and I have the go
routine die without having the program

2398
00:53:06,900 --> 00:53:06,910
routine die without having the program
 

2399
00:53:06,910 --> 00:53:08,880
routine die without having the program
die and that would be a problem for us

2400
00:53:08,880 --> 00:53:08,890
die and that would be a problem for us
 

2401
00:53:08,890 --> 00:53:12,120
die and that would be a problem for us
and so really the white right way to I'm

2402
00:53:12,120 --> 00:53:12,130
and so really the white right way to I'm
 

2403
00:53:12,130 --> 00:53:13,650
and so really the white right way to I'm
sure you had this in mind and asking the

2404
00:53:13,650 --> 00:53:13,660
sure you had this in mind and asking the
 

2405
00:53:13,660 --> 00:53:15,839
sure you had this in mind and asking the
question the right way to write this to

2406
00:53:15,839 --> 00:53:15,849
question the right way to write this to
 

2407
00:53:15,849 --> 00:53:18,510
question the right way to write this to
be sure that the done call is made no

2408
00:53:18,510 --> 00:53:18,520
be sure that the done call is made no
 

2409
00:53:18,520 --> 00:53:20,730
be sure that the done call is made no
matter why this guru team is finishing

2410
00:53:20,730 --> 00:53:20,740
matter why this guru team is finishing
 

2411
00:53:20,740 --> 00:53:27,170
matter why this guru team is finishing
would be to put a defer here which means

2412
00:53:27,170 --> 00:53:27,180
would be to put a defer here which means
 

2413
00:53:27,180 --> 00:53:31,530
would be to put a defer here which means
call done before the surrounding

2414
00:53:31,530 --> 00:53:31,540
call done before the surrounding
 

2415
00:53:31,540 --> 00:53:34,320
call done before the surrounding
function finishes and always call it no

2416
00:53:34,320 --> 00:53:34,330
function finishes and always call it no
 

2417
00:53:34,330 --> 00:53:36,120
function finishes and always call it no
matter why the surrounding function is

2418
00:53:36,120 --> 00:53:36,130
matter why the surrounding function is
 

2419
00:53:36,130 --> 00:53:53,549
matter why the surrounding function is
finished yes

2420
00:53:53,549 --> 00:53:53,559

 

2421
00:53:53,559 --> 00:53:58,779

and yes yeah so the question is how come

2422
00:53:58,779 --> 00:53:58,789
and yes yeah so the question is how come
 

2423
00:53:58,789 --> 00:54:00,640
and yes yeah so the question is how come
two users have done in different threads

2424
00:54:00,640 --> 00:54:00,650
two users have done in different threads
 

2425
00:54:00,650 --> 00:54:08,200
two users have done in different threads
aren't a race yeah so the answer must be

2426
00:54:08,200 --> 00:54:08,210
aren't a race yeah so the answer must be
 

2427
00:54:08,210 --> 00:54:10,630
aren't a race yeah so the answer must be
that internally dot a weight group has a

2428
00:54:10,630 --> 00:54:10,640
that internally dot a weight group has a
 

2429
00:54:10,640 --> 00:54:14,160
that internally dot a weight group has a
mutex or something like it that each of

2430
00:54:14,160 --> 00:54:14,170
mutex or something like it that each of
 

2431
00:54:14,170 --> 00:54:18,190
mutex or something like it that each of
Dunn's methods acquires before doing

2432
00:54:18,190 --> 00:54:18,200
Dunn's methods acquires before doing
 

2433
00:54:18,200 --> 00:54:19,960
Dunn's methods acquires before doing
anything else so that simultaneously

2434
00:54:19,960 --> 00:54:19,970
anything else so that simultaneously
 

2435
00:54:19,970 --> 00:54:22,779
anything else so that simultaneously
calls to a done to await groups methods

2436
00:54:22,779 --> 00:54:22,789
calls to a done to await groups methods
 

2437
00:54:22,789 --> 00:54:39,509
calls to a done to await groups methods
are trees we could to did a low class

2438
00:54:39,509 --> 00:54:39,519

 

2439
00:54:39,519 --> 00:54:43,870

yeah for certain leaf C++ and in C you

2440
00:54:43,870 --> 00:54:43,880
yeah for certain leaf C++ and in C you
 

2441
00:54:43,880 --> 00:54:45,430
yeah for certain leaf C++ and in C you
want to look at something called P

2442
00:54:45,430 --> 00:54:45,440
want to look at something called P
 

2443
00:54:45,440 --> 00:54:47,380
want to look at something called P
threads for C threads come in a library

2444
00:54:47,380 --> 00:54:47,390
threads for C threads come in a library
 

2445
00:54:47,390 --> 00:54:48,640
threads for C threads come in a library
they're not really part of the language

2446
00:54:48,640 --> 00:54:48,650
they're not really part of the language
 

2447
00:54:48,650 --> 00:54:51,700
they're not really part of the language
called P threads which they have these

2448
00:54:51,700 --> 00:54:51,710
called P threads which they have these
 

2449
00:54:51,710 --> 00:54:55,410
called P threads which they have these
are extremely traditional and ancient

2450
00:54:55,410 --> 00:54:55,420
are extremely traditional and ancient
 

2451
00:54:55,420 --> 00:55:06,620
are extremely traditional and ancient
primitives that all languages yeah

2452
00:55:06,620 --> 00:55:06,630

 

2453
00:55:06,630 --> 00:55:12,210

say it again you know not in this code

2454
00:55:12,210 --> 00:55:12,220
say it again you know not in this code
 

2455
00:55:12,220 --> 00:55:14,130
say it again you know not in this code
but you know you could imagine a use of

2456
00:55:14,130 --> 00:55:14,140
but you know you could imagine a use of
 

2457
00:55:14,140 --> 00:55:15,240
but you know you could imagine a use of
weight groups I mean weight groups just

2458
00:55:15,240 --> 00:55:15,250
weight groups I mean weight groups just
 

2459
00:55:15,250 --> 00:55:21,240
weight groups I mean weight groups just
count stuff and yeah yeah yeah weight

2460
00:55:21,240 --> 00:55:21,250
count stuff and yeah yeah yeah weight
 

2461
00:55:21,250 --> 00:55:22,980
count stuff and yeah yeah yeah weight
group doesn't really care what you're

2462
00:55:22,980 --> 00:55:22,990
group doesn't really care what you're
 

2463
00:55:22,990 --> 00:55:27,360
group doesn't really care what you're
pounding or why I mean you know this is

2464
00:55:27,360 --> 00:55:27,370
pounding or why I mean you know this is
 

2465
00:55:27,370 --> 00:55:45,840
pounding or why I mean you know this is
the most common way to see it use you're

2466
00:55:45,840 --> 00:55:45,850
the most common way to see it use you're
 

2467
00:55:45,850 --> 00:55:48,540
the most common way to see it use you're
wondering why you is passed as a

2468
00:55:48,540 --> 00:55:48,550
wondering why you is passed as a
 

2469
00:55:48,550 --> 00:55:54,770
wondering why you is passed as a
parameter to the function at 58 okay

2470
00:55:54,770 --> 00:55:54,780
parameter to the function at 58 okay
 

2471
00:55:54,780 --> 00:55:59,060
parameter to the function at 58 okay
yeah this is alright so the question is

2472
00:55:59,060 --> 00:55:59,070
yeah this is alright so the question is
 

2473
00:55:59,070 --> 00:56:01,440
yeah this is alright so the question is
okay so actually backing up a little bit

2474
00:56:01,440 --> 00:56:01,450
okay so actually backing up a little bit
 

2475
00:56:01,450 --> 00:56:05,880
okay so actually backing up a little bit
the rules for these for a function like

2476
00:56:05,880 --> 00:56:05,890
the rules for these for a function like
 

2477
00:56:05,890 --> 00:56:09,000
the rules for these for a function like
the one I'm defining on 58 is that if

2478
00:56:09,000 --> 00:56:09,010
the one I'm defining on 58 is that if
 

2479
00:56:09,010 --> 00:56:10,950
the one I'm defining on 58 is that if
the function body mentions a variable

2480
00:56:10,950 --> 00:56:10,960
the function body mentions a variable
 

2481
00:56:10,960 --> 00:56:14,040
the function body mentions a variable
that's declared in the outer function

2482
00:56:14,040 --> 00:56:14,050
that's declared in the outer function
 

2483
00:56:14,050 --> 00:56:17,460
that's declared in the outer function
but not shadowed then the the inner

2484
00:56:17,460 --> 00:56:17,470
but not shadowed then the the inner
 

2485
00:56:17,470 --> 00:56:18,990
but not shadowed then the the inner
functions use of that is the same

2486
00:56:18,990 --> 00:56:19,000
functions use of that is the same
 

2487
00:56:19,000 --> 00:56:20,640
functions use of that is the same
variable in the inner function as in the

2488
00:56:20,640 --> 00:56:20,650
variable in the inner function as in the
 

2489
00:56:20,650 --> 00:56:23,070
variable in the inner function as in the
outer function and so that's what's

2490
00:56:23,070 --> 00:56:23,080
outer function and so that's what's
 

2491
00:56:23,080 --> 00:56:26,370
outer function and so that's what's
happening with Fechter for example like

2492
00:56:26,370 --> 00:56:26,380
happening with Fechter for example like
 

2493
00:56:26,380 --> 00:56:28,770
happening with Fechter for example like
what is this variable here refer to what

2494
00:56:28,770 --> 00:56:28,780
what is this variable here refer to what
 

2495
00:56:28,780 --> 00:56:30,240
what is this variable here refer to what
does the Fechter variable refer to in

2496
00:56:30,240 --> 00:56:30,250
does the Fechter variable refer to in
 

2497
00:56:30,250 --> 00:56:32,970
does the Fechter variable refer to in
the inner function well it refers it's

2498
00:56:32,970 --> 00:56:32,980
the inner function well it refers it's
 

2499
00:56:32,980 --> 00:56:35,280
the inner function well it refers it's
the same variable as as the fetcher in

2500
00:56:35,280 --> 00:56:35,290
the same variable as as the fetcher in
 

2501
00:56:35,290 --> 00:56:37,470
the same variable as as the fetcher in
the outer function says just is that

2502
00:56:37,470 --> 00:56:37,480
the outer function says just is that
 

2503
00:56:37,480 --> 00:56:38,910
the outer function says just is that
variable and so when the inner function

2504
00:56:38,910 --> 00:56:38,920
variable and so when the inner function
 

2505
00:56:38,920 --> 00:56:40,500
variable and so when the inner function
refers to fetcher it just means it's

2506
00:56:40,500 --> 00:56:40,510
refers to fetcher it just means it's
 

2507
00:56:40,510 --> 00:56:42,300
refers to fetcher it just means it's
just referring the same variable as this

2508
00:56:42,300 --> 00:56:42,310
just referring the same variable as this
 

2509
00:56:42,310 --> 00:56:45,660
just referring the same variable as this
one here and the same with F f is it's

2510
00:56:45,660 --> 00:56:45,670
one here and the same with F f is it's
 

2511
00:56:45,670 --> 00:56:48,150
one here and the same with F f is it's
used here it's just is this variable so

2512
00:56:48,150 --> 00:56:48,160
used here it's just is this variable so
 

2513
00:56:48,160 --> 00:56:50,310
used here it's just is this variable so
you might think that we could get rid of

2514
00:56:50,310 --> 00:56:50,320
you might think that we could get rid of
 

2515
00:56:50,320 --> 00:56:55,980
you might think that we could get rid of
the this u argument that we're passing

2516
00:56:55,980 --> 00:56:55,990
the this u argument that we're passing
 

2517
00:56:55,990 --> 00:56:57,870
the this u argument that we're passing
and just have the inner function take no

2518
00:56:57,870 --> 00:56:57,880
and just have the inner function take no
 

2519
00:56:57,880 --> 00:56:59,850
and just have the inner function take no
arguments at all but just use the U that

2520
00:56:59,850 --> 00:56:59,860
arguments at all but just use the U that
 

2521
00:56:59,860 --> 00:57:05,060
arguments at all but just use the U that
was defined up on line 56 in the loop

2522
00:57:05,060 --> 00:57:05,070

 

2523
00:57:05,070 --> 00:57:07,380

and it'll be nice if we could do that

2524
00:57:07,380 --> 00:57:07,390
and it'll be nice if we could do that
 

2525
00:57:07,390 --> 00:57:09,900
and it'll be nice if we could do that
because save us some typing it turns out

2526
00:57:09,900 --> 00:57:09,910
because save us some typing it turns out
 

2527
00:57:09,910 --> 00:57:12,540
because save us some typing it turns out
not to work and the reason is that the

2528
00:57:12,540 --> 00:57:12,550
not to work and the reason is that the
 

2529
00:57:12,550 --> 00:57:16,050
not to work and the reason is that the
semantics of go of the for loop at line

2530
00:57:16,050 --> 00:57:16,060
semantics of go of the for loop at line
 

2531
00:57:16,060 --> 00:57:17,400
semantics of go of the for loop at line
56 is that the

2532
00:57:17,400 --> 00:57:17,410
56 is that the
 

2533
00:57:17,410 --> 00:57:21,840
56 is that the
for the updates the variable you so in

2534
00:57:21,840 --> 00:57:21,850
for the updates the variable you so in
 

2535
00:57:21,850 --> 00:57:23,610
for the updates the variable you so in
the first iteration of the for loop that

2536
00:57:23,610 --> 00:57:23,620
the first iteration of the for loop that
 

2537
00:57:23,620 --> 00:57:29,370
the first iteration of the for loop that
variable u contains some URL and when

2538
00:57:29,370 --> 00:57:29,380
variable u contains some URL and when
 

2539
00:57:29,380 --> 00:57:31,500
variable u contains some URL and when
you enter the second iteration before

2540
00:57:31,500 --> 00:57:31,510
you enter the second iteration before
 

2541
00:57:31,510 --> 00:57:34,140
you enter the second iteration before
the that variable this contents are

2542
00:57:34,140 --> 00:57:34,150
the that variable this contents are
 

2543
00:57:34,150 --> 00:57:37,740
the that variable this contents are
changed to be the second URL and that

2544
00:57:37,740 --> 00:57:37,750
changed to be the second URL and that
 

2545
00:57:37,750 --> 00:57:39,360
changed to be the second URL and that
means that the first go routine that we

2546
00:57:39,360 --> 00:57:39,370
means that the first go routine that we
 

2547
00:57:39,370 --> 00:57:41,520
means that the first go routine that we
launched that's just looking at the

2548
00:57:41,520 --> 00:57:41,530
launched that's just looking at the
 

2549
00:57:41,530 --> 00:57:42,990
launched that's just looking at the
outer if it we're looking at the outer

2550
00:57:42,990 --> 00:57:43,000
outer if it we're looking at the outer
 

2551
00:57:43,000 --> 00:57:46,920
outer if it we're looking at the outer
functions u variable the that first go

2552
00:57:46,920 --> 00:57:46,930
functions u variable the that first go
 

2553
00:57:46,930 --> 00:57:48,900
functions u variable the that first go
team we launched would see a different

2554
00:57:48,900 --> 00:57:48,910
team we launched would see a different
 

2555
00:57:48,910 --> 00:57:51,390
team we launched would see a different
value in the u variable after the outer

2556
00:57:51,390 --> 00:57:51,400
value in the u variable after the outer
 

2557
00:57:51,400 --> 00:57:53,790
value in the u variable after the outer
function it updated it and sometimes

2558
00:57:53,790 --> 00:57:53,800
function it updated it and sometimes
 

2559
00:57:53,800 --> 00:57:55,140
function it updated it and sometimes
that's actually what you want so for

2560
00:57:55,140 --> 00:57:55,150
that's actually what you want so for
 

2561
00:57:55,150 --> 00:57:57,990
that's actually what you want so for
example for for F and then particular F

2562
00:57:57,990 --> 00:57:58,000
example for for F and then particular F
 

2563
00:57:58,000 --> 00:58:01,590
example for for F and then particular F
dot fetched we interaction absolutely

2564
00:58:01,590 --> 00:58:01,600
dot fetched we interaction absolutely
 

2565
00:58:01,600 --> 00:58:04,950
dot fetched we interaction absolutely
wants to see changes to that map but for

2566
00:58:04,950 --> 00:58:04,960
wants to see changes to that map but for
 

2567
00:58:04,960 --> 00:58:06,480
wants to see changes to that map but for
you we don't want to see changes the

2568
00:58:06,480 --> 00:58:06,490
you we don't want to see changes the
 

2569
00:58:06,490 --> 00:58:09,060
you we don't want to see changes the
first go routine we spawn should read

2570
00:58:09,060 --> 00:58:09,070
first go routine we spawn should read
 

2571
00:58:09,070 --> 00:58:12,120
first go routine we spawn should read
the first URL not the second URL so we

2572
00:58:12,120 --> 00:58:12,130
the first URL not the second URL so we
 

2573
00:58:12,130 --> 00:58:13,800
the first URL not the second URL so we
want that go routine to have a copy you

2574
00:58:13,800 --> 00:58:13,810
want that go routine to have a copy you
 

2575
00:58:13,810 --> 00:58:16,070
want that go routine to have a copy you
have its own private copy of the URL and

2576
00:58:16,070 --> 00:58:16,080
have its own private copy of the URL and
 

2577
00:58:16,080 --> 00:58:18,360
have its own private copy of the URL and
you know is we could have done it in

2578
00:58:18,360 --> 00:58:18,370
you know is we could have done it in
 

2579
00:58:18,370 --> 00:58:20,550
you know is we could have done it in
other ways we could have but the way

2580
00:58:20,550 --> 00:58:20,560
other ways we could have but the way
 

2581
00:58:20,560 --> 00:58:22,140
other ways we could have but the way
this code happens to do it to produce

2582
00:58:22,140 --> 00:58:22,150
this code happens to do it to produce
 

2583
00:58:22,150 --> 00:58:25,620
this code happens to do it to produce
the copy private to that inner function

2584
00:58:25,620 --> 00:58:25,630
the copy private to that inner function
 

2585
00:58:25,630 --> 00:58:34,440
the copy private to that inner function
is by passing the URLs in argument yes

2586
00:58:34,440 --> 00:58:34,450

 

2587
00:58:34,450 --> 00:58:36,880

yeah if we have passed the address of

2588
00:58:36,880 --> 00:58:36,890
yeah if we have passed the address of
 

2589
00:58:36,890 --> 00:58:51,190
yeah if we have passed the address of
you yeah then it uh it's actually I

2590
00:58:51,190 --> 00:58:51,200
you yeah then it uh it's actually I
 

2591
00:58:51,200 --> 00:58:52,180
you yeah then it uh it's actually I
don't know how strings work but it is

2592
00:58:52,180 --> 00:58:52,190
don't know how strings work but it is
 

2593
00:58:52,190 --> 00:58:54,039
don't know how strings work but it is
absolutely giving you your own private

2594
00:58:54,039 --> 00:58:54,049
absolutely giving you your own private
 

2595
00:58:54,049 --> 00:59:00,130
absolutely giving you your own private
copy of the variable you get your own

2596
00:59:00,130 --> 00:59:00,140
copy of the variable you get your own
 

2597
00:59:00,140 --> 00:59:26,490
copy of the variable you get your own
copy of the variable and it yeah

2598
00:59:26,490 --> 00:59:26,500

 

2599
00:59:26,500 --> 00:59:28,840

are you saying we don't need to play

2600
00:59:28,840 --> 00:59:28,850
are you saying we don't need to play
 

2601
00:59:28,850 --> 00:59:33,850
are you saying we don't need to play
this trick in the code we definitely

2602
00:59:33,850 --> 00:59:33,860
this trick in the code we definitely
 

2603
00:59:33,860 --> 00:59:35,260
this trick in the code we definitely
need to play this trick in the code and

2604
00:59:35,260 --> 00:59:35,270
need to play this trick in the code and
 

2605
00:59:35,270 --> 00:59:37,690
need to play this trick in the code and
what's going on is this it's so the

2606
00:59:37,690 --> 00:59:37,700
what's going on is this it's so the
 

2607
00:59:37,700 --> 00:59:39,160
what's going on is this it's so the
question is Oh strings are immutable

2608
00:59:39,160 --> 00:59:39,170
question is Oh strings are immutable
 

2609
00:59:39,170 --> 00:59:41,950
question is Oh strings are immutable
strings are immutable right yeah so how

2610
00:59:41,950 --> 00:59:41,960
strings are immutable right yeah so how
 

2611
00:59:41,960 --> 00:59:43,840
strings are immutable right yeah so how
kind of strings are immutable how can

2612
00:59:43,840 --> 00:59:43,850
kind of strings are immutable how can
 

2613
00:59:43,850 --> 00:59:45,100
kind of strings are immutable how can
the outer function change the string

2614
00:59:45,100 --> 00:59:45,110
the outer function change the string
 

2615
00:59:45,110 --> 00:59:47,710
the outer function change the string
there should be no problem the problem

2616
00:59:47,710 --> 00:59:47,720
there should be no problem the problem
 

2617
00:59:47,720 --> 00:59:49,690
there should be no problem the problem
is not that the string is changed the

2618
00:59:49,690 --> 00:59:49,700
is not that the string is changed the
 

2619
00:59:49,700 --> 00:59:51,490
is not that the string is changed the
problem is that the variable U is

2620
00:59:51,490 --> 00:59:51,500
problem is that the variable U is
 

2621
00:59:51,500 --> 00:59:56,140
problem is that the variable U is
changed so the when the inner function

2622
00:59:56,140 --> 00:59:56,150
changed so the when the inner function
 

2623
00:59:56,150 --> 00:59:57,850
changed so the when the inner function
mentions a variable that's defined in

2624
00:59:57,850 --> 00:59:57,860
mentions a variable that's defined in
 

2625
00:59:57,860 --> 00:59:58,990
mentions a variable that's defined in
the outer function it's referring to

2626
00:59:58,990 --> 00:59:59,000
the outer function it's referring to
 

2627
00:59:59,000 --> 01:00:01,060
the outer function it's referring to
that variable and the variables current

2628
01:00:01,060 --> 01:00:01,070
that variable and the variables current
 

2629
01:00:01,070 --> 01:00:03,310
that variable and the variables current
value so when you if you have a string

2630
01:00:03,310 --> 01:00:03,320
value so when you if you have a string
 

2631
01:00:03,320 --> 01:00:06,580
value so when you if you have a string
variable that has has a in it and then

2632
01:00:06,580 --> 01:00:06,590
variable that has has a in it and then
 

2633
01:00:06,590 --> 01:00:09,100
variable that has has a in it and then
you assign B to that string variable

2634
01:00:09,100 --> 01:00:09,110
you assign B to that string variable
 

2635
01:00:09,110 --> 01:00:10,510
you assign B to that string variable
you're not over writing the string

2636
01:00:10,510 --> 01:00:10,520
you're not over writing the string
 

2637
01:00:10,520 --> 01:00:12,520
you're not over writing the string
you're changing the variable to point to

2638
01:00:12,520 --> 01:00:12,530
you're changing the variable to point to
 

2639
01:00:12,530 --> 01:00:15,940
you're changing the variable to point to
a different string and and because the

2640
01:00:15,940 --> 01:00:15,950
a different string and and because the
 

2641
01:00:15,950 --> 01:00:18,670
a different string and and because the
for loop changes the U variable to point

2642
01:00:18,670 --> 01:00:18,680
for loop changes the U variable to point
 

2643
01:00:18,680 --> 01:00:21,280
for loop changes the U variable to point
to a different string you know that

2644
01:00:21,280 --> 01:00:21,290
to a different string you know that
 

2645
01:00:21,290 --> 01:00:22,960
to a different string you know that
change to you would be visible inside

2646
01:00:22,960 --> 01:00:22,970
change to you would be visible inside
 

2647
01:00:22,970 --> 01:00:24,670
change to you would be visible inside
the inner function and therefore the

2648
01:00:24,670 --> 01:00:24,680
the inner function and therefore the
 

2649
01:00:24,680 --> 01:00:26,380
the inner function and therefore the
inner function needs its own copy of the

2650
01:00:26,380 --> 01:00:26,390
inner function needs its own copy of the
 

2651
01:00:26,390 --> 01:00:36,140
inner function needs its own copy of the
variable

2652
01:00:36,140 --> 01:00:36,150

 

2653
01:00:36,150 --> 01:00:50,240

essentially make a copy of that so that

2654
01:00:50,240 --> 01:00:50,250

 

2655
01:00:50,250 --> 01:00:53,100

okay but that is what we're doing in

2656
01:00:53,100 --> 01:00:53,110
okay but that is what we're doing in
 

2657
01:00:53,110 --> 01:00:54,660
okay but that is what we're doing in
this code and that's that is why this

2658
01:00:54,660 --> 01:00:54,670
this code and that's that is why this
 

2659
01:00:54,670 --> 01:00:56,430
this code and that's that is why this
code works okay

2660
01:00:56,430 --> 01:00:56,440
code works okay
 

2661
01:00:56,440 --> 01:00:59,070
code works okay
the proposal or the broken code that

2662
01:00:59,070 --> 01:00:59,080
the proposal or the broken code that
 

2663
01:00:59,080 --> 01:01:00,390
the proposal or the broken code that
we're not using here I will show you the

2664
01:01:00,390 --> 01:01:00,400
we're not using here I will show you the
 

2665
01:01:00,400 --> 01:01:44,050
we're not using here I will show you the
broken code

2666
01:01:44,050 --> 01:01:44,060

 

2667
01:01:44,060 --> 01:01:46,430

this is just like a horrible detail but

2668
01:01:46,430 --> 01:01:46,440
this is just like a horrible detail but
 

2669
01:01:46,440 --> 01:01:47,690
this is just like a horrible detail but
it is unfortunately one that you'll run

2670
01:01:47,690 --> 01:01:47,700
it is unfortunately one that you'll run
 

2671
01:01:47,700 --> 01:01:50,840
it is unfortunately one that you'll run
into while doing the labs so you should

2672
01:01:50,840 --> 01:01:50,850
into while doing the labs so you should
 

2673
01:01:50,850 --> 01:01:52,190
into while doing the labs so you should
be at least where that there's a problem

2674
01:01:52,190 --> 01:01:52,200
be at least where that there's a problem
 

2675
01:01:52,200 --> 01:01:54,680
be at least where that there's a problem
and when you run into it maybe you can

2676
01:01:54,680 --> 01:01:54,690
and when you run into it maybe you can
 

2677
01:01:54,690 --> 01:02:12,160
and when you run into it maybe you can
try to figure out the details okay

2678
01:02:12,160 --> 01:02:12,170
try to figure out the details okay
 

2679
01:02:12,170 --> 01:02:15,860
try to figure out the details okay
that's a great question so so the

2680
01:02:15,860 --> 01:02:15,870
that's a great question so so the
 

2681
01:02:15,870 --> 01:02:18,080
that's a great question so so the
question is you know if you have an

2682
01:02:18,080 --> 01:02:18,090
question is you know if you have an
 

2683
01:02:18,090 --> 01:02:19,760
question is you know if you have an
inner function just a repeated if you

2684
01:02:19,760 --> 01:02:19,770
inner function just a repeated if you
 

2685
01:02:19,770 --> 01:02:21,170
inner function just a repeated if you
have an inner function that refers to a

2686
01:02:21,170 --> 01:02:21,180
have an inner function that refers to a
 

2687
01:02:21,180 --> 01:02:23,420
have an inner function that refers to a
variable in the surrounding function but

2688
01:02:23,420 --> 01:02:23,430
variable in the surrounding function but
 

2689
01:02:23,430 --> 01:02:25,970
variable in the surrounding function but
the surrounding function returns what is

2690
01:02:25,970 --> 01:02:25,980
the surrounding function returns what is
 

2691
01:02:25,980 --> 01:02:28,580
the surrounding function returns what is
the inner functions variable referring

2692
01:02:28,580 --> 01:02:28,590
the inner functions variable referring
 

2693
01:02:28,590 --> 01:02:30,020
the inner functions variable referring
to anymore since the outer function is

2694
01:02:30,020 --> 01:02:30,030
to anymore since the outer function is
 

2695
01:02:30,030 --> 01:02:32,450
to anymore since the outer function is
as returned and the answer is that go

2696
01:02:32,450 --> 01:02:32,460
as returned and the answer is that go
 

2697
01:02:32,460 --> 01:02:35,180
as returned and the answer is that go
notices go analyzes your inner functions

2698
01:02:35,180 --> 01:02:35,190
notices go analyzes your inner functions
 

2699
01:02:35,190 --> 01:02:38,150
notices go analyzes your inner functions
or these are called closures go analyzes

2700
01:02:38,150 --> 01:02:38,160
or these are called closures go analyzes
 

2701
01:02:38,160 --> 01:02:39,860
or these are called closures go analyzes
them the compiler analyze them says aha

2702
01:02:39,860 --> 01:02:39,870
them the compiler analyze them says aha
 

2703
01:02:39,870 --> 01:02:41,570
them the compiler analyze them says aha
oh this disclosure this inner function

2704
01:02:41,570 --> 01:02:41,580
oh this disclosure this inner function
 

2705
01:02:41,580 --> 01:02:42,560
oh this disclosure this inner function
is using a variable in the outer

2706
01:02:42,560 --> 01:02:42,570
is using a variable in the outer
 

2707
01:02:42,570 --> 01:02:44,300
is using a variable in the outer
function we're actually gonna and the

2708
01:02:44,300 --> 01:02:44,310
function we're actually gonna and the
 

2709
01:02:44,310 --> 01:02:47,570
function we're actually gonna and the
compiler will allocate heat memory to

2710
01:02:47,570 --> 01:02:47,580
compiler will allocate heat memory to
 

2711
01:02:47,580 --> 01:02:50,660
compiler will allocate heat memory to
hold the variable the you know the

2712
01:02:50,660 --> 01:02:50,670
hold the variable the you know the
 

2713
01:02:50,670 --> 01:02:52,580
hold the variable the you know the
current value of the variable and both

2714
01:02:52,580 --> 01:02:52,590
current value of the variable and both
 

2715
01:02:52,590 --> 01:02:55,220
current value of the variable and both
functions will refer to that that little

2716
01:02:55,220 --> 01:02:55,230
functions will refer to that that little
 

2717
01:02:55,230 --> 01:02:58,340
functions will refer to that that little
area heap that has the barrel so it

2718
01:02:58,340 --> 01:02:58,350
area heap that has the barrel so it
 

2719
01:02:58,350 --> 01:02:59,750
area heap that has the barrel so it
won't be allocated the variable won't be

2720
01:02:59,750 --> 01:02:59,760
won't be allocated the variable won't be
 

2721
01:02:59,760 --> 01:03:01,580
won't be allocated the variable won't be
on the stack as you might expect it's

2722
01:03:01,580 --> 01:03:01,590
on the stack as you might expect it's
 

2723
01:03:01,590 --> 01:03:03,170
on the stack as you might expect it's
moved to the heap if if the compiler

2724
01:03:03,170 --> 01:03:03,180
moved to the heap if if the compiler
 

2725
01:03:03,180 --> 01:03:04,970
moved to the heap if if the compiler
sees that it's using a closure and then

2726
01:03:04,970 --> 01:03:04,980
sees that it's using a closure and then
 

2727
01:03:04,980 --> 01:03:06,050
sees that it's using a closure and then
when the outer function returns the

2728
01:03:06,050 --> 01:03:06,060
when the outer function returns the
 

2729
01:03:06,060 --> 01:03:07,940
when the outer function returns the
object is still there in the heap the

2730
01:03:07,940 --> 01:03:07,950
object is still there in the heap the
 

2731
01:03:07,950 --> 01:03:09,830
object is still there in the heap the
inner function can still get at it and

2732
01:03:09,830 --> 01:03:09,840
inner function can still get at it and
 

2733
01:03:09,840 --> 01:03:11,810
inner function can still get at it and
then the garbage collector is

2734
01:03:11,810 --> 01:03:11,820
then the garbage collector is
 

2735
01:03:11,820 --> 01:03:13,430
then the garbage collector is
responsible for noticing that the last

2736
01:03:13,430 --> 01:03:13,440
responsible for noticing that the last
 

2737
01:03:13,440 --> 01:03:15,530
responsible for noticing that the last
function to refer to this little piece

2738
01:03:15,530 --> 01:03:15,540
function to refer to this little piece
 

2739
01:03:15,540 --> 01:03:18,530
function to refer to this little piece
of heat that's exited returned and to

2740
01:03:18,530 --> 01:03:18,540
of heat that's exited returned and to
 

2741
01:03:18,540 --> 01:03:24,759
of heat that's exited returned and to
free it only then okay okay

2742
01:03:24,759 --> 01:03:24,769
free it only then okay okay
 

2743
01:03:24,769 --> 01:03:29,299
free it only then okay okay
okay so wait group wait group is maybe

2744
01:03:29,299 --> 01:03:29,309
okay so wait group wait group is maybe
 

2745
01:03:29,309 --> 01:03:30,619
okay so wait group wait group is maybe
the more important thing here that the

2746
01:03:30,619 --> 01:03:30,629
the more important thing here that the
 

2747
01:03:30,629 --> 01:03:32,539
the more important thing here that the
technique that this code uses to wait

2748
01:03:32,539 --> 01:03:32,549
technique that this code uses to wait
 

2749
01:03:32,549 --> 01:03:35,709
technique that this code uses to wait
for all the all this level of crawls to

2750
01:03:35,709 --> 01:03:35,719
for all the all this level of crawls to
 

2751
01:03:35,719 --> 01:03:37,729
for all the all this level of crawls to
finished all its direct chill and the

2752
01:03:37,729 --> 01:03:37,739
finished all its direct chill and the
 

2753
01:03:37,739 --> 01:03:39,589
finished all its direct chill and the
finish is the wait group of course

2754
01:03:39,589 --> 01:03:39,599
finish is the wait group of course
 

2755
01:03:39,599 --> 01:03:41,269
finish is the wait group of course
there's many of these wait groups one

2756
01:03:41,269 --> 01:03:41,279
there's many of these wait groups one
 

2757
01:03:41,279 --> 01:03:44,899
there's many of these wait groups one
per call two concurrent mutex each call

2758
01:03:44,899 --> 01:03:44,909
per call two concurrent mutex each call
 

2759
01:03:44,909 --> 01:03:46,279
per call two concurrent mutex each call
that concurrent mutex just waits for its

2760
01:03:46,279 --> 01:03:46,289
that concurrent mutex just waits for its
 

2761
01:03:46,289 --> 01:03:49,509
that concurrent mutex just waits for its
own children to finish and then returns

2762
01:03:49,509 --> 01:03:49,519
own children to finish and then returns
 

2763
01:03:49,519 --> 01:03:53,599
own children to finish and then returns
okay so back to the lock actually

2764
01:03:53,599 --> 01:03:53,609
okay so back to the lock actually
 

2765
01:03:53,609 --> 01:03:54,469
okay so back to the lock actually
there's one more thing I want to talk

2766
01:03:54,469 --> 01:03:54,479
there's one more thing I want to talk
 

2767
01:03:54,479 --> 01:03:56,269
there's one more thing I want to talk
about with a lock and that is to explore

2768
01:03:56,269 --> 01:03:56,279
about with a lock and that is to explore
 

2769
01:03:56,279 --> 01:03:57,939
about with a lock and that is to explore
what would happen if we hadn't locked

2770
01:03:57,939 --> 01:03:57,949
what would happen if we hadn't locked
 

2771
01:03:57,949 --> 01:04:00,679
what would happen if we hadn't locked
right I'm claiming oh you know you don't

2772
01:04:00,679 --> 01:04:00,689
right I'm claiming oh you know you don't
 

2773
01:04:00,689 --> 01:04:02,359
right I'm claiming oh you know you don't
lock you're gonna get these races you're

2774
01:04:02,359 --> 01:04:02,369
lock you're gonna get these races you're
 

2775
01:04:02,369 --> 01:04:05,199
lock you're gonna get these races you're
gonna get incorrect execution whatever

2776
01:04:05,199 --> 01:04:05,209
gonna get incorrect execution whatever
 

2777
01:04:05,209 --> 01:04:11,029
gonna get incorrect execution whatever
let's give it a shot I'm gonna I'm gonna

2778
01:04:11,029 --> 01:04:11,039
let's give it a shot I'm gonna I'm gonna
 

2779
01:04:11,039 --> 01:04:14,509
let's give it a shot I'm gonna I'm gonna
comment out the locks and the question

2780
01:04:14,509 --> 01:04:14,519
comment out the locks and the question
 

2781
01:04:14,519 --> 01:04:17,149
comment out the locks and the question
is what happens if I run the code with

2782
01:04:17,149 --> 01:04:17,159
is what happens if I run the code with
 

2783
01:04:17,159 --> 01:04:24,169
is what happens if I run the code with
no locks what am I gonna see so we may

2784
01:04:24,169 --> 01:04:24,179
no locks what am I gonna see so we may
 

2785
01:04:24,179 --> 01:04:26,449
no locks what am I gonna see so we may
see a ru or I'll call twice or I fetch

2786
01:04:26,449 --> 01:04:26,459
see a ru or I'll call twice or I fetch
 

2787
01:04:26,459 --> 01:04:28,579
see a ru or I'll call twice or I fetch
twice yeah that's yeah that would be the

2788
01:04:28,579 --> 01:04:28,589
twice yeah that's yeah that would be the
 

2789
01:04:28,589 --> 01:04:31,639
twice yeah that's yeah that would be the
error you might expect alright so I'll

2790
01:04:31,639 --> 01:04:31,649
error you might expect alright so I'll
 

2791
01:04:31,649 --> 01:04:34,789
error you might expect alright so I'll
run it without locks and we're looking

2792
01:04:34,789 --> 01:04:34,799
run it without locks and we're looking
 

2793
01:04:34,799 --> 01:04:36,259
run it without locks and we're looking
at the concurrent map the one in the

2794
01:04:36,259 --> 01:04:36,269
at the concurrent map the one in the
 

2795
01:04:36,269 --> 01:04:38,449
at the concurrent map the one in the
middle this time it doesn't seem to have

2796
01:04:38,449 --> 01:04:38,459
middle this time it doesn't seem to have
 

2797
01:04:38,459 --> 01:04:40,359
middle this time it doesn't seem to have
fetched anything twice it's only five

2798
01:04:40,359 --> 01:04:40,369
fetched anything twice it's only five
 

2799
01:04:40,369 --> 01:04:49,129
fetched anything twice it's only five
run again gosh so far genius so maybe

2800
01:04:49,129 --> 01:04:49,139
run again gosh so far genius so maybe
 

2801
01:04:49,139 --> 01:04:50,709
run again gosh so far genius so maybe
we're wasting our time with those locks

2802
01:04:50,709 --> 01:04:50,719
we're wasting our time with those locks
 

2803
01:04:50,719 --> 01:04:52,489
we're wasting our time with those locks
yeah never seems to go wrong I've

2804
01:04:52,489 --> 01:04:52,499
yeah never seems to go wrong I've
 

2805
01:04:52,499 --> 01:04:57,409
yeah never seems to go wrong I've
actually never seem to go wrong so the

2806
01:04:57,409 --> 01:04:57,419
actually never seem to go wrong so the
 

2807
01:04:57,419 --> 01:05:00,259
actually never seem to go wrong so the
code is nevertheless wrong and someday

2808
01:05:00,259 --> 01:05:00,269
code is nevertheless wrong and someday
 

2809
01:05:00,269 --> 01:05:03,319
code is nevertheless wrong and someday
it will fail okay the problem is that

2810
01:05:03,319 --> 01:05:03,329
it will fail okay the problem is that
 

2811
01:05:03,329 --> 01:05:04,549
it will fail okay the problem is that
you know this is only a couple of

2812
01:05:04,549 --> 01:05:04,559
you know this is only a couple of
 

2813
01:05:04,559 --> 01:05:06,169
you know this is only a couple of
instructions here and so the chances of

2814
01:05:06,169 --> 01:05:06,179
instructions here and so the chances of
 

2815
01:05:06,179 --> 01:05:07,969
instructions here and so the chances of
these two threads which are maybe

2816
01:05:07,969 --> 01:05:07,979
these two threads which are maybe
 

2817
01:05:07,979 --> 01:05:09,529
these two threads which are maybe
hundreds of instructions happening to

2818
01:05:09,529 --> 01:05:09,539
hundreds of instructions happening to
 

2819
01:05:09,539 --> 01:05:12,259
hundreds of instructions happening to
stumble on this you know the same couple

2820
01:05:12,259 --> 01:05:12,269
stumble on this you know the same couple
 

2821
01:05:12,269 --> 01:05:14,479
stumble on this you know the same couple
of instructions at the same time is

2822
01:05:14,479 --> 01:05:14,489
of instructions at the same time is
 

2823
01:05:14,489 --> 01:05:17,719
of instructions at the same time is
quite low and indeed and and this is a

2824
01:05:17,719 --> 01:05:17,729
quite low and indeed and and this is a
 

2825
01:05:17,729 --> 01:05:20,449
quite low and indeed and and this is a
real bummer about buggy code with races

2826
01:05:20,449 --> 01:05:20,459
real bummer about buggy code with races
 

2827
01:05:20,459 --> 01:05:23,509
real bummer about buggy code with races
is that it usually works just fine but

2828
01:05:23,509 --> 01:05:23,519
is that it usually works just fine but
 

2829
01:05:23,519 --> 01:05:25,279
is that it usually works just fine but
it probably won't work when the customer

2830
01:05:25,279 --> 01:05:25,289
it probably won't work when the customer
 

2831
01:05:25,289 --> 01:05:28,010
it probably won't work when the customer
runs it on their computer

2832
01:05:28,010 --> 01:05:28,020
runs it on their computer
 

2833
01:05:28,020 --> 01:05:30,500
runs it on their computer
so it's actually bad news for us right

2834
01:05:30,500 --> 01:05:30,510
so it's actually bad news for us right
 

2835
01:05:30,510 --> 01:05:32,930
so it's actually bad news for us right
what do we you know it it can be in

2836
01:05:32,930 --> 01:05:32,940
what do we you know it it can be in
 

2837
01:05:32,940 --> 01:05:34,910
what do we you know it it can be in
complex programs quite difficult to

2838
01:05:34,910 --> 01:05:34,920
complex programs quite difficult to
 

2839
01:05:34,920 --> 01:05:37,160
complex programs quite difficult to
figure out if you have a race right and

2840
01:05:37,160 --> 01:05:37,170
figure out if you have a race right and
 

2841
01:05:37,170 --> 01:05:39,380
figure out if you have a race right and
you might you may have code that just

2842
01:05:39,380 --> 01:05:39,390
you might you may have code that just
 

2843
01:05:39,390 --> 01:05:41,900
you might you may have code that just
looks completely reasonable that is in

2844
01:05:41,900 --> 01:05:41,910
looks completely reasonable that is in
 

2845
01:05:41,910 --> 01:05:44,600
looks completely reasonable that is in
fact sort of unknown to you using shared

2846
01:05:44,600 --> 01:05:44,610
fact sort of unknown to you using shared
 

2847
01:05:44,610 --> 01:05:47,960
fact sort of unknown to you using shared
variables and the answer is you really

2848
01:05:47,960 --> 01:05:47,970
variables and the answer is you really
 

2849
01:05:47,970 --> 01:05:50,030
variables and the answer is you really
the only way to find races in practice

2850
01:05:50,030 --> 01:05:50,040
the only way to find races in practice
 

2851
01:05:50,040 --> 01:05:53,570
the only way to find races in practice
to be is you automated tools and luckily

2852
01:05:53,570 --> 01:05:53,580
to be is you automated tools and luckily
 

2853
01:05:53,580 --> 01:05:55,880
to be is you automated tools and luckily
go actually gives us this pretty good

2854
01:05:55,880 --> 01:05:55,890
go actually gives us this pretty good
 

2855
01:05:55,890 --> 01:06:00,109
go actually gives us this pretty good
race detector built-in to go and you

2856
01:06:00,109 --> 01:06:00,119
race detector built-in to go and you
 

2857
01:06:00,119 --> 01:06:04,609
race detector built-in to go and you
should use it so if you pass the - race

2858
01:06:04,609 --> 01:06:04,619
should use it so if you pass the - race
 

2859
01:06:04,619 --> 01:06:06,530
should use it so if you pass the - race
flag when you have to get your go

2860
01:06:06,530 --> 01:06:06,540
flag when you have to get your go
 

2861
01:06:06,540 --> 01:06:09,700
flag when you have to get your go
program and run this race detector which

2862
01:06:09,700 --> 01:06:09,710
program and run this race detector which
 

2863
01:06:09,710 --> 01:06:11,750
program and run this race detector which
well I'll run the race detector and

2864
01:06:11,750 --> 01:06:11,760
well I'll run the race detector and
 

2865
01:06:11,760 --> 01:06:16,640
well I'll run the race detector and
we'll see so it emits an error message

2866
01:06:16,640 --> 01:06:16,650
we'll see so it emits an error message
 

2867
01:06:16,650 --> 01:06:19,670
we'll see so it emits an error message
from us it's found a race and it

2868
01:06:19,670 --> 01:06:19,680
from us it's found a race and it
 

2869
01:06:19,680 --> 01:06:21,410
from us it's found a race and it
actually tells us exactly where the race

2870
01:06:21,410 --> 01:06:21,420
actually tells us exactly where the race
 

2871
01:06:21,420 --> 01:06:23,540
actually tells us exactly where the race
happened so there's a lot of junk in

2872
01:06:23,540 --> 01:06:23,550
happened so there's a lot of junk in
 

2873
01:06:23,550 --> 01:06:25,250
happened so there's a lot of junk in
this output but the really critical

2874
01:06:25,250 --> 01:06:25,260
this output but the really critical
 

2875
01:06:25,260 --> 01:06:28,310
this output but the really critical
thing is that the race detector realize

2876
01:06:28,310 --> 01:06:28,320
thing is that the race detector realize
 

2877
01:06:28,320 --> 01:06:30,170
thing is that the race detector realize
that we had read a variable that's what

2878
01:06:30,170 --> 01:06:30,180
that we had read a variable that's what
 

2879
01:06:30,180 --> 01:06:32,780
that we had read a variable that's what
this read is that was previously written

2880
01:06:32,780 --> 01:06:32,790
this read is that was previously written
 

2881
01:06:32,790 --> 01:06:35,660
this read is that was previously written
and there was no intervening release and

2882
01:06:35,660 --> 01:06:35,670
and there was no intervening release and
 

2883
01:06:35,670 --> 01:06:37,760
and there was no intervening release and
acquire of a lock that's what that's

2884
01:06:37,760 --> 01:06:37,770
acquire of a lock that's what that's
 

2885
01:06:37,770 --> 01:06:40,190
acquire of a lock that's what that's
what this means furthermore it tells us

2886
01:06:40,190 --> 01:06:40,200
what this means furthermore it tells us
 

2887
01:06:40,200 --> 01:06:43,700
what this means furthermore it tells us
the line number so it's told us that the

2888
01:06:43,700 --> 01:06:43,710
the line number so it's told us that the
 

2889
01:06:43,710 --> 01:06:49,280
the line number so it's told us that the
read was a line 43 and the write the

2890
01:06:49,280 --> 01:06:49,290
read was a line 43 and the write the
 

2891
01:06:49,290 --> 01:06:51,650
read was a line 43 and the write the
previous write was at line 44 and indeed

2892
01:06:51,650 --> 01:06:51,660
previous write was at line 44 and indeed
 

2893
01:06:51,660 --> 01:06:53,180
previous write was at line 44 and indeed
we look at the code and the read isn't

2894
01:06:53,180 --> 01:06:53,190
we look at the code and the read isn't
 

2895
01:06:53,190 --> 01:06:56,210
we look at the code and the read isn't
line 43 and the right is at lying 44 so

2896
01:06:56,210 --> 01:06:56,220
line 43 and the right is at lying 44 so
 

2897
01:06:56,220 --> 01:06:58,160
line 43 and the right is at lying 44 so
that means that one thread did a write

2898
01:06:58,160 --> 01:06:58,170
that means that one thread did a write
 

2899
01:06:58,170 --> 01:07:00,859
that means that one thread did a write
at line 44 and then without any

2900
01:07:00,859 --> 01:07:00,869
at line 44 and then without any
 

2901
01:07:00,869 --> 01:07:02,510
at line 44 and then without any
intervening lock and another thread came

2902
01:07:02,510 --> 01:07:02,520
intervening lock and another thread came
 

2903
01:07:02,520 --> 01:07:05,330
intervening lock and another thread came
along and read that written data at line

2904
01:07:05,330 --> 01:07:05,340
along and read that written data at line
 

2905
01:07:05,340 --> 01:07:07,550
along and read that written data at line
43 that's basically what the race

2906
01:07:07,550 --> 01:07:07,560
43 that's basically what the race
 

2907
01:07:07,560 --> 01:07:10,010
43 that's basically what the race
detector is looking for the way it works

2908
01:07:10,010 --> 01:07:10,020
detector is looking for the way it works
 

2909
01:07:10,020 --> 01:07:11,810
detector is looking for the way it works
internally is it allocates sort of

2910
01:07:11,810 --> 01:07:11,820
internally is it allocates sort of
 

2911
01:07:11,820 --> 01:07:14,990
internally is it allocates sort of
shadow memory now lucky some you know it

2912
01:07:14,990 --> 01:07:15,000
shadow memory now lucky some you know it
 

2913
01:07:15,000 --> 01:07:16,250
shadow memory now lucky some you know it
uses a huge amount of memory and

2914
01:07:16,250 --> 01:07:16,260
uses a huge amount of memory and
 

2915
01:07:16,260 --> 01:07:17,450
uses a huge amount of memory and
basically for every one of your memory

2916
01:07:17,450 --> 01:07:17,460
basically for every one of your memory
 

2917
01:07:17,460 --> 01:07:19,700
basically for every one of your memory
locations the race detector is allocated

2918
01:07:19,700 --> 01:07:19,710
locations the race detector is allocated
 

2919
01:07:19,710 --> 01:07:21,590
locations the race detector is allocated
a little bit of memory itself in which

2920
01:07:21,590 --> 01:07:21,600
a little bit of memory itself in which
 

2921
01:07:21,600 --> 01:07:24,320
a little bit of memory itself in which
it keeps track of which threads recently

2922
01:07:24,320 --> 01:07:24,330
it keeps track of which threads recently
 

2923
01:07:24,330 --> 01:07:26,390
it keeps track of which threads recently
read or wrote every single memory

2924
01:07:26,390 --> 01:07:26,400
read or wrote every single memory
 

2925
01:07:26,400 --> 01:07:28,580
read or wrote every single memory
location and then when and it also to

2926
01:07:28,580 --> 01:07:28,590
location and then when and it also to
 

2927
01:07:28,590 --> 01:07:30,800
location and then when and it also to
keep tracking keeping track of when

2928
01:07:30,800 --> 01:07:30,810
keep tracking keeping track of when
 

2929
01:07:30,810 --> 01:07:32,599
keep tracking keeping track of when
threads acquiring release locks and do

2930
01:07:32,599 --> 01:07:32,609
threads acquiring release locks and do
 

2931
01:07:32,609 --> 01:07:35,420
threads acquiring release locks and do
other synchronization activities that it

2932
01:07:35,420 --> 01:07:35,430
other synchronization activities that it
 

2933
01:07:35,430 --> 01:07:37,970
other synchronization activities that it
knows forces but force threads to not

2934
01:07:37,970 --> 01:07:37,980
knows forces but force threads to not
 

2935
01:07:37,980 --> 01:07:39,170
knows forces but force threads to not
run

2936
01:07:39,170 --> 01:07:39,180
run
 

2937
01:07:39,180 --> 01:07:40,970
run
and if the race detector driver sees a

2938
01:07:40,970 --> 01:07:40,980
and if the race detector driver sees a
 

2939
01:07:40,980 --> 01:07:42,440
and if the race detector driver sees a
ha there was a memory location that was

2940
01:07:42,440 --> 01:07:42,450
ha there was a memory location that was
 

2941
01:07:42,450 --> 01:07:45,200
ha there was a memory location that was
written and then read with no

2942
01:07:45,200 --> 01:07:45,210
written and then read with no
 

2943
01:07:45,210 --> 01:07:49,150
written and then read with no
intervening market it'll raise an error

2944
01:07:49,150 --> 01:07:49,160
intervening market it'll raise an error
 

2945
01:07:49,160 --> 01:08:06,590
intervening market it'll raise an error
yes I believe it is not perfect yeah I

2946
01:08:06,590 --> 01:08:06,600
yes I believe it is not perfect yeah I
 

2947
01:08:06,600 --> 01:08:12,160
yes I believe it is not perfect yeah I
have to think about it what one

2948
01:08:12,160 --> 01:08:12,170
have to think about it what one
 

2949
01:08:12,170 --> 01:08:15,170
have to think about it what one
certainly one way it is not perfect is

2950
01:08:15,170 --> 01:08:15,180
certainly one way it is not perfect is
 

2951
01:08:15,180 --> 01:08:18,890
certainly one way it is not perfect is
that if you if you don't execute some

2952
01:08:18,890 --> 01:08:18,900
that if you if you don't execute some
 

2953
01:08:18,900 --> 01:08:21,260
that if you if you don't execute some
code the race detector doesn't know

2954
01:08:21,260 --> 01:08:21,270
code the race detector doesn't know
 

2955
01:08:21,270 --> 01:08:25,100
code the race detector doesn't know
anything about it so it's not analyzing

2956
01:08:25,100 --> 01:08:25,110
anything about it so it's not analyzing
 

2957
01:08:25,110 --> 01:08:27,980
anything about it so it's not analyzing
it's not doing static analysis the

2958
01:08:27,980 --> 01:08:27,990
it's not doing static analysis the
 

2959
01:08:27,990 --> 01:08:29,210
it's not doing static analysis the
racing sectors not looking at your

2960
01:08:29,210 --> 01:08:29,220
racing sectors not looking at your
 

2961
01:08:29,220 --> 01:08:31,760
racing sectors not looking at your
source and making decisions based on the

2962
01:08:31,760 --> 01:08:31,770
source and making decisions based on the
 

2963
01:08:31,770 --> 01:08:33,380
source and making decisions based on the
source it's sort of watching what

2964
01:08:33,380 --> 01:08:33,390
source it's sort of watching what
 

2965
01:08:33,390 --> 01:08:35,690
source it's sort of watching what
happened at on this particular run of

2966
01:08:35,690 --> 01:08:35,700
happened at on this particular run of
 

2967
01:08:35,700 --> 01:08:37,640
happened at on this particular run of
the program and so if this particular

2968
01:08:37,640 --> 01:08:37,650
the program and so if this particular
 

2969
01:08:37,650 --> 01:08:39,320
the program and so if this particular
run of the program didn't execute some

2970
01:08:39,320 --> 01:08:39,330
run of the program didn't execute some
 

2971
01:08:39,330 --> 01:08:42,440
run of the program didn't execute some
code that happens to read or write

2972
01:08:42,440 --> 01:08:42,450
code that happens to read or write
 

2973
01:08:42,450 --> 01:08:44,360
code that happens to read or write
shared data then the race detector will

2974
01:08:44,360 --> 01:08:44,370
shared data then the race detector will
 

2975
01:08:44,370 --> 01:08:46,490
shared data then the race detector will
never know and there could be erased

2976
01:08:46,490 --> 01:08:46,500
never know and there could be erased
 

2977
01:08:46,500 --> 01:08:48,260
never know and there could be erased
there so that's certainly something to

2978
01:08:48,260 --> 01:08:48,270
there so that's certainly something to
 

2979
01:08:48,270 --> 01:08:49,310
there so that's certainly something to
watch out for so you know if you're

2980
01:08:49,310 --> 01:08:49,320
watch out for so you know if you're
 

2981
01:08:49,320 --> 01:08:50,570
watch out for so you know if you're
serious about the race detector you need

2982
01:08:50,570 --> 01:08:50,580
serious about the race detector you need
 

2983
01:08:50,580 --> 01:08:53,090
serious about the race detector you need
to set up sort of testing apparatus that

2984
01:08:53,090 --> 01:08:53,100
to set up sort of testing apparatus that
 

2985
01:08:53,100 --> 01:08:55,610
to set up sort of testing apparatus that
tries to make sure all all the code is

2986
01:08:55,610 --> 01:08:55,620
tries to make sure all all the code is
 

2987
01:08:55,620 --> 01:08:59,330
tries to make sure all all the code is
executed but it's it's it's very good

2988
01:08:59,330 --> 01:08:59,340
executed but it's it's it's very good
 

2989
01:08:59,340 --> 01:09:01,610
executed but it's it's it's very good
and you just have to use it for your 8

2990
01:09:01,610 --> 01:09:01,620
and you just have to use it for your 8
 

2991
01:09:01,620 --> 01:09:07,820
and you just have to use it for your 8
to 4 lives okay so this is race here and

2992
01:09:07,820 --> 01:09:07,830
to 4 lives okay so this is race here and
 

2993
01:09:07,830 --> 01:09:09,290
to 4 lives okay so this is race here and
of course the race didn't actually occur

2994
01:09:09,290 --> 01:09:09,300
of course the race didn't actually occur
 

2995
01:09:09,300 --> 01:09:12,320
of course the race didn't actually occur
what the race editor did not see was the

2996
01:09:12,320 --> 01:09:12,330
what the race editor did not see was the
 

2997
01:09:12,330 --> 01:09:14,360
what the race editor did not see was the
actual interleaving simultaneous

2998
01:09:14,360 --> 01:09:14,370
actual interleaving simultaneous
 

2999
01:09:14,370 --> 01:09:17,360
actual interleaving simultaneous
execution of some sensitive code right

3000
01:09:17,360 --> 01:09:17,370
execution of some sensitive code right
 

3001
01:09:17,370 --> 01:09:18,890
execution of some sensitive code right
it didn't see two threads literally

3002
01:09:18,890 --> 01:09:18,900
it didn't see two threads literally
 

3003
01:09:18,900 --> 01:09:21,850
it didn't see two threads literally
execute lines 43 and 44 at the same time

3004
01:09:21,850 --> 01:09:21,860
execute lines 43 and 44 at the same time
 

3005
01:09:21,860 --> 01:09:23,960
execute lines 43 and 44 at the same time
and as we know from having run the

3006
01:09:23,960 --> 01:09:23,970
and as we know from having run the
 

3007
01:09:23,970 --> 01:09:25,130
and as we know from having run the
things by hand that apparently doesn't

3008
01:09:25,130 --> 01:09:25,140
things by hand that apparently doesn't
 

3009
01:09:25,140 --> 01:09:28,310
things by hand that apparently doesn't
happen only with low probability all it

3010
01:09:28,310 --> 01:09:28,320
happen only with low probability all it
 

3011
01:09:28,320 --> 01:09:29,870
happen only with low probability all it
saw was at one point that was a right

3012
01:09:29,870 --> 01:09:29,880
saw was at one point that was a right
 

3013
01:09:29,880 --> 01:09:31,520
saw was at one point that was a right
and they made me much later there was a

3014
01:09:31,520 --> 01:09:31,530
and they made me much later there was a
 

3015
01:09:31,530 --> 01:09:37,610
and they made me much later there was a
read with no intervening walk and so

3016
01:09:37,610 --> 01:09:37,620
read with no intervening walk and so
 

3017
01:09:37,620 --> 01:09:39,170
read with no intervening walk and so
enact in that sense it can sort of

3018
01:09:39,170 --> 01:09:39,180
enact in that sense it can sort of
 

3019
01:09:39,180 --> 01:09:41,530
enact in that sense it can sort of
detect races that didn't actually happen

3020
01:09:41,530 --> 01:09:41,540
detect races that didn't actually happen
 

3021
01:09:41,540 --> 01:09:49,530
detect races that didn't actually happen
or didn't really cause bugs okay

3022
01:09:49,530 --> 01:09:49,540

 

3023
01:09:49,540 --> 01:09:52,540

okay one final question about this this

3024
01:09:52,540 --> 01:09:52,550
okay one final question about this this
 

3025
01:09:52,550 --> 01:10:03,629
okay one final question about this this
crawler how many threads does it create

3026
01:10:03,629 --> 01:10:03,639

 

3027
01:10:03,639 --> 01:10:10,109

yeah and how many concurrent threads

3028
01:10:10,109 --> 01:10:10,119
yeah and how many concurrent threads
 

3029
01:10:10,119 --> 01:10:24,959
yeah and how many concurrent threads
could there be yeah so a defect in this

3030
01:10:24,959 --> 01:10:24,969
could there be yeah so a defect in this
 

3031
01:10:24,969 --> 01:10:27,149
could there be yeah so a defect in this
crawler is that there's no obvious bound

3032
01:10:27,149 --> 01:10:27,159
crawler is that there's no obvious bound
 

3033
01:10:27,159 --> 01:10:28,709
crawler is that there's no obvious bound
on the number of simultaneous threads

3034
01:10:28,709 --> 01:10:28,719
on the number of simultaneous threads
 

3035
01:10:28,719 --> 01:10:30,570
on the number of simultaneous threads
that might create you know with the test

3036
01:10:30,570 --> 01:10:30,580
that might create you know with the test
 

3037
01:10:30,580 --> 01:10:32,790
that might create you know with the test
case which only has five URLs big

3038
01:10:32,790 --> 01:10:32,800
case which only has five URLs big
 

3039
01:10:32,800 --> 01:10:34,649
case which only has five URLs big
whoopee but if you're crawling a real

3040
01:10:34,649 --> 01:10:34,659
whoopee but if you're crawling a real
 

3041
01:10:34,659 --> 01:10:36,600
whoopee but if you're crawling a real
wheel web with you know I don't know are

3042
01:10:36,600 --> 01:10:36,610
wheel web with you know I don't know are
 

3043
01:10:36,610 --> 01:10:38,370
wheel web with you know I don't know are
there billions of URLs out there maybe

3044
01:10:38,370 --> 01:10:38,380
there billions of URLs out there maybe
 

3045
01:10:38,380 --> 01:10:40,379
there billions of URLs out there maybe
not we certainly don't want to be in a

3046
01:10:40,379 --> 01:10:40,389
not we certainly don't want to be in a
 

3047
01:10:40,389 --> 01:10:41,370
not we certainly don't want to be in a
position where the crawler might

3048
01:10:41,370 --> 01:10:41,380
position where the crawler might
 

3049
01:10:41,380 --> 01:10:43,370
position where the crawler might
accidentally create billions of threads

3050
01:10:43,370 --> 01:10:43,380
accidentally create billions of threads
 

3051
01:10:43,380 --> 01:10:46,109
accidentally create billions of threads
because you know thousands of threads

3052
01:10:46,109 --> 01:10:46,119
because you know thousands of threads
 

3053
01:10:46,119 --> 01:10:47,879
because you know thousands of threads
it's just fine billions of threads it's

3054
01:10:47,879 --> 01:10:47,889
it's just fine billions of threads it's
 

3055
01:10:47,889 --> 01:10:51,060
it's just fine billions of threads it's
not okay because each one sits on some

3056
01:10:51,060 --> 01:10:51,070
not okay because each one sits on some
 

3057
01:10:51,070 --> 01:10:54,270
not okay because each one sits on some
amount of memory so a you know there's

3058
01:10:54,270 --> 01:10:54,280
amount of memory so a you know there's
 

3059
01:10:54,280 --> 01:10:56,070
amount of memory so a you know there's
probably many defects in real life for

3060
01:10:56,070 --> 01:10:56,080
probably many defects in real life for
 

3061
01:10:56,080 --> 01:10:58,260
probably many defects in real life for
this crawler but one at the level we're

3062
01:10:58,260 --> 01:10:58,270
this crawler but one at the level we're
 

3063
01:10:58,270 --> 01:11:00,209
this crawler but one at the level we're
talking about is that it does create too

3064
01:11:00,209 --> 01:11:00,219
talking about is that it does create too
 

3065
01:11:00,219 --> 01:11:01,590
talking about is that it does create too
many threads and really ought to have a

3066
01:11:01,590 --> 01:11:01,600
many threads and really ought to have a
 

3067
01:11:01,600 --> 01:11:03,270
many threads and really ought to have a
way of saying well you can create 20

3068
01:11:03,270 --> 01:11:03,280
way of saying well you can create 20
 

3069
01:11:03,280 --> 01:11:04,620
way of saying well you can create 20
threads or 100 threads or a thousand

3070
01:11:04,620 --> 01:11:04,630
threads or 100 threads or a thousand
 

3071
01:11:04,630 --> 01:11:06,510
threads or 100 threads or a thousand
threads but no more so one way to do

3072
01:11:06,510 --> 01:11:06,520
threads but no more so one way to do
 

3073
01:11:06,520 --> 01:11:08,189
threads but no more so one way to do
that would be to pre create a pool a

3074
01:11:08,189 --> 01:11:08,199
that would be to pre create a pool a
 

3075
01:11:08,199 --> 01:11:11,040
that would be to pre create a pool a
fixed size pool of workers and have the

3076
01:11:11,040 --> 01:11:11,050
fixed size pool of workers and have the
 

3077
01:11:11,050 --> 01:11:13,169
fixed size pool of workers and have the
workers just iteratively look for

3078
01:11:13,169 --> 01:11:13,179
workers just iteratively look for
 

3079
01:11:13,179 --> 01:11:14,820
workers just iteratively look for
another URL to crawl crawl that URL

3080
01:11:14,820 --> 01:11:14,830
another URL to crawl crawl that URL
 

3081
01:11:14,830 --> 01:11:18,149
another URL to crawl crawl that URL
rather than creating a new thread for

3082
01:11:18,149 --> 01:11:18,159
rather than creating a new thread for
 

3083
01:11:18,159 --> 01:11:21,060
rather than creating a new thread for
each URL okay so next up I want to talk

3084
01:11:21,060 --> 01:11:21,070
each URL okay so next up I want to talk
 

3085
01:11:21,070 --> 01:11:23,220
each URL okay so next up I want to talk
about a another crawler that's

3086
01:11:23,220 --> 01:11:23,230
about a another crawler that's
 

3087
01:11:23,230 --> 01:11:25,590
about a another crawler that's
implemented and a significantly

3088
01:11:25,590 --> 01:11:25,600
implemented and a significantly
 

3089
01:11:25,600 --> 01:11:28,770
implemented and a significantly
different way using channels instead of

3090
01:11:28,770 --> 01:11:28,780
different way using channels instead of
 

3091
01:11:28,780 --> 01:11:31,859
different way using channels instead of
shared memory it's a member on the mutex

3092
01:11:31,859 --> 01:11:31,869
shared memory it's a member on the mutex
 

3093
01:11:31,869 --> 01:11:33,479
shared memory it's a member on the mutex
call or I just said there is this table

3094
01:11:33,479 --> 01:11:33,489
call or I just said there is this table
 

3095
01:11:33,489 --> 01:11:34,830
call or I just said there is this table
of URLs that are called that's shared

3096
01:11:34,830 --> 01:11:34,840
of URLs that are called that's shared
 

3097
01:11:34,840 --> 01:11:36,540
of URLs that are called that's shared
between all the threads and asked me

3098
01:11:36,540 --> 01:11:36,550
between all the threads and asked me
 

3099
01:11:36,550 --> 01:11:40,320
between all the threads and asked me
locked this version does not have such a

3100
01:11:40,320 --> 01:11:40,330
locked this version does not have such a
 

3101
01:11:40,330 --> 01:11:44,430
locked this version does not have such a
table does not share memory and does not

3102
01:11:44,430 --> 01:11:44,440
table does not share memory and does not
 

3103
01:11:44,440 --> 01:11:52,500
table does not share memory and does not
need to use locks okay so this one the

3104
01:11:52,500 --> 01:11:52,510
need to use locks okay so this one the
 

3105
01:11:52,510 --> 01:11:55,050
need to use locks okay so this one the
instead there's basically a master

3106
01:11:55,050 --> 01:11:55,060
instead there's basically a master
 

3107
01:11:55,060 --> 01:11:57,780
instead there's basically a master
thread that's his master function on a

3108
01:11:57,780 --> 01:11:57,790
thread that's his master function on a
 

3109
01:11:57,790 --> 01:12:00,689
thread that's his master function on a
decent 986 and it has a table but the

3110
01:12:00,689 --> 01:12:00,699
decent 986 and it has a table but the
 

3111
01:12:00,699 --> 01:12:02,790
decent 986 and it has a table but the
table is private to the master function

3112
01:12:02,790 --> 01:12:02,800
table is private to the master function
 

3113
01:12:02,800 --> 01:12:06,680
table is private to the master function
and what the master function is doing is

3114
01:12:06,680 --> 01:12:06,690
and what the master function is doing is
 

3115
01:12:06,690 --> 01:12:09,209
and what the master function is doing is
instead of sort of basically creating a

3116
01:12:09,209 --> 01:12:09,219
instead of sort of basically creating a
 

3117
01:12:09,219 --> 01:12:11,399
instead of sort of basically creating a
tree of functions that corresponds to

3118
01:12:11,399 --> 01:12:11,409
tree of functions that corresponds to
 

3119
01:12:11,409 --> 01:12:13,320
tree of functions that corresponds to
the exploration of the graph which the

3120
01:12:13,320 --> 01:12:13,330
the exploration of the graph which the
 

3121
01:12:13,330 --> 01:12:17,930
the exploration of the graph which the
previous crawler did this one fires off

3122
01:12:17,930 --> 01:12:17,940
previous crawler did this one fires off
 

3123
01:12:17,940 --> 01:12:21,870
previous crawler did this one fires off
one ute one guru team per URL that it's

3124
01:12:21,870 --> 01:12:21,880
one ute one guru team per URL that it's
 

3125
01:12:21,880 --> 01:12:23,760
one ute one guru team per URL that it's
fetches and that but it's only the

3126
01:12:23,760 --> 01:12:23,770
fetches and that but it's only the
 

3127
01:12:23,770 --> 01:12:26,550
fetches and that but it's only the
master only the one master that's

3128
01:12:26,550 --> 01:12:26,560
master only the one master that's
 

3129
01:12:26,560 --> 01:12:28,290
master only the one master that's
creating these threads so we don't have

3130
01:12:28,290 --> 01:12:28,300
creating these threads so we don't have
 

3131
01:12:28,300 --> 01:12:30,120
creating these threads so we don't have
a tree of functions creating threads we

3132
01:12:30,120 --> 01:12:30,130
a tree of functions creating threads we
 

3133
01:12:30,130 --> 01:12:35,189
a tree of functions creating threads we
just have the one master okay so it

3134
01:12:35,189 --> 01:12:35,199
just have the one master okay so it
 

3135
01:12:35,199 --> 01:12:37,530
just have the one master okay so it
creates its own private map a line 88

3136
01:12:37,530 --> 01:12:37,540
creates its own private map a line 88
 

3137
01:12:37,540 --> 01:12:41,540
creates its own private map a line 88
this record what it's fetched and then

3138
01:12:41,540 --> 01:12:41,550
this record what it's fetched and then
 

3139
01:12:41,550 --> 01:12:44,640
this record what it's fetched and then
it also creates a channel just a single

3140
01:12:44,640 --> 01:12:44,650
it also creates a channel just a single
 

3141
01:12:44,650 --> 01:12:46,890
it also creates a channel just a single
channel that all of its worker threads

3142
01:12:46,890 --> 01:12:46,900
channel that all of its worker threads
 

3143
01:12:46,900 --> 01:12:49,110
channel that all of its worker threads
are going to talk to and the idea is

3144
01:12:49,110 --> 01:12:49,120
are going to talk to and the idea is
 

3145
01:12:49,120 --> 01:12:50,689
are going to talk to and the idea is
that it's gonna fire up a worker thread

3146
01:12:50,689 --> 01:12:50,699
that it's gonna fire up a worker thread
 

3147
01:12:50,699 --> 01:12:53,030
that it's gonna fire up a worker thread
and each worker thread that it fires up

3148
01:12:53,030 --> 01:12:53,040
and each worker thread that it fires up
 

3149
01:12:53,040 --> 01:12:55,620
and each worker thread that it fires up
when it finished such as fetching the

3150
01:12:55,620 --> 01:12:55,630
when it finished such as fetching the
 

3151
01:12:55,630 --> 01:12:58,140
when it finished such as fetching the
page will send exactly one item back to

3152
01:12:58,140 --> 01:12:58,150
page will send exactly one item back to
 

3153
01:12:58,150 --> 01:13:00,240
page will send exactly one item back to
the master on the channel and that item

3154
01:13:00,240 --> 01:13:00,250
the master on the channel and that item
 

3155
01:13:00,250 --> 01:13:03,209
the master on the channel and that item
will be a list of the URLs in the page

3156
01:13:03,209 --> 01:13:03,219
will be a list of the URLs in the page
 

3157
01:13:03,219 --> 01:13:07,950
will be a list of the URLs in the page
that that worker thread fetched so the

3158
01:13:07,950 --> 01:13:07,960
that that worker thread fetched so the
 

3159
01:13:07,960 --> 01:13:10,410
that that worker thread fetched so the
master sits in a loop we're in line

3160
01:13:10,410 --> 01:13:10,420
master sits in a loop we're in line
 

3161
01:13:10,420 --> 01:13:13,979
master sits in a loop we're in line
eighty nine is reading entries from the

3162
01:13:13,979 --> 01:13:13,989
eighty nine is reading entries from the
 

3163
01:13:13,989 --> 01:13:16,770
eighty nine is reading entries from the
channel and so we have to imagine that

3164
01:13:16,770 --> 01:13:16,780
channel and so we have to imagine that
 

3165
01:13:16,780 --> 01:13:20,459
channel and so we have to imagine that
it's started up some workers in advance

3166
01:13:20,459 --> 01:13:20,469
it's started up some workers in advance
 

3167
01:13:20,469 --> 01:13:22,830
it's started up some workers in advance
and now it's reading the information the

3168
01:13:22,830 --> 01:13:22,840
and now it's reading the information the
 

3169
01:13:22,840 --> 01:13:24,479
and now it's reading the information the
URL lists that those workers send back

3170
01:13:24,479 --> 01:13:24,489
URL lists that those workers send back
 

3171
01:13:24,489 --> 01:13:26,820
URL lists that those workers send back
and each time he gets a URL is sitting

3172
01:13:26,820 --> 01:13:26,830
and each time he gets a URL is sitting
 

3173
01:13:26,830 --> 01:13:28,800
and each time he gets a URL is sitting
on land eighty nine it then loops over

3174
01:13:28,800 --> 01:13:28,810
on land eighty nine it then loops over
 

3175
01:13:28,810 --> 01:13:32,610
on land eighty nine it then loops over
the URLs in that URL list from a single

3176
01:13:32,610 --> 01:13:32,620
the URLs in that URL list from a single
 

3177
01:13:32,620 --> 01:13:36,090
the URLs in that URL list from a single
page fetch align ninety and if the URL

3178
01:13:36,090 --> 01:13:36,100
page fetch align ninety and if the URL
 

3179
01:13:36,100 --> 01:13:39,959
page fetch align ninety and if the URL
hasn't already been fetched it fires off

3180
01:13:39,959 --> 01:13:39,969
hasn't already been fetched it fires off
 

3181
01:13:39,969 --> 01:13:42,180
hasn't already been fetched it fires off
a new worker at line 94 to fetch that

3182
01:13:42,180 --> 01:13:42,190
a new worker at line 94 to fetch that
 

3183
01:13:42,190 --> 01:13:44,790
a new worker at line 94 to fetch that
URL and if we look at the worker code

3184
01:13:44,790 --> 01:13:44,800
URL and if we look at the worker code
 

3185
01:13:44,800 --> 01:13:47,310
URL and if we look at the worker code
online starting line 77 basically calls

3186
01:13:47,310 --> 01:13:47,320
online starting line 77 basically calls
 

3187
01:13:47,320 --> 01:13:51,120
online starting line 77 basically calls
his fetcher and then sends a message on

3188
01:13:51,120 --> 01:13:51,130
his fetcher and then sends a message on
 

3189
01:13:51,130 --> 01:13:53,700
his fetcher and then sends a message on
the channel a line 80 or 82 saying

3190
01:13:53,700 --> 01:13:53,710
the channel a line 80 or 82 saying
 

3191
01:13:53,710 --> 01:13:57,919
the channel a line 80 or 82 saying
here's the URLs in the page they fetched

3192
01:13:57,919 --> 01:13:57,929
here's the URLs in the page they fetched
 

3193
01:13:57,929 --> 01:14:01,160
here's the URLs in the page they fetched
and notice that now that the maybe

3194
01:14:01,160 --> 01:14:01,170
and notice that now that the maybe
 

3195
01:14:01,170 --> 01:14:03,629
and notice that now that the maybe
interesting thing about this is that the

3196
01:14:03,629 --> 01:14:03,639
interesting thing about this is that the
 

3197
01:14:03,639 --> 01:14:07,979
interesting thing about this is that the
worker threads don't share any objects

3198
01:14:07,979 --> 01:14:07,989
worker threads don't share any objects
 

3199
01:14:07,989 --> 01:14:10,200
worker threads don't share any objects
there's no shared object between the

3200
01:14:10,200 --> 01:14:10,210
there's no shared object between the
 

3201
01:14:10,210 --> 01:14:11,520
there's no shared object between the
workers and the master so we don't have

3202
01:14:11,520 --> 01:14:11,530
workers and the master so we don't have
 

3203
01:14:11,530 --> 01:14:12,840
workers and the master so we don't have
to worry about locking we don't have to

3204
01:14:12,840 --> 01:14:12,850
to worry about locking we don't have to
 

3205
01:14:12,850 --> 01:14:16,350
to worry about locking we don't have to
worry about rhesus instead this is a

3206
01:14:16,350 --> 01:14:16,360
worry about rhesus instead this is a
 

3207
01:14:16,360 --> 01:14:18,930
worry about rhesus instead this is a
example of sort of communicating

3208
01:14:18,930 --> 01:14:18,940
example of sort of communicating
 

3209
01:14:18,940 --> 01:14:21,090
example of sort of communicating
information instead of getting at it

3210
01:14:21,090 --> 01:14:21,100
information instead of getting at it
 

3211
01:14:21,100 --> 01:14:33,920
information instead of getting at it
through shared memory yes

3212
01:14:33,920 --> 01:14:33,930

 

3213
01:14:33,930 --> 01:14:38,130

yeah yeah so the observation is that the

3214
01:14:38,130 --> 01:14:38,140
yeah yeah so the observation is that the
 

3215
01:14:38,140 --> 01:14:40,800
yeah yeah so the observation is that the
code appears but the workers are the

3216
01:14:40,800 --> 01:14:40,810
code appears but the workers are the
 

3217
01:14:40,810 --> 01:14:42,240
code appears but the workers are the
observation is the workers are modifying

3218
01:14:42,240 --> 01:14:42,250
observation is the workers are modifying
 

3219
01:14:42,250 --> 01:14:49,160
observation is the workers are modifying
ch while the Masters reading it and

3220
01:14:49,160 --> 01:14:49,170

 

3221
01:14:49,170 --> 01:14:51,510

that's not the way the go authors would

3222
01:14:51,510 --> 01:14:51,520
that's not the way the go authors would
 

3223
01:14:51,520 --> 01:14:54,150
that's not the way the go authors would
like you to think about this the way

3224
01:14:54,150 --> 01:14:54,160
like you to think about this the way
 

3225
01:14:54,160 --> 01:14:55,350
like you to think about this the way
they want you to think about this is

3226
01:14:55,350 --> 01:14:55,360
they want you to think about this is
 

3227
01:14:55,360 --> 01:14:58,020
they want you to think about this is
that CH is a channel and the channel has

3228
01:14:58,020 --> 01:14:58,030
that CH is a channel and the channel has
 

3229
01:14:58,030 --> 01:15:00,870
that CH is a channel and the channel has
send and receive operations and the

3230
01:15:00,870 --> 01:15:00,880
send and receive operations and the
 

3231
01:15:00,880 --> 01:15:03,060
send and receive operations and the
workers are sending on the channel while

3232
01:15:03,060 --> 01:15:03,070
workers are sending on the channel while
 

3233
01:15:03,070 --> 01:15:05,250
workers are sending on the channel while
the master receives on the channel and

3234
01:15:05,250 --> 01:15:05,260
the master receives on the channel and
 

3235
01:15:05,260 --> 01:15:09,240
the master receives on the channel and
that's perfectly legal the channel is

3236
01:15:09,240 --> 01:15:09,250
that's perfectly legal the channel is
 

3237
01:15:09,250 --> 01:15:11,040
that's perfectly legal the channel is
happy I mean what that really means is

3238
01:15:11,040 --> 01:15:11,050
happy I mean what that really means is
 

3239
01:15:11,050 --> 01:15:12,780
happy I mean what that really means is
that the internal implementation of

3240
01:15:12,780 --> 01:15:12,790
that the internal implementation of
 

3241
01:15:12,790 --> 01:15:15,600
that the internal implementation of
channel has a mutex in it and the

3242
01:15:15,600 --> 01:15:15,610
channel has a mutex in it and the
 

3243
01:15:15,610 --> 01:15:18,990
channel has a mutex in it and the
channel operations are careful to take

3244
01:15:18,990 --> 01:15:19,000
channel operations are careful to take
 

3245
01:15:19,000 --> 01:15:20,850
channel operations are careful to take
out the mutex when they're messing with

3246
01:15:20,850 --> 01:15:20,860
out the mutex when they're messing with
 

3247
01:15:20,860 --> 01:15:22,439
out the mutex when they're messing with
the channels internal data to ensure

3248
01:15:22,439 --> 01:15:22,449
the channels internal data to ensure
 

3249
01:15:22,449 --> 01:15:24,180
the channels internal data to ensure
that it doesn't actually have any

3250
01:15:24,180 --> 01:15:24,190
that it doesn't actually have any
 

3251
01:15:24,190 --> 01:15:27,570
that it doesn't actually have any
reasons in it but yeah channels are sort

3252
01:15:27,570 --> 01:15:27,580
reasons in it but yeah channels are sort
 

3253
01:15:27,580 --> 01:15:29,280
reasons in it but yeah channels are sort
of protected against concurrency and

3254
01:15:29,280 --> 01:15:29,290
of protected against concurrency and
 

3255
01:15:29,290 --> 01:15:30,390
of protected against concurrency and
you're allowed to use them concurrently

3256
01:15:30,390 --> 01:15:30,400
you're allowed to use them concurrently
 

3257
01:15:30,400 --> 01:15:36,379
you're allowed to use them concurrently
from different threads yes

3258
01:15:36,379 --> 01:15:36,389

 

3259
01:15:36,389 --> 01:15:53,800

over the channel receive yes

3260
01:15:53,800 --> 01:15:53,810

 

3261
01:15:53,810 --> 01:15:56,250

we don't need to close the channel I

3262
01:15:56,250 --> 01:15:56,260
we don't need to close the channel I
 

3263
01:15:56,260 --> 01:15:58,840
we don't need to close the channel I
mean okay the the break statement is

3264
01:15:58,840 --> 01:15:58,850
mean okay the the break statement is
 

3265
01:15:58,850 --> 01:16:00,580
mean okay the the break statement is
about when the crawl has completely

3266
01:16:00,580 --> 01:16:00,590
about when the crawl has completely
 

3267
01:16:00,590 --> 01:16:03,150
about when the crawl has completely
finished and we fetched every single URL

3268
01:16:03,150 --> 01:16:03,160
finished and we fetched every single URL
 

3269
01:16:03,160 --> 01:16:06,400
finished and we fetched every single URL
right because hey what's going on is the

3270
01:16:06,400 --> 01:16:06,410
right because hey what's going on is the
 

3271
01:16:06,410 --> 01:16:09,220
right because hey what's going on is the
master is keeping I mean this n value is

3272
01:16:09,220 --> 01:16:09,230
master is keeping I mean this n value is
 

3273
01:16:09,230 --> 01:16:13,180
master is keeping I mean this n value is
private value and a master every time it

3274
01:16:13,180 --> 01:16:13,190
private value and a master every time it
 

3275
01:16:13,190 --> 01:16:14,850
private value and a master every time it
fires off a worker at increments the end

3276
01:16:14,850 --> 01:16:14,860
fires off a worker at increments the end
 

3277
01:16:14,860 --> 01:16:17,350
fires off a worker at increments the end
though every worker it starts since

3278
01:16:17,350 --> 01:16:17,360
though every worker it starts since
 

3279
01:16:17,360 --> 01:16:20,470
though every worker it starts since
exactly one item on the channel and so

3280
01:16:20,470 --> 01:16:20,480
exactly one item on the channel and so
 

3281
01:16:20,480 --> 01:16:21,910
exactly one item on the channel and so
every time the master reads an item off

3282
01:16:21,910 --> 01:16:21,920
every time the master reads an item off
 

3283
01:16:21,920 --> 01:16:23,110
every time the master reads an item off
the channel it knows that one of his

3284
01:16:23,110 --> 01:16:23,120
the channel it knows that one of his
 

3285
01:16:23,120 --> 01:16:24,910
the channel it knows that one of his
workers is finished and when the number

3286
01:16:24,910 --> 01:16:24,920
workers is finished and when the number
 

3287
01:16:24,920 --> 01:16:29,050
workers is finished and when the number
of outstanding workers goes to zero then

3288
01:16:29,050 --> 01:16:29,060
of outstanding workers goes to zero then
 

3289
01:16:29,060 --> 01:16:32,860
of outstanding workers goes to zero then
we're done and we don't once the number

3290
01:16:32,860 --> 01:16:32,870
we're done and we don't once the number
 

3291
01:16:32,870 --> 01:16:34,510
we're done and we don't once the number
of outstanding workers goes to zero then

3292
01:16:34,510 --> 01:16:34,520
of outstanding workers goes to zero then
 

3293
01:16:34,520 --> 01:16:36,490
of outstanding workers goes to zero then
the only reference to the channel is

3294
01:16:36,490 --> 01:16:36,500
the only reference to the channel is
 

3295
01:16:36,500 --> 01:16:40,360
the only reference to the channel is
from the master or from oh really from

3296
01:16:40,360 --> 01:16:40,370
from the master or from oh really from
 

3297
01:16:40,370 --> 01:16:41,770
from the master or from oh really from
the code that calls the master and so

3298
01:16:41,770 --> 01:16:41,780
the code that calls the master and so
 

3299
01:16:41,780 --> 01:16:43,450
the code that calls the master and so
the garbage collector will very soon see

3300
01:16:43,450 --> 01:16:43,460
the garbage collector will very soon see
 

3301
01:16:43,460 --> 01:16:45,250
the garbage collector will very soon see
that the channel has no references to it

3302
01:16:45,250 --> 01:16:45,260
that the channel has no references to it
 

3303
01:16:45,260 --> 01:16:48,670
that the channel has no references to it
and will free the channel so in this

3304
01:16:48,670 --> 01:16:48,680
and will free the channel so in this
 

3305
01:16:48,680 --> 01:16:50,050
and will free the channel so in this
case sometimes you need to close

3306
01:16:50,050 --> 01:16:50,060
case sometimes you need to close
 

3307
01:16:50,060 --> 01:16:53,620
case sometimes you need to close
channels but actually I rarely have to

3308
01:16:53,620 --> 01:16:53,630
channels but actually I rarely have to
 

3309
01:16:53,630 --> 01:17:03,140
channels but actually I rarely have to
close channels

3310
01:17:03,140 --> 01:17:03,150

 

3311
01:17:03,150 --> 01:17:09,739

he said again

3312
01:17:09,739 --> 01:17:09,749

 

3313
01:17:09,749 --> 01:17:12,209

so the question is alright so you can

3314
01:17:12,209 --> 01:17:12,219
so the question is alright so you can
 

3315
01:17:12,219 --> 01:17:16,379
so the question is alright so you can
see at line 106 before calling master

3316
01:17:16,379 --> 01:17:16,389
see at line 106 before calling master
 

3317
01:17:16,389 --> 01:17:19,939
see at line 106 before calling master
concurrent channel sort of fires up one

3318
01:17:19,939 --> 01:17:19,949
concurrent channel sort of fires up one
 

3319
01:17:19,949 --> 01:17:25,649
concurrent channel sort of fires up one
shoves one URL into the channel and it's

3320
01:17:25,649 --> 01:17:25,659
shoves one URL into the channel and it's
 

3321
01:17:25,659 --> 01:17:26,700
shoves one URL into the channel and it's
to sort of get the whole thing started

3322
01:17:26,700 --> 01:17:26,710
to sort of get the whole thing started
 

3323
01:17:26,710 --> 01:17:28,049
to sort of get the whole thing started
because the code for master was written

3324
01:17:28,049 --> 01:17:28,059
because the code for master was written
 

3325
01:17:28,059 --> 01:17:29,459
because the code for master was written
you know the master goes right into

3326
01:17:29,459 --> 01:17:29,469
you know the master goes right into
 

3327
01:17:29,469 --> 01:17:31,739
you know the master goes right into
reading from the channel line 89 so

3328
01:17:31,739 --> 01:17:31,749
reading from the channel line 89 so
 

3329
01:17:31,749 --> 01:17:33,479
reading from the channel line 89 so
there better be something in the channel

3330
01:17:33,479 --> 01:17:33,489
there better be something in the channel
 

3331
01:17:33,489 --> 01:17:36,540
there better be something in the channel
otherwise line 89 would block forever so

3332
01:17:36,540 --> 01:17:36,550
otherwise line 89 would block forever so
 

3333
01:17:36,550 --> 01:17:38,250
otherwise line 89 would block forever so
if it weren't for that little code at

3334
01:17:38,250 --> 01:17:38,260
if it weren't for that little code at
 

3335
01:17:38,260 --> 01:17:42,540
if it weren't for that little code at
line 107 the for loop at 89 would block

3336
01:17:42,540 --> 01:17:42,550
line 107 the for loop at 89 would block
 

3337
01:17:42,550 --> 01:17:44,040
line 107 the for loop at 89 would block
reading from the channel forever and

3338
01:17:44,040 --> 01:17:44,050
reading from the channel forever and
 

3339
01:17:44,050 --> 01:17:54,450
reading from the channel forever and
this code wouldn't work well yeah so the

3340
01:17:54,450 --> 01:17:54,460
this code wouldn't work well yeah so the
 

3341
01:17:54,460 --> 01:17:56,279
this code wouldn't work well yeah so the
observation is gosh you know wouldn't it

3342
01:17:56,279 --> 01:17:56,289
observation is gosh you know wouldn't it
 

3343
01:17:56,289 --> 01:17:57,500
observation is gosh you know wouldn't it
be nice to be able to write code that

3344
01:17:57,500 --> 01:17:57,510
be nice to be able to write code that
 

3345
01:17:57,510 --> 01:17:59,520
be nice to be able to write code that
would be able to notice if there's

3346
01:17:59,520 --> 01:17:59,530
would be able to notice if there's
 

3347
01:17:59,530 --> 01:18:01,560
would be able to notice if there's
nothing waiting on the channel and you

3348
01:18:01,560 --> 01:18:01,570
nothing waiting on the channel and you
 

3349
01:18:01,570 --> 01:18:03,209
nothing waiting on the channel and you
can if you look up the Select statement

3350
01:18:03,209 --> 01:18:03,219
can if you look up the Select statement
 

3351
01:18:03,219 --> 01:18:05,009
can if you look up the Select statement
it's much more complicated than this but

3352
01:18:05,009 --> 01:18:05,019
it's much more complicated than this but
 

3353
01:18:05,019 --> 01:18:06,569
it's much more complicated than this but
there is the Select statement which

3354
01:18:06,569 --> 01:18:06,579
there is the Select statement which
 

3355
01:18:06,579 --> 01:18:09,450
there is the Select statement which
allows you to proceed to not block if

3356
01:18:09,450 --> 01:18:09,460
allows you to proceed to not block if
 

3357
01:18:09,460 --> 01:18:11,129
allows you to proceed to not block if
something if there's nothing waiting on

3358
01:18:11,129 --> 01:18:11,139
something if there's nothing waiting on
 

3359
01:18:11,139 --> 01:18:44,580
something if there's nothing waiting on
the channel

3360
01:18:44,580 --> 01:18:44,590

 

3361
01:18:44,590 --> 01:18:59,590

because the work resin finish okay sorry

3362
01:18:59,590 --> 01:18:59,600
because the work resin finish okay sorry
 

3363
01:18:59,600 --> 01:19:02,590
because the work resin finish okay sorry
to the first question is there I think

3364
01:19:02,590 --> 01:19:02,600
to the first question is there I think
 

3365
01:19:02,600 --> 01:19:03,820
to the first question is there I think
what you're really worried about is

3366
01:19:03,820 --> 01:19:03,830
what you're really worried about is
 

3367
01:19:03,830 --> 01:19:05,620
what you're really worried about is
whether we're actually able to launch

3368
01:19:05,620 --> 01:19:05,630
whether we're actually able to launch
 

3369
01:19:05,630 --> 01:19:09,100
whether we're actually able to launch
parallel so the very first step won't be

3370
01:19:09,100 --> 01:19:09,110
parallel so the very first step won't be
 

3371
01:19:09,110 --> 01:19:37,210
parallel so the very first step won't be
in parallel because there's an exit

3372
01:19:37,210 --> 01:19:37,220
in parallel because there's an exit
 

3373
01:19:37,220 --> 01:19:40,260
in parallel because there's an exit
owner the for-loop weights in at line 89

3374
01:19:40,260 --> 01:19:40,270
owner the for-loop weights in at line 89
 

3375
01:19:40,270 --> 01:19:44,440
owner the for-loop weights in at line 89
that's not okay that for loop at line 89

3376
01:19:44,440 --> 01:19:44,450
that's not okay that for loop at line 89
 

3377
01:19:44,450 --> 01:19:47,650
that's not okay that for loop at line 89
is does not just loop over the current

3378
01:19:47,650 --> 01:19:47,660
is does not just loop over the current
 

3379
01:19:47,660 --> 01:19:49,180
is does not just loop over the current
contents of the channel and then quit

3380
01:19:49,180 --> 01:19:49,190
contents of the channel and then quit
 

3381
01:19:49,190 --> 01:19:54,220
contents of the channel and then quit
that is the for loop at 89 is going to

3382
01:19:54,220 --> 01:19:54,230
that is the for loop at 89 is going to
 

3383
01:19:54,230 --> 01:19:58,090
that is the for loop at 89 is going to
read it may never exit but it's gonna

3384
01:19:58,090 --> 01:19:58,100
read it may never exit but it's gonna
 

3385
01:19:58,100 --> 01:19:59,770
read it may never exit but it's gonna
read it's just going to keep waiting

3386
01:19:59,770 --> 01:19:59,780
read it's just going to keep waiting
 

3387
01:19:59,780 --> 01:20:01,120
read it's just going to keep waiting
until something shows up in the channel

3388
01:20:01,120 --> 01:20:01,130
until something shows up in the channel
 

3389
01:20:01,130 --> 01:20:04,270
until something shows up in the channel
so if you don't hit the break at line 99

3390
01:20:04,270 --> 01:20:04,280
so if you don't hit the break at line 99
 

3391
01:20:04,280 --> 01:20:10,240
so if you don't hit the break at line 99
the for loop own exit yeah alright I'm

3392
01:20:10,240 --> 01:20:10,250
the for loop own exit yeah alright I'm
 

3393
01:20:10,250 --> 01:20:12,430
the for loop own exit yeah alright I'm
afraid we're out of time we'll continue

3394
01:20:12,430 --> 01:20:12,440
afraid we're out of time we'll continue
 

3395
01:20:12,440 --> 01:20:15,790
afraid we're out of time we'll continue
this actually we have a presentation

3396
01:20:15,790 --> 01:20:15,800
this actually we have a presentation
 

3397
01:20:15,800 --> 01:20:18,250
this actually we have a presentation
scheduled by the TAS which I'll talk

3398
01:20:18,250 --> 01:20:18,260
scheduled by the TAS which I'll talk
 

3399
01:20:18,260 --> 01:20:20,950
scheduled by the TAS which I'll talk
more about go

